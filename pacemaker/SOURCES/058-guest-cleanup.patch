From d3322b19c38200d4a7a535618fb8b4b6061386b4 Mon Sep 17 00:00:00 2001
From: Klaus Wenninger <klaus.wenninger@aon.at>
Date: Thu, 4 May 2017 19:43:43 +0200
Subject: [PATCH 1/4] Fix: pengine: have guest-node connection-resources probed

---
 pengine/native.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/pengine/native.c b/pengine/native.c
index d0cebb3..283772f 100644
--- a/pengine/native.c
+++ b/pengine/native.c
@@ -2737,7 +2737,7 @@ native_create_probe(resource_t * rsc, node_t * node, action_t * complete,
 
         return any_created;
 
-    } else if (rsc->container) {
+    } else if ((rsc->container) && (!rsc->is_remote_node)) {
         pe_rsc_trace(rsc, "Skipping %s: it is within container %s", rsc->id, rsc->container->id);
         return FALSE;
     }
-- 
1.8.3.1


From bda2ddcfb1a4902c6fa9b6691eecc1230eb7dbcf Mon Sep 17 00:00:00 2001
From: Klaus Wenninger <klaus.wenninger@aon.at>
Date: Thu, 4 May 2017 23:08:40 +0200
Subject: [PATCH 2/4] Test: pengine: update regression tests for probes of
 guest-connections

---
 pengine/test10/bug-cl-5247.dot                     |   3 +
 pengine/test10/bug-cl-5247.exp                     | 286 +++++++++---------
 pengine/test10/bug-cl-5247.summary                 |   6 +-
 pengine/test10/guest-node-host-dies.dot            |  18 ++
 pengine/test10/guest-node-host-dies.exp            | 322 +++++++++++++--------
 pengine/test10/guest-node-host-dies.summary        |   6 +
 pengine/test10/whitebox-fail3.dot                  |   2 +
 pengine/test10/whitebox-fail3.exp                  |  72 +++--
 pengine/test10/whitebox-fail3.summary              |   3 +-
 pengine/test10/whitebox-migrate1.dot               |   4 +
 pengine/test10/whitebox-migrate1.exp               |  92 +++---
 pengine/test10/whitebox-migrate1.summary           |   1 +
 pengine/test10/whitebox-ms-ordering-move.dot       |  16 +
 pengine/test10/whitebox-ms-ordering-move.exp       | 194 +++++++++----
 pengine/test10/whitebox-ms-ordering-move.summary   |   8 +
 pengine/test10/whitebox-ms-ordering.dot            |  12 +
 pengine/test10/whitebox-ms-ordering.exp            | 262 +++++++++++------
 pengine/test10/whitebox-ms-ordering.summary        |   6 +
 pengine/test10/whitebox-nested-group.dot           |   6 +
 pengine/test10/whitebox-nested-group.exp           | 216 ++++++++------
 pengine/test10/whitebox-nested-group.summary       |   3 +
 pengine/test10/whitebox-unexpectedly-running.dot   |   2 +
 pengine/test10/whitebox-unexpectedly-running.exp   |  46 +--
 .../test10/whitebox-unexpectedly-running.summary   |   1 +
 24 files changed, 1018 insertions(+), 569 deletions(-)

diff --git a/pengine/test10/bug-cl-5247.dot b/pengine/test10/bug-cl-5247.dot
index 0ab7893..44f788d 100644
--- a/pengine/test10/bug-cl-5247.dot
+++ b/pengine/test10/bug-cl-5247.dot
@@ -89,6 +89,9 @@ digraph "g" {
 "pgsql_stop_0 pgsr02" -> "all_stopped" [ style = bold]
 "pgsql_stop_0 pgsr02" -> "msPostgresql_stopped_0" [ style = bold]
 "pgsql_stop_0 pgsr02" [ style=bold color="green" fontcolor="orange"]
+"pgsr01_monitor_0 bl460g8n4" [ style=bold color="green" fontcolor="black"]
+"pgsr02_monitor_0 bl460g8n3" -> "pgsr02_stop_0 bl460g8n4" [ style = bold]
+"pgsr02_monitor_0 bl460g8n3" [ style=bold color="green" fontcolor="black"]
 "pgsr02_stop_0 bl460g8n4" -> "all_stopped" [ style = bold]
 "pgsr02_stop_0 bl460g8n4" -> "prmDB2_stop_0 bl460g8n4" [ style = bold]
 "pgsr02_stop_0 bl460g8n4" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/bug-cl-5247.exp b/pengine/test10/bug-cl-5247.exp
index 8ef8b9d..e7bac9c 100644
--- a/pengine/test10/bug-cl-5247.exp
+++ b/pengine/test10/bug-cl-5247.exp
@@ -8,28 +8,28 @@
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="66" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
+        <rsc_op id="68" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <pseudo_event id="17" operation="stopped" operation_key="grpStonith1_stopped_0">
+      <pseudo_event id="19" operation="stopped" operation_key="grpStonith1_stopped_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="13" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
+        <rsc_op id="15" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <pseudo_event id="16" operation="stop" operation_key="grpStonith1_stop_0"/>
+        <pseudo_event id="18" operation="stop" operation_key="grpStonith1_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <pseudo_event id="16" operation="stop" operation_key="grpStonith1_stop_0">
+      <pseudo_event id="18" operation="stop" operation_key="grpStonith1_stop_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -37,7 +37,7 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <pseudo_event id="15" operation="running" operation_key="grpStonith1_running_0">
+      <pseudo_event id="17" operation="running" operation_key="grpStonith1_running_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -46,32 +46,32 @@
         <rsc_op id="9" operation="start" operation_key="prmStonith1-2_start_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <pseudo_event id="14" operation="start" operation_key="grpStonith1_start_0"/>
+        <pseudo_event id="16" operation="start" operation_key="grpStonith1_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <pseudo_event id="14" operation="start" operation_key="grpStonith1_start_0">
+      <pseudo_event id="16" operation="start" operation_key="grpStonith1_start_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="17" operation="stopped" operation_key="grpStonith1_stopped_0"/>
+        <pseudo_event id="19" operation="stopped" operation_key="grpStonith1_stopped_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <rsc_op id="13" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400">
+      <rsc_op id="15" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400">
         <primitive id="prmStonith1-2" class="stonith" type="external/ipmi"/>
         <attributes CRM_meta_name="stop" CRM_meta_on_fail="ignore" CRM_meta_on_node="bl460g8n4" CRM_meta_on_node_uuid="3232261400" CRM_meta_timeout="60000"  hostname="bl460g8n3" interface="lanplus" ipaddr="192.168.28.43" passwd="****" pcmk_reboot_timeout="60s" userid="USERID"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="16" operation="stop" operation_key="grpStonith1_stop_0"/>
+        <pseudo_event id="18" operation="stop" operation_key="grpStonith1_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
@@ -87,10 +87,10 @@
         <pseudo_event id="8" operation="all_stopped" operation_key="all_stopped"/>
       </trigger>
       <trigger>
-        <rsc_op id="13" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
+        <rsc_op id="15" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <pseudo_event id="14" operation="start" operation_key="grpStonith1_start_0"/>
+        <pseudo_event id="16" operation="start" operation_key="grpStonith1_start_0"/>
       </trigger>
     </inputs>
   </synapse>
@@ -109,22 +109,22 @@
   </synapse>
   <synapse id="8">
     <action_set>
-      <pseudo_event id="22" operation="stopped" operation_key="grpStonith2_stopped_0">
+      <pseudo_event id="24" operation="stopped" operation_key="grpStonith2_stopped_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="18" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
+        <rsc_op id="20" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
       </trigger>
       <trigger>
-        <pseudo_event id="21" operation="stop" operation_key="grpStonith2_stop_0"/>
+        <pseudo_event id="23" operation="stop" operation_key="grpStonith2_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9">
     <action_set>
-      <pseudo_event id="21" operation="stop" operation_key="grpStonith2_stop_0">
+      <pseudo_event id="23" operation="stop" operation_key="grpStonith2_stop_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -132,7 +132,7 @@
   </synapse>
   <synapse id="10">
     <action_set>
-      <pseudo_event id="20" operation="running" operation_key="grpStonith2_running_0">
+      <pseudo_event id="22" operation="running" operation_key="grpStonith2_running_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -141,32 +141,32 @@
         <rsc_op id="10" operation="start" operation_key="prmStonith2-2_start_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
       </trigger>
       <trigger>
-        <pseudo_event id="19" operation="start" operation_key="grpStonith2_start_0"/>
+        <pseudo_event id="21" operation="start" operation_key="grpStonith2_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <pseudo_event id="19" operation="start" operation_key="grpStonith2_start_0">
+      <pseudo_event id="21" operation="start" operation_key="grpStonith2_start_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="22" operation="stopped" operation_key="grpStonith2_stopped_0"/>
+        <pseudo_event id="24" operation="stopped" operation_key="grpStonith2_stopped_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <rsc_op id="18" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399">
+      <rsc_op id="20" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399">
         <primitive id="prmStonith2-2" class="stonith" type="external/ipmi"/>
         <attributes CRM_meta_name="stop" CRM_meta_on_fail="ignore" CRM_meta_on_node="bl460g8n3" CRM_meta_on_node_uuid="3232261399" CRM_meta_timeout="60000"  hostname="bl460g8n4" interface="lanplus" ipaddr="192.168.28.44" passwd="****" pcmk_reboot_timeout="60s" userid="USERID"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="21" operation="stop" operation_key="grpStonith2_stop_0"/>
+        <pseudo_event id="23" operation="stop" operation_key="grpStonith2_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
@@ -182,10 +182,10 @@
         <pseudo_event id="8" operation="all_stopped" operation_key="all_stopped"/>
       </trigger>
       <trigger>
-        <rsc_op id="18" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
+        <rsc_op id="20" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
       </trigger>
       <trigger>
-        <pseudo_event id="19" operation="start" operation_key="grpStonith2_start_0"/>
+        <pseudo_event id="21" operation="start" operation_key="grpStonith2_start_0"/>
       </trigger>
     </inputs>
   </synapse>
@@ -204,349 +204,349 @@
   </synapse>
   <synapse id="15">
     <action_set>
-      <pseudo_event id="32" operation="stopped" operation_key="master-group_stopped_0">
+      <pseudo_event id="34" operation="stopped" operation_key="master-group_stopped_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="23" operation="stop" operation_key="vip-master_stop_0"/>
+        <pseudo_event id="25" operation="stop" operation_key="vip-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="stop" operation_key="vip-rep_stop_0"/>
+        <pseudo_event id="28" operation="stop" operation_key="vip-rep_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="31" operation="stop" operation_key="master-group_stop_0"/>
+        <pseudo_event id="33" operation="stop" operation_key="master-group_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
-      <pseudo_event id="31" operation="stop" operation_key="master-group_stop_0">
+      <pseudo_event id="33" operation="stop" operation_key="master-group_stop_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
+        <pseudo_event id="65" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="17">
     <action_set>
-      <pseudo_event id="30" operation="running" operation_key="master-group_running_0">
+      <pseudo_event id="32" operation="running" operation_key="master-group_running_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="24" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="26" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
       <trigger>
-        <rsc_op id="27" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="29" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="29" operation="start" operation_key="master-group_start_0"/>
+        <pseudo_event id="31" operation="start" operation_key="master-group_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="18">
     <action_set>
-      <pseudo_event id="29" operation="start" operation_key="master-group_start_0">
+      <pseudo_event id="31" operation="start" operation_key="master-group_start_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="32" operation="stopped" operation_key="master-group_stopped_0"/>
+        <pseudo_event id="34" operation="stopped" operation_key="master-group_stopped_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="19">
     <action_set>
-      <rsc_op id="25" operation="monitor" operation_key="vip-master_monitor_10000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="27" operation="monitor" operation_key="vip-master_monitor_10000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="vip-master" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_fail="restart" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="24" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="26" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="20">
     <action_set>
-      <rsc_op id="24" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="26" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="vip-master" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_fail="restart" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="23" operation="stop" operation_key="vip-master_stop_0"/>
+        <pseudo_event id="25" operation="stop" operation_key="vip-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="29" operation="start" operation_key="master-group_start_0"/>
+        <pseudo_event id="31" operation="start" operation_key="master-group_start_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="67" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="69" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="21">
     <action_set>
-      <pseudo_event id="23" operation="stop" operation_key="vip-master_stop_0">
+      <pseudo_event id="25" operation="stop" operation_key="vip-master_stop_0">
         <attributes CRM_meta_name="stop" CRM_meta_on_fail="fence" CRM_meta_timeout="60000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="26" operation="stop" operation_key="vip-rep_stop_0"/>
+        <pseudo_event id="28" operation="stop" operation_key="vip-rep_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="31" operation="stop" operation_key="master-group_stop_0"/>
+        <pseudo_event id="33" operation="stop" operation_key="master-group_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="22">
     <action_set>
-      <rsc_op id="28" operation="monitor" operation_key="vip-rep_monitor_10000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="30" operation="monitor" operation_key="vip-rep_monitor_10000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="vip-rep" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_fail="restart" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="27" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="29" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="23">
     <action_set>
-      <rsc_op id="27" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="29" operation="start" operation_key="vip-rep_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="vip-rep" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_fail="stop" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="24" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="26" operation="start" operation_key="vip-master_start_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="stop" operation_key="vip-rep_stop_0"/>
+        <pseudo_event id="28" operation="stop" operation_key="vip-rep_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="29" operation="start" operation_key="master-group_start_0"/>
+        <pseudo_event id="31" operation="start" operation_key="master-group_start_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="67" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="69" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="24">
     <action_set>
-      <pseudo_event id="26" operation="stop" operation_key="vip-rep_stop_0">
+      <pseudo_event id="28" operation="stop" operation_key="vip-rep_stop_0">
         <attributes CRM_meta_name="stop" CRM_meta_on_fail="ignore" CRM_meta_timeout="60000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="31" operation="stop" operation_key="master-group_stop_0"/>
+        <pseudo_event id="33" operation="stop" operation_key="master-group_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="25" priority="1000000">
     <action_set>
-      <pseudo_event id="70" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0">
+      <pseudo_event id="72" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="60000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="69" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0"/>
+        <pseudo_event id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="73" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="26" priority="1000000">
     <action_set>
-      <pseudo_event id="69" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0">
+      <pseudo_event id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="60000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="27">
     <action_set>
-      <pseudo_event id="34" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0">
+      <pseudo_event id="36" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_on_fail="fence" CRM_meta_timeout="300000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="33" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0"/>
+        <pseudo_event id="35" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="46" operation="stop" operation_key="msPostgresql_stop_0"/>
+        <pseudo_event id="48" operation="stop" operation_key="msPostgresql_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="28">
     <action_set>
-      <pseudo_event id="33" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0">
+      <pseudo_event id="35" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="demote" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_on_fail="fence" CRM_meta_timeout="300000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="58" operation="demote" operation_key="msPostgresql_demote_0"/>
+        <pseudo_event id="60" operation="demote" operation_key="msPostgresql_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="29" priority="1000000">
     <action_set>
-      <rsc_op id="81" operation="notify" operation_key="pgsql_post_notify_demote_0" internal_operation_key="pgsql:1_post_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="83" operation="notify" operation_key="pgsql_post_notify_demote_0" internal_operation_key="pgsql:1_post_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="pgsql" long-id="pgsql:1" class="ocf" provider="heartbeat" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_key_operation="demoted" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_operation="demote" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_notify_type="post" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="62" operation="notify" operation_key="msPostgresql_post_notify_demoted_0"/>
+        <pseudo_event id="64" operation="notify" operation_key="msPostgresql_post_notify_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="30">
     <action_set>
-      <rsc_op id="80" operation="notify" operation_key="pgsql_pre_notify_demote_0" internal_operation_key="pgsql:1_pre_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="82" operation="notify" operation_key="pgsql_pre_notify_demote_0" internal_operation_key="pgsql:1_pre_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="pgsql" long-id="pgsql:1" class="ocf" provider="heartbeat" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_key_operation="demote" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_operation="demote" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_notify_type="pre" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="60" operation="notify" operation_key="msPostgresql_pre_notify_demote_0"/>
+        <pseudo_event id="62" operation="notify" operation_key="msPostgresql_pre_notify_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="31">
     <action_set>
-      <rsc_op id="77" operation="notify" operation_key="pgsql_pre_notify_stop_0" internal_operation_key="pgsql:1_pre_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="79" operation="notify" operation_key="pgsql_pre_notify_stop_0" internal_operation_key="pgsql:1_pre_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="pgsql" long-id="pgsql:1" class="ocf" provider="heartbeat" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_notify_type="pre" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="48" operation="notify" operation_key="msPostgresql_pre_notify_stop_0"/>
+        <pseudo_event id="50" operation="notify" operation_key="msPostgresql_pre_notify_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="32" priority="1000000">
     <action_set>
-      <rsc_op id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="73" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="pgsql" long-id="pgsql:1" class="ocf" provider="heartbeat" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="notify" CRM_meta_notify="true" CRM_meta_notify_active_resource="pgsql:0 pgsql:1" CRM_meta_notify_active_uname="pgsr02 pgsr01" CRM_meta_notify_all_uname="bl460g8n3 bl460g8n4 pgsr01 pgsr02" CRM_meta_notify_available_uname="bl460g8n4 bl460g8n3 pgsr01 pgsr02" CRM_meta_notify_demote_resource="pgsql:0" CRM_meta_notify_demote_uname="pgsr02" CRM_meta_notify_inactive_resource=" " CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="pgsql:0 pgsql:1" CRM_meta_notify_master_uname="pgsr02 pgsr01" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource=" " CRM_meta_notify_slave_uname=" " CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="pgsql:0" CRM_meta_notify_stop_uname="pgsr02" CRM_meta_notify_type="post" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="50" operation="notify" operation_key="msPostgresql_post_notify_stopped_0"/>
+        <pseudo_event id="52" operation="notify" operation_key="msPostgresql_post_notify_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="69" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0"/>
+        <pseudo_event id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:0_post_notify_stonith_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="33">
     <action_set>
-      <rsc_op id="39" operation="monitor" operation_key="pgsql_monitor_9000" internal_operation_key="pgsql:1_monitor_9000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
+      <rsc_op id="41" operation="monitor" operation_key="pgsql_monitor_9000" internal_operation_key="pgsql:1_monitor_9000" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3">
         <primitive id="pgsql" long-id="pgsql:1" class="ocf" provider="heartbeat" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="9000" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="true" CRM_meta_on_fail="restart" CRM_meta_on_node="pgsr01" CRM_meta_on_node_uuid="pgsr01" CRM_meta_op_target_rc="8" CRM_meta_role="Master" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0"/>
+        <pseudo_event id="53" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
+        <pseudo_event id="65" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="70" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0"/>
+        <pseudo_event id="72" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="34" priority="1000000">
     <action_set>
-      <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0">
+      <pseudo_event id="65" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="demoted" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="demote" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="62" operation="notify" operation_key="msPostgresql_post_notify_demoted_0"/>
+        <pseudo_event id="64" operation="notify" operation_key="msPostgresql_post_notify_demoted_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="81" operation="notify" operation_key="pgsql_post_notify_demote_0" internal_operation_key="pgsql:1_post_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="83" operation="notify" operation_key="pgsql_post_notify_demote_0" internal_operation_key="pgsql:1_post_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="35" priority="1000000">
     <action_set>
-      <pseudo_event id="62" operation="notify" operation_key="msPostgresql_post_notify_demoted_0">
+      <pseudo_event id="64" operation="notify" operation_key="msPostgresql_post_notify_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="demoted" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="demote" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="59" operation="demoted" operation_key="msPostgresql_demoted_0"/>
+        <pseudo_event id="61" operation="demoted" operation_key="msPostgresql_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="61" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0"/>
+        <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="36">
     <action_set>
-      <pseudo_event id="61" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0">
+      <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="demote" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="demote" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="60" operation="notify" operation_key="msPostgresql_pre_notify_demote_0"/>
+        <pseudo_event id="62" operation="notify" operation_key="msPostgresql_pre_notify_demote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="80" operation="notify" operation_key="pgsql_pre_notify_demote_0" internal_operation_key="pgsql:1_pre_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="82" operation="notify" operation_key="pgsql_pre_notify_demote_0" internal_operation_key="pgsql:1_pre_notify_demote_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="37">
     <action_set>
-      <pseudo_event id="60" operation="notify" operation_key="msPostgresql_pre_notify_demote_0">
+      <pseudo_event id="62" operation="notify" operation_key="msPostgresql_pre_notify_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="demote" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="demote" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -554,124 +554,133 @@
   </synapse>
   <synapse id="38" priority="1000000">
     <action_set>
-      <pseudo_event id="59" operation="demoted" operation_key="msPostgresql_demoted_0">
+      <pseudo_event id="61" operation="demoted" operation_key="msPostgresql_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="33" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0"/>
+        <pseudo_event id="35" operation="demote" operation_key="pgsql_demote_0" internal_operation_key="pgsql:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="58" operation="demote" operation_key="msPostgresql_demote_0"/>
+        <pseudo_event id="60" operation="demote" operation_key="msPostgresql_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="39">
     <action_set>
-      <pseudo_event id="58" operation="demote" operation_key="msPostgresql_demote_0">
+      <pseudo_event id="60" operation="demote" operation_key="msPostgresql_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="61" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0"/>
+        <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="40" priority="1000000">
     <action_set>
-      <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0">
+      <pseudo_event id="53" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="50" operation="notify" operation_key="msPostgresql_post_notify_stopped_0"/>
+        <pseudo_event id="52" operation="notify" operation_key="msPostgresql_post_notify_stopped_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="71" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="73" operation="notify" operation_key="pgsql_post_notify_stop_0" internal_operation_key="pgsql:1_post_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="41" priority="1000000">
     <action_set>
-      <pseudo_event id="50" operation="notify" operation_key="msPostgresql_post_notify_stopped_0">
+      <pseudo_event id="52" operation="notify" operation_key="msPostgresql_post_notify_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="47" operation="stopped" operation_key="msPostgresql_stopped_0"/>
+        <pseudo_event id="49" operation="stopped" operation_key="msPostgresql_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="49" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0"/>
+        <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="42">
     <action_set>
-      <pseudo_event id="49" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0">
+      <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="48" operation="notify" operation_key="msPostgresql_pre_notify_stop_0"/>
+        <pseudo_event id="50" operation="notify" operation_key="msPostgresql_pre_notify_stop_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="77" operation="notify" operation_key="pgsql_pre_notify_stop_0" internal_operation_key="pgsql:1_pre_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
+        <rsc_op id="79" operation="notify" operation_key="pgsql_pre_notify_stop_0" internal_operation_key="pgsql:1_pre_notify_stop_0" on_node="pgsr01" on_node_uuid="pgsr01" router_node="bl460g8n3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="43">
     <action_set>
-      <pseudo_event id="48" operation="notify" operation_key="msPostgresql_pre_notify_stop_0">
+      <pseudo_event id="50" operation="notify" operation_key="msPostgresql_pre_notify_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="63" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
+        <pseudo_event id="65" operation="notified" operation_key="msPostgresql_confirmed-post_notify_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="44" priority="1000000">
     <action_set>
-      <pseudo_event id="47" operation="stopped" operation_key="msPostgresql_stopped_0">
+      <pseudo_event id="49" operation="stopped" operation_key="msPostgresql_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="34" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0"/>
+        <pseudo_event id="36" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="46" operation="stop" operation_key="msPostgresql_stop_0"/>
+        <pseudo_event id="48" operation="stop" operation_key="msPostgresql_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="45">
     <action_set>
-      <pseudo_event id="46" operation="stop" operation_key="msPostgresql_stop_0">
+      <pseudo_event id="48" operation="stop" operation_key="msPostgresql_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="49" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0"/>
+        <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-pre_notify_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="59" operation="demoted" operation_key="msPostgresql_demoted_0"/>
+        <pseudo_event id="61" operation="demoted" operation_key="msPostgresql_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="46">
     <action_set>
-      <rsc_op id="66" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400">
+      <rsc_op id="12" operation="monitor" operation_key="pgsr01_monitor_0" on_node="bl460g8n4" on_node_uuid="3232261400">
+        <primitive id="pgsr01" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="prmDB1" CRM_meta_on_node="bl460g8n4" CRM_meta_on_node_uuid="3232261400" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="47">
+    <action_set>
+      <rsc_op id="68" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400">
         <primitive id="pgsr02" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="prmDB2" CRM_meta_on_node="bl460g8n4" CRM_meta_on_node_uuid="3232261400" CRM_meta_timeout="20000" />
         <downed>
@@ -679,11 +688,24 @@
         </downed>
       </rsc_op>
     </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="monitor" operation_key="pgsr02_monitor_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="48">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="pgsr02_monitor_0" on_node="bl460g8n3" on_node_uuid="3232261399">
+        <primitive id="pgsr02" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="prmDB2" CRM_meta_on_node="bl460g8n3" CRM_meta_on_node_uuid="3232261399" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
     <inputs/>
   </synapse>
-  <synapse id="47">
+  <synapse id="49">
     <action_set>
-      <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02">
+      <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02">
         <attributes CRM_meta_master_pgsql="10" CRM_meta_on_node="pgsr02" CRM_meta_on_node_uuid="pgsr02" CRM_meta_stonith_action="off" />
         <downed>
           <node id="pgsr02"/>
@@ -696,19 +718,19 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="48">
+  <synapse id="50">
     <action_set>
-      <pseudo_event id="67" operation="stonith_complete" operation_key="stonith_complete">
+      <pseudo_event id="69" operation="stonith_complete" operation_key="stonith_complete">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="68" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
+        <pseudo_event id="70" operation="stonith" operation_key="stonith-pgsr02-off" on_node="pgsr02" on_node_uuid="pgsr02"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="49">
+  <synapse id="51">
     <action_set>
       <pseudo_event id="8" operation="all_stopped" operation_key="all_stopped">
         <attributes />
@@ -719,31 +741,31 @@
         <rsc_op id="4" operation="stop" operation_key="prmDB2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <rsc_op id="13" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
+        <rsc_op id="15" operation="stop" operation_key="prmStonith1-2_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <rsc_op id="18" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
+        <rsc_op id="20" operation="stop" operation_key="prmStonith2-2_stop_0" on_node="bl460g8n3" on_node_uuid="3232261399"/>
       </trigger>
       <trigger>
-        <pseudo_event id="23" operation="stop" operation_key="vip-master_stop_0"/>
+        <pseudo_event id="25" operation="stop" operation_key="vip-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="stop" operation_key="vip-rep_stop_0"/>
+        <pseudo_event id="28" operation="stop" operation_key="vip-rep_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="34" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0"/>
+        <pseudo_event id="36" operation="stop" operation_key="pgsql_stop_0" internal_operation_key="pgsql:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="51" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0"/>
+        <pseudo_event id="53" operation="notified" operation_key="msPostgresql_confirmed-post_notify_stopped_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="66" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
+        <rsc_op id="68" operation="stop" operation_key="pgsr02_stop_0" on_node="bl460g8n4" on_node_uuid="3232261400"/>
       </trigger>
       <trigger>
-        <pseudo_event id="67" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="69" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
       <trigger>
-        <pseudo_event id="70" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0"/>
+        <pseudo_event id="72" operation="notified" operation_key="pgsql_notified_0" internal_operation_key="pgsql:0_confirmed-post_notify_stonith_0"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/bug-cl-5247.summary b/pengine/test10/bug-cl-5247.summary
index 91ed8db..a13754f 100644
--- a/pengine/test10/bug-cl-5247.summary
+++ b/pengine/test10/bug-cl-5247.summary
@@ -32,8 +32,8 @@ Executing cluster transition:
  * Pseudo action:   grpStonith2_stop_0
  * Resource action: prmStonith2-2   stop on bl460g8n3
  * Pseudo action:   msPostgresql_pre_notify_demote_0
- * Resource action: pgsr02          stop on bl460g8n4
- * Resource action: prmDB2          stop on bl460g8n4
+ * Resource action: pgsr01          monitor on bl460g8n4
+ * Resource action: pgsr02          monitor on bl460g8n3
  * Pseudo action:   grpStonith1_stopped_0
  * Pseudo action:   grpStonith1_start_0
  * Pseudo action:   grpStonith2_stopped_0
@@ -41,6 +41,8 @@ Executing cluster transition:
  * Resource action: pgsql           notify on pgsr01
  * Pseudo action:   msPostgresql_confirmed-pre_notify_demote_0
  * Pseudo action:   msPostgresql_demote_0
+ * Resource action: pgsr02          stop on bl460g8n4
+ * Resource action: prmDB2          stop on bl460g8n4
  * Pseudo action:   stonith-pgsr02-off on pgsr02
  * Pseudo action:   stonith_complete
  * Pseudo action:   pgsql_post_notify_stop_0
diff --git a/pengine/test10/guest-node-host-dies.dot b/pengine/test10/guest-node-host-dies.dot
index c1ced94..1fdec7b 100644
--- a/pengine/test10/guest-node-host-dies.dot
+++ b/pengine/test10/guest-node-host-dies.dot
@@ -63,6 +63,15 @@ digraph "g" {
 "lxc-ms_stop_0 lxc2" -> "lxc-ms-master_stopped_0" [ style = bold]
 "lxc-ms_stop_0 lxc2" -> "lxc-ms_start_0 lxc2" [ style = bold]
 "lxc-ms_stop_0 lxc2" [ style=bold color="green" fontcolor="orange"]
+"lxc1_monitor_0 rhel7-3" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-3" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-3" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-4" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-4" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-4" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-5" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-5" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-5" [ style=bold color="green" fontcolor="black"]
 "lxc1_monitor_30000 rhel7-2" [ style=bold color="green" fontcolor="black"]
 "lxc1_start_0 rhel7-2" -> "lxc-ms_promote_0 lxc1" [ style = bold]
 "lxc1_start_0 rhel7-2" -> "lxc-ms_start_0 lxc1" [ style = bold]
@@ -72,6 +81,15 @@ digraph "g" {
 "lxc1_stop_0 rhel7-1" -> "container1_stop_0 rhel7-1" [ style = bold]
 "lxc1_stop_0 rhel7-1" -> "lxc1_start_0 rhel7-2" [ style = bold]
 "lxc1_stop_0 rhel7-1" [ style=bold color="green" fontcolor="orange"]
+"lxc2_monitor_0 rhel7-2" -> "lxc2_start_0 rhel7-3" [ style = bold]
+"lxc2_monitor_0 rhel7-2" -> "lxc2_stop_0 rhel7-1" [ style = bold]
+"lxc2_monitor_0 rhel7-2" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-4" -> "lxc2_start_0 rhel7-3" [ style = bold]
+"lxc2_monitor_0 rhel7-4" -> "lxc2_stop_0 rhel7-1" [ style = bold]
+"lxc2_monitor_0 rhel7-4" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-5" -> "lxc2_start_0 rhel7-3" [ style = bold]
+"lxc2_monitor_0 rhel7-5" -> "lxc2_stop_0 rhel7-1" [ style = bold]
+"lxc2_monitor_0 rhel7-5" [ style=bold color="green" fontcolor="black"]
 "lxc2_monitor_30000 rhel7-3" [ style=bold color="green" fontcolor="black"]
 "lxc2_start_0 rhel7-3" -> "lxc-ms_monitor_10000 lxc2" [ style = bold]
 "lxc2_start_0 rhel7-3" -> "lxc-ms_start_0 lxc2" [ style = bold]
diff --git a/pengine/test10/guest-node-host-dies.exp b/pengine/test10/guest-node-host-dies.exp
index 2029b60..5f49eb1 100644
--- a/pengine/test10/guest-node-host-dies.exp
+++ b/pengine/test10/guest-node-host-dies.exp
@@ -1,7 +1,7 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="4" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5">
+      <rsc_op id="10" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5">
         <primitive id="Fencing" class="stonith" type="fence_xvm"/>
         <attributes CRM_meta_name="stop" CRM_meta_on_node="rhel7-4" CRM_meta_on_node_uuid="5" CRM_meta_timeout="60000"  delay="0" multicast_address="239.255.100.100" pcmk_arg_map="domain:uname" pcmk_host_list="rhel7-1 rhel7-2 rhel7-3 rhel7-4 rhel7-5"/>
       </rsc_op>
@@ -20,7 +20,7 @@
         <pseudo_event id="2" operation="all_stopped" operation_key="all_stopped"/>
       </trigger>
       <trigger>
-        <rsc_op id="4" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5"/>
+        <rsc_op id="10" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
@@ -39,258 +39,258 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="7" operation="monitor" operation_key="rsc_rhel7-1_monitor_5000" on_node="rhel7-5" on_node_uuid="3">
+      <rsc_op id="13" operation="monitor" operation_key="rsc_rhel7-1_monitor_5000" on_node="rhel7-5" on_node_uuid="3">
         <primitive id="rsc_rhel7-1" class="ocf" provider="heartbeat" type="IPaddr2"/>
         <attributes CRM_meta_interval="5000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="192.168.122.202"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="6" operation="start" operation_key="rsc_rhel7-1_start_0" on_node="rhel7-5" on_node_uuid="3"/>
+        <rsc_op id="12" operation="start" operation_key="rsc_rhel7-1_start_0" on_node="rhel7-5" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="6" operation="start" operation_key="rsc_rhel7-1_start_0" on_node="rhel7-5" on_node_uuid="3">
+      <rsc_op id="12" operation="start" operation_key="rsc_rhel7-1_start_0" on_node="rhel7-5" on_node_uuid="3">
         <primitive id="rsc_rhel7-1" class="ocf" provider="heartbeat" type="IPaddr2"/>
         <attributes CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="192.168.122.202"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="5" operation="stop" operation_key="rsc_rhel7-1_stop_0"/>
+        <pseudo_event id="11" operation="stop" operation_key="rsc_rhel7-1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <pseudo_event id="5" operation="stop" operation_key="rsc_rhel7-1_stop_0">
+      <pseudo_event id="11" operation="stop" operation_key="rsc_rhel7-1_stop_0">
         <attributes CRM_meta_timeout="20000" cidr_netmask="32"  ip="192.168.122.202"/>
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="6">
     <action_set>
-      <rsc_op id="9" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="15" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_remote_node="lxc1" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="8" operation="stop" operation_key="container1_stop_0"/>
+        <pseudo_event id="14" operation="stop" operation_key="container1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="7">
     <action_set>
-      <pseudo_event id="8" operation="stop" operation_key="container1_stop_0">
+      <pseudo_event id="14" operation="stop" operation_key="container1_stop_0">
         <attributes CRM_meta_remote_node="lxc1" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///"/>
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="27" operation="stop" operation_key="lxc1_stop_0"/>
+        <pseudo_event id="33" operation="stop" operation_key="lxc1_stop_0"/>
       </trigger>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="8">
     <action_set>
-      <rsc_op id="11" operation="start" operation_key="container2_start_0" on_node="rhel7-3" on_node_uuid="4">
+      <rsc_op id="17" operation="start" operation_key="container2_start_0" on_node="rhel7-3" on_node_uuid="4">
         <primitive id="container2" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_remote_node="lxc2" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc2.xml"  force_stop="true" hypervisor="lxc:///"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="10" operation="stop" operation_key="container2_stop_0"/>
+        <pseudo_event id="16" operation="stop" operation_key="container2_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9">
     <action_set>
-      <pseudo_event id="10" operation="stop" operation_key="container2_stop_0">
+      <pseudo_event id="16" operation="stop" operation_key="container2_stop_0">
         <attributes CRM_meta_remote_node="lxc2" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc2.xml"  force_stop="true" hypervisor="lxc:///"/>
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="30" operation="stop" operation_key="lxc2_stop_0"/>
+        <pseudo_event id="36" operation="stop" operation_key="lxc2_stop_0"/>
       </trigger>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="10">
     <action_set>
-      <rsc_op id="15" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
+      <rsc_op id="21" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="12" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="18" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="14" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="20" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="23" operation="promote" operation_key="lxc-ms-master_promote_0"/>
+        <pseudo_event id="29" operation="promote" operation_key="lxc-ms-master_promote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="28" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="34" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <rsc_op id="14" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
+      <rsc_op id="20" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="13" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="19" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="19" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="25" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="28" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="34" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <pseudo_event id="13" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0">
+      <pseudo_event id="19" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="12" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="18" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="21" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="27" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="34" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="40" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="13">
     <action_set>
-      <pseudo_event id="12" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0">
+      <pseudo_event id="18" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="25" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="31" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="34" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="40" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="14">
     <action_set>
-      <rsc_op id="18" operation="monitor" operation_key="lxc-ms_monitor_10000" internal_operation_key="lxc-ms:1_monitor_10000" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3">
+      <rsc_op id="24" operation="monitor" operation_key="lxc-ms_monitor_10000" internal_operation_key="lxc-ms:1_monitor_10000" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3">
         <primitive id="lxc-ms" long-id="lxc-ms:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="17" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3"/>
+        <rsc_op id="23" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3"/>
       </trigger>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+        <rsc_op id="37" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="15">
     <action_set>
-      <rsc_op id="17" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3">
+      <rsc_op id="23" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3">
         <primitive id="lxc-ms" long-id="lxc-ms:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="16" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="22" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="19" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="25" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+        <rsc_op id="37" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
-      <pseudo_event id="16" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0">
+      <pseudo_event id="22" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0">
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="21" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="27" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="41" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="17" priority="1000000">
     <action_set>
-      <pseudo_event id="26" operation="demoted" operation_key="lxc-ms-master_demoted_0">
+      <pseudo_event id="32" operation="demoted" operation_key="lxc-ms-master_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="12" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="18" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="25" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="31" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="18">
     <action_set>
-      <pseudo_event id="25" operation="demote" operation_key="lxc-ms-master_demote_0">
+      <pseudo_event id="31" operation="demote" operation_key="lxc-ms-master_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -298,194 +298,284 @@
   </synapse>
   <synapse id="19" priority="1000000">
     <action_set>
-      <pseudo_event id="24" operation="promoted" operation_key="lxc-ms-master_promoted_0">
+      <pseudo_event id="30" operation="promoted" operation_key="lxc-ms-master_promoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="15" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="21" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="20">
     <action_set>
-      <pseudo_event id="23" operation="promote" operation_key="lxc-ms-master_promote_0">
+      <pseudo_event id="29" operation="promote" operation_key="lxc-ms-master_promote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="20" operation="running" operation_key="lxc-ms-master_running_0"/>
+        <pseudo_event id="26" operation="running" operation_key="lxc-ms-master_running_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="22" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="28" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="32" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="21" priority="1000000">
     <action_set>
-      <pseudo_event id="22" operation="stopped" operation_key="lxc-ms-master_stopped_0">
+      <pseudo_event id="28" operation="stopped" operation_key="lxc-ms-master_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="13" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="19" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="16" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="22" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="21" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="27" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="22">
     <action_set>
-      <pseudo_event id="21" operation="stop" operation_key="lxc-ms-master_stop_0">
+      <pseudo_event id="27" operation="stop" operation_key="lxc-ms-master_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="26" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="32" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="34" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="40" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="41" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="23" priority="1000000">
     <action_set>
-      <pseudo_event id="20" operation="running" operation_key="lxc-ms-master_running_0">
+      <pseudo_event id="26" operation="running" operation_key="lxc-ms-master_running_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="14" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="20" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
       <trigger>
-        <rsc_op id="17" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3"/>
+        <rsc_op id="23" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="rhel7-3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="19" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="25" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="24">
     <action_set>
-      <pseudo_event id="19" operation="start" operation_key="lxc-ms-master_start_0">
+      <pseudo_event id="25" operation="start" operation_key="lxc-ms-master_start_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="22" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="28" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="32" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="25">
     <action_set>
-      <rsc_op id="29" operation="monitor" operation_key="lxc1_monitor_30000" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="35" operation="monitor" operation_key="lxc1_monitor_30000" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="28" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="34" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="26">
     <action_set>
-      <rsc_op id="28" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="34" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_name="start" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="9" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="5" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4"/>
       </trigger>
       <trigger>
-        <pseudo_event id="27" operation="stop" operation_key="lxc1_stop_0"/>
+        <rsc_op id="6" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <rsc_op id="8" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="15" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="33" operation="stop" operation_key="lxc1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="27">
     <action_set>
-      <pseudo_event id="27" operation="stop" operation_key="lxc1_stop_0">
+      <pseudo_event id="33" operation="stop" operation_key="lxc1_stop_0">
         <attributes CRM_meta_container="container1" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="5" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="6" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="8" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="28">
     <action_set>
-      <rsc_op id="32" operation="monitor" operation_key="lxc2_monitor_30000" on_node="rhel7-3" on_node_uuid="4">
+      <rsc_op id="8" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="29">
+    <action_set>
+      <rsc_op id="6" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-4" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="30">
+    <action_set>
+      <rsc_op id="5" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="31">
+    <action_set>
+      <rsc_op id="38" operation="monitor" operation_key="lxc2_monitor_30000" on_node="rhel7-3" on_node_uuid="4">
         <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container2" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+        <rsc_op id="37" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="29">
+  <synapse id="32">
     <action_set>
-      <rsc_op id="31" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4">
+      <rsc_op id="37" operation="start" operation_key="lxc2_start_0" on_node="rhel7-3" on_node_uuid="4">
         <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container2" CRM_meta_name="start" CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="11" operation="start" operation_key="container2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+        <rsc_op id="4" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="7" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
       </trigger>
       <trigger>
-        <pseudo_event id="30" operation="stop" operation_key="lxc2_stop_0"/>
+        <rsc_op id="9" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <rsc_op id="17" operation="start" operation_key="container2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="36" operation="stop" operation_key="lxc2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="30">
+  <synapse id="33">
     <action_set>
-      <pseudo_event id="30" operation="stop" operation_key="lxc2_stop_0">
+      <pseudo_event id="36" operation="stop" operation_key="lxc2_stop_0">
         <attributes CRM_meta_container="container2" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="4" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="7" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="9" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="31">
+  <synapse id="34">
     <action_set>
-      <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1">
+      <rsc_op id="9" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-5" on_node_uuid="3">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="35">
+    <action_set>
+      <rsc_op id="7" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-4" on_node_uuid="5">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-4" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="36">
+    <action_set>
+      <rsc_op id="4" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-2" on_node_uuid="2">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="37">
+    <action_set>
+      <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1">
         <attributes CRM_meta_connected="1" CRM_meta_on_node="rhel7-1" CRM_meta_on_node_uuid="1" CRM_meta_shutdown="0" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="1"/>
@@ -496,9 +586,9 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="32">
+  <synapse id="38">
     <action_set>
-      <pseudo_event id="35" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2">
+      <pseudo_event id="41" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2">
         <attributes CRM_meta_master_lxc_ms="5" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="lxc2"/>
@@ -507,13 +597,13 @@
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="10" operation="stop" operation_key="container2_stop_0"/>
+        <pseudo_event id="16" operation="stop" operation_key="container2_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="33">
+  <synapse id="39">
     <action_set>
-      <pseudo_event id="34" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1">
+      <pseudo_event id="40" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1">
         <attributes CRM_meta_last_failure_lxc_ms="1458766329" CRM_meta_master_lxc_ms="10" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="lxc1"/>
@@ -522,29 +612,29 @@
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="8" operation="stop" operation_key="container1_stop_0"/>
+        <pseudo_event id="14" operation="stop" operation_key="container1_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="34">
+  <synapse id="40">
     <action_set>
-      <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete">
+      <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="34" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="40" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="41" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
       <trigger>
-        <crm_event id="36" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
+        <crm_event id="42" operation="stonith" operation_key="stonith-rhel7-1-reboot" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="35">
+  <synapse id="41">
     <action_set>
       <pseudo_event id="2" operation="all_stopped" operation_key="all_stopped">
         <attributes />
@@ -552,31 +642,31 @@
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="4" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5"/>
+        <rsc_op id="10" operation="stop" operation_key="Fencing_stop_0" on_node="rhel7-4" on_node_uuid="5"/>
       </trigger>
       <trigger>
-        <pseudo_event id="5" operation="stop" operation_key="rsc_rhel7-1_stop_0"/>
+        <pseudo_event id="11" operation="stop" operation_key="rsc_rhel7-1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="8" operation="stop" operation_key="container1_stop_0"/>
+        <pseudo_event id="14" operation="stop" operation_key="container1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="10" operation="stop" operation_key="container2_stop_0"/>
+        <pseudo_event id="16" operation="stop" operation_key="container2_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="13" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="19" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="16" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="22" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="27" operation="stop" operation_key="lxc1_stop_0"/>
+        <pseudo_event id="33" operation="stop" operation_key="lxc1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="30" operation="stop" operation_key="lxc2_stop_0"/>
+        <pseudo_event id="36" operation="stop" operation_key="lxc2_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="33" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="39" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/guest-node-host-dies.summary b/pengine/test10/guest-node-host-dies.summary
index 83af5ce..c6180ca 100644
--- a/pengine/test10/guest-node-host-dies.summary
+++ b/pengine/test10/guest-node-host-dies.summary
@@ -23,6 +23,12 @@ Transition Summary:
 Executing cluster transition:
  * Resource action: Fencing         stop on rhel7-4
  * Pseudo action:   lxc-ms-master_demote_0
+ * Resource action: lxc1            monitor on rhel7-5
+ * Resource action: lxc1            monitor on rhel7-4
+ * Resource action: lxc1            monitor on rhel7-3
+ * Resource action: lxc2            monitor on rhel7-5
+ * Resource action: lxc2            monitor on rhel7-4
+ * Resource action: lxc2            monitor on rhel7-2
  * Fencing rhel7-1 (reboot)
  * Pseudo action:   rsc_rhel7-1_stop_0
  * Pseudo action:   lxc1_stop_0
diff --git a/pengine/test10/whitebox-fail3.dot b/pengine/test10/whitebox-fail3.dot
index 123acd0..b3c1535 100644
--- a/pengine/test10/whitebox-fail3.dot
+++ b/pengine/test10/whitebox-fail3.dot
@@ -1,4 +1,6 @@
 digraph "g" {
+"18builder_monitor_0 dvossel-laptop2" -> "18builder_start_0 dvossel-laptop2" [ style = bold]
+"18builder_monitor_0 dvossel-laptop2" [ style=bold color="green" fontcolor="black"]
 "18builder_monitor_30000 dvossel-laptop2" [ style=bold color="green" fontcolor="black"]
 "18builder_start_0 dvossel-laptop2" -> "18builder_monitor_30000 dvossel-laptop2" [ style = bold]
 "18builder_start_0 dvossel-laptop2" -> "FAKE_start_0 18builder" [ style = bold]
diff --git a/pengine/test10/whitebox-fail3.exp b/pengine/test10/whitebox-fail3.exp
index 1cbd24a..8ddaba0 100644
--- a/pengine/test10/whitebox-fail3.exp
+++ b/pengine/test10/whitebox-fail3.exp
@@ -1,7 +1,7 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="2" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
+      <rsc_op id="3" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
         <primitive id="vm" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="dvossel-laptop2" CRM_meta_on_node_uuid="24815808" CRM_meta_remote_node="18builder" CRM_meta_timeout="20000" config="/home/dvossel/virtual_machines/18builder.xml"  hypervisor="qemu:///system"/>
       </rsc_op>
@@ -10,23 +10,23 @@
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="4" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
+      <rsc_op id="5" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
         <primitive id="FAKE" class="ocf" provider="pacemaker" type="Dummy"/>
         <attributes CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="18builder" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="4" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
+      <rsc_op id="4" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
         <primitive id="FAKE" class="ocf" provider="pacemaker" type="Dummy"/>
         <attributes CRM_meta_on_node="dvossel-laptop2" CRM_meta_on_node_uuid="24815808" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -35,54 +35,54 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="10" operation="monitor" operation_key="W:1_monitor_10000" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
+      <rsc_op id="11" operation="monitor" operation_key="W:1_monitor_10000" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
         <primitive id="W" long-id="W:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="18builder" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="9" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
+        <rsc_op id="10" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="9" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
+      <rsc_op id="10" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
         <primitive id="W" long-id="W:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="18builder" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="11" operation="start" operation_key="W-master_start_0"/>
+        <pseudo_event id="12" operation="start" operation_key="W-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5" priority="1000000">
     <action_set>
-      <pseudo_event id="12" operation="running" operation_key="W-master_running_0">
+      <pseudo_event id="13" operation="running" operation_key="W-master_running_0">
         <attributes CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="9" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
+        <rsc_op id="10" operation="start" operation_key="W:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="11" operation="start" operation_key="W-master_start_0"/>
+        <pseudo_event id="12" operation="start" operation_key="W-master_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="6">
     <action_set>
-      <pseudo_event id="11" operation="start" operation_key="W-master_start_0">
+      <pseudo_event id="12" operation="start" operation_key="W-master_start_0">
         <attributes CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -90,54 +90,54 @@
   </synapse>
   <synapse id="7">
     <action_set>
-      <rsc_op id="24" operation="monitor" operation_key="X:1_monitor_10000" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
+      <rsc_op id="25" operation="monitor" operation_key="X:1_monitor_10000" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
         <primitive id="X" long-id="X:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="18builder" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="23" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
+        <rsc_op id="24" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="8">
     <action_set>
-      <rsc_op id="23" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
+      <rsc_op id="24" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2">
         <primitive id="X" long-id="X:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="18builder" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="25" operation="start" operation_key="X-master_start_0"/>
+        <pseudo_event id="26" operation="start" operation_key="X-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9" priority="1000000">
     <action_set>
-      <pseudo_event id="26" operation="running" operation_key="X-master_running_0">
+      <pseudo_event id="27" operation="running" operation_key="X-master_running_0">
         <attributes CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="23" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
+        <rsc_op id="24" operation="start" operation_key="X:1_start_0" on_node="18builder" on_node_uuid="18builder" router_node="dvossel-laptop2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="25" operation="start" operation_key="X-master_start_0"/>
+        <pseudo_event id="26" operation="start" operation_key="X-master_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="10">
     <action_set>
-      <pseudo_event id="25" operation="start" operation_key="X-master_start_0">
+      <pseudo_event id="26" operation="start" operation_key="X-master_start_0">
         <attributes CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -145,39 +145,51 @@
   </synapse>
   <synapse id="11">
     <action_set>
-      <rsc_op id="34" operation="monitor" operation_key="18builder_monitor_30000" on_node="dvossel-laptop2" on_node_uuid="24815808">
+      <rsc_op id="35" operation="monitor" operation_key="18builder_monitor_30000" on_node="dvossel-laptop2" on_node_uuid="24815808">
         <primitive id="18builder" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="vm" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="dvossel-laptop2" CRM_meta_on_node_uuid="24815808" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <rsc_op id="33" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
+      <rsc_op id="34" operation="start" operation_key="18builder_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
         <primitive id="18builder" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="vm" CRM_meta_name="start" CRM_meta_on_node="dvossel-laptop2" CRM_meta_on_node_uuid="24815808" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="2" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="2" operation="monitor" operation_key="18builder_monitor_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="3" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="13">
     <action_set>
+      <rsc_op id="2" operation="monitor" operation_key="18builder_monitor_0" on_node="dvossel-laptop2" on_node_uuid="24815808">
+        <primitive id="18builder" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="vm" CRM_meta_on_node="dvossel-laptop2" CRM_meta_on_node_uuid="24815808" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="14">
+    <action_set>
       <pseudo_event id="1" operation="all_stopped" operation_key="all_stopped">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+        <rsc_op id="4" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/whitebox-fail3.summary b/pengine/test10/whitebox-fail3.summary
index 7acf1b6..19b2e3d 100644
--- a/pengine/test10/whitebox-fail3.summary
+++ b/pengine/test10/whitebox-fail3.summary
@@ -24,8 +24,9 @@ Executing cluster transition:
  * Resource action: FAKE            stop on dvossel-laptop2
  * Pseudo action:   W-master_start_0
  * Pseudo action:   X-master_start_0
- * Resource action: 18builder       start on dvossel-laptop2
+ * Resource action: 18builder       monitor on dvossel-laptop2
  * Pseudo action:   all_stopped
+ * Resource action: 18builder       start on dvossel-laptop2
  * Resource action: FAKE            start on 18builder
  * Resource action: W               start on 18builder
  * Pseudo action:   W-master_running_0
diff --git a/pengine/test10/whitebox-migrate1.dot b/pengine/test10/whitebox-migrate1.dot
index b00e272..e54df2c 100644
--- a/pengine/test10/whitebox-migrate1.dot
+++ b/pengine/test10/whitebox-migrate1.dot
@@ -25,6 +25,10 @@
 "rhel7-node1_migrate_from_0 rhel7-node3" [ style=bold color="green" fontcolor="black"]
 "rhel7-node1_migrate_to_0 rhel7-node2" -> "rhel7-node1_migrate_from_0 rhel7-node3" [ style = bold]
 "rhel7-node1_migrate_to_0 rhel7-node2" [ style=bold color="green" fontcolor="black"]
+"rhel7-node1_monitor_0 rhel7-node3" -> "rhel7-node1_migrate_to_0 rhel7-node2" [ style = bold]
+"rhel7-node1_monitor_0 rhel7-node3" -> "rhel7-node1_start_0 rhel7-node3" [ style = bold]
+"rhel7-node1_monitor_0 rhel7-node3" -> "rhel7-node1_stop_0 rhel7-node2" [ style = bold]
+"rhel7-node1_monitor_0 rhel7-node3" [ style=bold color="green" fontcolor="black"]
 "rhel7-node1_monitor_30000 rhel7-node3" [ style=bold color="green" fontcolor="black"]
 "rhel7-node1_start_0 rhel7-node3" -> "rhel7-node1_monitor_30000 rhel7-node3" [ style = bold]
 "rhel7-node1_start_0 rhel7-node3" [ style=bold color="green" fontcolor="orange"]
diff --git a/pengine/test10/whitebox-migrate1.exp b/pengine/test10/whitebox-migrate1.exp
index 6ce29eb..1b6c451 100644
--- a/pengine/test10/whitebox-migrate1.exp
+++ b/pengine/test10/whitebox-migrate1.exp
@@ -1,33 +1,33 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="14" operation="monitor" operation_key="shooter1_monitor_60000" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="15" operation="monitor" operation_key="shooter1_monitor_60000" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="shooter1" class="stonith" type="fence_xvm"/>
         <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="13" operation="start" operation_key="shooter1_start_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="14" operation="start" operation_key="shooter1_start_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="13" operation="start" operation_key="shooter1_start_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="14" operation="start" operation_key="shooter1_start_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="shooter1" class="stonith" type="fence_xvm"/>
         <attributes CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="12" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="13" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="12" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="13" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="shooter1" class="stonith" type="fence_xvm"/>
         <attributes CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -36,33 +36,33 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="21" operation="monitor" operation_key="FAKE3_monitor_10000" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="22" operation="monitor" operation_key="FAKE3_monitor_10000" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="FAKE3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="20" operation="start" operation_key="FAKE3_start_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="21" operation="start" operation_key="FAKE3_start_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="20" operation="start" operation_key="FAKE3_start_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="21" operation="start" operation_key="FAKE3_start_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="FAKE3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="19" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="20" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <rsc_op id="19" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="20" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="FAKE3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="stop" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -71,20 +71,20 @@
   </synapse>
   <synapse id="6">
     <action_set>
-      <rsc_op id="34" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="35" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="remote-rsc" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_migrate_source="rhel7-node2" CRM_meta_migrate_target="rhel7-node3" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_remote_node="rhel7-node1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="33" operation="migrate_to" operation_key="remote-rsc_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="34" operation="migrate_to" operation_key="remote-rsc_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="7">
     <action_set>
-      <rsc_op id="33" operation="migrate_to" operation_key="remote-rsc_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="34" operation="migrate_to" operation_key="remote-rsc_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="remote-rsc" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_migrate_source="rhel7-node2" CRM_meta_migrate_target="rhel7-node3" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_record_pending="true" CRM_meta_remote_node="rhel7-node1" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -93,136 +93,154 @@
   </synapse>
   <synapse id="8">
     <action_set>
-      <rsc_op id="32" operation="monitor" operation_key="remote-rsc_monitor_10000" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="33" operation="monitor" operation_key="remote-rsc_monitor_10000" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="remote-rsc" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_remote_node="rhel7-node1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="31" operation="start" operation_key="remote-rsc_start_0"/>
+        <pseudo_event id="32" operation="start" operation_key="remote-rsc_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9">
     <action_set>
-      <pseudo_event id="31" operation="start" operation_key="remote-rsc_start_0">
+      <pseudo_event id="32" operation="start" operation_key="remote-rsc_start_0">
         <attributes CRM_meta_name="start" CRM_meta_remote_node="rhel7-node1" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="30" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="31" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="34" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="35" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="10">
     <action_set>
-      <rsc_op id="30" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="31" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="remote-rsc" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="stop" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_remote_node="rhel7-node1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="34" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="35" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="35" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="36" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <rsc_op id="39" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="40" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="rhel7-node1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="remote-rsc" CRM_meta_migrate_source="rhel7-node2" CRM_meta_migrate_target="rhel7-node3" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="38" operation="migrate_to" operation_key="rhel7-node1_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="39" operation="migrate_to" operation_key="rhel7-node1_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <rsc_op id="38" operation="migrate_to" operation_key="rhel7-node1_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="39" operation="migrate_to" operation_key="rhel7-node1_migrate_to_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="rhel7-node1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="remote-rsc" CRM_meta_migrate_source="rhel7-node2" CRM_meta_migrate_target="rhel7-node3" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="34" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="12" operation="monitor" operation_key="rhel7-node1_monitor_0" on_node="rhel7-node3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="35" operation="migrate_from" operation_key="remote-rsc_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="13">
     <action_set>
-      <rsc_op id="37" operation="monitor" operation_key="rhel7-node1_monitor_30000" on_node="rhel7-node3" on_node_uuid="3">
+      <rsc_op id="38" operation="monitor" operation_key="rhel7-node1_monitor_30000" on_node="rhel7-node3" on_node_uuid="3">
         <primitive id="rhel7-node1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="remote-rsc" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="36" operation="start" operation_key="rhel7-node1_start_0"/>
+        <pseudo_event id="37" operation="start" operation_key="rhel7-node1_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="14">
     <action_set>
-      <pseudo_event id="36" operation="start" operation_key="rhel7-node1_start_0">
+      <pseudo_event id="37" operation="start" operation_key="rhel7-node1_start_0">
         <attributes CRM_meta_container="remote-rsc" CRM_meta_name="start" CRM_meta_timeout="60000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="31" operation="start" operation_key="remote-rsc_start_0"/>
+        <rsc_op id="12" operation="monitor" operation_key="rhel7-node1_monitor_0" on_node="rhel7-node3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="32" operation="start" operation_key="remote-rsc_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="35" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="36" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="39" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="40" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="15">
     <action_set>
-      <rsc_op id="35" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2">
+      <rsc_op id="36" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2">
         <primitive id="rhel7-node1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="remote-rsc" CRM_meta_on_node="rhel7-node2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="39" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="12" operation="monitor" operation_key="rhel7-node1_monitor_0" on_node="rhel7-node3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="40" operation="migrate_from" operation_key="rhel7-node1_migrate_from_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
+      <rsc_op id="12" operation="monitor" operation_key="rhel7-node1_monitor_0" on_node="rhel7-node3" on_node_uuid="3">
+        <primitive id="rhel7-node1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="remote-rsc" CRM_meta_on_node="rhel7-node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="17">
+    <action_set>
       <pseudo_event id="11" operation="all_stopped" operation_key="all_stopped">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="12" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="13" operation="stop" operation_key="shooter1_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="19" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
+        <rsc_op id="20" operation="stop" operation_key="FAKE3_stop_0" on_node="rhel7-node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="30" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="31" operation="stop" operation_key="remote-rsc_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="35" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
+        <rsc_op id="36" operation="stop" operation_key="rhel7-node1_stop_0" on_node="rhel7-node2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/whitebox-migrate1.summary b/pengine/test10/whitebox-migrate1.summary
index 7cbe03d..a6e4c00 100644
--- a/pengine/test10/whitebox-migrate1.summary
+++ b/pengine/test10/whitebox-migrate1.summary
@@ -23,6 +23,7 @@ Executing cluster transition:
  * Resource action: shooter1        stop on rhel7-node3
  * Resource action: FAKE3           stop on rhel7-node3
  * Resource action: remote-rsc      migrate_to on rhel7-node2
+ * Resource action: rhel7-node1     monitor on rhel7-node3
  * Resource action: shooter1        start on rhel7-node2
  * Resource action: FAKE3           start on rhel7-node2
  * Resource action: remote-rsc      migrate_from on rhel7-node3
diff --git a/pengine/test10/whitebox-ms-ordering-move.dot b/pengine/test10/whitebox-ms-ordering-move.dot
index 0e4df3c..fe0b0e8 100644
--- a/pengine/test10/whitebox-ms-ordering-move.dot
+++ b/pengine/test10/whitebox-ms-ordering-move.dot
@@ -40,6 +40,18 @@ digraph "g" {
 "lxc-ms_stop_0 lxc1" -> "lxc-ms_start_0 lxc1" [ style = bold]
 "lxc-ms_stop_0 lxc1" -> "lxc1_stop_0 rhel7-1" [ style = bold]
 "lxc-ms_stop_0 lxc1" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-2" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-2" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-2" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-3" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-3" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-3" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-4" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-4" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-4" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 rhel7-5" -> "lxc1_start_0 rhel7-2" [ style = bold]
+"lxc1_monitor_0 rhel7-5" -> "lxc1_stop_0 rhel7-1" [ style = bold]
+"lxc1_monitor_0 rhel7-5" [ style=bold color="green" fontcolor="black"]
 "lxc1_monitor_30000 rhel7-2" [ style=bold color="green" fontcolor="black"]
 "lxc1_start_0 rhel7-2" -> "lxc-ms_promote_0 lxc1" [ style = bold]
 "lxc1_start_0 rhel7-2" -> "lxc-ms_start_0 lxc1" [ style = bold]
@@ -49,4 +61,8 @@ digraph "g" {
 "lxc1_stop_0 rhel7-1" -> "container1_stop_0 rhel7-1" [ style = bold]
 "lxc1_stop_0 rhel7-1" -> "lxc1_start_0 rhel7-2" [ style = bold]
 "lxc1_stop_0 rhel7-1" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-2" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-3" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-4" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 rhel7-5" [ style=bold color="green" fontcolor="black"]
 }
diff --git a/pengine/test10/whitebox-ms-ordering-move.exp b/pengine/test10/whitebox-ms-ordering-move.exp
index 54067f0..f8718de 100644
--- a/pengine/test10/whitebox-ms-ordering-move.exp
+++ b/pengine/test10/whitebox-ms-ordering-move.exp
@@ -1,118 +1,118 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="1"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="91" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="99" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_remote_node="lxc1" CRM_meta_timeout="90000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="90" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="98" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="90" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1">
+      <rsc_op id="98" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="rhel7-1" CRM_meta_on_node_uuid="1" CRM_meta_remote_node="lxc1" CRM_meta_timeout="90000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///"/>
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="108" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="116" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="97" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
+      <rsc_op id="105" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="90000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="94" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="102" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
       <trigger>
-        <rsc_op id="95" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="103" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="104" operation="promote" operation_key="lxc-ms-master_promote_0"/>
+        <pseudo_event id="112" operation="promote" operation_key="lxc-ms-master_promote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="109" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="117" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="96" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1">
+      <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="90000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="95" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="103" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="102" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="110" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="95" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1">
+      <rsc_op id="103" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="90000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="106" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="114" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <rsc_op id="94" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
+      <rsc_op id="102" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="90000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="96" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="100" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="108" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="109" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="117" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="6" priority="1000000">
     <action_set>
-      <pseudo_event id="107" operation="demoted" operation_key="lxc-ms-master_demoted_0">
+      <pseudo_event id="115" operation="demoted" operation_key="lxc-ms-master_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="95" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="103" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="106" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="114" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="7">
     <action_set>
-      <pseudo_event id="106" operation="demote" operation_key="lxc-ms-master_demote_0">
+      <pseudo_event id="114" operation="demote" operation_key="lxc-ms-master_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
@@ -120,123 +120,135 @@
   </synapse>
   <synapse id="8" priority="1000000">
     <action_set>
-      <pseudo_event id="105" operation="promoted" operation_key="lxc-ms-master_promoted_0">
+      <pseudo_event id="113" operation="promoted" operation_key="lxc-ms-master_promoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="97" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="105" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9">
     <action_set>
-      <pseudo_event id="104" operation="promote" operation_key="lxc-ms-master_promote_0">
+      <pseudo_event id="112" operation="promote" operation_key="lxc-ms-master_promote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="101" operation="running" operation_key="lxc-ms-master_running_0"/>
+        <pseudo_event id="109" operation="running" operation_key="lxc-ms-master_running_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="103" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="111" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="107" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="115" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="10" priority="1000000">
     <action_set>
-      <pseudo_event id="103" operation="stopped" operation_key="lxc-ms-master_stopped_0">
+      <pseudo_event id="111" operation="stopped" operation_key="lxc-ms-master_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="96" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="102" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="110" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <pseudo_event id="102" operation="stop" operation_key="lxc-ms-master_stop_0">
+      <pseudo_event id="110" operation="stop" operation_key="lxc-ms-master_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="107" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="115" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12" priority="1000000">
     <action_set>
-      <pseudo_event id="101" operation="running" operation_key="lxc-ms-master_running_0">
+      <pseudo_event id="109" operation="running" operation_key="lxc-ms-master_running_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="94" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
+        <rsc_op id="102" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
       <trigger>
-        <pseudo_event id="100" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="108" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="13">
     <action_set>
-      <pseudo_event id="100" operation="start" operation_key="lxc-ms-master_start_0">
+      <pseudo_event id="108" operation="start" operation_key="lxc-ms-master_start_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="90000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="103" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="111" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="107" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="115" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="14">
     <action_set>
-      <rsc_op id="110" operation="monitor" operation_key="lxc1_monitor_30000" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="118" operation="monitor" operation_key="lxc1_monitor_30000" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="109" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="117" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="15">
     <action_set>
-      <rsc_op id="109" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2">
+      <rsc_op id="117" operation="start" operation_key="lxc1_start_0" on_node="rhel7-2" on_node_uuid="2">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_name="start" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="91" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+        <rsc_op id="26" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="108" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="28" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="30" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="32" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="99" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="116" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
-      <rsc_op id="108" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1">
+      <rsc_op id="116" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="90000" />
         <downed>
@@ -246,25 +258,109 @@
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="96" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="26" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="28" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="30" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="32" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="17">
     <action_set>
+      <rsc_op id="32" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="18">
+    <action_set>
+      <rsc_op id="30" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-4" on_node_uuid="5">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-4" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="19">
+    <action_set>
+      <rsc_op id="28" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-3" on_node_uuid="4">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="20">
+    <action_set>
+      <rsc_op id="26" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-2" on_node_uuid="2">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="21">
+    <action_set>
+      <rsc_op id="33" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-5" on_node_uuid="3">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-5" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="22">
+    <action_set>
+      <rsc_op id="31" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-4" on_node_uuid="5">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-4" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="23">
+    <action_set>
+      <rsc_op id="29" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-3" on_node_uuid="4">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-3" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="24">
+    <action_set>
+      <rsc_op id="27" operation="monitor" operation_key="lxc2_monitor_0" on_node="rhel7-2" on_node_uuid="2">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="rhel7-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="25">
+    <action_set>
       <pseudo_event id="25" operation="all_stopped" operation_key="all_stopped">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="90" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="98" operation="stop" operation_key="container1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="96" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+        <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
-        <rsc_op id="108" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
+        <rsc_op id="116" operation="stop" operation_key="lxc1_stop_0" on_node="rhel7-1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/whitebox-ms-ordering-move.summary b/pengine/test10/whitebox-ms-ordering-move.summary
index 5777b84..d5f133b 100644
--- a/pengine/test10/whitebox-ms-ordering-move.summary
+++ b/pengine/test10/whitebox-ms-ordering-move.summary
@@ -36,6 +36,14 @@ Transition Summary:
 
 Executing cluster transition:
  * Pseudo action:   lxc-ms-master_demote_0
+ * Resource action: lxc1            monitor on rhel7-5
+ * Resource action: lxc1            monitor on rhel7-4
+ * Resource action: lxc1            monitor on rhel7-3
+ * Resource action: lxc1            monitor on rhel7-2
+ * Resource action: lxc2            monitor on rhel7-5
+ * Resource action: lxc2            monitor on rhel7-4
+ * Resource action: lxc2            monitor on rhel7-3
+ * Resource action: lxc2            monitor on rhel7-2
  * Resource action: lxc-ms          demote on lxc1
  * Pseudo action:   lxc-ms-master_demoted_0
  * Pseudo action:   lxc-ms-master_stop_0
diff --git a/pengine/test10/whitebox-ms-ordering.dot b/pengine/test10/whitebox-ms-ordering.dot
index bd77363..1a942f4 100644
--- a/pengine/test10/whitebox-ms-ordering.dot
+++ b/pengine/test10/whitebox-ms-ordering.dot
@@ -69,11 +69,23 @@
 "lxc-ms_stop_0 lxc2" -> "lxc-ms-master_stopped_0" [ style = bold]
 "lxc-ms_stop_0 lxc2" -> "lxc-ms_start_0 lxc2" [ style = bold]
 "lxc-ms_stop_0 lxc2" [ style=bold color="green" fontcolor="orange"]
+"lxc1_monitor_0 18node1" -> "lxc1_start_0 18node1" [ style = bold]
+"lxc1_monitor_0 18node1" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 18node2" -> "lxc1_start_0 18node1" [ style = bold]
+"lxc1_monitor_0 18node2" [ style=bold color="green" fontcolor="black"]
+"lxc1_monitor_0 18node3" -> "lxc1_start_0 18node1" [ style = bold]
+"lxc1_monitor_0 18node3" [ style=bold color="green" fontcolor="black"]
 "lxc1_monitor_30000 18node1" [ style=bold color="green" fontcolor="black"]
 "lxc1_start_0 18node1" -> "lxc-ms_promote_0 lxc1" [ style = bold]
 "lxc1_start_0 18node1" -> "lxc-ms_start_0 lxc1" [ style = bold]
 "lxc1_start_0 18node1" -> "lxc1_monitor_30000 18node1" [ style = bold]
 "lxc1_start_0 18node1" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 18node1" -> "lxc2_start_0 18node1" [ style = bold]
+"lxc2_monitor_0 18node1" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 18node2" -> "lxc2_start_0 18node1" [ style = bold]
+"lxc2_monitor_0 18node2" [ style=bold color="green" fontcolor="black"]
+"lxc2_monitor_0 18node3" -> "lxc2_start_0 18node1" [ style = bold]
+"lxc2_monitor_0 18node3" [ style=bold color="green" fontcolor="black"]
 "lxc2_monitor_30000 18node1" [ style=bold color="green" fontcolor="black"]
 "lxc2_start_0 18node1" -> "lxc-ms_monitor_10000 lxc2" [ style = bold]
 "lxc2_start_0 18node1" -> "lxc-ms_start_0 lxc2" [ style = bold]
diff --git a/pengine/test10/whitebox-ms-ordering.exp b/pengine/test10/whitebox-ms-ordering.exp
index 5d32d6f..de4f4d0 100644
--- a/pengine/test10/whitebox-ms-ordering.exp
+++ b/pengine/test10/whitebox-ms-ordering.exp
@@ -1,7 +1,7 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="14" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="20" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_remote_node="lxc1" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc1"/>
       </rsc_op>
@@ -11,19 +11,19 @@
         <rsc_op id="3" operation="monitor" operation_key="container1_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="6" operation="monitor" operation_key="container1_monitor_0" on_node="18node2" on_node_uuid="2"/>
+        <rsc_op id="8" operation="monitor" operation_key="container1_monitor_0" on_node="18node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="9" operation="monitor" operation_key="container1_monitor_0" on_node="18node3" on_node_uuid="3"/>
+        <rsc_op id="13" operation="monitor" operation_key="container1_monitor_0" on_node="18node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="9" operation="monitor" operation_key="container1_monitor_0" on_node="18node3" on_node_uuid="3">
+      <rsc_op id="13" operation="monitor" operation_key="container1_monitor_0" on_node="18node3" on_node_uuid="3">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_remote_node="lxc1" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc1"/>
       </rsc_op>
@@ -32,7 +32,7 @@
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="6" operation="monitor" operation_key="container1_monitor_0" on_node="18node2" on_node_uuid="2">
+      <rsc_op id="8" operation="monitor" operation_key="container1_monitor_0" on_node="18node2" on_node_uuid="2">
         <primitive id="container1" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_remote_node="lxc1" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc1.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc1"/>
       </rsc_op>
@@ -50,7 +50,7 @@
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="15" operation="start" operation_key="container2_start_0" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="21" operation="start" operation_key="container2_start_0" on_node="18node1" on_node_uuid="1">
         <primitive id="container2" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_remote_node="lxc2" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc2.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc2"/>
       </rsc_op>
@@ -60,19 +60,19 @@
         <rsc_op id="4" operation="monitor" operation_key="container2_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="7" operation="monitor" operation_key="container2_monitor_0" on_node="18node2" on_node_uuid="2"/>
+        <rsc_op id="9" operation="monitor" operation_key="container2_monitor_0" on_node="18node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="10" operation="monitor" operation_key="container2_monitor_0" on_node="18node3" on_node_uuid="3"/>
+        <rsc_op id="14" operation="monitor" operation_key="container2_monitor_0" on_node="18node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <rsc_op id="10" operation="monitor" operation_key="container2_monitor_0" on_node="18node3" on_node_uuid="3">
+      <rsc_op id="14" operation="monitor" operation_key="container2_monitor_0" on_node="18node3" on_node_uuid="3">
         <primitive id="container2" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_remote_node="lxc2" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc2.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc2"/>
       </rsc_op>
@@ -81,7 +81,7 @@
   </synapse>
   <synapse id="6">
     <action_set>
-      <rsc_op id="7" operation="monitor" operation_key="container2_monitor_0" on_node="18node2" on_node_uuid="2">
+      <rsc_op id="9" operation="monitor" operation_key="container2_monitor_0" on_node="18node2" on_node_uuid="2">
         <primitive id="container2" class="ocf" provider="heartbeat" type="VirtualDomain"/>
         <attributes CRM_meta_on_node="18node2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_remote_node="lxc2" CRM_meta_timeout="20000" config="/var/lib/pacemaker/cts/lxc/lxc2.xml"  force_stop="true" hypervisor="lxc:///" remote-node="lxc2"/>
       </rsc_op>
@@ -99,54 +99,54 @@
   </synapse>
   <synapse id="8">
     <action_set>
-      <rsc_op id="19" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1">
+      <rsc_op id="25" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="16" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="22" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="18" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
+        <rsc_op id="24" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="27" operation="promote" operation_key="lxc-ms-master_promote_0"/>
+        <pseudo_event id="33" operation="promote" operation_key="lxc-ms-master_promote_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="37" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="9">
     <action_set>
-      <rsc_op id="18" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1">
+      <rsc_op id="24" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="17" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="23" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="23" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="29" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="37" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="10">
     <action_set>
-      <pseudo_event id="17" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0">
+      <pseudo_event id="23" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -155,40 +155,40 @@
         <rsc_op id="5" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="8" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2"/>
+        <rsc_op id="10" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="11" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3"/>
+        <rsc_op id="15" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="16" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="22" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="25" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="31" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="36" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="42" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <pseudo_event id="16" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0">
+      <pseudo_event id="22" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="29" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="35" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="36" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="42" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <rsc_op id="11" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3">
+      <rsc_op id="15" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="18node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -197,7 +197,7 @@
   </synapse>
   <synapse id="13">
     <action_set>
-      <rsc_op id="8" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2">
+      <rsc_op id="10" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2">
         <primitive id="lxc-ms" long-id="lxc-ms:0" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="18node2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -215,75 +215,75 @@
   </synapse>
   <synapse id="15">
     <action_set>
-      <rsc_op id="22" operation="monitor" operation_key="lxc-ms_monitor_10000" internal_operation_key="lxc-ms:1_monitor_10000" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1">
+      <rsc_op id="28" operation="monitor" operation_key="lxc-ms_monitor_10000" internal_operation_key="lxc-ms:1_monitor_10000" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1">
         <primitive id="lxc-ms" long-id="lxc-ms:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="21" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1"/>
+        <rsc_op id="27" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="39" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
-      <rsc_op id="21" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1">
+      <rsc_op id="27" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1">
         <primitive id="lxc-ms" long-id="lxc-ms:1" class="ocf" provider="pacemaker" type="Stateful"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="20" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="26" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="23" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="29" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="39" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="17">
     <action_set>
-      <pseudo_event id="20" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0">
+      <pseudo_event id="26" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0">
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="25" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="31" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="37" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="43" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="18" priority="1000000">
     <action_set>
-      <pseudo_event id="30" operation="demoted" operation_key="lxc-ms-master_demoted_0">
+      <pseudo_event id="36" operation="demoted" operation_key="lxc-ms-master_demoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="16" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
+        <pseudo_event id="22" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="29" operation="demote" operation_key="lxc-ms-master_demote_0"/>
+        <pseudo_event id="35" operation="demote" operation_key="lxc-ms-master_demote_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="19">
     <action_set>
-      <pseudo_event id="29" operation="demote" operation_key="lxc-ms-master_demote_0">
+      <pseudo_event id="35" operation="demote" operation_key="lxc-ms-master_demote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -291,91 +291,91 @@
   </synapse>
   <synapse id="20" priority="1000000">
     <action_set>
-      <pseudo_event id="28" operation="promoted" operation_key="lxc-ms-master_promoted_0">
+      <pseudo_event id="34" operation="promoted" operation_key="lxc-ms-master_promoted_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="19" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
+        <rsc_op id="25" operation="promote" operation_key="lxc-ms_promote_0" internal_operation_key="lxc-ms:0_promote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="21">
     <action_set>
-      <pseudo_event id="27" operation="promote" operation_key="lxc-ms-master_promote_0">
+      <pseudo_event id="33" operation="promote" operation_key="lxc-ms-master_promote_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="24" operation="running" operation_key="lxc-ms-master_running_0"/>
+        <pseudo_event id="30" operation="running" operation_key="lxc-ms-master_running_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="32" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="30" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="36" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="22" priority="1000000">
     <action_set>
-      <pseudo_event id="26" operation="stopped" operation_key="lxc-ms-master_stopped_0">
+      <pseudo_event id="32" operation="stopped" operation_key="lxc-ms-master_stopped_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="17" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="23" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="20" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="26" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="25" operation="stop" operation_key="lxc-ms-master_stop_0"/>
+        <pseudo_event id="31" operation="stop" operation_key="lxc-ms-master_stop_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="23">
     <action_set>
-      <pseudo_event id="25" operation="stop" operation_key="lxc-ms-master_stop_0">
+      <pseudo_event id="31" operation="stop" operation_key="lxc-ms-master_stop_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="30" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="36" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="36" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="42" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="37" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="43" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="24" priority="1000000">
     <action_set>
-      <pseudo_event id="24" operation="running" operation_key="lxc-ms-master_running_0">
+      <pseudo_event id="30" operation="running" operation_key="lxc-ms-master_running_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="18" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
+        <rsc_op id="24" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
       </trigger>
       <trigger>
-        <rsc_op id="21" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1"/>
+        <rsc_op id="27" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:1_start_0" on_node="lxc2" on_node_uuid="lxc2" router_node="18node1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="23" operation="start" operation_key="lxc-ms-master_start_0"/>
+        <pseudo_event id="29" operation="start" operation_key="lxc-ms-master_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="25">
     <action_set>
-      <pseudo_event id="23" operation="start" operation_key="lxc-ms-master_start_0">
+      <pseudo_event id="29" operation="start" operation_key="lxc-ms-master_start_0">
         <attributes CRM_meta_clone_max="2" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -384,80 +384,152 @@
         <rsc_op id="5" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="8" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2"/>
+        <rsc_op id="10" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="11" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3"/>
+        <rsc_op id="15" operation="monitor" operation_key="lxc-ms_monitor_0" internal_operation_key="lxc-ms:0_monitor_0" on_node="18node3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="26" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
+        <pseudo_event id="32" operation="stopped" operation_key="lxc-ms-master_stopped_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="30" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
+        <pseudo_event id="36" operation="demoted" operation_key="lxc-ms-master_demoted_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="26">
     <action_set>
-      <rsc_op id="32" operation="monitor" operation_key="lxc1_monitor_30000" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="38" operation="monitor" operation_key="lxc1_monitor_30000" on_node="18node1" on_node_uuid="1">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="31" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="37" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="27">
     <action_set>
-      <rsc_op id="31" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="37" operation="start" operation_key="lxc1_start_0" on_node="18node1" on_node_uuid="1">
         <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container1" CRM_meta_name="start" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="14" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="6" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <rsc_op id="11" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="16" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="20" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="28">
     <action_set>
-      <rsc_op id="34" operation="monitor" operation_key="lxc2_monitor_30000" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="16" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node3" on_node_uuid="3">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="18node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="29">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node2" on_node_uuid="2">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="18node2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="30">
+    <action_set>
+      <rsc_op id="6" operation="monitor" operation_key="lxc1_monitor_0" on_node="18node1" on_node_uuid="1">
+        <primitive id="lxc1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container1" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="31">
+    <action_set>
+      <rsc_op id="40" operation="monitor" operation_key="lxc2_monitor_30000" on_node="18node1" on_node_uuid="1">
         <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container2" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="33" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="39" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="29">
+  <synapse id="32">
     <action_set>
-      <rsc_op id="33" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1">
+      <rsc_op id="39" operation="start" operation_key="lxc2_start_0" on_node="18node1" on_node_uuid="1">
         <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container2" CRM_meta_name="start" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="15" operation="start" operation_key="container2_start_0" on_node="18node1" on_node_uuid="1"/>
+        <rsc_op id="7" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <rsc_op id="12" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="17" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="21" operation="start" operation_key="container2_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="30">
+  <synapse id="33">
     <action_set>
-      <pseudo_event id="37" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2">
+      <rsc_op id="17" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node3" on_node_uuid="3">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="18node3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="34">
+    <action_set>
+      <rsc_op id="12" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node2" on_node_uuid="2">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="18node2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="35">
+    <action_set>
+      <rsc_op id="7" operation="monitor" operation_key="lxc2_monitor_0" on_node="18node1" on_node_uuid="1">
+        <primitive id="lxc2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container2" CRM_meta_on_node="18node1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="36">
+    <action_set>
+      <pseudo_event id="43" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2">
         <attributes CRM_meta_master_lxc_ms="5" CRM_meta_on_node="lxc2" CRM_meta_on_node_uuid="lxc2" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="lxc2"/>
@@ -466,9 +538,9 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="31">
+  <synapse id="37">
     <action_set>
-      <pseudo_event id="36" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1">
+      <pseudo_event id="42" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1">
         <attributes CRM_meta_master_lxc_ms="10" CRM_meta_on_node="lxc1" CRM_meta_on_node_uuid="lxc1" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="lxc1"/>
@@ -477,22 +549,22 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="32">
+  <synapse id="38">
     <action_set>
-      <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete">
+      <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="36" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
+        <pseudo_event id="42" operation="stonith" operation_key="stonith-lxc1-reboot" on_node="lxc1" on_node_uuid="lxc1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="37" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
+        <pseudo_event id="43" operation="stonith" operation_key="stonith-lxc2-reboot" on_node="lxc2" on_node_uuid="lxc2"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="33">
+  <synapse id="39">
     <action_set>
       <pseudo_event id="2" operation="all_stopped" operation_key="all_stopped">
         <attributes />
@@ -500,13 +572,13 @@
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="17" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
+        <pseudo_event id="23" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="20" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
+        <pseudo_event id="26" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
-        <pseudo_event id="35" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="41" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/whitebox-ms-ordering.summary b/pengine/test10/whitebox-ms-ordering.summary
index 5d7c042..365cf8d 100644
--- a/pengine/test10/whitebox-ms-ordering.summary
+++ b/pengine/test10/whitebox-ms-ordering.summary
@@ -27,6 +27,12 @@ Executing cluster transition:
  * Resource action: lxc-ms          monitor on 18node2
  * Resource action: lxc-ms          monitor on 18node1
  * Pseudo action:   lxc-ms-master_demote_0
+ * Resource action: lxc1            monitor on 18node3
+ * Resource action: lxc1            monitor on 18node2
+ * Resource action: lxc1            monitor on 18node1
+ * Resource action: lxc2            monitor on 18node3
+ * Resource action: lxc2            monitor on 18node2
+ * Resource action: lxc2            monitor on 18node1
  * Pseudo action:   stonith-lxc2-reboot on lxc2
  * Pseudo action:   stonith-lxc1-reboot on lxc1
  * Pseudo action:   stonith_complete
diff --git a/pengine/test10/whitebox-nested-group.dot b/pengine/test10/whitebox-nested-group.dot
index 2e41e3e..e149f9a 100644
--- a/pengine/test10/whitebox-nested-group.dot
+++ b/pengine/test10/whitebox-nested-group.dot
@@ -1,4 +1,10 @@
  digraph "g" {
+"c7auto4_monitor_0 c7auto1" -> "c7auto4_start_0 c7auto1" [ style = bold]
+"c7auto4_monitor_0 c7auto1" [ style=bold color="green" fontcolor="black"]
+"c7auto4_monitor_0 c7auto2" -> "c7auto4_start_0 c7auto1" [ style = bold]
+"c7auto4_monitor_0 c7auto2" [ style=bold color="green" fontcolor="black"]
+"c7auto4_monitor_0 c7auto3" -> "c7auto4_start_0 c7auto1" [ style = bold]
+"c7auto4_monitor_0 c7auto3" [ style=bold color="green" fontcolor="black"]
 "c7auto4_monitor_30000 c7auto1" [ style=bold color="green" fontcolor="black"]
 "c7auto4_start_0 c7auto1" -> "c7auto4_monitor_30000 c7auto1" [ style = bold]
 "c7auto4_start_0 c7auto1" -> "fake2_monitor_10000 c7auto4" [ style = bold]
diff --git a/pengine/test10/whitebox-nested-group.exp b/pengine/test10/whitebox-nested-group.exp
index 67767d3..e6b68f2 100644
--- a/pengine/test10/whitebox-nested-group.exp
+++ b/pengine/test10/whitebox-nested-group.exp
@@ -1,20 +1,20 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="27" operation="monitor" operation_key="fake1_monitor_10000" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="30" operation="monitor" operation_key="fake1_monitor_10000" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="26" operation="start" operation_key="fake1_start_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="29" operation="start" operation_key="fake1_start_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="26" operation="start" operation_key="fake1_start_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="29" operation="start" operation_key="fake1_start_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -24,16 +24,16 @@
         <rsc_op id="3" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="10" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="11" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="17" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="19" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="17" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="19" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -42,7 +42,7 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="10" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="11" operation="monitor" operation_key="fake1_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -60,23 +60,23 @@
   </synapse>
   <synapse id="5">
     <action_set>
-      <rsc_op id="29" operation="monitor" operation_key="fake2_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="32" operation="monitor" operation_key="fake2_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="28" operation="start" operation_key="fake2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
+        <rsc_op id="31" operation="start" operation_key="fake2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="6">
     <action_set>
-      <rsc_op id="28" operation="start" operation_key="fake2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="31" operation="start" operation_key="fake2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -86,19 +86,19 @@
         <rsc_op id="4" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="11" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="12" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="18" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="20" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="7">
     <action_set>
-      <rsc_op id="18" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="20" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -107,7 +107,7 @@
   </synapse>
   <synapse id="8">
     <action_set>
-      <rsc_op id="11" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="12" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -125,20 +125,20 @@
   </synapse>
   <synapse id="10">
     <action_set>
-      <rsc_op id="31" operation="monitor" operation_key="fake3_monitor_10000" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="34" operation="monitor" operation_key="fake3_monitor_10000" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="30" operation="start" operation_key="fake3_start_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="33" operation="start" operation_key="fake3_start_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="11">
     <action_set>
-      <rsc_op id="30" operation="start" operation_key="fake3_start_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="33" operation="start" operation_key="fake3_start_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -148,16 +148,16 @@
         <rsc_op id="5" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="12" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="13" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="19" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="21" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="12">
     <action_set>
-      <rsc_op id="19" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="21" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -166,7 +166,7 @@
   </synapse>
   <synapse id="13">
     <action_set>
-      <rsc_op id="12" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="13" operation="monitor" operation_key="fake3_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -184,20 +184,20 @@
   </synapse>
   <synapse id="15">
     <action_set>
-      <rsc_op id="33" operation="monitor" operation_key="fake4_monitor_10000" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="36" operation="monitor" operation_key="fake4_monitor_10000" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake4" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="32" operation="start" operation_key="fake4_start_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="35" operation="start" operation_key="fake4_start_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="16">
     <action_set>
-      <rsc_op id="32" operation="start" operation_key="fake4_start_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="35" operation="start" operation_key="fake4_start_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake4" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -207,16 +207,16 @@
         <rsc_op id="6" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="13" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="14" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="20" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="22" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="17">
     <action_set>
-      <rsc_op id="20" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="22" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake4" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -225,7 +225,7 @@
   </synapse>
   <synapse id="18">
     <action_set>
-      <rsc_op id="13" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="14" operation="monitor" operation_key="fake4_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake4" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -243,23 +243,23 @@
   </synapse>
   <synapse id="20">
     <action_set>
-      <rsc_op id="35" operation="monitor" operation_key="fake5_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="38" operation="monitor" operation_key="fake5_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake5" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="34" operation="start" operation_key="fake5_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
+        <rsc_op id="37" operation="start" operation_key="fake5_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="21">
     <action_set>
-      <rsc_op id="34" operation="start" operation_key="fake5_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="37" operation="start" operation_key="fake5_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake5" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -269,19 +269,19 @@
         <rsc_op id="7" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="14" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="15" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="21" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="23" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="22">
     <action_set>
-      <rsc_op id="21" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="23" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake5" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -290,7 +290,7 @@
   </synapse>
   <synapse id="23">
     <action_set>
-      <rsc_op id="14" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="15" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake5" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -308,33 +308,33 @@
   </synapse>
   <synapse id="25">
     <action_set>
-      <rsc_op id="37" operation="monitor" operation_key="fake:0_monitor_10000" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="40" operation="monitor" operation_key="fake:0_monitor_10000" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake" long-id="fake:0" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="36" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="39" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="26">
     <action_set>
-      <rsc_op id="36" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="39" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake" long-id="fake:0" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0"/>
+        <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="27">
     <action_set>
-      <rsc_op id="15" operation="monitor" operation_key="fake:0_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="16" operation="monitor" operation_key="fake:0_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake" long-id="fake:0" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -343,33 +343,33 @@
   </synapse>
   <synapse id="28">
     <action_set>
-      <rsc_op id="39" operation="monitor" operation_key="fake:1_monitor_10000" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="42" operation="monitor" operation_key="fake:1_monitor_10000" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake" long-id="fake:1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="38" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="41" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="29">
     <action_set>
-      <rsc_op id="38" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="41" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake" long-id="fake:1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0"/>
+        <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="30">
     <action_set>
-      <rsc_op id="22" operation="monitor" operation_key="fake:1_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="24" operation="monitor" operation_key="fake:1_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake" long-id="fake:1" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="1" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -378,59 +378,59 @@
   </synapse>
   <synapse id="31">
     <action_set>
-      <rsc_op id="41" operation="monitor" operation_key="fake:2_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="44" operation="monitor" operation_key="fake:2_monitor_10000" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake" long-id="fake:2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="2" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="40" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
+        <rsc_op id="43" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="32">
     <action_set>
-      <rsc_op id="40" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
+      <rsc_op id="43" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1">
         <primitive id="fake" long-id="fake:2" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="2" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="c7auto4" CRM_meta_on_node_uuid="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0"/>
+        <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="33">
     <action_set>
-      <rsc_op id="43" operation="monitor" operation_key="fake:3_monitor_10000" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="46" operation="monitor" operation_key="fake:3_monitor_10000" on_node="c7auto1" on_node_uuid="1">
         <primitive id="fake" long-id="fake:3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="3" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="42" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="45" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="34">
     <action_set>
-      <rsc_op id="42" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="45" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1">
         <primitive id="fake" long-id="fake:3" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_clone="3" CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0"/>
+        <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
     </inputs>
   </synapse>
@@ -445,31 +445,31 @@
   </synapse>
   <synapse id="36" priority="1000000">
     <action_set>
-      <pseudo_event id="45" operation="running" operation_key="fake_clone_running_0">
+      <pseudo_event id="48" operation="running" operation_key="fake_clone_running_0">
         <attributes CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="36" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="39" operation="start" operation_key="fake:0_start_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="38" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="41" operation="start" operation_key="fake:1_start_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <rsc_op id="40" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
+        <rsc_op id="43" operation="start" operation_key="fake:2_start_0" on_node="c7auto4" on_node_uuid="c7auto4" router_node="c7auto1"/>
       </trigger>
       <trigger>
-        <rsc_op id="42" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="45" operation="start" operation_key="fake:3_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0"/>
+        <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="37">
     <action_set>
-      <pseudo_event id="44" operation="start" operation_key="fake_clone_start_0">
+      <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0">
         <attributes CRM_meta_clone_max="4" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -478,34 +478,34 @@
         <rsc_op id="8" operation="monitor" operation_key="fake:3_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="15" operation="monitor" operation_key="fake:0_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="16" operation="monitor" operation_key="fake:0_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="22" operation="monitor" operation_key="fake:1_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="24" operation="monitor" operation_key="fake:1_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="38">
     <action_set>
-      <pseudo_event id="53" operation="running" operation_key="fake_group_running_0">
+      <pseudo_event id="56" operation="running" operation_key="fake_group_running_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="48" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="51" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="50" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="52" operation="start" operation_key="fake_group_start_0"/>
+        <pseudo_event id="55" operation="start" operation_key="fake_group_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="39">
     <action_set>
-      <pseudo_event id="52" operation="start" operation_key="fake_group_start_0">
+      <pseudo_event id="55" operation="start" operation_key="fake_group_start_0">
         <attributes CRM_meta_timeout="20000" />
       </pseudo_event>
     </action_set>
@@ -513,20 +513,20 @@
   </synapse>
   <synapse id="40">
     <action_set>
-      <rsc_op id="49" operation="monitor" operation_key="fake_fs_monitor_10000" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="52" operation="monitor" operation_key="fake_fs_monitor_10000" on_node="c7auto1" on_node_uuid="1">
         <primitive id="fake_fs" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="48" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="51" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="41">
     <action_set>
-      <rsc_op id="48" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="51" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1">
         <primitive id="fake_fs" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -536,19 +536,19 @@
         <rsc_op id="9" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <rsc_op id="16" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+        <rsc_op id="17" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
       </trigger>
       <trigger>
-        <rsc_op id="23" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+        <rsc_op id="25" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
-        <pseudo_event id="52" operation="start" operation_key="fake_group_start_0"/>
+        <pseudo_event id="55" operation="start" operation_key="fake_group_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="42">
     <action_set>
-      <rsc_op id="23" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto3" on_node_uuid="3">
+      <rsc_op id="25" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto3" on_node_uuid="3">
         <primitive id="fake_fs" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -557,7 +557,7 @@
   </synapse>
   <synapse id="43">
     <action_set>
-      <rsc_op id="16" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto2" on_node_uuid="2">
+      <rsc_op id="17" operation="monitor" operation_key="fake_fs_monitor_0" on_node="c7auto2" on_node_uuid="2">
         <primitive id="fake_fs" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -575,57 +575,93 @@
   </synapse>
   <synapse id="45">
     <action_set>
-      <rsc_op id="51" operation="monitor" operation_key="container_monitor_10000" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="54" operation="monitor" operation_key="container_monitor_10000" on_node="c7auto1" on_node_uuid="1">
         <primitive id="container" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_remote_node="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="50" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="46">
     <action_set>
-      <rsc_op id="50" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1">
         <primitive id="container" class="ocf" provider="heartbeat" type="Dummy"/>
         <attributes CRM_meta_name="start" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_remote_node="c7auto4" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="48" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="51" operation="start" operation_key="fake_fs_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-        <pseudo_event id="52" operation="start" operation_key="fake_group_start_0"/>
+        <pseudo_event id="55" operation="start" operation_key="fake_group_start_0"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="47">
     <action_set>
-      <rsc_op id="57" operation="monitor" operation_key="c7auto4_monitor_30000" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="60" operation="monitor" operation_key="c7auto4_monitor_30000" on_node="c7auto1" on_node_uuid="1">
         <primitive id="c7auto4" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="48">
     <action_set>
-      <rsc_op id="56" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1">
+      <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1">
         <primitive id="c7auto4" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="container" CRM_meta_name="start" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="50" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+        <rsc_op id="10" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="18" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="26" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
   </synapse>
+  <synapse id="49">
+    <action_set>
+      <rsc_op id="26" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto3" on_node_uuid="3">
+        <primitive id="c7auto4" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container" CRM_meta_on_node="c7auto3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="50">
+    <action_set>
+      <rsc_op id="18" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto2" on_node_uuid="2">
+        <primitive id="c7auto4" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container" CRM_meta_on_node="c7auto2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="51">
+    <action_set>
+      <rsc_op id="10" operation="monitor" operation_key="c7auto4_monitor_0" on_node="c7auto1" on_node_uuid="1">
+        <primitive id="c7auto4" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="container" CRM_meta_on_node="c7auto1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
 </transition_graph>
diff --git a/pengine/test10/whitebox-nested-group.summary b/pengine/test10/whitebox-nested-group.summary
index 6e6287a..ca9c47f 100644
--- a/pengine/test10/whitebox-nested-group.summary
+++ b/pengine/test10/whitebox-nested-group.summary
@@ -52,6 +52,9 @@ Executing cluster transition:
  * Resource action: fake_fs         monitor on c7auto3
  * Resource action: fake_fs         monitor on c7auto2
  * Resource action: fake_fs         monitor on c7auto1
+ * Resource action: c7auto4         monitor on c7auto3
+ * Resource action: c7auto4         monitor on c7auto2
+ * Resource action: c7auto4         monitor on c7auto1
  * Resource action: fake1           start on c7auto3
  * Resource action: fake3           start on c7auto2
  * Resource action: fake4           start on c7auto3
diff --git a/pengine/test10/whitebox-unexpectedly-running.dot b/pengine/test10/whitebox-unexpectedly-running.dot
index 2915d77..0e2e5bb 100644
--- a/pengine/test10/whitebox-unexpectedly-running.dot
+++ b/pengine/test10/whitebox-unexpectedly-running.dot
@@ -8,6 +8,8 @@
 "FAKE_stop_0 18builder" -> "stonith 'reboot' remote1" [ style = bold]
 "FAKE_stop_0 18builder" [ style=bold color="green" fontcolor="black"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"remote1_monitor_0 18builder" -> "remote1_start_0 18builder" [ style = bold]
+"remote1_monitor_0 18builder" [ style=bold color="green" fontcolor="black"]
 "remote1_monitor_30000 18builder" [ style=bold color="green" fontcolor="black"]
 "remote1_start_0 18builder" -> "remote1_monitor_30000 18builder" [ style = bold]
 "remote1_start_0 18builder" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/whitebox-unexpectedly-running.exp b/pengine/test10/whitebox-unexpectedly-running.exp
index 17606ce..a0e5cae 100644
--- a/pengine/test10/whitebox-unexpectedly-running.exp
+++ b/pengine/test10/whitebox-unexpectedly-running.exp
@@ -1,33 +1,33 @@
 <transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
   <synapse id="0">
     <action_set>
-      <rsc_op id="4" operation="monitor" operation_key="FAKE_monitor_60000" on_node="18builder" on_node_uuid="5">
+      <rsc_op id="5" operation="monitor" operation_key="FAKE_monitor_60000" on_node="18builder" on_node_uuid="5">
         <primitive id="FAKE" class="ocf" provider="pacemaker" type="Dummy"/>
         <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_remote_node="remote1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="3" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="4" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
-      <rsc_op id="3" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5">
+      <rsc_op id="4" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5">
         <primitive id="FAKE" class="ocf" provider="pacemaker" type="Dummy"/>
         <attributes CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_remote_node="remote1" CRM_meta_timeout="20000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="2" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
-      <rsc_op id="2" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5">
+      <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5">
         <primitive id="FAKE" class="ocf" provider="pacemaker" type="Dummy"/>
         <attributes CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_remote_node="remote1" CRM_meta_timeout="20000" />
       </rsc_op>
@@ -36,33 +36,45 @@
   </synapse>
   <synapse id="3">
     <action_set>
-      <rsc_op id="6" operation="monitor" operation_key="remote1_monitor_30000" on_node="18builder" on_node_uuid="5">
+      <rsc_op id="7" operation="monitor" operation_key="remote1_monitor_30000" on_node="18builder" on_node_uuid="5">
         <primitive id="remote1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="FAKE" CRM_meta_interval="30000" CRM_meta_name="monitor" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_timeout="30000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="5" operation="start" operation_key="remote1_start_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="6" operation="start" operation_key="remote1_start_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="4">
     <action_set>
-      <rsc_op id="5" operation="start" operation_key="remote1_start_0" on_node="18builder" on_node_uuid="5">
+      <rsc_op id="6" operation="start" operation_key="remote1_start_0" on_node="18builder" on_node_uuid="5">
         <primitive id="remote1" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="FAKE" CRM_meta_name="start" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_timeout="60000" />
       </rsc_op>
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="3" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="2" operation="monitor" operation_key="remote1_monitor_0" on_node="18builder" on_node_uuid="5"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="4" operation="start" operation_key="FAKE_start_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
   <synapse id="5">
     <action_set>
-      <pseudo_event id="8" operation="stonith" operation_key="stonith-remote1-reboot" on_node="remote1" on_node_uuid="remote1">
+      <rsc_op id="2" operation="monitor" operation_key="remote1_monitor_0" on_node="18builder" on_node_uuid="5">
+        <primitive id="remote1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="FAKE" CRM_meta_on_node="18builder" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="30000" />
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="6">
+    <action_set>
+      <pseudo_event id="9" operation="stonith" operation_key="stonith-remote1-reboot" on_node="remote1" on_node_uuid="remote1">
         <attributes CRM_meta_on_node="remote1" CRM_meta_on_node_uuid="remote1" CRM_meta_stonith_action="reboot" />
         <downed>
           <node id="remote1"/>
@@ -71,23 +83,23 @@
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="2" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="6">
+  <synapse id="7">
     <action_set>
-      <pseudo_event id="7" operation="stonith_complete" operation_key="stonith_complete">
+      <pseudo_event id="8" operation="stonith_complete" operation_key="stonith_complete">
         <attributes />
       </pseudo_event>
     </action_set>
     <inputs>
       <trigger>
-        <pseudo_event id="8" operation="stonith" operation_key="stonith-remote1-reboot" on_node="remote1" on_node_uuid="remote1"/>
+        <pseudo_event id="9" operation="stonith" operation_key="stonith-remote1-reboot" on_node="remote1" on_node_uuid="remote1"/>
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="7">
+  <synapse id="8">
     <action_set>
       <pseudo_event id="1" operation="all_stopped" operation_key="all_stopped">
         <attributes />
@@ -95,10 +107,10 @@
     </action_set>
     <inputs>
       <trigger>
-        <rsc_op id="2" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
+        <rsc_op id="3" operation="stop" operation_key="FAKE_stop_0" on_node="18builder" on_node_uuid="5"/>
       </trigger>
       <trigger>
-        <pseudo_event id="7" operation="stonith_complete" operation_key="stonith_complete"/>
+        <pseudo_event id="8" operation="stonith_complete" operation_key="stonith_complete"/>
       </trigger>
     </inputs>
   </synapse>
diff --git a/pengine/test10/whitebox-unexpectedly-running.summary b/pengine/test10/whitebox-unexpectedly-running.summary
index 7d5b908..0b5ca42 100644
--- a/pengine/test10/whitebox-unexpectedly-running.summary
+++ b/pengine/test10/whitebox-unexpectedly-running.summary
@@ -10,6 +10,7 @@ Transition Summary:
 
 Executing cluster transition:
  * Resource action: FAKE            stop on 18builder
+ * Resource action: remote1         monitor on 18builder
  * Pseudo action:   stonith-remote1-reboot on remote1
  * Pseudo action:   stonith_complete
  * Pseudo action:   all_stopped
-- 
1.8.3.1


From 43450d8bfabc981b2637189e9872aaa0b7cdccb3 Mon Sep 17 00:00:00 2001
From: Klaus Wenninger <klaus.wenninger@aon.at>
Date: Fri, 5 May 2017 00:50:33 +0200
Subject: [PATCH 3/4] Fix: pengine: unique ids for meta-attributes of
 guest-connection

---
 lib/pengine/unpack.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/pengine/unpack.c b/lib/pengine/unpack.c
index 29a1013..0e9f2b1 100644
--- a/lib/pengine/unpack.c
+++ b/lib/pengine/unpack.c
@@ -463,7 +463,7 @@ expand_remote_rsc_meta(xmlNode *xml_obj, xmlNode *parent, pe_working_set_t *data
 
     if (remote_allow_migrate) {
         attr = create_xml_node(xml_tmp, XML_CIB_TAG_NVPAIR);
-        crm_xml_set_id(attr, "%s_%s", remote_name, "meta-attributes-container");
+        crm_xml_set_id(attr, "%s_%s", remote_name, "meta-attributes-migrate");
         crm_xml_add(attr, XML_NVPAIR_ATTR_NAME, XML_OP_ATTR_ALLOW_MIGRATE);
         crm_xml_add(attr, XML_NVPAIR_ATTR_VALUE, remote_allow_migrate);
     }
-- 
1.8.3.1


From f5a8c701b81b6e4bde989feeef93fb5b1e539d28 Mon Sep 17 00:00:00 2001
From: Klaus Wenninger <klaus.wenninger@aon.at>
Date: Thu, 4 May 2017 19:48:06 +0200
Subject: [PATCH 4/4] Feature: pengine: unmanage guest-container puts guest in
 maintenance

sync managed-state of connection-resource with container
can be used to do - otherwise not possible - cleanup of connection

Fixes rhbz#1303742
---
 lib/pengine/unpack.c | 32 ++++++++++++++++++++++++--------
 1 file changed, 24 insertions(+), 8 deletions(-)

diff --git a/lib/pengine/unpack.c b/lib/pengine/unpack.c
index 0e9f2b1..6ec7daf 100644
--- a/lib/pengine/unpack.c
+++ b/lib/pengine/unpack.c
@@ -72,15 +72,21 @@ pe_fence_node(pe_working_set_t * data_set, node_t * node, const char *reason)
         resource_t *rsc = node->details->remote_rsc->container;
 
         if (is_set(rsc->flags, pe_rsc_failed) == FALSE) {
-            crm_warn("Guest node %s will be fenced (by recovering %s) %s",
-                node->details->uname, rsc->id, reason);
+            if (!is_set(rsc->flags, pe_rsc_managed)) {
+                crm_notice("Not fencing guest node %s because the container is "
+                           "unmanaged, otherwise we would do so recovering %s "
+                           "%s", node->details->uname, rsc->id, reason);
+            } else {
+                crm_warn("Guest node %s will be fenced (by recovering %s) %s",
+                    node->details->uname, rsc->id, reason);
 
-            /* We don't mark the node as unclean, because that would prevent the
-             * node from running resources. We want to allow it to run resources
-             * in this transition if the recovery succeeds.
-             */
-            node->details->remote_requires_reset = TRUE;
-            set_bit(rsc->flags, pe_rsc_failed);
+                /* We don't mark the node as unclean because that would prevent the
+                 * node from running resources. We want to allow it to run resources
+                 * in this transition if the recovery succeeds.
+                 */
+                node->details->remote_requires_reset = TRUE;
+                set_bit(rsc->flags, pe_rsc_failed);
+            }
         }
     } else if (is_dangling_container_remote_node(node)) {
         crm_info("Cleaning up dangling connection resource for guest node %s %s"
@@ -409,6 +415,7 @@ expand_remote_rsc_meta(xmlNode *xml_obj, xmlNode *parent, pe_working_set_t *data
     const char *remote_port = NULL;
     const char *connect_timeout = "60s";
     const char *remote_allow_migrate=NULL;
+    const char *container_managed = NULL;
 
     for (attr_set = __xml_first_child(xml_obj); attr_set != NULL; attr_set = __xml_next_element(attr_set)) {
         if (safe_str_neq((const char *)attr_set->name, XML_TAG_META_SETS)) {
@@ -429,6 +436,8 @@ expand_remote_rsc_meta(xmlNode *xml_obj, xmlNode *parent, pe_working_set_t *data
                 connect_timeout = value;
             } else if (safe_str_eq(name, "remote-allow-migrate")) {
                 remote_allow_migrate=value;
+            } else if (safe_str_eq(name, XML_RSC_ATTR_MANAGED)) {
+                container_managed = value;
             }
         }
     }
@@ -468,6 +477,13 @@ expand_remote_rsc_meta(xmlNode *xml_obj, xmlNode *parent, pe_working_set_t *data
         crm_xml_add(attr, XML_NVPAIR_ATTR_VALUE, remote_allow_migrate);
     }
 
+    if (container_managed) {
+        attr = create_xml_node(xml_tmp, XML_CIB_TAG_NVPAIR);
+        crm_xml_set_id(attr, "%s_%s", remote_name, "meta-attributes-managed");
+        crm_xml_add(attr, XML_NVPAIR_ATTR_NAME, XML_RSC_ATTR_MANAGED);
+        crm_xml_add(attr, XML_NVPAIR_ATTR_VALUE, container_managed);
+    }
+
     xml_tmp = create_xml_node(xml_rsc, "operations");
     attr = create_xml_node(xml_tmp, XML_ATTR_OP);
     crm_xml_set_id(attr, "%s_%s", remote_name, "monitor-interval-30s");
-- 
1.8.3.1

