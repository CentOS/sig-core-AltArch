From bc9ba911936e7816e467b5ee1298da11fb83862b Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Wed, 24 May 2017 11:21:15 +1000
Subject: [PATCH 1/6] Fix: PE: Correctly compare a point with NULL instead of
 FALSE

---
 lib/pengine/remote.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/pengine/remote.c b/lib/pengine/remote.c
index c5a3eec..4755d20 100644
--- a/lib/pengine/remote.c
+++ b/lib/pengine/remote.c
@@ -43,7 +43,7 @@ is_rsc_baremetal_remote_node(resource_t *rsc, pe_working_set_t * data_set)
 gboolean
 is_baremetal_remote_node(node_t *node)
 {
-    if (is_remote_node(node) && (node->details->remote_rsc == FALSE || node->details->remote_rsc->container == FALSE)) {
+    if (is_remote_node(node) && (node->details->remote_rsc == NULL || node->details->remote_rsc->container == FALSE)) {
         return TRUE;
     }
     return FALSE;
-- 
1.8.3.1


From 3f72a028f9a12a6623a7b88733a6fe7ecc879230 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Wed, 24 May 2017 11:21:44 +1000
Subject: [PATCH 2/6] PE: Assume resources on remote nodes do not need to be
 restarted until absolutely necessary

---
 pengine/allocate.c | 378 ++++++++++++++++++++++++++++++++++-------------------
 1 file changed, 245 insertions(+), 133 deletions(-)

diff --git a/pengine/allocate.c b/pengine/allocate.c
index 6b0025b..90d25fc 100644
--- a/pengine/allocate.c
+++ b/pengine/allocate.c
@@ -1745,6 +1745,244 @@ rsc_order_first(resource_t * lh_rsc, order_constraint_t * order, pe_working_set_
 extern gboolean update_action(action_t * action);
 extern void update_colo_start_chain(action_t * action);
 
+enum remote_connection_state 
+{
+    remote_state_unknown = 0,
+    remote_state_alive = 1,
+    remote_state_resting = 2,
+    remote_state_dead= 3
+};
+
+static int
+is_recurring_action(action_t *action) 
+{
+    const char *interval_s = g_hash_table_lookup(action->meta, XML_LRM_ATTR_INTERVAL);
+    int interval = crm_parse_int(interval_s, "0");
+    if(interval > 0) {
+        return TRUE;
+    }
+    return FALSE;
+}
+
+static void
+apply_container_ordering(action_t *action, pe_working_set_t *data_set)
+{
+    /* VMs are also classified as containers for these purposes... in
+     * that they both involve a 'thing' running on a real or remote
+     * cluster node.
+     *
+     * This allows us to be smarter about the type and extent of
+     * recovery actions required in various scenarios
+     */
+    resource_t *remote_rsc = NULL;
+    resource_t *container = NULL;
+    enum action_tasks task = text2task(action->task);
+
+    if (action->rsc == NULL) {
+        return;
+    }
+
+    CRM_ASSERT(action->node);
+    CRM_ASSERT(is_remote_node(action->node));
+    CRM_ASSERT(action->node->details->remote_rsc);
+
+    remote_rsc = action->node->details->remote_rsc;
+    CRM_ASSERT(remote_rsc);
+
+    container = remote_rsc->container;
+    CRM_ASSERT(container);
+
+    crm_trace("%s %s %s %s %d", action->uuid, action->task, remote_rsc->id, container->id, is_set(container->flags, pe_rsc_failed));
+    switch (task) {
+        case start_rsc:
+        case action_promote:
+            /* Force resource recovery if the container is recovered */
+            custom_action_order(container, generate_op_key(container->id, RSC_START, 0), NULL,
+                                action->rsc, NULL, action,
+                                pe_order_preserve | pe_order_implies_then | pe_order_runnable_left, data_set);
+
+            /* Wait for the connection resource to be up too */
+            custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                action->rsc, NULL, action,
+                                pe_order_preserve | pe_order_runnable_left, data_set);
+            break;
+        case stop_rsc:
+            if(is_set(container->flags, pe_rsc_failed)) {
+                /* When the container representing a guest node fails,
+                 * the stop action for all the resources living in
+                 * that container is implied by the container
+                 * stopping. This is similar to how fencing operations
+                 * work for cluster nodes.
+                 */
+                custom_action_order(container, generate_op_key(container->id, RSC_STOP, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_implies_then | pe_order_runnable_left, data_set);
+                pe_set_action_bit(action, pe_action_pseudo);
+            } else {
+                /* Otherwise, ensure the operation happens before the connection is brought down */
+                custom_action_order(action->rsc, NULL, action,
+                                    remote_rsc, generate_op_key(remote_rsc->id, RSC_STOP, 0), NULL,
+                                    pe_order_preserve, data_set);
+            }
+            break;
+        case action_demote:
+            if(is_set(container->flags, pe_rsc_failed)) {
+                /* Just like a stop, the demote is implied by the
+                 * container having failed/stopped
+                 *
+                 * If we really wanted to we would order the demote
+                 * after the stop, IFF the containers current role was
+                 * stopped (otherwise we re-introduce an ordering
+                 * loop)
+                 */
+                pe_set_action_bit(action, pe_action_pseudo);
+            } else {
+                /* Otherwise, ensure the operation happens before the connection is brought down */
+                custom_action_order(action->rsc, NULL, action,
+                                    remote_rsc, generate_op_key(remote_rsc->id, RSC_STOP, 0), NULL,
+                                    pe_order_preserve, data_set);
+            }
+            break;
+        default:
+            /* Wait for the connection resource to be up */
+            if (is_recurring_action(action)) {
+                /* In case we ever get the recovery logic wrong, force
+                 * recurring monitors to be restarted, even if just
+                 * the connection was re-established
+                 */
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left | pe_order_implies_then, data_set);
+            } else {
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left, data_set);
+            }
+            break;
+    }
+}
+
+static void
+apply_remote_ordering(action_t *action, pe_working_set_t *data_set)
+{
+    resource_t *remote_rsc = NULL;
+    node_t *cluster_node = NULL;
+    enum action_tasks task = text2task(action->task);
+    enum remote_connection_state state = remote_state_unknown;
+
+    if (action->rsc == NULL) {
+        return;
+    }
+
+    CRM_ASSERT(action->node);
+    CRM_ASSERT(is_remote_node(action->node));
+    CRM_ASSERT(action->node->details->remote_rsc);
+
+    remote_rsc = action->node->details->remote_rsc;
+    CRM_ASSERT(remote_rsc);
+
+    if(remote_rsc->running_on) {
+        cluster_node = remote_rsc->running_on->data;
+    }
+
+    /* If the cluster node the remote connection resource resides on
+     * is unclean or went offline, we can't process any operations
+     * on that remote node until after it starts elsewhere.
+     */
+    if(remote_rsc->next_role == RSC_ROLE_STOPPED || remote_rsc->allocated_to == NULL) {
+        /* There is no-where left to run the connection resource
+         * We must assume the target has failed
+         */
+        state = remote_state_dead;
+
+    } else if (cluster_node == NULL) {
+        /* Connection is recoverable but not currently running anywhere, see if we can recover it first */
+        state = remote_state_unknown;
+
+    } else if(cluster_node->details->unclean == TRUE
+              || cluster_node->details->online == FALSE) {
+        /* Connection is running on a dead node, see if we can recover it first */
+        state = remote_state_resting;
+
+    } else if (g_list_length(remote_rsc->running_on) > 1
+               && remote_rsc->partial_migration_source
+               && remote_rsc->partial_migration_target) {
+        /* We're in the middle of migrating a connection resource,
+         * wait until after the resource migrates before performing
+         * any actions.
+         */
+        state = remote_state_resting;
+
+    } else {
+        state = remote_state_alive;
+    }
+
+    crm_trace("%s %s %d", action->uuid, action->task, state);
+    switch (task) {
+        case start_rsc:
+        case action_promote:
+            if(state == remote_state_dead) {
+                /* Wait for the connection resource to be up and force recovery */
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_implies_then | pe_order_runnable_left, data_set);
+            } else {
+                /* Ensure the connection resource is up and assume everything is as we left it */
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left, data_set);
+            }
+            break;
+        case stop_rsc:
+            /* Handle special case with remote node where stop actions need to be
+             * ordered after the connection resource starts somewhere else.
+             */
+            if(state == remote_state_resting) {
+                /* Wait for the connection resource to be up and assume everything is as we left it */
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left, data_set);
+            } else {
+                custom_action_order(action->rsc, NULL, action,
+                                    remote_rsc, generate_op_key(remote_rsc->id, RSC_STOP, 0), NULL,
+                                    pe_order_preserve | pe_order_implies_first, data_set);
+            }
+            break;
+        case action_demote:
+
+            /* If the connection is being torn down, we don't want
+             * to build a constraint between a resource's demotion and
+             * the connection resource starting... because the connection
+             * resource can not start. The connection might already be up,
+             * but the "start" action would not be allowed, which in turn would
+             * block the demotion of any resources living in the node.
+             */
+
+            if(state == remote_state_resting || state == remote_state_unknown) {
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve, data_set);
+            } /* Otherwise we can rely on the stop ordering */
+            break;
+        default:
+            /* Wait for the connection resource to be up */
+            if (is_recurring_action(action)) {
+                /* In case we ever get the recovery logic wrong, force
+                 * recurring monitors to be restarted, even if just
+                 * the connection was re-established
+                 */
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left | pe_order_implies_then, data_set);
+            } else {
+                custom_action_order(remote_rsc, generate_op_key(remote_rsc->id, RSC_START, 0), NULL,
+                                    action->rsc, NULL, action,
+                                    pe_order_preserve | pe_order_runnable_left, data_set);
+            }
+            break;
+    }
+}
+
 static void
 apply_remote_node_ordering(pe_working_set_t *data_set)
 {
@@ -1753,10 +1991,9 @@ apply_remote_node_ordering(pe_working_set_t *data_set)
     if (is_set(data_set->flags, pe_flag_have_remote_nodes) == FALSE) {
         return;
     }
+
     for (; gIter != NULL; gIter = gIter->next) {
         action_t *action = (action_t *) gIter->data;
-        resource_t *remote_rsc = NULL;
-        resource_t *container = NULL;
 
         if (action->rsc == NULL) {
             continue;
@@ -1781,7 +2018,7 @@ apply_remote_node_ordering(pe_working_set_t *data_set)
                 pe_order_optional,
                 data_set);
 
-                continue;
+            continue;
         }
 
         /* If the action occurs on a Pacemaker Remote node, create
@@ -1792,138 +2029,13 @@ apply_remote_node_ordering(pe_working_set_t *data_set)
             is_remote_node(action->node) == FALSE ||
             action->node->details->remote_rsc == NULL ||
             is_set(action->flags, pe_action_pseudo)) {
-            continue;
-        }
+            crm_trace("Nothing required for %s", action->uuid);
 
-        remote_rsc = action->node->details->remote_rsc;
-        container = remote_rsc->container;
+        } else if(action->node->details->remote_rsc->container) {
+            apply_container_ordering(action, data_set);
 
-        if (safe_str_eq(action->task, "monitor") ||
-            safe_str_eq(action->task, "start") ||
-            safe_str_eq(action->task, "promote") ||
-            safe_str_eq(action->task, "notify") ||
-            safe_str_eq(action->task, CRM_OP_LRM_REFRESH) ||
-            safe_str_eq(action->task, CRM_OP_CLEAR_FAILCOUNT) ||
-            safe_str_eq(action->task, "delete")) {
-
-            custom_action_order(remote_rsc,
-                generate_op_key(remote_rsc->id, RSC_START, 0),
-                NULL,
-                action->rsc,
-                NULL,
-                action,
-                pe_order_preserve | pe_order_implies_then | pe_order_runnable_left,
-                data_set);
-
-        } else if (safe_str_eq(action->task, "demote")) {
-
-            /* If the connection is being torn down, we don't want
-             * to build a constraint between a resource's demotion and
-             * the connection resource starting... because the connection
-             * resource can not start. The connection might already be up,
-             * but the "start" action would not be allowed, which in turn would
-             * block the demotion of any resources living in the node.
-             *
-             * In this case, only build the constraint between the demotion and
-             * the connection's "stop" action. This allows the connection and
-             * all the resources within the node to be torn down properly.
-             */
-            if (remote_rsc->next_role == RSC_ROLE_STOPPED) {
-                custom_action_order(action->rsc,
-                    NULL,
-                    action,
-                    remote_rsc,
-                    generate_op_key(remote_rsc->id, RSC_STOP, 0),
-                    NULL,
-                    pe_order_preserve | pe_order_implies_first,
-                    data_set);
-            } else if(container == NULL) {
-                custom_action_order(remote_rsc,
-                    generate_op_key(remote_rsc->id, RSC_START, 0),
-                    NULL,
-                    action->rsc,
-                    NULL,
-                    action,
-                    pe_order_preserve | pe_order_implies_then | pe_order_runnable_left,
-                    data_set);
-            }
-
-            if(container && is_set(container->flags, pe_rsc_failed)) {
-                /* Just like a stop, the demote is implied by the
-                 * container having failed/stopped
-                 *
-                 * If we really wanted to we would order the demote
-                 * after the stop, IFF the containers current role was
-                 * stopped (otherwise we re-introduce an ordering
-                 * loop)
-                 */
-                pe_set_action_bit(action, pe_action_pseudo);
-            }
-
-        } else if (safe_str_eq(action->task, "stop") &&
-                   container &&
-                   is_set(container->flags, pe_rsc_failed)) {
-
-            /* When the container representing a guest node fails, the stop
-             * action for all the resources living in that container is implied
-             * by the container stopping. This is similar to how fencing
-             * operations work for cluster nodes.
-             */
-            pe_set_action_bit(action, pe_action_pseudo);
-            custom_action_order(container,
-                generate_op_key(container->id, RSC_STOP, 0),
-                NULL,
-                action->rsc,
-                NULL,
-                action,
-                pe_order_preserve | pe_order_implies_then | pe_order_runnable_left,
-                data_set);
-        } else if (safe_str_eq(action->task, "stop")) {
-            gboolean after_start = FALSE;
-
-            /* Handle special case with remote node where stop actions need to be
-             * ordered after the connection resource starts somewhere else.
-             */
-            if (is_baremetal_remote_node(action->node)) {
-                node_t *cluster_node = remote_rsc->running_on ? remote_rsc->running_on->data : NULL;
-
-                /* If the cluster node the remote connection resource resides on
-                 * is unclean or went offline, we can't process any operations
-                 * on that remote node until after it starts elsewhere.
-                 */
-                if (cluster_node == NULL ||
-                    cluster_node->details->unclean == TRUE ||
-                    cluster_node->details->online == FALSE) {
-                    after_start = TRUE;
-                } else if (g_list_length(remote_rsc->running_on) > 1 &&
-                           remote_rsc->partial_migration_source &&
-                            remote_rsc->partial_migration_target) {
-                    /* if we're caught in the middle of migrating a connection resource,
-                     * then we have to wait until after the resource migrates before performing
-                     * any actions. */
-                    after_start = TRUE;
-                }
-            }
-
-            if (after_start) {
-                custom_action_order(remote_rsc,
-                    generate_op_key(remote_rsc->id, RSC_START, 0),
-                    NULL,
-                    action->rsc,
-                    NULL,
-                    action,
-                    pe_order_preserve | pe_order_implies_then | pe_order_runnable_left,
-                    data_set);
-            } else {
-                custom_action_order(action->rsc,
-                    NULL,
-                    action,
-                    remote_rsc,
-                    generate_op_key(remote_rsc->id, RSC_STOP, 0),
-                    NULL,
-                    pe_order_preserve | pe_order_implies_first,
-                    data_set);
-            }
+        } else {
+            apply_remote_ordering(action, data_set);
         }
     }
 }
-- 
1.8.3.1


From ca279000ed8733dd76a4f9c6306c939979139133 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Wed, 24 May 2017 11:22:05 +1000
Subject: [PATCH 3/6] Test: PE: Assume resources on remote nodes do not need to
 be restarted until absolutely necessary

---
 pengine/test10/bug-rh-1097457.dot               |   3 +
 pengine/test10/bug-rh-1097457.exp               |   9 +
 pengine/test10/guest-node-host-dies.dot         |   3 +
 pengine/test10/guest-node-host-dies.exp         |   9 +
 pengine/test10/remote-recover.dot               |   8 -
 pengine/test10/remote-recover.exp               |  44 ---
 pengine/test10/remote-recover.summary           |   6 +-
 pengine/test10/remote-recovery.dot              |  90 -----
 pengine/test10/remote-recovery.exp              | 488 ++----------------------
 pengine/test10/remote-recovery.summary          |  31 +-
 pengine/test10/whitebox-fail1.dot               |   2 +
 pengine/test10/whitebox-fail1.exp               |   6 +
 pengine/test10/whitebox-fail2.dot               |   2 +
 pengine/test10/whitebox-fail2.exp               |   6 +
 pengine/test10/whitebox-fail3.dot               |   3 +
 pengine/test10/whitebox-fail3.exp               |   9 +
 pengine/test10/whitebox-imply-stop-on-fence.dot |   1 +
 pengine/test10/whitebox-imply-stop-on-fence.exp |   3 +
 pengine/test10/whitebox-move.dot                |   2 +
 pengine/test10/whitebox-move.exp                |   6 +
 pengine/test10/whitebox-ms-ordering-move.dot    |   3 +
 pengine/test10/whitebox-ms-ordering-move.exp    |   9 +
 pengine/test10/whitebox-ms-ordering.dot         |   3 +
 pengine/test10/whitebox-ms-ordering.exp         |   9 +
 pengine/test10/whitebox-nested-group.dot        |   3 +
 pengine/test10/whitebox-nested-group.exp        |   9 +
 pengine/test10/whitebox-start.dot               |   2 +
 pengine/test10/whitebox-start.exp               |   6 +
 28 files changed, 151 insertions(+), 624 deletions(-)

diff --git a/pengine/test10/bug-rh-1097457.dot b/pengine/test10/bug-rh-1097457.dot
index ece2834..e74c8fb 100644
--- a/pengine/test10/bug-rh-1097457.dot
+++ b/pengine/test10/bug-rh-1097457.dot
@@ -43,6 +43,9 @@ digraph "g" {
 "FSlun3_stop_0 lamaVM2" -> "all_stopped" [ style = bold]
 "FSlun3_stop_0 lamaVM2" [ style=bold color="green" fontcolor="orange"]
 "VM2_monitor_10000 lama3" [ style=bold color="green" fontcolor="black"]
+"VM2_start_0 lama3" -> "FAKE4-IP_start_0 lamaVM2" [ style = bold]
+"VM2_start_0 lama3" -> "FAKE4_start_0 lamaVM2" [ style = bold]
+"VM2_start_0 lama3" -> "FAKE6_start_0 lamaVM2" [ style = bold]
 "VM2_start_0 lama3" -> "FSlun3_start_0 lama2" [ style = bold]
 "VM2_start_0 lama3" -> "VM2_monitor_10000 lama3" [ style = bold]
 "VM2_start_0 lama3" -> "lamaVM2_start_0 lama3" [ style = bold]
diff --git a/pengine/test10/bug-rh-1097457.exp b/pengine/test10/bug-rh-1097457.exp
index 16b6b77..bf62647 100644
--- a/pengine/test10/bug-rh-1097457.exp
+++ b/pengine/test10/bug-rh-1097457.exp
@@ -173,6 +173,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="37" operation="start" operation_key="VM2_start_0" on_node="lama3" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="71" operation="stop" operation_key="FAKE4_stop_0"/>
       </trigger>
       <trigger>
@@ -229,6 +232,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="37" operation="start" operation_key="VM2_start_0" on_node="lama3" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <rsc_op id="72" operation="start" operation_key="FAKE4_start_0" on_node="lamaVM2" on_node_uuid="lamaVM2" router_node="lama3"/>
       </trigger>
       <trigger>
@@ -285,6 +291,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="37" operation="start" operation_key="VM2_start_0" on_node="lama3" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="83" operation="stop" operation_key="FAKE6_stop_0" internal_operation_key="FAKE6:2_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/guest-node-host-dies.dot b/pengine/test10/guest-node-host-dies.dot
index 1fdec7b..04152d1 100644
--- a/pengine/test10/guest-node-host-dies.dot
+++ b/pengine/test10/guest-node-host-dies.dot
@@ -7,12 +7,15 @@ digraph "g" {
 "Fencing_stop_0 rhel7-4" [ style=bold color="green" fontcolor="black"]
 "all_stopped" -> "Fencing_start_0 rhel7-4" [ style = bold]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 rhel7-2" -> "lxc-ms_promote_0 lxc1" [ style = bold]
+"container1_start_0 rhel7-2" -> "lxc-ms_start_0 lxc1" [ style = bold]
 "container1_start_0 rhel7-2" -> "lxc1_start_0 rhel7-2" [ style = bold]
 "container1_start_0 rhel7-2" [ style=bold color="green" fontcolor="black"]
 "container1_stop_0 rhel7-1" -> "all_stopped" [ style = bold]
 "container1_stop_0 rhel7-1" -> "container1_start_0 rhel7-2" [ style = bold]
 "container1_stop_0 rhel7-1" -> "stonith 'reboot' lxc1" [ style = bold]
 "container1_stop_0 rhel7-1" [ style=bold color="green" fontcolor="orange"]
+"container2_start_0 rhel7-3" -> "lxc-ms_start_0 lxc2" [ style = bold]
 "container2_start_0 rhel7-3" -> "lxc2_start_0 rhel7-3" [ style = bold]
 "container2_start_0 rhel7-3" [ style=bold color="green" fontcolor="black"]
 "container2_stop_0 rhel7-1" -> "all_stopped" [ style = bold]
diff --git a/pengine/test10/guest-node-host-dies.exp b/pengine/test10/guest-node-host-dies.exp
index 5f49eb1..73a0264 100644
--- a/pengine/test10/guest-node-host-dies.exp
+++ b/pengine/test10/guest-node-host-dies.exp
@@ -149,6 +149,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="15" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="18" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
@@ -174,6 +177,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="15" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="19" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
@@ -245,6 +251,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="17" operation="start" operation_key="container2_start_0" on_node="rhel7-3" on_node_uuid="4"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="22" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/remote-recover.dot b/pengine/test10/remote-recover.dot
index 22e0cc7..ccaff14 100644
--- a/pengine/test10/remote-recover.dot
+++ b/pengine/test10/remote-recover.dot
@@ -1,15 +1,7 @@
  digraph "g" {
-"all_stopped" [ style=bold color="green" fontcolor="orange"]
 "fake_monitor_10000 rhel7-alt4" [ style=bold color="green" fontcolor="black"]
-"fake_start_0 rhel7-alt4" -> "fake_monitor_10000 rhel7-alt4" [ style = bold]
-"fake_start_0 rhel7-alt4" [ style=bold color="green" fontcolor="black"]
-"fake_stop_0 rhel7-alt4" -> "all_stopped" [ style = bold]
-"fake_stop_0 rhel7-alt4" -> "fake_start_0 rhel7-alt4" [ style = bold]
-"fake_stop_0 rhel7-alt4" [ style=bold color="green" fontcolor="black"]
 "rhel7-alt4_monitor_60000 rhel7-alt1" [ style=bold color="green" fontcolor="black"]
 "rhel7-alt4_start_0 rhel7-alt1" -> "fake_monitor_10000 rhel7-alt4" [ style = bold]
-"rhel7-alt4_start_0 rhel7-alt1" -> "fake_start_0 rhel7-alt4" [ style = bold]
-"rhel7-alt4_start_0 rhel7-alt1" -> "fake_stop_0 rhel7-alt4" [ style = bold]
 "rhel7-alt4_start_0 rhel7-alt1" -> "rhel7-alt4_monitor_60000 rhel7-alt1" [ style = bold]
 "rhel7-alt4_start_0 rhel7-alt1" [ style=bold color="green" fontcolor="black"]
 "shooter_monitor_60000 rhel7-alt1" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/remote-recover.exp b/pengine/test10/remote-recover.exp
index 3936c51..918db8d 100644
--- a/pengine/test10/remote-recover.exp
+++ b/pengine/test10/remote-recover.exp
@@ -54,50 +54,6 @@
       <trigger>
         <rsc_op id="4" operation="start" operation_key="rhel7-alt4_start_0" on_node="rhel7-alt1" on_node_uuid="1"/>
       </trigger>
-      <trigger>
-        <rsc_op id="7" operation="start" operation_key="fake_start_0" on_node="rhel7-alt4" on_node_uuid="rhel7-alt4" router_node="rhel7-alt1"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="5">
-    <action_set>
-      <rsc_op id="7" operation="start" operation_key="fake_start_0" on_node="rhel7-alt4" on_node_uuid="rhel7-alt4" router_node="rhel7-alt1">
-        <primitive id="fake" class="ocf" provider="heartbeat" type="Dummy"/>
-        <attributes CRM_meta_name="start" CRM_meta_on_node="rhel7-alt4" CRM_meta_on_node_uuid="rhel7-alt4" CRM_meta_timeout="20000" />
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="4" operation="start" operation_key="rhel7-alt4_start_0" on_node="rhel7-alt1" on_node_uuid="1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="6" operation="stop" operation_key="fake_stop_0" on_node="rhel7-alt4" on_node_uuid="rhel7-alt4" router_node="rhel7-alt1"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="6">
-    <action_set>
-      <rsc_op id="6" operation="stop" operation_key="fake_stop_0" on_node="rhel7-alt4" on_node_uuid="rhel7-alt4" router_node="rhel7-alt1">
-        <primitive id="fake" class="ocf" provider="heartbeat" type="Dummy"/>
-        <attributes CRM_meta_name="stop" CRM_meta_on_node="rhel7-alt4" CRM_meta_on_node_uuid="rhel7-alt4" CRM_meta_timeout="20000" />
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="4" operation="start" operation_key="rhel7-alt4_start_0" on_node="rhel7-alt1" on_node_uuid="1"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="7">
-    <action_set>
-      <pseudo_event id="1" operation="all_stopped" operation_key="all_stopped">
-        <attributes />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="6" operation="stop" operation_key="fake_stop_0" on_node="rhel7-alt4" on_node_uuid="rhel7-alt4" router_node="rhel7-alt1"/>
-      </trigger>
     </inputs>
   </synapse>
 </transition_graph>
diff --git a/pengine/test10/remote-recover.summary b/pengine/test10/remote-recover.summary
index ad4710d..38a1ea4 100644
--- a/pengine/test10/remote-recover.summary
+++ b/pengine/test10/remote-recover.summary
@@ -12,17 +12,13 @@ OFFLINE: [ rhel7-alt3 ]
 Transition Summary:
  * Start   shooter	(rhel7-alt1)
  * Start   rhel7-alt4	(rhel7-alt1)
- * Restart fake	(Started rhel7-alt4)
 
 Executing cluster transition:
  * Resource action: shooter         start on rhel7-alt1
  * Resource action: rhel7-alt4      start on rhel7-alt1
- * Resource action: fake            stop on rhel7-alt4
- * Pseudo action:   all_stopped
+ * Resource action: fake            monitor=10000 on rhel7-alt4
  * Resource action: shooter         monitor=60000 on rhel7-alt1
  * Resource action: rhel7-alt4      monitor=60000 on rhel7-alt1
- * Resource action: fake            start on rhel7-alt4
- * Resource action: fake            monitor=10000 on rhel7-alt4
 
 Revised cluster status:
 Node rhel7-alt2 (2): standby
diff --git a/pengine/test10/remote-recovery.dot b/pengine/test10/remote-recovery.dot
index 31a82af..d6fdefe 100644
--- a/pengine/test10/remote-recovery.dot
+++ b/pengine/test10/remote-recovery.dot
@@ -2,87 +2,20 @@ digraph "g" {
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
 "galera-0_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
 "galera-0_start_0 controller-2" -> "galera-0_monitor_20000 controller-2" [ style = bold]
-"galera-0_start_0 controller-2" -> "galera_demote_0 galera-0" [ style = bold]
 "galera-0_start_0 controller-2" -> "galera_monitor_10000 galera-0" [ style = bold]
-"galera-0_start_0 controller-2" -> "galera_promote_0 galera-0" [ style = bold]
-"galera-0_start_0 controller-2" -> "galera_start_0 galera-0" [ style = bold]
-"galera-0_start_0 controller-2" -> "galera_stop_0 galera-0" [ style = bold]
 "galera-0_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
 "galera-0_stop_0 controller-1" -> "all_stopped" [ style = bold]
 "galera-0_stop_0 controller-1" -> "galera-0_start_0 controller-2" [ style = bold]
 "galera-0_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
 "galera-2_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
 "galera-2_start_0 controller-2" -> "galera-2_monitor_20000 controller-2" [ style = bold]
-"galera-2_start_0 controller-2" -> "galera_demote_0 galera-2" [ style = bold]
 "galera-2_start_0 controller-2" -> "galera_monitor_10000 galera-2" [ style = bold]
-"galera-2_start_0 controller-2" -> "galera_promote_0 galera-2" [ style = bold]
-"galera-2_start_0 controller-2" -> "galera_start_0 galera-2" [ style = bold]
-"galera-2_start_0 controller-2" -> "galera_stop_0 galera-2" [ style = bold]
 "galera-2_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
 "galera-2_stop_0 controller-1" -> "all_stopped" [ style = bold]
 "galera-2_stop_0 controller-1" -> "galera-2_start_0 controller-2" [ style = bold]
 "galera-2_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
-"galera-master_demote_0" -> "galera-master_demoted_0" [ style = bold]
-"galera-master_demote_0" -> "galera_demote_0 galera-0" [ style = bold]
-"galera-master_demote_0" -> "galera_demote_0 galera-2" [ style = bold]
-"galera-master_demote_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_demoted_0" -> "galera-master_promote_0" [ style = bold]
-"galera-master_demoted_0" -> "galera-master_start_0" [ style = bold]
-"galera-master_demoted_0" -> "galera-master_stop_0" [ style = bold]
-"galera-master_demoted_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_promote_0" -> "galera_promote_0 galera-0" [ style = bold]
-"galera-master_promote_0" -> "galera_promote_0 galera-2" [ style = bold]
-"galera-master_promote_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_promoted_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_running_0" -> "galera-master_promote_0" [ style = bold]
-"galera-master_running_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_start_0" -> "galera-master_running_0" [ style = bold]
-"galera-master_start_0" -> "galera_start_0 galera-0" [ style = bold]
-"galera-master_start_0" -> "galera_start_0 galera-2" [ style = bold]
-"galera-master_start_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_stop_0" -> "galera-master_stopped_0" [ style = bold]
-"galera-master_stop_0" -> "galera_stop_0 galera-0" [ style = bold]
-"galera-master_stop_0" -> "galera_stop_0 galera-2" [ style = bold]
-"galera-master_stop_0" [ style=bold color="green" fontcolor="orange"]
-"galera-master_stopped_0" -> "galera-master_promote_0" [ style = bold]
-"galera-master_stopped_0" -> "galera-master_start_0" [ style = bold]
-"galera-master_stopped_0" [ style=bold color="green" fontcolor="orange"]
-"galera_demote_0 galera-0" -> "galera-master_demoted_0" [ style = bold]
-"galera_demote_0 galera-0" -> "galera_demote_0 galera-2" [ style = bold]
-"galera_demote_0 galera-0" -> "galera_promote_0 galera-0" [ style = bold]
-"galera_demote_0 galera-0" -> "galera_stop_0 galera-0" [ style = bold]
-"galera_demote_0 galera-0" [ style=bold color="green" fontcolor="black"]
-"galera_demote_0 galera-2" -> "galera-master_demoted_0" [ style = bold]
-"galera_demote_0 galera-2" -> "galera_promote_0 galera-2" [ style = bold]
-"galera_demote_0 galera-2" -> "galera_stop_0 galera-2" [ style = bold]
-"galera_demote_0 galera-2" [ style=bold color="green" fontcolor="black"]
 "galera_monitor_10000 galera-0" [ style=bold color="green" fontcolor="black"]
 "galera_monitor_10000 galera-2" [ style=bold color="green" fontcolor="black"]
-"galera_promote_0 galera-0" -> "galera-master_promoted_0" [ style = bold]
-"galera_promote_0 galera-0" -> "galera_monitor_10000 galera-0" [ style = bold]
-"galera_promote_0 galera-0" [ style=bold color="green" fontcolor="black"]
-"galera_promote_0 galera-2" -> "galera-master_promoted_0" [ style = bold]
-"galera_promote_0 galera-2" -> "galera_monitor_10000 galera-2" [ style = bold]
-"galera_promote_0 galera-2" -> "galera_promote_0 galera-0" [ style = bold]
-"galera_promote_0 galera-2" [ style=bold color="green" fontcolor="black"]
-"galera_start_0 galera-0" -> "galera-master_running_0" [ style = bold]
-"galera_start_0 galera-0" -> "galera_monitor_10000 galera-0" [ style = bold]
-"galera_start_0 galera-0" -> "galera_promote_0 galera-0" [ style = bold]
-"galera_start_0 galera-0" [ style=bold color="green" fontcolor="black"]
-"galera_start_0 galera-2" -> "galera-master_running_0" [ style = bold]
-"galera_start_0 galera-2" -> "galera_monitor_10000 galera-2" [ style = bold]
-"galera_start_0 galera-2" -> "galera_promote_0 galera-2" [ style = bold]
-"galera_start_0 galera-2" -> "galera_start_0 galera-0" [ style = bold]
-"galera_start_0 galera-2" [ style=bold color="green" fontcolor="black"]
-"galera_stop_0 galera-0" -> "all_stopped" [ style = bold]
-"galera_stop_0 galera-0" -> "galera-master_stopped_0" [ style = bold]
-"galera_stop_0 galera-0" -> "galera_start_0 galera-0" [ style = bold]
-"galera_stop_0 galera-0" -> "galera_stop_0 galera-2" [ style = bold]
-"galera_stop_0 galera-0" [ style=bold color="green" fontcolor="black"]
-"galera_stop_0 galera-2" -> "all_stopped" [ style = bold]
-"galera_stop_0 galera-2" -> "galera-master_stopped_0" [ style = bold]
-"galera_stop_0 galera-2" -> "galera_start_0 galera-2" [ style = bold]
-"galera_stop_0 galera-2" [ style=bold color="green" fontcolor="black"]
 "haproxy-clone_stop_0" -> "haproxy-clone_stopped_0" [ style = bold]
 "haproxy-clone_stop_0" -> "haproxy_stop_0 controller-1" [ style = bold]
 "haproxy-clone_stop_0" [ style=bold color="green" fontcolor="orange"]
@@ -114,29 +47,11 @@ digraph "g" {
 "messaging-1_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
 "messaging-1_start_0 controller-2" -> "messaging-1_monitor_20000 controller-2" [ style = bold]
 "messaging-1_start_0 controller-2" -> "rabbitmq_monitor_10000 messaging-1" [ style = bold]
-"messaging-1_start_0 controller-2" -> "rabbitmq_start_0 messaging-1" [ style = bold]
-"messaging-1_start_0 controller-2" -> "rabbitmq_stop_0 messaging-1" [ style = bold]
 "messaging-1_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
 "messaging-1_stop_0 controller-1" -> "all_stopped" [ style = bold]
 "messaging-1_stop_0 controller-1" -> "messaging-1_start_0 controller-2" [ style = bold]
 "messaging-1_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
-"rabbitmq-clone_running_0" [ style=bold color="green" fontcolor="orange"]
-"rabbitmq-clone_start_0" -> "rabbitmq-clone_running_0" [ style = bold]
-"rabbitmq-clone_start_0" -> "rabbitmq_start_0 messaging-1" [ style = bold]
-"rabbitmq-clone_start_0" [ style=bold color="green" fontcolor="orange"]
-"rabbitmq-clone_stop_0" -> "rabbitmq-clone_stopped_0" [ style = bold]
-"rabbitmq-clone_stop_0" -> "rabbitmq_stop_0 messaging-1" [ style = bold]
-"rabbitmq-clone_stop_0" [ style=bold color="green" fontcolor="orange"]
-"rabbitmq-clone_stopped_0" -> "rabbitmq-clone_start_0" [ style = bold]
-"rabbitmq-clone_stopped_0" [ style=bold color="green" fontcolor="orange"]
 "rabbitmq_monitor_10000 messaging-1" [ style=bold color="green" fontcolor="black"]
-"rabbitmq_start_0 messaging-1" -> "rabbitmq-clone_running_0" [ style = bold]
-"rabbitmq_start_0 messaging-1" -> "rabbitmq_monitor_10000 messaging-1" [ style = bold]
-"rabbitmq_start_0 messaging-1" [ style=bold color="green" fontcolor="black"]
-"rabbitmq_stop_0 messaging-1" -> "all_stopped" [ style = bold]
-"rabbitmq_stop_0 messaging-1" -> "rabbitmq-clone_stopped_0" [ style = bold]
-"rabbitmq_stop_0 messaging-1" -> "rabbitmq_start_0 messaging-1" [ style = bold]
-"rabbitmq_stop_0 messaging-1" [ style=bold color="green" fontcolor="black"]
 "redis-master_confirmed-post_notify_stopped_0" -> "all_stopped" [ style = bold]
 "redis-master_confirmed-post_notify_stopped_0" [ style=bold color="green" fontcolor="orange"]
 "redis-master_confirmed-pre_notify_stop_0" -> "redis-master_post_notify_stopped_0" [ style = bold]
@@ -208,14 +123,9 @@ digraph "g" {
 "stonith_complete" -> "all_stopped" [ style = bold]
 "stonith_complete" -> "galera-0_start_0 controller-2" [ style = bold]
 "stonith_complete" -> "galera-2_start_0 controller-2" [ style = bold]
-"stonith_complete" -> "galera_promote_0 galera-0" [ style = bold]
-"stonith_complete" -> "galera_promote_0 galera-2" [ style = bold]
-"stonith_complete" -> "galera_start_0 galera-0" [ style = bold]
-"stonith_complete" -> "galera_start_0 galera-2" [ style = bold]
 "stonith_complete" -> "ip-172.17.1.14_start_0 controller-2" [ style = bold]
 "stonith_complete" -> "ip-172.17.1.17_start_0 controller-2" [ style = bold]
 "stonith_complete" -> "ip-172.17.4.11_start_0 controller-2" [ style = bold]
 "stonith_complete" -> "messaging-1_start_0 controller-2" [ style = bold]
-"stonith_complete" -> "rabbitmq_start_0 messaging-1" [ style = bold]
 "stonith_complete" [ style=bold color="green" fontcolor="orange"]
 }
diff --git a/pengine/test10/remote-recovery.exp b/pengine/test10/remote-recovery.exp
index 70492f4..62860f0 100644
--- a/pengine/test10/remote-recovery.exp
+++ b/pengine/test10/remote-recovery.exp
@@ -124,44 +124,6 @@
   </synapse>
   <synapse id="9">
     <action_set>
-      <rsc_op id="44" operation="start" operation_key="rabbitmq_start_0" internal_operation_key="rabbitmq:2_start_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-2">
-        <primitive id="rabbitmq" long-id="rabbitmq:2" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="messaging-1" CRM_meta_on_node_uuid="messaging-1" CRM_meta_timeout="200000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="43" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="45" operation="start" operation_key="rabbitmq-clone_start_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="10">
-    <action_set>
-      <rsc_op id="43" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-1">
-        <primitive id="rabbitmq" long-id="rabbitmq:2" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_on_node="messaging-1" CRM_meta_on_node_uuid="messaging-1" CRM_meta_timeout="200000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="47" operation="stop" operation_key="rabbitmq-clone_stop_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="11">
-    <action_set>
       <rsc_op id="20" operation="monitor" operation_key="rabbitmq_monitor_10000" internal_operation_key="rabbitmq:2_monitor_10000" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-2">
         <primitive id="rabbitmq" long-id="rabbitmq:2" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
         <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="messaging-1" CRM_meta_on_node_uuid="messaging-1" CRM_meta_timeout="40000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
@@ -171,150 +133,9 @@
       <trigger>
         <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3"/>
       </trigger>
-      <trigger>
-        <rsc_op id="44" operation="start" operation_key="rabbitmq_start_0" internal_operation_key="rabbitmq:2_start_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-2"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="12" priority="1000000">
-    <action_set>
-      <pseudo_event id="48" operation="stopped" operation_key="rabbitmq-clone_stopped_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="43" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="47" operation="stop" operation_key="rabbitmq-clone_stop_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="13">
-    <action_set>
-      <pseudo_event id="47" operation="stop" operation_key="rabbitmq-clone_stop_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs/>
-  </synapse>
-  <synapse id="14" priority="1000000">
-    <action_set>
-      <pseudo_event id="46" operation="running" operation_key="rabbitmq-clone_running_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="44" operation="start" operation_key="rabbitmq_start_0" internal_operation_key="rabbitmq:2_start_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="45" operation="start" operation_key="rabbitmq-clone_start_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="15">
-    <action_set>
-      <pseudo_event id="45" operation="start" operation_key="rabbitmq-clone_start_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <pseudo_event id="48" operation="stopped" operation_key="rabbitmq-clone_stopped_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="16">
-    <action_set>
-      <rsc_op id="56" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:1_promote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2">
-        <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="promote" CRM_meta_notify="false" CRM_meta_on_fail="block" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_timeout="300000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="53" operation="start" operation_key="galera_start_0" internal_operation_key="galera:1_start_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="54" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="65" operation="promote" operation_key="galera-master_promote_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
-      </trigger>
     </inputs>
   </synapse>
-  <synapse id="17">
-    <action_set>
-      <rsc_op id="55" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1">
-        <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="54" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="59" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="63" operation="stop" operation_key="galera-master_stop_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="18">
-    <action_set>
-      <rsc_op id="54" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1">
-        <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="demote" CRM_meta_notify="false" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="58" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="67" operation="demote" operation_key="galera-master_demote_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="19">
-    <action_set>
-      <rsc_op id="53" operation="start" operation_key="galera_start_0" internal_operation_key="galera:1_start_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2">
-        <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="55" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="61" operation="start" operation_key="galera-master_start_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="20">
+  <synapse id="10">
     <action_set>
       <rsc_op id="13" operation="monitor" operation_key="galera_monitor_10000" internal_operation_key="galera:1_monitor_10000" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2">
         <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
@@ -325,103 +146,9 @@
       <trigger>
         <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
       </trigger>
-      <trigger>
-        <rsc_op id="53" operation="start" operation_key="galera_start_0" internal_operation_key="galera:1_start_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="56" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:1_promote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="21">
-    <action_set>
-      <rsc_op id="60" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:2_promote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2">
-        <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="promote" CRM_meta_notify="false" CRM_meta_on_fail="block" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_timeout="300000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="56" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:1_promote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="57" operation="start" operation_key="galera_start_0" internal_operation_key="galera:2_start_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="58" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="65" operation="promote" operation_key="galera-master_promote_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
-      </trigger>
     </inputs>
   </synapse>
-  <synapse id="22">
-    <action_set>
-      <rsc_op id="59" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1">
-        <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="58" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="63" operation="stop" operation_key="galera-master_stop_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="23">
-    <action_set>
-      <rsc_op id="58" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1">
-        <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="demote" CRM_meta_notify="false" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="67" operation="demote" operation_key="galera-master_demote_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="24">
-    <action_set>
-      <rsc_op id="57" operation="start" operation_key="galera_start_0" internal_operation_key="galera:2_start_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2">
-        <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
-        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="start" CRM_meta_notify="false" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
-      </rsc_op>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="53" operation="start" operation_key="galera_start_0" internal_operation_key="galera:1_start_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="59" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="61" operation="start" operation_key="galera-master_start_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="25">
+  <synapse id="11">
     <action_set>
       <rsc_op id="14" operation="monitor" operation_key="galera_monitor_10000" internal_operation_key="galera:2_monitor_10000" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2">
         <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
@@ -432,137 +159,9 @@
       <trigger>
         <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
       </trigger>
-      <trigger>
-        <rsc_op id="57" operation="start" operation_key="galera_start_0" internal_operation_key="galera:2_start_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="60" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:2_promote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="26" priority="1000000">
-    <action_set>
-      <pseudo_event id="68" operation="demoted" operation_key="galera-master_demoted_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="54" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="58" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="67" operation="demote" operation_key="galera-master_demote_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="27">
-    <action_set>
-      <pseudo_event id="67" operation="demote" operation_key="galera-master_demote_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs/>
-  </synapse>
-  <synapse id="28" priority="1000000">
-    <action_set>
-      <pseudo_event id="66" operation="promoted" operation_key="galera-master_promoted_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="56" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:1_promote_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="60" operation="promote" operation_key="galera_promote_0" internal_operation_key="galera:2_promote_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2"/>
-      </trigger>
     </inputs>
   </synapse>
-  <synapse id="29">
-    <action_set>
-      <pseudo_event id="65" operation="promote" operation_key="galera-master_promote_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <pseudo_event id="62" operation="running" operation_key="galera-master_running_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="64" operation="stopped" operation_key="galera-master_stopped_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="68" operation="demoted" operation_key="galera-master_demoted_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="30" priority="1000000">
-    <action_set>
-      <pseudo_event id="64" operation="stopped" operation_key="galera-master_stopped_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="55" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="59" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="63" operation="stop" operation_key="galera-master_stop_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="31">
-    <action_set>
-      <pseudo_event id="63" operation="stop" operation_key="galera-master_stop_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <pseudo_event id="68" operation="demoted" operation_key="galera-master_demoted_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="32" priority="1000000">
-    <action_set>
-      <pseudo_event id="62" operation="running" operation_key="galera-master_running_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <rsc_op id="53" operation="start" operation_key="galera_start_0" internal_operation_key="galera:1_start_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="57" operation="start" operation_key="galera_start_0" internal_operation_key="galera:2_start_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="61" operation="start" operation_key="galera-master_start_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="33">
-    <action_set>
-      <pseudo_event id="61" operation="start" operation_key="galera-master_start_0">
-        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
-      </pseudo_event>
-    </action_set>
-    <inputs>
-      <trigger>
-        <pseudo_event id="64" operation="stopped" operation_key="galera-master_stopped_0"/>
-      </trigger>
-      <trigger>
-        <pseudo_event id="68" operation="demoted" operation_key="galera-master_demoted_0"/>
-      </trigger>
-    </inputs>
-  </synapse>
-  <synapse id="34" priority="1000000">
+  <synapse id="12" priority="1000000">
     <action_set>
       <pseudo_event id="134" operation="notified" operation_key="redis_notified_0" internal_operation_key="redis:0_confirmed-post_notify_stonith_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
@@ -580,7 +179,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="35" priority="1000000">
+  <synapse id="13" priority="1000000">
     <action_set>
       <pseudo_event id="133" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
@@ -592,7 +191,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="36">
+  <synapse id="14">
     <action_set>
       <pseudo_event id="69" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_timeout="200000"  wait_last_known_master="true"/>
@@ -607,7 +206,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="37">
+  <synapse id="15">
     <action_set>
       <rsc_op id="193" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:1_pre_notify_stop_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
@@ -620,7 +219,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="38" priority="1000000">
+  <synapse id="16" priority="1000000">
     <action_set>
       <rsc_op id="135" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
@@ -636,7 +235,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="39">
+  <synapse id="17">
     <action_set>
       <rsc_op id="194" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:2_pre_notify_stop_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
@@ -649,7 +248,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="40" priority="1000000">
+  <synapse id="18" priority="1000000">
     <action_set>
       <rsc_op id="136" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
@@ -665,7 +264,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="41" priority="1000000">
+  <synapse id="19" priority="1000000">
     <action_set>
       <pseudo_event id="87" operation="notified" operation_key="redis-master_confirmed-post_notify_stopped_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
@@ -683,7 +282,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="42" priority="1000000">
+  <synapse id="20" priority="1000000">
     <action_set>
       <pseudo_event id="86" operation="notify" operation_key="redis-master_post_notify_stopped_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
@@ -698,7 +297,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="43">
+  <synapse id="21">
     <action_set>
       <pseudo_event id="85" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
@@ -716,7 +315,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="44">
+  <synapse id="22">
     <action_set>
       <pseudo_event id="84" operation="notify" operation_key="redis-master_pre_notify_stop_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
@@ -724,7 +323,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="45" priority="1000000">
+  <synapse id="23" priority="1000000">
     <action_set>
       <pseudo_event id="83" operation="stopped" operation_key="redis-master_stopped_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
@@ -739,7 +338,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="46">
+  <synapse id="24">
     <action_set>
       <pseudo_event id="82" operation="stop" operation_key="redis-master_stop_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
@@ -754,7 +353,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="47">
+  <synapse id="25">
     <action_set>
       <rsc_op id="106" operation="monitor" operation_key="ip-172.17.1.14_monitor_10000" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -767,7 +366,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="48">
+  <synapse id="26">
     <action_set>
       <rsc_op id="105" operation="start" operation_key="ip-172.17.1.14_start_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -783,7 +382,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="49">
+  <synapse id="27">
     <action_set>
       <pseudo_event id="104" operation="stop" operation_key="ip-172.17.1.14_stop_0">
         <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
@@ -798,7 +397,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="50">
+  <synapse id="28">
     <action_set>
       <rsc_op id="109" operation="monitor" operation_key="ip-172.17.1.17_monitor_10000" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -811,7 +410,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="51">
+  <synapse id="29">
     <action_set>
       <rsc_op id="108" operation="start" operation_key="ip-172.17.1.17_start_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -827,7 +426,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="52">
+  <synapse id="30">
     <action_set>
       <pseudo_event id="107" operation="stop" operation_key="ip-172.17.1.17_stop_0">
         <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
@@ -842,7 +441,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="53">
+  <synapse id="31">
     <action_set>
       <rsc_op id="114" operation="monitor" operation_key="ip-172.17.4.11_monitor_10000" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -855,7 +454,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="54">
+  <synapse id="32">
     <action_set>
       <rsc_op id="113" operation="start" operation_key="ip-172.17.4.11_start_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
@@ -871,7 +470,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="55">
+  <synapse id="33">
     <action_set>
       <pseudo_event id="112" operation="stop" operation_key="ip-172.17.4.11_stop_0">
         <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
@@ -886,7 +485,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="56">
+  <synapse id="34">
     <action_set>
       <pseudo_event id="115" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0">
         <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_timeout="200000" />
@@ -901,7 +500,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="57" priority="1000000">
+  <synapse id="35" priority="1000000">
     <action_set>
       <pseudo_event id="123" operation="stopped" operation_key="haproxy-clone_stopped_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
@@ -916,7 +515,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="58">
+  <synapse id="36">
     <action_set>
       <pseudo_event id="122" operation="stop" operation_key="haproxy-clone_stop_0">
         <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
@@ -928,7 +527,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="59">
+  <synapse id="37">
     <action_set>
       <rsc_op id="126" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
@@ -937,7 +536,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="60">
+  <synapse id="38">
     <action_set>
       <rsc_op id="22" operation="start" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
@@ -950,7 +549,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="61">
+  <synapse id="39">
     <action_set>
       <rsc_op id="6" operation="monitor" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_60000" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
@@ -963,7 +562,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="62">
+  <synapse id="40">
     <action_set>
       <rsc_op id="127" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
@@ -972,7 +571,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="63">
+  <synapse id="41">
     <action_set>
       <rsc_op id="23" operation="start" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
@@ -985,7 +584,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="64">
+  <synapse id="42">
     <action_set>
       <rsc_op id="11" operation="monitor" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" on_node="controller-0" on_node_uuid="1">
         <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
@@ -998,7 +597,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="65">
+  <synapse id="43">
     <action_set>
       <rsc_op id="130" operation="monitor" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" on_node="controller-2" on_node_uuid="3">
         <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
@@ -1011,7 +610,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="66">
+  <synapse id="44">
     <action_set>
       <rsc_op id="129" operation="start" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
@@ -1024,7 +623,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="67">
+  <synapse id="45">
     <action_set>
       <pseudo_event id="128" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0">
         <attributes CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
@@ -1032,7 +631,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="68">
+  <synapse id="46">
     <action_set>
       <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2">
         <attributes CRM_meta_cinder_volume_role="true" CRM_meta_haproxy_role="true" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_redis_role="true" CRM_meta_stonith_action="reboot" />
@@ -1043,7 +642,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="69">
+  <synapse id="47">
     <action_set>
       <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete">
         <attributes />
@@ -1055,7 +654,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="70">
+  <synapse id="48">
     <action_set>
       <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped">
         <attributes />
@@ -1072,15 +671,6 @@
         <pseudo_event id="36" operation="stop" operation_key="galera-2_stop_0"/>
       </trigger>
       <trigger>
-        <rsc_op id="43" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="55" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-1"/>
-      </trigger>
-      <trigger>
-        <rsc_op id="59" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-1"/>
-      </trigger>
-      <trigger>
         <pseudo_event id="69" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/remote-recovery.summary b/pengine/test10/remote-recovery.summary
index 251febc..57b5e01 100644
--- a/pengine/test10/remote-recovery.summary
+++ b/pengine/test10/remote-recovery.summary
@@ -41,9 +41,6 @@ Transition Summary:
  * Move    messaging-1	(Started controller-1 -> controller-2)
  * Move    galera-0	(Started controller-1 -> controller-2)
  * Move    galera-2	(Started controller-1 -> controller-2)
- * Restart rabbitmq:2	(Started messaging-1)
- * Restart galera:1	(Master galera-2)
- * Restart galera:2	(Master galera-0)
  * Stop    redis:0	(controller-1)
  * Move    ip-172.17.1.14	(Started controller-1 -> controller-2)
  * Move    ip-172.17.1.17	(Started controller-1 -> controller-2)
@@ -54,8 +51,6 @@ Transition Summary:
  * Move    stonith-fence_ipmilan-5254005bdbb5	(Started controller-1 -> controller-2)
 
 Executing cluster transition:
- * Pseudo action:   rabbitmq-clone_stop_0
- * Pseudo action:   galera-master_demote_0
  * Pseudo action:   redis-master_pre_notify_stop_0
  * Resource action: stonith-fence_ipmilan-525400bbf613 stop on controller-0
  * Resource action: stonith-fence_ipmilan-525400bbf613 start on controller-0
@@ -79,10 +74,9 @@ Executing cluster transition:
  * Resource action: messaging-1     start on controller-2
  * Resource action: galera-0        start on controller-2
  * Resource action: galera-2        start on controller-2
- * Resource action: rabbitmq        stop on messaging-1
- * Pseudo action:   rabbitmq-clone_stopped_0
- * Pseudo action:   rabbitmq-clone_start_0
- * Resource action: galera          demote on galera-0
+ * Resource action: rabbitmq        monitor=10000 on messaging-1
+ * Resource action: galera          monitor=10000 on galera-2
+ * Resource action: galera          monitor=10000 on galera-0
  * Pseudo action:   redis_stop_0
  * Pseudo action:   redis-master_stopped_0
  * Pseudo action:   haproxy_stop_0
@@ -91,40 +85,21 @@ Executing cluster transition:
  * Resource action: messaging-1     monitor=20000 on controller-2
  * Resource action: galera-0        monitor=20000 on controller-2
  * Resource action: galera-2        monitor=20000 on controller-2
- * Resource action: rabbitmq        start on messaging-1
- * Resource action: rabbitmq        monitor=10000 on messaging-1
- * Pseudo action:   rabbitmq-clone_running_0
- * Resource action: galera          demote on galera-2
- * Pseudo action:   galera-master_demoted_0
- * Pseudo action:   galera-master_stop_0
  * Pseudo action:   redis-master_post_notify_stopped_0
  * Pseudo action:   ip-172.17.1.14_stop_0
  * Pseudo action:   ip-172.17.1.17_stop_0
  * Pseudo action:   ip-172.17.4.11_stop_0
- * Resource action: galera          stop on galera-0
  * Resource action: redis           notify on controller-0
  * Resource action: redis           notify on controller-2
  * Pseudo action:   redis-master_confirmed-post_notify_stopped_0
  * Resource action: ip-172.17.1.14  start on controller-2
  * Resource action: ip-172.17.1.17  start on controller-2
  * Resource action: ip-172.17.4.11  start on controller-2
- * Resource action: galera          stop on galera-2
- * Pseudo action:   galera-master_stopped_0
- * Pseudo action:   galera-master_start_0
  * Pseudo action:   redis_notified_0
  * Resource action: ip-172.17.1.14  monitor=10000 on controller-2
  * Resource action: ip-172.17.1.17  monitor=10000 on controller-2
  * Resource action: ip-172.17.4.11  monitor=10000 on controller-2
  * Pseudo action:   all_stopped
- * Resource action: galera          start on galera-2
- * Resource action: galera          start on galera-0
- * Pseudo action:   galera-master_running_0
- * Pseudo action:   galera-master_promote_0
- * Resource action: galera          promote on galera-2
- * Resource action: galera          monitor=10000 on galera-2
- * Resource action: galera          promote on galera-0
- * Resource action: galera          monitor=10000 on galera-0
- * Pseudo action:   galera-master_promoted_0
 Using the original execution date of: 2017-05-03 13:33:24Z
 
 Revised cluster status:
diff --git a/pengine/test10/whitebox-fail1.dot b/pengine/test10/whitebox-fail1.dot
index c6380ea..0123a58 100644
--- a/pengine/test10/whitebox-fail1.dot
+++ b/pengine/test10/whitebox-fail1.dot
@@ -23,6 +23,8 @@ digraph "g" {
 "M_stop_0 lxc1" -> "all_stopped" [ style = bold]
 "M_stop_0 lxc1" [ style=bold color="green" fontcolor="orange"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 18node2" -> "B_start_0 lxc1" [ style = bold]
+"container1_start_0 18node2" -> "M_start_0 lxc1" [ style = bold]
 "container1_start_0 18node2" -> "lxc1_start_0 18node2" [ style = bold]
 "container1_start_0 18node2" [ style=bold color="green" fontcolor="black"]
 "container1_stop_0 18node2" -> "all_stopped" [ style = bold]
diff --git a/pengine/test10/whitebox-fail1.exp b/pengine/test10/whitebox-fail1.exp
index 7ac3a19..5c4b26c 100644
--- a/pengine/test10/whitebox-fail1.exp
+++ b/pengine/test10/whitebox-fail1.exp
@@ -53,6 +53,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="12" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="25" operation="stop" operation_key="M_stop_0" internal_operation_key="M:4_stop_0"/>
       </trigger>
       <trigger>
@@ -160,6 +163,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="12" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="34" operation="stop" operation_key="B_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-fail2.dot b/pengine/test10/whitebox-fail2.dot
index c6380ea..0123a58 100644
--- a/pengine/test10/whitebox-fail2.dot
+++ b/pengine/test10/whitebox-fail2.dot
@@ -23,6 +23,8 @@ digraph "g" {
 "M_stop_0 lxc1" -> "all_stopped" [ style = bold]
 "M_stop_0 lxc1" [ style=bold color="green" fontcolor="orange"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 18node2" -> "B_start_0 lxc1" [ style = bold]
+"container1_start_0 18node2" -> "M_start_0 lxc1" [ style = bold]
 "container1_start_0 18node2" -> "lxc1_start_0 18node2" [ style = bold]
 "container1_start_0 18node2" [ style=bold color="green" fontcolor="black"]
 "container1_stop_0 18node2" -> "all_stopped" [ style = bold]
diff --git a/pengine/test10/whitebox-fail2.exp b/pengine/test10/whitebox-fail2.exp
index 7ac3a19..5c4b26c 100644
--- a/pengine/test10/whitebox-fail2.exp
+++ b/pengine/test10/whitebox-fail2.exp
@@ -53,6 +53,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="12" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="25" operation="stop" operation_key="M_stop_0" internal_operation_key="M:4_stop_0"/>
       </trigger>
       <trigger>
@@ -160,6 +163,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="12" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="34" operation="stop" operation_key="B_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-fail3.dot b/pengine/test10/whitebox-fail3.dot
index b3c1535..9814f66 100644
--- a/pengine/test10/whitebox-fail3.dot
+++ b/pengine/test10/whitebox-fail3.dot
@@ -31,5 +31,8 @@ digraph "g" {
 "X:1_start_0 18builder" [ style=bold color="green" fontcolor="black"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
 "vm_start_0 dvossel-laptop2" -> "18builder_start_0 dvossel-laptop2" [ style = bold]
+"vm_start_0 dvossel-laptop2" -> "FAKE_start_0 18builder" [ style = bold]
+"vm_start_0 dvossel-laptop2" -> "W:1_start_0 18builder" [ style = bold]
+"vm_start_0 dvossel-laptop2" -> "X:1_start_0 18builder" [ style = bold]
 "vm_start_0 dvossel-laptop2" [ style=bold color="green" fontcolor="black"]
 }
diff --git a/pengine/test10/whitebox-fail3.exp b/pengine/test10/whitebox-fail3.exp
index 8ddaba0..95fc289 100644
--- a/pengine/test10/whitebox-fail3.exp
+++ b/pengine/test10/whitebox-fail3.exp
@@ -17,6 +17,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="3" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+      </trigger>
+      <trigger>
         <rsc_op id="4" operation="stop" operation_key="FAKE_stop_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
       </trigger>
       <trigger>
@@ -58,6 +61,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="3" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="12" operation="start" operation_key="W-master_start_0"/>
       </trigger>
       <trigger>
@@ -113,6 +119,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="3" operation="start" operation_key="vm_start_0" on_node="dvossel-laptop2" on_node_uuid="24815808"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="26" operation="start" operation_key="X-master_start_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-imply-stop-on-fence.dot b/pengine/test10/whitebox-imply-stop-on-fence.dot
index 0e17a16..5885d4b 100644
--- a/pengine/test10/whitebox-imply-stop-on-fence.dot
+++ b/pengine/test10/whitebox-imply-stop-on-fence.dot
@@ -2,6 +2,7 @@
 "R-lxc-01_kiff-01_monitor_10000 kiff-02" [ style=bold color="green" fontcolor="black"]
 "R-lxc-01_kiff-01_start_0 kiff-02" -> "R-lxc-01_kiff-01_monitor_10000 kiff-02" [ style = bold]
 "R-lxc-01_kiff-01_start_0 kiff-02" -> "lxc-01_kiff-01_start_0 kiff-02" [ style = bold]
+"R-lxc-01_kiff-01_start_0 kiff-02" -> "vm-fs_start_0 lxc-01_kiff-01" [ style = bold]
 "R-lxc-01_kiff-01_start_0 kiff-02" [ style=bold color="green" fontcolor="black"]
 "R-lxc-01_kiff-01_stop_0 kiff-01" -> "R-lxc-01_kiff-01_start_0 kiff-02" [ style = bold]
 "R-lxc-01_kiff-01_stop_0 kiff-01" -> "all_stopped" [ style = bold]
diff --git a/pengine/test10/whitebox-imply-stop-on-fence.exp b/pengine/test10/whitebox-imply-stop-on-fence.exp
index d248d8d..e9390bf 100644
--- a/pengine/test10/whitebox-imply-stop-on-fence.exp
+++ b/pengine/test10/whitebox-imply-stop-on-fence.exp
@@ -293,6 +293,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="37" operation="start" operation_key="R-lxc-01_kiff-01_start_0" on_node="kiff-02" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="46" operation="stop" operation_key="vm-fs_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-move.dot b/pengine/test10/whitebox-move.dot
index 7368b1e..f47c95b 100644
--- a/pengine/test10/whitebox-move.dot
+++ b/pengine/test10/whitebox-move.dot
@@ -25,6 +25,8 @@ digraph "g" {
 "M_stop_0 lxc1" -> "lxc1_stop_0 18node1" [ style = bold]
 "M_stop_0 lxc1" [ style=bold color="green" fontcolor="black"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 18node2" -> "A_start_0 lxc1" [ style = bold]
+"container1_start_0 18node2" -> "M_start_0 lxc1" [ style = bold]
 "container1_start_0 18node2" -> "lxc1_start_0 18node2" [ style = bold]
 "container1_start_0 18node2" [ style=bold color="green" fontcolor="black"]
 "container1_stop_0 18node1" -> "all_stopped" [ style = bold]
diff --git a/pengine/test10/whitebox-move.exp b/pengine/test10/whitebox-move.exp
index d72a767..ecea360 100644
--- a/pengine/test10/whitebox-move.exp
+++ b/pengine/test10/whitebox-move.exp
@@ -34,6 +34,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="11" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <rsc_op id="22" operation="stop" operation_key="M_stop_0" internal_operation_key="M:3_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
       </trigger>
       <trigger>
@@ -132,6 +135,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="11" operation="start" operation_key="container1_start_0" on_node="18node2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <rsc_op id="30" operation="stop" operation_key="A_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="18node1"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-ms-ordering-move.dot b/pengine/test10/whitebox-ms-ordering-move.dot
index fe0b0e8..43c1d4f 100644
--- a/pengine/test10/whitebox-ms-ordering-move.dot
+++ b/pengine/test10/whitebox-ms-ordering-move.dot
@@ -1,5 +1,7 @@
 digraph "g" {
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 rhel7-2" -> "lxc-ms_promote_0 lxc1" [ style = bold]
+"container1_start_0 rhel7-2" -> "lxc-ms_start_0 lxc1" [ style = bold]
 "container1_start_0 rhel7-2" -> "lxc1_start_0 rhel7-2" [ style = bold]
 "container1_start_0 rhel7-2" [ style=bold color="green" fontcolor="black"]
 "container1_stop_0 rhel7-1" -> "all_stopped" [ style = bold]
@@ -29,6 +31,7 @@ digraph "g" {
 "lxc-ms_demote_0 lxc1" -> "lxc-ms-master_demoted_0" [ style = bold]
 "lxc-ms_demote_0 lxc1" -> "lxc-ms_promote_0 lxc1" [ style = bold]
 "lxc-ms_demote_0 lxc1" -> "lxc-ms_stop_0 lxc1" [ style = bold]
+"lxc-ms_demote_0 lxc1" -> "lxc1_stop_0 rhel7-1" [ style = bold]
 "lxc-ms_demote_0 lxc1" [ style=bold color="green" fontcolor="black"]
 "lxc-ms_promote_0 lxc1" -> "lxc-ms-master_promoted_0" [ style = bold]
 "lxc-ms_promote_0 lxc1" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/whitebox-ms-ordering-move.exp b/pengine/test10/whitebox-ms-ordering-move.exp
index f8718de..3b5598f 100644
--- a/pengine/test10/whitebox-ms-ordering-move.exp
+++ b/pengine/test10/whitebox-ms-ordering-move.exp
@@ -34,6 +34,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="99" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <rsc_op id="102" operation="start" operation_key="lxc-ms_start_0" internal_operation_key="lxc-ms:0_start_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-2"/>
       </trigger>
       <trigger>
@@ -85,6 +88,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="99" operation="start" operation_key="container1_start_0" on_node="rhel7-2" on_node_uuid="2"/>
+      </trigger>
+      <trigger>
         <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
       <trigger>
@@ -270,6 +276,9 @@
         <rsc_op id="32" operation="monitor" operation_key="lxc1_monitor_0" on_node="rhel7-5" on_node_uuid="3"/>
       </trigger>
       <trigger>
+        <rsc_op id="103" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
+      </trigger>
+      <trigger>
         <rsc_op id="104" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0" on_node="lxc1" on_node_uuid="lxc1" router_node="rhel7-1"/>
       </trigger>
     </inputs>
diff --git a/pengine/test10/whitebox-ms-ordering.dot b/pengine/test10/whitebox-ms-ordering.dot
index 1a942f4..84a0984 100644
--- a/pengine/test10/whitebox-ms-ordering.dot
+++ b/pengine/test10/whitebox-ms-ordering.dot
@@ -6,6 +6,8 @@
 "container1_monitor_0 18node2" [ style=bold color="green" fontcolor="black"]
 "container1_monitor_0 18node3" -> "container1_start_0 18node1" [ style = bold]
 "container1_monitor_0 18node3" [ style=bold color="green" fontcolor="black"]
+"container1_start_0 18node1" -> "lxc-ms_promote_0 lxc1" [ style = bold]
+"container1_start_0 18node1" -> "lxc-ms_start_0 lxc1" [ style = bold]
 "container1_start_0 18node1" -> "lxc1_start_0 18node1" [ style = bold]
 "container1_start_0 18node1" [ style=bold color="green" fontcolor="black"]
 "container2_monitor_0 18node1" -> "container2_start_0 18node1" [ style = bold]
@@ -14,6 +16,7 @@
 "container2_monitor_0 18node2" [ style=bold color="green" fontcolor="black"]
 "container2_monitor_0 18node3" -> "container2_start_0 18node1" [ style = bold]
 "container2_monitor_0 18node3" [ style=bold color="green" fontcolor="black"]
+"container2_start_0 18node1" -> "lxc-ms_start_0 lxc2" [ style = bold]
 "container2_start_0 18node1" -> "lxc2_start_0 18node1" [ style = bold]
 "container2_start_0 18node1" [ style=bold color="green" fontcolor="black"]
 "lxc-ms-master_demote_0" -> "lxc-ms-master_demoted_0" [ style = bold]
diff --git a/pengine/test10/whitebox-ms-ordering.exp b/pengine/test10/whitebox-ms-ordering.exp
index de4f4d0..43cb49a 100644
--- a/pengine/test10/whitebox-ms-ordering.exp
+++ b/pengine/test10/whitebox-ms-ordering.exp
@@ -106,6 +106,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="20" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="22" operation="demote" operation_key="lxc-ms_demote_0" internal_operation_key="lxc-ms:0_demote_0"/>
       </trigger>
       <trigger>
@@ -131,6 +134,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="20" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="23" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:0_stop_0"/>
       </trigger>
       <trigger>
@@ -238,6 +244,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="21" operation="start" operation_key="container2_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="26" operation="stop" operation_key="lxc-ms_stop_0" internal_operation_key="lxc-ms:1_stop_0"/>
       </trigger>
       <trigger>
diff --git a/pengine/test10/whitebox-nested-group.dot b/pengine/test10/whitebox-nested-group.dot
index e149f9a..9e1abce 100644
--- a/pengine/test10/whitebox-nested-group.dot
+++ b/pengine/test10/whitebox-nested-group.dot
@@ -17,6 +17,9 @@
 "container_monitor_10000 c7auto1" [ style=bold color="green" fontcolor="black"]
 "container_start_0 c7auto1" -> "c7auto4_start_0 c7auto1" [ style = bold]
 "container_start_0 c7auto1" -> "container_monitor_10000 c7auto1" [ style = bold]
+"container_start_0 c7auto1" -> "fake2_start_0 c7auto4" [ style = bold]
+"container_start_0 c7auto1" -> "fake5_start_0 c7auto4" [ style = bold]
+"container_start_0 c7auto1" -> "fake:2_start_0 c7auto4" [ style = bold]
 "container_start_0 c7auto1" -> "fake_group_running_0" [ style = bold]
 "container_start_0 c7auto1" [ style=bold color="green" fontcolor="black"]
 "fake1_monitor_0 c7auto1" -> "fake1_start_0 c7auto3" [ style = bold]
diff --git a/pengine/test10/whitebox-nested-group.exp b/pengine/test10/whitebox-nested-group.exp
index e6b68f2..979a0f5 100644
--- a/pengine/test10/whitebox-nested-group.exp
+++ b/pengine/test10/whitebox-nested-group.exp
@@ -92,6 +92,9 @@
         <rsc_op id="20" operation="monitor" operation_key="fake2_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
@@ -275,6 +278,9 @@
         <rsc_op id="23" operation="monitor" operation_key="fake5_monitor_0" on_node="c7auto3" on_node_uuid="3"/>
       </trigger>
       <trigger>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
@@ -404,6 +410,9 @@
         <pseudo_event id="47" operation="start" operation_key="fake_clone_start_0"/>
       </trigger>
       <trigger>
+        <rsc_op id="53" operation="start" operation_key="container_start_0" on_node="c7auto1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <rsc_op id="59" operation="start" operation_key="c7auto4_start_0" on_node="c7auto1" on_node_uuid="1"/>
       </trigger>
     </inputs>
diff --git a/pengine/test10/whitebox-start.dot b/pengine/test10/whitebox-start.dot
index 659ea97..8b4dbcd 100644
--- a/pengine/test10/whitebox-start.dot
+++ b/pengine/test10/whitebox-start.dot
@@ -20,6 +20,8 @@ digraph "g" {
 "M_start_0 lxc1" -> "M_monitor_10000 lxc1" [ style = bold]
 "M_start_0 lxc1" [ style=bold color="green" fontcolor="black"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
+"container1_start_0 18node1" -> "A_start_0 lxc1" [ style = bold]
+"container1_start_0 18node1" -> "M_start_0 lxc1" [ style = bold]
 "container1_start_0 18node1" -> "lxc1_start_0 18node1" [ style = bold]
 "container1_start_0 18node1" [ style=bold color="green" fontcolor="black"]
 "lxc1_monitor_30000 18node1" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/whitebox-start.exp b/pengine/test10/whitebox-start.exp
index 3f28d9e..11438e9 100644
--- a/pengine/test10/whitebox-start.exp
+++ b/pengine/test10/whitebox-start.exp
@@ -33,6 +33,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="11" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <pseudo_event id="26" operation="start" operation_key="M-clone_start_0"/>
       </trigger>
       <trigger>
@@ -88,6 +91,9 @@
     </action_set>
     <inputs>
       <trigger>
+        <rsc_op id="11" operation="start" operation_key="container1_start_0" on_node="18node1" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
         <rsc_op id="30" operation="stop" operation_key="A_stop_0" on_node="18node1" on_node_uuid="1"/>
       </trigger>
       <trigger>
-- 
1.8.3.1


From 990c99a639ec382582a1be8829ffecf52798622f Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Thu, 25 May 2017 14:30:06 +1000
Subject: [PATCH 4/6] Fix: PE: Improved fencing logging

---
 lib/pengine/unpack.c | 8 +++++---
 lib/pengine/utils.c  | 5 +++--
 2 files changed, 8 insertions(+), 5 deletions(-)

diff --git a/lib/pengine/unpack.c b/lib/pengine/unpack.c
index df9a133..8caf522 100644
--- a/lib/pengine/unpack.c
+++ b/lib/pengine/unpack.c
@@ -100,15 +100,16 @@ pe_fence_node(pe_working_set_t * data_set, node_t * node, const char *reason)
         if (rsc && (!is_set(rsc->flags, pe_rsc_managed))) {
             crm_notice("Not fencing node %s because connection is unmanaged, "
                        "otherwise would %s", node->details->uname, reason);
-        } else {
+        } else if(node->details->remote_requires_reset == FALSE) {
+            node->details->remote_requires_reset = TRUE;
             if (pe_can_fence(data_set, node)) {
                 crm_warn("Node %s will be fenced %s", node->details->uname, reason);
             } else {
                 crm_warn("Node %s is unclean %s", node->details->uname, reason);
             }
-            node->details->remote_requires_reset = TRUE;
         }
         node->details->unclean = TRUE;
+
     } else if (node->details->unclean == FALSE) {
         if (pe_can_fence(data_set, node)) {
             crm_warn("Node %s will be fenced %s", node->details->uname, reason);
@@ -116,8 +117,9 @@ pe_fence_node(pe_working_set_t * data_set, node_t * node, const char *reason)
             crm_warn("Node %s is unclean %s", node->details->uname, reason);
         }
         node->details->unclean = TRUE;
+
     } else {
-        crm_trace("Huh? %s %s", node->details->uname, reason);
+        crm_trace("Node %s would also be fenced '%s'", node->details->uname, reason);
     }
 }
 
diff --git a/lib/pengine/utils.c b/lib/pengine/utils.c
index 3d4e60d..7acd90c 100644
--- a/lib/pengine/utils.c
+++ b/lib/pengine/utils.c
@@ -515,8 +515,9 @@ custom_action(resource_t * rsc, char *key, const char *task,
             do_crm_log(warn_level, "Action %s on %s is unrunnable (offline)",
                        action->uuid, action->node->details->uname);
             if (is_set(action->rsc->flags, pe_rsc_managed)
-                && save_action && a_task == stop_rsc) {
-                pe_fence_node(data_set, action->node, "because node is unclean");
+                && save_action && a_task == stop_rsc
+                && action->node->details->unclean == FALSE) {
+                pe_fence_node(data_set, action->node, "because of unrunnable resource actions");
             }
 
         } else if (action->node->details->pending) {
-- 
1.8.3.1


From 7f1cd383738dee507dd7120252e562de008b1f77 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Thu, 25 May 2017 14:40:11 +1000
Subject: [PATCH 5/6] Fix: PE: Ensure remote nodes are fenced when the
 connection cannot be recovered

Also ensure it is fenced directly, not as a side-effect of scheduling an
action for the remote node that cannot run because the connection is
dead.

Also re-use the standard pe_fence_node() and stage6() fencing calculation
logic instead of rolling code specific to remotes and containers.
---
 pengine/allocate.c                               |  36 +-
 pengine/regression.sh                            |   2 +
 pengine/test10/remote-recover-all.dot            | 173 +++++
 pengine/test10/remote-recover-all.exp            | 889 +++++++++++++++++++++++
 pengine/test10/remote-recover-all.scores         | 848 +++++++++++++++++++++
 pengine/test10/remote-recover-all.summary        | 152 ++++
 pengine/test10/remote-recover-all.xml            | 745 +++++++++++++++++++
 pengine/test10/remote-recover-connection.dot     | 131 ++++
 pengine/test10/remote-recover-connection.exp     | 708 ++++++++++++++++++
 pengine/test10/remote-recover-connection.scores  | 848 +++++++++++++++++++++
 pengine/test10/remote-recover-connection.summary | 139 ++++
 pengine/test10/remote-recover-connection.xml     | 739 +++++++++++++++++++
 12 files changed, 5400 insertions(+), 10 deletions(-)
 create mode 100644 pengine/test10/remote-recover-all.dot
 create mode 100644 pengine/test10/remote-recover-all.exp
 create mode 100644 pengine/test10/remote-recover-all.scores
 create mode 100644 pengine/test10/remote-recover-all.summary
 create mode 100644 pengine/test10/remote-recover-all.xml
 create mode 100644 pengine/test10/remote-recover-connection.dot
 create mode 100644 pengine/test10/remote-recover-connection.exp
 create mode 100644 pengine/test10/remote-recover-connection.scores
 create mode 100644 pengine/test10/remote-recover-connection.summary
 create mode 100644 pengine/test10/remote-recover-connection.xml

diff --git a/pengine/allocate.c b/pengine/allocate.c
index 90d25fc..b431d31 100644
--- a/pengine/allocate.c
+++ b/pengine/allocate.c
@@ -38,6 +38,7 @@ void set_alloc_actions(pe_working_set_t * data_set);
 void migrate_reload_madness(pe_working_set_t * data_set);
 extern void ReloadRsc(resource_t * rsc, node_t *node, pe_working_set_t * data_set);
 extern gboolean DeleteRsc(resource_t * rsc, node_t * node, gboolean optional, pe_working_set_t * data_set);
+static void apply_remote_node_ordering(pe_working_set_t *data_set);
 
 resource_alloc_functions_t resource_class_alloc_functions[] = {
     {
@@ -1442,8 +1443,18 @@ stage6(pe_working_set_t * data_set)
     GListPtr gIter;
     GListPtr stonith_ops = NULL;
 
-    crm_trace("Processing fencing and shutdown cases");
+    /* Remote ordering constraints need to happen prior to calculate
+     * fencing because it is one more place we will mark the node as
+     * dirty.
+     *
+     * A nice side-effect of doing it first is that we can remove a
+     * bunch of special logic from apply_*_ordering() because its
+     * already part of pe_fence_node()
+     */
+    crm_trace("Creating remote ordering constraints");
+    apply_remote_node_ordering(data_set);
 
+    crm_trace("Processing fencing and shutdown cases");
     if (any_managed_resources(data_set) == FALSE) {
         crm_notice("Delaying fencing operations until there are resources to manage");
         need_stonith = FALSE;
@@ -1792,6 +1803,10 @@ apply_container_ordering(action_t *action, pe_working_set_t *data_set)
     container = remote_rsc->container;
     CRM_ASSERT(container);
 
+    if(is_set(container->flags, pe_rsc_failed)) {
+        pe_fence_node(data_set, action->node, " because the container failed");
+    }
+
     crm_trace("%s %s %s %s %d", action->uuid, action->task, remote_rsc->id, container->id, is_set(container->flags, pe_rsc_failed));
     switch (task) {
         case start_rsc:
@@ -1814,10 +1829,6 @@ apply_container_ordering(action_t *action, pe_working_set_t *data_set)
                  * stopping. This is similar to how fencing operations
                  * work for cluster nodes.
                  */
-                custom_action_order(container, generate_op_key(container->id, RSC_STOP, 0), NULL,
-                                    action->rsc, NULL, action,
-                                    pe_order_preserve | pe_order_implies_then | pe_order_runnable_left, data_set);
-                pe_set_action_bit(action, pe_action_pseudo);
             } else {
                 /* Otherwise, ensure the operation happens before the connection is brought down */
                 custom_action_order(action->rsc, NULL, action,
@@ -1835,7 +1846,7 @@ apply_container_ordering(action_t *action, pe_working_set_t *data_set)
                  * stopped (otherwise we re-introduce an ordering
                  * loop)
                  */
-                pe_set_action_bit(action, pe_action_pseudo);
+
             } else {
                 /* Otherwise, ensure the operation happens before the connection is brought down */
                 custom_action_order(action->rsc, NULL, action,
@@ -1894,6 +1905,11 @@ apply_remote_ordering(action_t *action, pe_working_set_t *data_set)
          * We must assume the target has failed
          */
         state = remote_state_dead;
+        if(is_set(remote_rsc->flags, pe_rsc_failed)) {
+            pe_fence_node(data_set, action->node, "because the connection is unrecoverable (failed)");
+        } else if(cluster_node && cluster_node->details->unclean) {
+            pe_fence_node(data_set, action->node, "because the connection is unrecoverable (unclean host)");
+        }
 
     } else if (cluster_node == NULL) {
         /* Connection is recoverable but not currently running anywhere, see if we can recover it first */
@@ -1917,7 +1933,7 @@ apply_remote_ordering(action_t *action, pe_working_set_t *data_set)
         state = remote_state_alive;
     }
 
-    crm_trace("%s %s %d", action->uuid, action->task, state);
+    crm_trace("%s %s %d %d", action->uuid, action->task, state, is_set(remote_rsc->flags, pe_rsc_failed));
     switch (task) {
         case start_rsc:
         case action_promote:
@@ -2167,7 +2183,6 @@ stage7(pe_working_set_t * data_set)
 {
     GListPtr gIter = NULL;
 
-    apply_remote_node_ordering(data_set);
     crm_trace("Applying ordering constraints");
 
     /* Don't ask me why, but apparently they need to be processed in
@@ -2310,11 +2325,12 @@ stage8(pe_working_set_t * data_set)
              */
             if (is_set(data_set->flags, pe_flag_have_quorum)
                 || data_set->no_quorum_policy == no_quorum_ignore) {
-                crm_crit("Cannot %s node '%s' because of %s:%s%s",
+                crm_crit("Cannot %s node '%s' because of %s:%s%s (%s)",
                          action->node->details->unclean ? "fence" : "shut down",
                          action->node->details->uname, action->rsc->id,
                          is_not_set(action->rsc->flags, pe_rsc_managed) ? " unmanaged" : " blocked",
-                         is_set(action->rsc->flags, pe_rsc_failed) ? " failed" : "");
+                         is_set(action->rsc->flags, pe_rsc_failed) ? " failed" : "",
+                         action->uuid);
             }
         }
 
diff --git a/pengine/regression.sh b/pengine/regression.sh
index 62fc066..7b0ce76 100755
--- a/pengine/regression.sh
+++ b/pengine/regression.sh
@@ -838,6 +838,8 @@ do_test remote-start-fail       "Make sure a start failure does not result in fe
 do_test remote-unclean2         "Make monitor failure always results in fencing, even if no rsc are active on remote."
 do_test remote-fence-before-reconnect "Fence before clearing recurring monitor failure"
 do_test remote-recovery		"Recover remote connections before attempting demotion"
+do_test remote-recover-connection "Optimistically recovery of only the connection"
+do_test remote-recover-all        "Fencing when the connection has no home"
 
 echo ""
 do_test resource-discovery      "Exercises resource-discovery location constraint option."
diff --git a/pengine/test10/remote-recover-all.dot b/pengine/test10/remote-recover-all.dot
new file mode 100644
index 0000000..2369adc
--- /dev/null
+++ b/pengine/test10/remote-recover-all.dot
@@ -0,0 +1,173 @@
+digraph "g" {
+"all_stopped" -> "stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" [ style = bold]
+"all_stopped" -> "stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" [ style = bold]
+"all_stopped" -> "stonith-fence_ipmilan-525400bbf613_start_0 controller-0" [ style = bold]
+"all_stopped" [ style=bold color="green" fontcolor="orange"]
+"galera-0_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"galera-0_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"galera-2_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"galera-2_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"galera-master_demote_0" -> "galera-master_demoted_0" [ style = bold]
+"galera-master_demote_0" -> "galera_demote_0 galera-0" [ style = bold]
+"galera-master_demote_0" -> "galera_demote_0 galera-2" [ style = bold]
+"galera-master_demote_0" [ style=bold color="green" fontcolor="orange"]
+"galera-master_demoted_0" -> "galera-master_stop_0" [ style = bold]
+"galera-master_demoted_0" [ style=bold color="green" fontcolor="orange"]
+"galera-master_stop_0" -> "galera-master_stopped_0" [ style = bold]
+"galera-master_stop_0" -> "galera_stop_0 galera-0" [ style = bold]
+"galera-master_stop_0" -> "galera_stop_0 galera-2" [ style = bold]
+"galera-master_stop_0" [ style=bold color="green" fontcolor="orange"]
+"galera-master_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"galera_demote_0 galera-0" -> "galera-master_demoted_0" [ style = bold]
+"galera_demote_0 galera-0" -> "galera_demote_0 galera-2" [ style = bold]
+"galera_demote_0 galera-0" -> "galera_stop_0 galera-0" [ style = bold]
+"galera_demote_0 galera-0" [ style=bold color="green" fontcolor="orange"]
+"galera_demote_0 galera-2" -> "galera-master_demoted_0" [ style = bold]
+"galera_demote_0 galera-2" -> "galera_stop_0 galera-2" [ style = bold]
+"galera_demote_0 galera-2" [ style=bold color="green" fontcolor="orange"]
+"galera_stop_0 galera-0" -> "all_stopped" [ style = bold]
+"galera_stop_0 galera-0" -> "galera-0_stop_0 controller-1" [ style = bold]
+"galera_stop_0 galera-0" -> "galera-master_stopped_0" [ style = bold]
+"galera_stop_0 galera-0" -> "galera_stop_0 galera-2" [ style = bold]
+"galera_stop_0 galera-0" [ style=bold color="green" fontcolor="orange"]
+"galera_stop_0 galera-2" -> "all_stopped" [ style = bold]
+"galera_stop_0 galera-2" -> "galera-2_stop_0 controller-1" [ style = bold]
+"galera_stop_0 galera-2" -> "galera-master_stopped_0" [ style = bold]
+"galera_stop_0 galera-2" [ style=bold color="green" fontcolor="orange"]
+"haproxy-clone_stop_0" -> "haproxy-clone_stopped_0" [ style = bold]
+"haproxy-clone_stop_0" -> "haproxy_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stop_0" [ style=bold color="green" fontcolor="orange"]
+"haproxy-clone_stopped_0" -> "ip-172.17.1.14_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" -> "ip-172.17.1.17_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" -> "ip-172.17.4.11_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"haproxy_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"haproxy_stop_0 controller-1" -> "haproxy-clone_stopped_0" [ style = bold]
+"haproxy_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.1.14_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.14_start_0 controller-2" -> "ip-172.17.1.14_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.1.14_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.14_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.1.14_stop_0 controller-1" -> "ip-172.17.1.14_start_0 controller-2" [ style = bold]
+"ip-172.17.1.14_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.1.17_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.17_start_0 controller-2" -> "ip-172.17.1.17_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.1.17_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.17_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.1.17_stop_0 controller-1" -> "ip-172.17.1.17_start_0 controller-2" [ style = bold]
+"ip-172.17.1.17_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.4.11_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.4.11_start_0 controller-2" -> "ip-172.17.4.11_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.4.11_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.4.11_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.4.11_stop_0 controller-1" -> "ip-172.17.4.11_start_0 controller-2" [ style = bold]
+"ip-172.17.4.11_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"messaging-1_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"messaging-1_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq-clone_stop_0" -> "rabbitmq-clone_stopped_0" [ style = bold]
+"rabbitmq-clone_stop_0" -> "rabbitmq_stop_0 messaging-1" [ style = bold]
+"rabbitmq-clone_stop_0" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq-clone_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq_confirmed-post_notify_stonith_0" -> "all_stopped" [ style = bold]
+"rabbitmq_confirmed-post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq_post_notify_stonith_0 messaging-0" -> "rabbitmq_confirmed-post_notify_stonith_0" [ style = bold]
+"rabbitmq_post_notify_stonith_0 messaging-0" [ style=bold color="green" fontcolor="black"]
+"rabbitmq_post_notify_stonith_0 messaging-2" -> "rabbitmq_confirmed-post_notify_stonith_0" [ style = bold]
+"rabbitmq_post_notify_stonith_0 messaging-2" [ style=bold color="green" fontcolor="black"]
+"rabbitmq_post_notify_stonith_0" -> "rabbitmq_confirmed-post_notify_stonith_0" [ style = bold]
+"rabbitmq_post_notify_stonith_0" -> "rabbitmq_post_notify_stonith_0 messaging-0" [ style = bold]
+"rabbitmq_post_notify_stonith_0" -> "rabbitmq_post_notify_stonith_0 messaging-2" [ style = bold]
+"rabbitmq_post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq_stop_0 messaging-1" -> "all_stopped" [ style = bold]
+"rabbitmq_stop_0 messaging-1" -> "messaging-1_stop_0 controller-1" [ style = bold]
+"rabbitmq_stop_0 messaging-1" -> "rabbitmq-clone_stopped_0" [ style = bold]
+"rabbitmq_stop_0 messaging-1" [ style=bold color="green" fontcolor="orange"]
+"redis-master_confirmed-post_notify_stopped_0" -> "all_stopped" [ style = bold]
+"redis-master_confirmed-post_notify_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_confirmed-pre_notify_stop_0" -> "redis-master_post_notify_stopped_0" [ style = bold]
+"redis-master_confirmed-pre_notify_stop_0" -> "redis-master_stop_0" [ style = bold]
+"redis-master_confirmed-pre_notify_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_post_notify_stopped_0" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis-master_post_notify_stopped_0" -> "redis_post_notify_stonith_0 controller-0" [ style = bold]
+"redis-master_post_notify_stopped_0" -> "redis_post_notify_stonith_0 controller-2" [ style = bold]
+"redis-master_post_notify_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_pre_notify_stop_0" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis-master_pre_notify_stop_0" -> "redis_pre_notify_stop_0 controller-0" [ style = bold]
+"redis-master_pre_notify_stop_0" -> "redis_pre_notify_stop_0 controller-2" [ style = bold]
+"redis-master_pre_notify_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_stop_0" -> "redis-master_stopped_0" [ style = bold]
+"redis-master_stop_0" -> "redis_stop_0 controller-1" [ style = bold]
+"redis-master_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_stopped_0" -> "redis-master_post_notify_stopped_0" [ style = bold]
+"redis-master_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis_confirmed-post_notify_stonith_0" -> "all_stopped" [ style = bold]
+"redis_confirmed-post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"redis_post_notify_stonith_0 controller-0" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-0" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"redis_post_notify_stonith_0 controller-2" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-2" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"redis_post_notify_stonith_0" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0" -> "redis_post_notify_stonith_0 controller-0" [ style = bold]
+"redis_post_notify_stonith_0" -> "redis_post_notify_stonith_0 controller-2" [ style = bold]
+"redis_post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"redis_pre_notify_stop_0 controller-0" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis_pre_notify_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"redis_pre_notify_stop_0 controller-2" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis_pre_notify_stop_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"redis_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"redis_stop_0 controller-1" -> "redis-master_stopped_0" [ style = bold]
+"redis_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"stonith 'reboot' controller-1" -> "galera-0_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "galera-2_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "haproxy-clone_stop_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "haproxy_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.1.14_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.1.17_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.4.11_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "messaging-1_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis-master_stop_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis_post_notify_stonith_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "stonith 'reboot' galera-0" [ style = bold]
+"stonith 'reboot' controller-1" [ style=bold color="green" fontcolor="black"]
+"stonith 'reboot' galera-0" -> "galera-master_stop_0" [ style = bold]
+"stonith 'reboot' galera-0" -> "galera_demote_0 galera-0" [ style = bold]
+"stonith 'reboot' galera-0" -> "galera_stop_0 galera-0" [ style = bold]
+"stonith 'reboot' galera-0" -> "stonith 'reboot' galera-2" [ style = bold]
+"stonith 'reboot' galera-0" [ style=bold color="green" fontcolor="black"]
+"stonith 'reboot' galera-2" -> "galera-master_stop_0" [ style = bold]
+"stonith 'reboot' galera-2" -> "galera_demote_0 galera-2" [ style = bold]
+"stonith 'reboot' galera-2" -> "galera_stop_0 galera-2" [ style = bold]
+"stonith 'reboot' galera-2" -> "stonith 'reboot' messaging-1" [ style = bold]
+"stonith 'reboot' galera-2" [ style=bold color="green" fontcolor="black"]
+"stonith 'reboot' messaging-1" -> "rabbitmq-clone_stop_0" [ style = bold]
+"stonith 'reboot' messaging-1" -> "rabbitmq_post_notify_stonith_0" [ style = bold]
+"stonith 'reboot' messaging-1" -> "rabbitmq_stop_0 messaging-1" [ style = bold]
+"stonith 'reboot' messaging-1" -> "stonith_complete" [ style = bold]
+"stonith 'reboot' messaging-1" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_monitor_60000 controller-2" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" -> "stonith-fence_ipmilan-5254005bdbb5_monitor_60000 controller-2" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" -> "stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"stonith-fence_ipmilan-525400b4f6bd_monitor_60000 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" -> "stonith-fence_ipmilan-525400b4f6bd_monitor_60000 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" -> "stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_monitor_60000 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_start_0 controller-0" -> "stonith-fence_ipmilan-525400bbf613_monitor_60000 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_start_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" -> "stonith-fence_ipmilan-525400bbf613_start_0 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith_complete" -> "all_stopped" [ style = bold]
+"stonith_complete" -> "ip-172.17.1.14_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "ip-172.17.1.17_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "ip-172.17.4.11_start_0 controller-2" [ style = bold]
+"stonith_complete" [ style=bold color="green" fontcolor="orange"]
+}
diff --git a/pengine/test10/remote-recover-all.exp b/pengine/test10/remote-recover-all.exp
new file mode 100644
index 0000000..2b0bd1e
--- /dev/null
+++ b/pengine/test10/remote-recover-all.exp
@@ -0,0 +1,889 @@
+<transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
+  <synapse id="0">
+    <action_set>
+      <pseudo_event id="26" operation="stop" operation_key="messaging-1_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="37" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="1">
+    <action_set>
+      <pseudo_event id="29" operation="stop" operation_key="galera-0_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="49" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="2">
+    <action_set>
+      <pseudo_event id="32" operation="stop" operation_key="galera-2_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="47" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="3" priority="1000000">
+    <action_set>
+      <rsc_op id="131" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:0_post_notify_stop_0" on_node="messaging-2" on_node_uuid="messaging-2" router_node="controller-0">
+        <primitive id="rabbitmq" long-id="rabbitmq:0" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_stop_resource="rabbitmq:2" CRM_meta_notify_stop_uname="messaging-1" CRM_meta_notify_type="post" CRM_meta_on_node="messaging-2" CRM_meta_on_node_uuid="messaging-2" CRM_meta_timeout="20000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="129" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:2_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="4" priority="1000000">
+    <action_set>
+      <rsc_op id="132" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:1_post_notify_stop_0" on_node="messaging-0" on_node_uuid="messaging-0" router_node="controller-0">
+        <primitive id="rabbitmq" long-id="rabbitmq:1" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_stop_resource="rabbitmq:2" CRM_meta_notify_stop_uname="messaging-1" CRM_meta_notify_type="post" CRM_meta_on_node="messaging-0" CRM_meta_on_node_uuid="messaging-0" CRM_meta_timeout="20000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="129" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:2_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="5" priority="1000000">
+    <action_set>
+      <pseudo_event id="130" operation="notified" operation_key="rabbitmq_notified_0" internal_operation_key="rabbitmq:2_confirmed-post_notify_stonith_0">
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="129" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:2_post_notify_stonith_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="131" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:0_post_notify_stop_0" on_node="messaging-2" on_node_uuid="messaging-2" router_node="controller-0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="132" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:1_post_notify_stop_0" on_node="messaging-0" on_node_uuid="messaging-0" router_node="controller-0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="6" priority="1000000">
+    <action_set>
+      <pseudo_event id="129" operation="notify" operation_key="rabbitmq_post_notify_stop_0" internal_operation_key="rabbitmq:2_post_notify_stonith_0">
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="128" operation="stonith" operation_key="stonith-messaging-1-reboot" on_node="messaging-1" on_node_uuid="messaging-1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="7">
+    <action_set>
+      <pseudo_event id="37" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0">
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_notify_stop_resource="rabbitmq:2" CRM_meta_notify_stop_uname="messaging-1" CRM_meta_timeout="200000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="40" operation="stop" operation_key="rabbitmq-clone_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="128" operation="stonith" operation_key="stonith-messaging-1-reboot" on_node="messaging-1" on_node_uuid="messaging-1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="8" priority="1000000">
+    <action_set>
+      <pseudo_event id="41" operation="stopped" operation_key="rabbitmq-clone_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="37" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="40" operation="stop" operation_key="rabbitmq-clone_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="9">
+    <action_set>
+      <pseudo_event id="40" operation="stop" operation_key="rabbitmq-clone_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="128" operation="stonith" operation_key="stonith-messaging-1-reboot" on_node="messaging-1" on_node_uuid="messaging-1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="10">
+    <action_set>
+      <pseudo_event id="47" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0">
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="46" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="49" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="52" operation="stop" operation_key="galera-master_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="127" operation="stonith" operation_key="stonith-galera-2-reboot" on_node="galera-2" on_node_uuid="galera-2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="11">
+    <action_set>
+      <pseudo_event id="46" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0">
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="demote" CRM_meta_notify="false" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="48" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="56" operation="demote" operation_key="galera-master_demote_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="127" operation="stonith" operation_key="stonith-galera-2-reboot" on_node="galera-2" on_node_uuid="galera-2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="12">
+    <action_set>
+      <pseudo_event id="49" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0">
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="48" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="52" operation="stop" operation_key="galera-master_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="126" operation="stonith" operation_key="stonith-galera-0-reboot" on_node="galera-0" on_node_uuid="galera-0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="13">
+    <action_set>
+      <pseudo_event id="48" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0">
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="demote" CRM_meta_notify="false" CRM_meta_timeout="120000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="56" operation="demote" operation_key="galera-master_demote_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="126" operation="stonith" operation_key="stonith-galera-0-reboot" on_node="galera-0" on_node_uuid="galera-0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="14" priority="1000000">
+    <action_set>
+      <pseudo_event id="57" operation="demoted" operation_key="galera-master_demoted_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="46" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:1_demote_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="48" operation="demote" operation_key="galera_demote_0" internal_operation_key="galera:2_demote_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="56" operation="demote" operation_key="galera-master_demote_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="15">
+    <action_set>
+      <pseudo_event id="56" operation="demote" operation_key="galera-master_demote_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="16" priority="1000000">
+    <action_set>
+      <pseudo_event id="53" operation="stopped" operation_key="galera-master_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="47" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="49" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="52" operation="stop" operation_key="galera-master_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="17">
+    <action_set>
+      <pseudo_event id="52" operation="stop" operation_key="galera-master_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="57" operation="demoted" operation_key="galera-master_demoted_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="126" operation="stonith" operation_key="stonith-galera-0-reboot" on_node="galera-0" on_node_uuid="galera-0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="127" operation="stonith" operation_key="stonith-galera-2-reboot" on_node="galera-2" on_node_uuid="galera-2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="18" priority="1000000">
+    <action_set>
+      <pseudo_event id="123" operation="notified" operation_key="redis_notified_0" internal_operation_key="redis:0_confirmed-post_notify_stonith_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="122" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="124" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="125" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="19" priority="1000000">
+    <action_set>
+      <pseudo_event id="122" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="20">
+    <action_set>
+      <pseudo_event id="58" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0 galera-2 galera-0 messaging-1" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_timeout="200000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="71" operation="stop" operation_key="redis-master_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="21">
+    <action_set>
+      <rsc_op id="197" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:1_pre_notify_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0 galera-2 galera-0 messaging-1" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="pre" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="73" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="22" priority="1000000">
+    <action_set>
+      <rsc_op id="124" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0 galera-2 galera-0 messaging-1" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="post" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="75" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="122" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="23">
+    <action_set>
+      <rsc_op id="198" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:2_pre_notify_stop_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0 galera-2 galera-0 messaging-1" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="pre" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="73" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="24" priority="1000000">
+    <action_set>
+      <rsc_op id="125" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0 galera-2 galera-0 messaging-1" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="post" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="75" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="122" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="25" priority="1000000">
+    <action_set>
+      <pseudo_event id="76" operation="notified" operation_key="redis-master_confirmed-post_notify_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="75" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="124" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="125" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="26" priority="1000000">
+    <action_set>
+      <pseudo_event id="75" operation="notify" operation_key="redis-master_post_notify_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="72" operation="stopped" operation_key="redis-master_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="74" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="27">
+    <action_set>
+      <pseudo_event id="74" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="73" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="197" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:1_pre_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="198" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:2_pre_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="28">
+    <action_set>
+      <pseudo_event id="73" operation="notify" operation_key="redis-master_pre_notify_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="29" priority="1000000">
+    <action_set>
+      <pseudo_event id="72" operation="stopped" operation_key="redis-master_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="58" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="71" operation="stop" operation_key="redis-master_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="30">
+    <action_set>
+      <pseudo_event id="71" operation="stop" operation_key="redis-master_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="74" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="31">
+    <action_set>
+      <rsc_op id="95" operation="monitor" operation_key="ip-172.17.1.14_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="94" operation="start" operation_key="ip-172.17.1.14_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="32">
+    <action_set>
+      <rsc_op id="94" operation="start" operation_key="ip-172.17.1.14_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="93" operation="stop" operation_key="ip-172.17.1.14_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="120" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="33">
+    <action_set>
+      <pseudo_event id="93" operation="stop" operation_key="ip-172.17.1.14_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="112" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="34">
+    <action_set>
+      <rsc_op id="98" operation="monitor" operation_key="ip-172.17.1.17_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="97" operation="start" operation_key="ip-172.17.1.17_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="35">
+    <action_set>
+      <rsc_op id="97" operation="start" operation_key="ip-172.17.1.17_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="96" operation="stop" operation_key="ip-172.17.1.17_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="120" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="36">
+    <action_set>
+      <pseudo_event id="96" operation="stop" operation_key="ip-172.17.1.17_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="112" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="37">
+    <action_set>
+      <rsc_op id="103" operation="monitor" operation_key="ip-172.17.4.11_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="102" operation="start" operation_key="ip-172.17.4.11_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="38">
+    <action_set>
+      <rsc_op id="102" operation="start" operation_key="ip-172.17.4.11_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="101" operation="stop" operation_key="ip-172.17.4.11_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="120" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="39">
+    <action_set>
+      <pseudo_event id="101" operation="stop" operation_key="ip-172.17.4.11_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="112" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="40">
+    <action_set>
+      <pseudo_event id="104" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_timeout="200000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="111" operation="stop" operation_key="haproxy-clone_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="41" priority="1000000">
+    <action_set>
+      <pseudo_event id="112" operation="stopped" operation_key="haproxy-clone_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="104" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="111" operation="stop" operation_key="haproxy-clone_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="42">
+    <action_set>
+      <pseudo_event id="111" operation="stop" operation_key="haproxy-clone_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="43">
+    <action_set>
+      <rsc_op id="115" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="44">
+    <action_set>
+      <rsc_op id="22" operation="start" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="115" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="45">
+    <action_set>
+      <rsc_op id="6" operation="monitor" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_60000" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="22" operation="start" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="46">
+    <action_set>
+      <rsc_op id="116" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="47">
+    <action_set>
+      <rsc_op id="23" operation="start" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="116" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="48">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="23" operation="start" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="49">
+    <action_set>
+      <rsc_op id="119" operation="monitor" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="118" operation="start" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="50">
+    <action_set>
+      <rsc_op id="118" operation="start" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="117" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="51">
+    <action_set>
+      <pseudo_event id="117" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0">
+        <attributes CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </pseudo_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="52">
+    <action_set>
+      <crm_event id="128" operation="stonith" operation_key="stonith-messaging-1-reboot" on_node="messaging-1" on_node_uuid="messaging-1">
+        <attributes CRM_meta_last_failure_rabbitmq="1493336946" CRM_meta_on_node="messaging-1" CRM_meta_on_node_uuid="messaging-1" CRM_meta_rabbitmq_role="true" CRM_meta_rmq_node_attr_last_known_rabbitmq="rabbit@messaging-1" CRM_meta_rmq_node_attr_rabbitmq="rabbit@messaging-1" CRM_meta_stonith_action="reboot" />
+        <downed>
+          <node id="messaging-1"/>
+        </downed>
+      </crm_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="127" operation="stonith" operation_key="stonith-galera-2-reboot" on_node="galera-2" on_node_uuid="galera-2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="53">
+    <action_set>
+      <crm_event id="127" operation="stonith" operation_key="stonith-galera-2-reboot" on_node="galera-2" on_node_uuid="galera-2">
+        <attributes CRM_meta_galera_role="true" CRM_meta_last_failure_galera="1493172798" CRM_meta_master_galera="100" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_stonith_action="reboot" />
+        <downed>
+          <node id="galera-2"/>
+        </downed>
+      </crm_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="126" operation="stonith" operation_key="stonith-galera-0-reboot" on_node="galera-0" on_node_uuid="galera-0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="54">
+    <action_set>
+      <crm_event id="126" operation="stonith" operation_key="stonith-galera-0-reboot" on_node="galera-0" on_node_uuid="galera-0">
+        <attributes CRM_meta_galera_role="true" CRM_meta_last_failure_galera="1493172797" CRM_meta_master_galera="100" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_stonith_action="reboot" />
+        <downed>
+          <node id="galera-0"/>
+        </downed>
+      </crm_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="55">
+    <action_set>
+      <crm_event id="121" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2">
+        <attributes CRM_meta_cinder_volume_role="true" CRM_meta_haproxy_role="true" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_redis_role="true" CRM_meta_stonith_action="reboot" />
+        <downed>
+          <node id="2"/>
+        </downed>
+      </crm_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="56">
+    <action_set>
+      <pseudo_event id="120" operation="stonith_complete" operation_key="stonith_complete">
+        <attributes />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="128" operation="stonith" operation_key="stonith-messaging-1-reboot" on_node="messaging-1" on_node_uuid="messaging-1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="57">
+    <action_set>
+      <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped">
+        <attributes />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="26" operation="stop" operation_key="messaging-1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="29" operation="stop" operation_key="galera-0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="32" operation="stop" operation_key="galera-2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="37" operation="stop" operation_key="rabbitmq_stop_0" internal_operation_key="rabbitmq:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="47" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="49" operation="stop" operation_key="galera_stop_0" internal_operation_key="galera:2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="58" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="76" operation="notified" operation_key="redis-master_confirmed-post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="93" operation="stop" operation_key="ip-172.17.1.14_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="96" operation="stop" operation_key="ip-172.17.1.17_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="101" operation="stop" operation_key="ip-172.17.4.11_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="104" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="115" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="116" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="117" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="120" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="123" operation="notified" operation_key="redis_notified_0" internal_operation_key="redis:0_confirmed-post_notify_stonith_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="130" operation="notified" operation_key="rabbitmq_notified_0" internal_operation_key="rabbitmq:2_confirmed-post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+</transition_graph>
diff --git a/pengine/test10/remote-recover-all.scores b/pengine/test10/remote-recover-all.scores
new file mode 100644
index 0000000..ef1f068
--- /dev/null
+++ b/pengine/test10/remote-recover-all.scores
@@ -0,0 +1,848 @@
+Allocation scores:
+Using the original execution date of: 2017-05-03 13:33:24Z
+clone_color: galera-master allocation score on controller-0: -INFINITY
+clone_color: galera-master allocation score on controller-1: -INFINITY
+clone_color: galera-master allocation score on controller-2: -INFINITY
+clone_color: galera-master allocation score on galera-0: 0
+clone_color: galera-master allocation score on galera-1: 0
+clone_color: galera-master allocation score on galera-2: 0
+clone_color: galera-master allocation score on messaging-0: -INFINITY
+clone_color: galera-master allocation score on messaging-1: -INFINITY
+clone_color: galera-master allocation score on messaging-2: -INFINITY
+clone_color: galera:0 allocation score on controller-0: -INFINITY
+clone_color: galera:0 allocation score on controller-1: -INFINITY
+clone_color: galera:0 allocation score on controller-2: -INFINITY
+clone_color: galera:0 allocation score on galera-0: 0
+clone_color: galera:0 allocation score on galera-1: INFINITY
+clone_color: galera:0 allocation score on galera-2: 0
+clone_color: galera:0 allocation score on messaging-0: -INFINITY
+clone_color: galera:0 allocation score on messaging-1: -INFINITY
+clone_color: galera:0 allocation score on messaging-2: -INFINITY
+clone_color: galera:1 allocation score on controller-0: -INFINITY
+clone_color: galera:1 allocation score on controller-1: -INFINITY
+clone_color: galera:1 allocation score on controller-2: -INFINITY
+clone_color: galera:1 allocation score on galera-0: 0
+clone_color: galera:1 allocation score on galera-1: 0
+clone_color: galera:1 allocation score on galera-2: INFINITY
+clone_color: galera:1 allocation score on messaging-0: -INFINITY
+clone_color: galera:1 allocation score on messaging-1: -INFINITY
+clone_color: galera:1 allocation score on messaging-2: -INFINITY
+clone_color: galera:2 allocation score on controller-0: -INFINITY
+clone_color: galera:2 allocation score on controller-1: -INFINITY
+clone_color: galera:2 allocation score on controller-2: -INFINITY
+clone_color: galera:2 allocation score on galera-0: INFINITY
+clone_color: galera:2 allocation score on galera-1: 0
+clone_color: galera:2 allocation score on galera-2: 0
+clone_color: galera:2 allocation score on messaging-0: -INFINITY
+clone_color: galera:2 allocation score on messaging-1: -INFINITY
+clone_color: galera:2 allocation score on messaging-2: -INFINITY
+clone_color: galera:3 allocation score on controller-0: -INFINITY
+clone_color: galera:3 allocation score on controller-1: -INFINITY
+clone_color: galera:3 allocation score on controller-2: -INFINITY
+clone_color: galera:3 allocation score on galera-0: 0
+clone_color: galera:3 allocation score on galera-1: 0
+clone_color: galera:3 allocation score on galera-2: 0
+clone_color: galera:3 allocation score on messaging-0: -INFINITY
+clone_color: galera:3 allocation score on messaging-1: -INFINITY
+clone_color: galera:3 allocation score on messaging-2: -INFINITY
+clone_color: galera:4 allocation score on controller-0: -INFINITY
+clone_color: galera:4 allocation score on controller-1: -INFINITY
+clone_color: galera:4 allocation score on controller-2: -INFINITY
+clone_color: galera:4 allocation score on galera-0: 0
+clone_color: galera:4 allocation score on galera-1: 0
+clone_color: galera:4 allocation score on galera-2: 0
+clone_color: galera:4 allocation score on messaging-0: -INFINITY
+clone_color: galera:4 allocation score on messaging-1: -INFINITY
+clone_color: galera:4 allocation score on messaging-2: -INFINITY
+clone_color: galera:5 allocation score on controller-0: -INFINITY
+clone_color: galera:5 allocation score on controller-1: -INFINITY
+clone_color: galera:5 allocation score on controller-2: -INFINITY
+clone_color: galera:5 allocation score on galera-0: 0
+clone_color: galera:5 allocation score on galera-1: 0
+clone_color: galera:5 allocation score on galera-2: 0
+clone_color: galera:5 allocation score on messaging-0: -INFINITY
+clone_color: galera:5 allocation score on messaging-1: -INFINITY
+clone_color: galera:5 allocation score on messaging-2: -INFINITY
+clone_color: galera:6 allocation score on controller-0: -INFINITY
+clone_color: galera:6 allocation score on controller-1: -INFINITY
+clone_color: galera:6 allocation score on controller-2: -INFINITY
+clone_color: galera:6 allocation score on galera-0: 0
+clone_color: galera:6 allocation score on galera-1: 0
+clone_color: galera:6 allocation score on galera-2: 0
+clone_color: galera:6 allocation score on messaging-0: -INFINITY
+clone_color: galera:6 allocation score on messaging-1: -INFINITY
+clone_color: galera:6 allocation score on messaging-2: -INFINITY
+clone_color: galera:7 allocation score on controller-0: -INFINITY
+clone_color: galera:7 allocation score on controller-1: -INFINITY
+clone_color: galera:7 allocation score on controller-2: -INFINITY
+clone_color: galera:7 allocation score on galera-0: 0
+clone_color: galera:7 allocation score on galera-1: 0
+clone_color: galera:7 allocation score on galera-2: 0
+clone_color: galera:7 allocation score on messaging-0: -INFINITY
+clone_color: galera:7 allocation score on messaging-1: -INFINITY
+clone_color: galera:7 allocation score on messaging-2: -INFINITY
+clone_color: galera:8 allocation score on controller-0: -INFINITY
+clone_color: galera:8 allocation score on controller-1: -INFINITY
+clone_color: galera:8 allocation score on controller-2: -INFINITY
+clone_color: galera:8 allocation score on galera-0: 0
+clone_color: galera:8 allocation score on galera-1: 0
+clone_color: galera:8 allocation score on galera-2: 0
+clone_color: galera:8 allocation score on messaging-0: -INFINITY
+clone_color: galera:8 allocation score on messaging-1: -INFINITY
+clone_color: galera:8 allocation score on messaging-2: -INFINITY
+clone_color: haproxy-clone allocation score on controller-0: INFINITY
+clone_color: haproxy-clone allocation score on controller-1: 0
+clone_color: haproxy-clone allocation score on controller-2: 0
+clone_color: haproxy-clone allocation score on galera-0: -INFINITY
+clone_color: haproxy-clone allocation score on galera-1: -INFINITY
+clone_color: haproxy-clone allocation score on galera-2: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-0: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-1: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-2: -INFINITY
+clone_color: haproxy:0 allocation score on controller-0: 0
+clone_color: haproxy:0 allocation score on controller-1: INFINITY
+clone_color: haproxy:0 allocation score on controller-2: 0
+clone_color: haproxy:0 allocation score on galera-0: -INFINITY
+clone_color: haproxy:0 allocation score on galera-1: -INFINITY
+clone_color: haproxy:0 allocation score on galera-2: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:1 allocation score on controller-0: INFINITY
+clone_color: haproxy:1 allocation score on controller-1: 0
+clone_color: haproxy:1 allocation score on controller-2: 0
+clone_color: haproxy:1 allocation score on galera-0: -INFINITY
+clone_color: haproxy:1 allocation score on galera-1: -INFINITY
+clone_color: haproxy:1 allocation score on galera-2: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:2 allocation score on controller-0: 0
+clone_color: haproxy:2 allocation score on controller-1: 0
+clone_color: haproxy:2 allocation score on controller-2: INFINITY
+clone_color: haproxy:2 allocation score on galera-0: -INFINITY
+clone_color: haproxy:2 allocation score on galera-1: -INFINITY
+clone_color: haproxy:2 allocation score on galera-2: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:3 allocation score on controller-0: 0
+clone_color: haproxy:3 allocation score on controller-1: 0
+clone_color: haproxy:3 allocation score on controller-2: 0
+clone_color: haproxy:3 allocation score on galera-0: -INFINITY
+clone_color: haproxy:3 allocation score on galera-1: -INFINITY
+clone_color: haproxy:3 allocation score on galera-2: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:4 allocation score on controller-0: 0
+clone_color: haproxy:4 allocation score on controller-1: 0
+clone_color: haproxy:4 allocation score on controller-2: 0
+clone_color: haproxy:4 allocation score on galera-0: -INFINITY
+clone_color: haproxy:4 allocation score on galera-1: -INFINITY
+clone_color: haproxy:4 allocation score on galera-2: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:5 allocation score on controller-0: 0
+clone_color: haproxy:5 allocation score on controller-1: 0
+clone_color: haproxy:5 allocation score on controller-2: 0
+clone_color: haproxy:5 allocation score on galera-0: -INFINITY
+clone_color: haproxy:5 allocation score on galera-1: -INFINITY
+clone_color: haproxy:5 allocation score on galera-2: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:6 allocation score on controller-0: 0
+clone_color: haproxy:6 allocation score on controller-1: 0
+clone_color: haproxy:6 allocation score on controller-2: 0
+clone_color: haproxy:6 allocation score on galera-0: -INFINITY
+clone_color: haproxy:6 allocation score on galera-1: -INFINITY
+clone_color: haproxy:6 allocation score on galera-2: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:7 allocation score on controller-0: 0
+clone_color: haproxy:7 allocation score on controller-1: 0
+clone_color: haproxy:7 allocation score on controller-2: 0
+clone_color: haproxy:7 allocation score on galera-0: -INFINITY
+clone_color: haproxy:7 allocation score on galera-1: -INFINITY
+clone_color: haproxy:7 allocation score on galera-2: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:8 allocation score on controller-0: 0
+clone_color: haproxy:8 allocation score on controller-1: 0
+clone_color: haproxy:8 allocation score on controller-2: 0
+clone_color: haproxy:8 allocation score on galera-0: -INFINITY
+clone_color: haproxy:8 allocation score on galera-1: -INFINITY
+clone_color: haproxy:8 allocation score on galera-2: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-0: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-1: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-0: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-1: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on messaging-0: 0
+clone_color: rabbitmq-clone allocation score on messaging-1: 0
+clone_color: rabbitmq-clone allocation score on messaging-2: 0
+clone_color: rabbitmq:0 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:0 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:0 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:0 allocation score on messaging-0: 0
+clone_color: rabbitmq:0 allocation score on messaging-1: 0
+clone_color: rabbitmq:0 allocation score on messaging-2: INFINITY
+clone_color: rabbitmq:1 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:1 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:1 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:1 allocation score on messaging-0: INFINITY
+clone_color: rabbitmq:1 allocation score on messaging-1: 0
+clone_color: rabbitmq:1 allocation score on messaging-2: 0
+clone_color: rabbitmq:2 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:2 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:2 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:2 allocation score on messaging-0: 0
+clone_color: rabbitmq:2 allocation score on messaging-1: INFINITY
+clone_color: rabbitmq:2 allocation score on messaging-2: 0
+clone_color: rabbitmq:3 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:3 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:3 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:3 allocation score on messaging-0: 0
+clone_color: rabbitmq:3 allocation score on messaging-1: 0
+clone_color: rabbitmq:3 allocation score on messaging-2: 0
+clone_color: rabbitmq:4 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:4 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:4 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:4 allocation score on messaging-0: 0
+clone_color: rabbitmq:4 allocation score on messaging-1: 0
+clone_color: rabbitmq:4 allocation score on messaging-2: 0
+clone_color: rabbitmq:5 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:5 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:5 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:5 allocation score on messaging-0: 0
+clone_color: rabbitmq:5 allocation score on messaging-1: 0
+clone_color: rabbitmq:5 allocation score on messaging-2: 0
+clone_color: rabbitmq:6 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:6 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:6 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:6 allocation score on messaging-0: 0
+clone_color: rabbitmq:6 allocation score on messaging-1: 0
+clone_color: rabbitmq:6 allocation score on messaging-2: 0
+clone_color: rabbitmq:7 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:7 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:7 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:7 allocation score on messaging-0: 0
+clone_color: rabbitmq:7 allocation score on messaging-1: 0
+clone_color: rabbitmq:7 allocation score on messaging-2: 0
+clone_color: rabbitmq:8 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:8 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:8 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:8 allocation score on messaging-0: 0
+clone_color: rabbitmq:8 allocation score on messaging-1: 0
+clone_color: rabbitmq:8 allocation score on messaging-2: 0
+clone_color: redis-master allocation score on controller-0: 0
+clone_color: redis-master allocation score on controller-1: 0
+clone_color: redis-master allocation score on controller-2: 0
+clone_color: redis-master allocation score on galera-0: -INFINITY
+clone_color: redis-master allocation score on galera-1: -INFINITY
+clone_color: redis-master allocation score on galera-2: -INFINITY
+clone_color: redis-master allocation score on messaging-0: -INFINITY
+clone_color: redis-master allocation score on messaging-1: -INFINITY
+clone_color: redis-master allocation score on messaging-2: -INFINITY
+clone_color: redis:0 allocation score on controller-0: 0
+clone_color: redis:0 allocation score on controller-1: INFINITY
+clone_color: redis:0 allocation score on controller-2: 0
+clone_color: redis:0 allocation score on galera-0: -INFINITY
+clone_color: redis:0 allocation score on galera-1: -INFINITY
+clone_color: redis:0 allocation score on galera-2: -INFINITY
+clone_color: redis:0 allocation score on messaging-0: -INFINITY
+clone_color: redis:0 allocation score on messaging-1: -INFINITY
+clone_color: redis:0 allocation score on messaging-2: -INFINITY
+clone_color: redis:1 allocation score on controller-0: INFINITY
+clone_color: redis:1 allocation score on controller-1: 0
+clone_color: redis:1 allocation score on controller-2: 0
+clone_color: redis:1 allocation score on galera-0: -INFINITY
+clone_color: redis:1 allocation score on galera-1: -INFINITY
+clone_color: redis:1 allocation score on galera-2: -INFINITY
+clone_color: redis:1 allocation score on messaging-0: -INFINITY
+clone_color: redis:1 allocation score on messaging-1: -INFINITY
+clone_color: redis:1 allocation score on messaging-2: -INFINITY
+clone_color: redis:2 allocation score on controller-0: 0
+clone_color: redis:2 allocation score on controller-1: 0
+clone_color: redis:2 allocation score on controller-2: INFINITY
+clone_color: redis:2 allocation score on galera-0: -INFINITY
+clone_color: redis:2 allocation score on galera-1: -INFINITY
+clone_color: redis:2 allocation score on galera-2: -INFINITY
+clone_color: redis:2 allocation score on messaging-0: -INFINITY
+clone_color: redis:2 allocation score on messaging-1: -INFINITY
+clone_color: redis:2 allocation score on messaging-2: -INFINITY
+clone_color: redis:3 allocation score on controller-0: 0
+clone_color: redis:3 allocation score on controller-1: 0
+clone_color: redis:3 allocation score on controller-2: 0
+clone_color: redis:3 allocation score on galera-0: -INFINITY
+clone_color: redis:3 allocation score on galera-1: -INFINITY
+clone_color: redis:3 allocation score on galera-2: -INFINITY
+clone_color: redis:3 allocation score on messaging-0: -INFINITY
+clone_color: redis:3 allocation score on messaging-1: -INFINITY
+clone_color: redis:3 allocation score on messaging-2: -INFINITY
+clone_color: redis:4 allocation score on controller-0: 0
+clone_color: redis:4 allocation score on controller-1: 0
+clone_color: redis:4 allocation score on controller-2: 0
+clone_color: redis:4 allocation score on galera-0: -INFINITY
+clone_color: redis:4 allocation score on galera-1: -INFINITY
+clone_color: redis:4 allocation score on galera-2: -INFINITY
+clone_color: redis:4 allocation score on messaging-0: -INFINITY
+clone_color: redis:4 allocation score on messaging-1: -INFINITY
+clone_color: redis:4 allocation score on messaging-2: -INFINITY
+clone_color: redis:5 allocation score on controller-0: 0
+clone_color: redis:5 allocation score on controller-1: 0
+clone_color: redis:5 allocation score on controller-2: 0
+clone_color: redis:5 allocation score on galera-0: -INFINITY
+clone_color: redis:5 allocation score on galera-1: -INFINITY
+clone_color: redis:5 allocation score on galera-2: -INFINITY
+clone_color: redis:5 allocation score on messaging-0: -INFINITY
+clone_color: redis:5 allocation score on messaging-1: -INFINITY
+clone_color: redis:5 allocation score on messaging-2: -INFINITY
+clone_color: redis:6 allocation score on controller-0: 0
+clone_color: redis:6 allocation score on controller-1: 0
+clone_color: redis:6 allocation score on controller-2: 0
+clone_color: redis:6 allocation score on galera-0: -INFINITY
+clone_color: redis:6 allocation score on galera-1: -INFINITY
+clone_color: redis:6 allocation score on galera-2: -INFINITY
+clone_color: redis:6 allocation score on messaging-0: -INFINITY
+clone_color: redis:6 allocation score on messaging-1: -INFINITY
+clone_color: redis:6 allocation score on messaging-2: -INFINITY
+clone_color: redis:7 allocation score on controller-0: 0
+clone_color: redis:7 allocation score on controller-1: 0
+clone_color: redis:7 allocation score on controller-2: 0
+clone_color: redis:7 allocation score on galera-0: -INFINITY
+clone_color: redis:7 allocation score on galera-1: -INFINITY
+clone_color: redis:7 allocation score on galera-2: -INFINITY
+clone_color: redis:7 allocation score on messaging-0: -INFINITY
+clone_color: redis:7 allocation score on messaging-1: -INFINITY
+clone_color: redis:7 allocation score on messaging-2: -INFINITY
+clone_color: redis:8 allocation score on controller-0: 0
+clone_color: redis:8 allocation score on controller-1: 0
+clone_color: redis:8 allocation score on controller-2: 0
+clone_color: redis:8 allocation score on galera-0: -INFINITY
+clone_color: redis:8 allocation score on galera-1: -INFINITY
+clone_color: redis:8 allocation score on galera-2: -INFINITY
+clone_color: redis:8 allocation score on messaging-0: -INFINITY
+clone_color: redis:8 allocation score on messaging-1: -INFINITY
+clone_color: redis:8 allocation score on messaging-2: -INFINITY
+galera:0 promotion score on galera-1: 100
+galera:1 promotion score on none: 0
+galera:2 promotion score on none: 0
+galera:3 promotion score on none: 0
+galera:4 promotion score on none: 0
+galera:5 promotion score on none: 0
+galera:6 promotion score on none: 0
+galera:7 promotion score on none: 0
+galera:8 promotion score on none: 0
+native_color: galera-0 allocation score on controller-0: -INFINITY
+native_color: galera-0 allocation score on controller-1: INFINITY
+native_color: galera-0 allocation score on controller-2: -INFINITY
+native_color: galera-0 allocation score on galera-0: -INFINITY
+native_color: galera-0 allocation score on galera-1: -INFINITY
+native_color: galera-0 allocation score on galera-2: -INFINITY
+native_color: galera-0 allocation score on messaging-0: -INFINITY
+native_color: galera-0 allocation score on messaging-1: -INFINITY
+native_color: galera-0 allocation score on messaging-2: -INFINITY
+native_color: galera-1 allocation score on controller-0: INFINITY
+native_color: galera-1 allocation score on controller-1: 0
+native_color: galera-1 allocation score on controller-2: 0
+native_color: galera-1 allocation score on galera-0: -INFINITY
+native_color: galera-1 allocation score on galera-1: -INFINITY
+native_color: galera-1 allocation score on galera-2: -INFINITY
+native_color: galera-1 allocation score on messaging-0: -INFINITY
+native_color: galera-1 allocation score on messaging-1: -INFINITY
+native_color: galera-1 allocation score on messaging-2: -INFINITY
+native_color: galera-2 allocation score on controller-0: -INFINITY
+native_color: galera-2 allocation score on controller-1: INFINITY
+native_color: galera-2 allocation score on controller-2: -INFINITY
+native_color: galera-2 allocation score on galera-0: -INFINITY
+native_color: galera-2 allocation score on galera-1: -INFINITY
+native_color: galera-2 allocation score on galera-2: -INFINITY
+native_color: galera-2 allocation score on messaging-0: -INFINITY
+native_color: galera-2 allocation score on messaging-1: -INFINITY
+native_color: galera-2 allocation score on messaging-2: -INFINITY
+native_color: galera:0 allocation score on controller-0: -INFINITY
+native_color: galera:0 allocation score on controller-1: -INFINITY
+native_color: galera:0 allocation score on controller-2: -INFINITY
+native_color: galera:0 allocation score on galera-0: -INFINITY
+native_color: galera:0 allocation score on galera-1: INFINITY
+native_color: galera:0 allocation score on galera-2: -INFINITY
+native_color: galera:0 allocation score on messaging-0: -INFINITY
+native_color: galera:0 allocation score on messaging-1: -INFINITY
+native_color: galera:0 allocation score on messaging-2: -INFINITY
+native_color: galera:1 allocation score on controller-0: -INFINITY
+native_color: galera:1 allocation score on controller-1: -INFINITY
+native_color: galera:1 allocation score on controller-2: -INFINITY
+native_color: galera:1 allocation score on galera-0: -INFINITY
+native_color: galera:1 allocation score on galera-1: -INFINITY
+native_color: galera:1 allocation score on galera-2: -INFINITY
+native_color: galera:1 allocation score on messaging-0: -INFINITY
+native_color: galera:1 allocation score on messaging-1: -INFINITY
+native_color: galera:1 allocation score on messaging-2: -INFINITY
+native_color: galera:2 allocation score on controller-0: -INFINITY
+native_color: galera:2 allocation score on controller-1: -INFINITY
+native_color: galera:2 allocation score on controller-2: -INFINITY
+native_color: galera:2 allocation score on galera-0: -INFINITY
+native_color: galera:2 allocation score on galera-1: -INFINITY
+native_color: galera:2 allocation score on galera-2: -INFINITY
+native_color: galera:2 allocation score on messaging-0: -INFINITY
+native_color: galera:2 allocation score on messaging-1: -INFINITY
+native_color: galera:2 allocation score on messaging-2: -INFINITY
+native_color: galera:3 allocation score on controller-0: -INFINITY
+native_color: galera:3 allocation score on controller-1: -INFINITY
+native_color: galera:3 allocation score on controller-2: -INFINITY
+native_color: galera:3 allocation score on galera-0: -INFINITY
+native_color: galera:3 allocation score on galera-1: -INFINITY
+native_color: galera:3 allocation score on galera-2: -INFINITY
+native_color: galera:3 allocation score on messaging-0: -INFINITY
+native_color: galera:3 allocation score on messaging-1: -INFINITY
+native_color: galera:3 allocation score on messaging-2: -INFINITY
+native_color: galera:4 allocation score on controller-0: -INFINITY
+native_color: galera:4 allocation score on controller-1: -INFINITY
+native_color: galera:4 allocation score on controller-2: -INFINITY
+native_color: galera:4 allocation score on galera-0: -INFINITY
+native_color: galera:4 allocation score on galera-1: -INFINITY
+native_color: galera:4 allocation score on galera-2: -INFINITY
+native_color: galera:4 allocation score on messaging-0: -INFINITY
+native_color: galera:4 allocation score on messaging-1: -INFINITY
+native_color: galera:4 allocation score on messaging-2: -INFINITY
+native_color: galera:5 allocation score on controller-0: -INFINITY
+native_color: galera:5 allocation score on controller-1: -INFINITY
+native_color: galera:5 allocation score on controller-2: -INFINITY
+native_color: galera:5 allocation score on galera-0: -INFINITY
+native_color: galera:5 allocation score on galera-1: -INFINITY
+native_color: galera:5 allocation score on galera-2: -INFINITY
+native_color: galera:5 allocation score on messaging-0: -INFINITY
+native_color: galera:5 allocation score on messaging-1: -INFINITY
+native_color: galera:5 allocation score on messaging-2: -INFINITY
+native_color: galera:6 allocation score on controller-0: -INFINITY
+native_color: galera:6 allocation score on controller-1: -INFINITY
+native_color: galera:6 allocation score on controller-2: -INFINITY
+native_color: galera:6 allocation score on galera-0: -INFINITY
+native_color: galera:6 allocation score on galera-1: -INFINITY
+native_color: galera:6 allocation score on galera-2: -INFINITY
+native_color: galera:6 allocation score on messaging-0: -INFINITY
+native_color: galera:6 allocation score on messaging-1: -INFINITY
+native_color: galera:6 allocation score on messaging-2: -INFINITY
+native_color: galera:7 allocation score on controller-0: -INFINITY
+native_color: galera:7 allocation score on controller-1: -INFINITY
+native_color: galera:7 allocation score on controller-2: -INFINITY
+native_color: galera:7 allocation score on galera-0: -INFINITY
+native_color: galera:7 allocation score on galera-1: -INFINITY
+native_color: galera:7 allocation score on galera-2: -INFINITY
+native_color: galera:7 allocation score on messaging-0: -INFINITY
+native_color: galera:7 allocation score on messaging-1: -INFINITY
+native_color: galera:7 allocation score on messaging-2: -INFINITY
+native_color: galera:8 allocation score on controller-0: -INFINITY
+native_color: galera:8 allocation score on controller-1: -INFINITY
+native_color: galera:8 allocation score on controller-2: -INFINITY
+native_color: galera:8 allocation score on galera-0: -INFINITY
+native_color: galera:8 allocation score on galera-1: -INFINITY
+native_color: galera:8 allocation score on galera-2: -INFINITY
+native_color: galera:8 allocation score on messaging-0: -INFINITY
+native_color: galera:8 allocation score on messaging-1: -INFINITY
+native_color: galera:8 allocation score on messaging-2: -INFINITY
+native_color: haproxy:0 allocation score on controller-0: -INFINITY
+native_color: haproxy:0 allocation score on controller-1: -INFINITY
+native_color: haproxy:0 allocation score on controller-2: -INFINITY
+native_color: haproxy:0 allocation score on galera-0: -INFINITY
+native_color: haproxy:0 allocation score on galera-1: -INFINITY
+native_color: haproxy:0 allocation score on galera-2: -INFINITY
+native_color: haproxy:0 allocation score on messaging-0: -INFINITY
+native_color: haproxy:0 allocation score on messaging-1: -INFINITY
+native_color: haproxy:0 allocation score on messaging-2: -INFINITY
+native_color: haproxy:1 allocation score on controller-0: INFINITY
+native_color: haproxy:1 allocation score on controller-1: -INFINITY
+native_color: haproxy:1 allocation score on controller-2: 0
+native_color: haproxy:1 allocation score on galera-0: -INFINITY
+native_color: haproxy:1 allocation score on galera-1: -INFINITY
+native_color: haproxy:1 allocation score on galera-2: -INFINITY
+native_color: haproxy:1 allocation score on messaging-0: -INFINITY
+native_color: haproxy:1 allocation score on messaging-1: -INFINITY
+native_color: haproxy:1 allocation score on messaging-2: -INFINITY
+native_color: haproxy:2 allocation score on controller-0: -INFINITY
+native_color: haproxy:2 allocation score on controller-1: -INFINITY
+native_color: haproxy:2 allocation score on controller-2: INFINITY
+native_color: haproxy:2 allocation score on galera-0: -INFINITY
+native_color: haproxy:2 allocation score on galera-1: -INFINITY
+native_color: haproxy:2 allocation score on galera-2: -INFINITY
+native_color: haproxy:2 allocation score on messaging-0: -INFINITY
+native_color: haproxy:2 allocation score on messaging-1: -INFINITY
+native_color: haproxy:2 allocation score on messaging-2: -INFINITY
+native_color: haproxy:3 allocation score on controller-0: -INFINITY
+native_color: haproxy:3 allocation score on controller-1: -INFINITY
+native_color: haproxy:3 allocation score on controller-2: -INFINITY
+native_color: haproxy:3 allocation score on galera-0: -INFINITY
+native_color: haproxy:3 allocation score on galera-1: -INFINITY
+native_color: haproxy:3 allocation score on galera-2: -INFINITY
+native_color: haproxy:3 allocation score on messaging-0: -INFINITY
+native_color: haproxy:3 allocation score on messaging-1: -INFINITY
+native_color: haproxy:3 allocation score on messaging-2: -INFINITY
+native_color: haproxy:4 allocation score on controller-0: -INFINITY
+native_color: haproxy:4 allocation score on controller-1: -INFINITY
+native_color: haproxy:4 allocation score on controller-2: -INFINITY
+native_color: haproxy:4 allocation score on galera-0: -INFINITY
+native_color: haproxy:4 allocation score on galera-1: -INFINITY
+native_color: haproxy:4 allocation score on galera-2: -INFINITY
+native_color: haproxy:4 allocation score on messaging-0: -INFINITY
+native_color: haproxy:4 allocation score on messaging-1: -INFINITY
+native_color: haproxy:4 allocation score on messaging-2: -INFINITY
+native_color: haproxy:5 allocation score on controller-0: -INFINITY
+native_color: haproxy:5 allocation score on controller-1: -INFINITY
+native_color: haproxy:5 allocation score on controller-2: -INFINITY
+native_color: haproxy:5 allocation score on galera-0: -INFINITY
+native_color: haproxy:5 allocation score on galera-1: -INFINITY
+native_color: haproxy:5 allocation score on galera-2: -INFINITY
+native_color: haproxy:5 allocation score on messaging-0: -INFINITY
+native_color: haproxy:5 allocation score on messaging-1: -INFINITY
+native_color: haproxy:5 allocation score on messaging-2: -INFINITY
+native_color: haproxy:6 allocation score on controller-0: -INFINITY
+native_color: haproxy:6 allocation score on controller-1: -INFINITY
+native_color: haproxy:6 allocation score on controller-2: -INFINITY
+native_color: haproxy:6 allocation score on galera-0: -INFINITY
+native_color: haproxy:6 allocation score on galera-1: -INFINITY
+native_color: haproxy:6 allocation score on galera-2: -INFINITY
+native_color: haproxy:6 allocation score on messaging-0: -INFINITY
+native_color: haproxy:6 allocation score on messaging-1: -INFINITY
+native_color: haproxy:6 allocation score on messaging-2: -INFINITY
+native_color: haproxy:7 allocation score on controller-0: -INFINITY
+native_color: haproxy:7 allocation score on controller-1: -INFINITY
+native_color: haproxy:7 allocation score on controller-2: -INFINITY
+native_color: haproxy:7 allocation score on galera-0: -INFINITY
+native_color: haproxy:7 allocation score on galera-1: -INFINITY
+native_color: haproxy:7 allocation score on galera-2: -INFINITY
+native_color: haproxy:7 allocation score on messaging-0: -INFINITY
+native_color: haproxy:7 allocation score on messaging-1: -INFINITY
+native_color: haproxy:7 allocation score on messaging-2: -INFINITY
+native_color: haproxy:8 allocation score on controller-0: -INFINITY
+native_color: haproxy:8 allocation score on controller-1: -INFINITY
+native_color: haproxy:8 allocation score on controller-2: -INFINITY
+native_color: haproxy:8 allocation score on galera-0: -INFINITY
+native_color: haproxy:8 allocation score on galera-1: -INFINITY
+native_color: haproxy:8 allocation score on galera-2: -INFINITY
+native_color: haproxy:8 allocation score on messaging-0: -INFINITY
+native_color: haproxy:8 allocation score on messaging-1: -INFINITY
+native_color: haproxy:8 allocation score on messaging-2: -INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-0: INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-2: 0
+native_color: ip-10.0.0.102 allocation score on galera-0: -INFINITY
+native_color: ip-10.0.0.102 allocation score on galera-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on galera-2: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-0: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.1.14 allocation score on controller-0: 0
+native_color: ip-172.17.1.14 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on controller-2: 0
+native_color: ip-172.17.1.14 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.1.14 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.1.17 allocation score on controller-0: 0
+native_color: ip-172.17.1.17 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on controller-2: 0
+native_color: ip-172.17.1.17 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.1.17 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-0: INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-2: 0
+native_color: ip-172.17.3.15 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.3.15 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.4.11 allocation score on controller-0: 0
+native_color: ip-172.17.4.11 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on controller-2: 0
+native_color: ip-172.17.4.11 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.4.11 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-2: -INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-0: INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-2: 0
+native_color: ip-192.168.24.6 allocation score on galera-0: -INFINITY
+native_color: ip-192.168.24.6 allocation score on galera-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on galera-2: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-0: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-2: -INFINITY
+native_color: messaging-0 allocation score on controller-0: INFINITY
+native_color: messaging-0 allocation score on controller-1: 0
+native_color: messaging-0 allocation score on controller-2: 0
+native_color: messaging-0 allocation score on galera-0: -INFINITY
+native_color: messaging-0 allocation score on galera-1: -INFINITY
+native_color: messaging-0 allocation score on galera-2: -INFINITY
+native_color: messaging-0 allocation score on messaging-0: -INFINITY
+native_color: messaging-0 allocation score on messaging-1: -INFINITY
+native_color: messaging-0 allocation score on messaging-2: -INFINITY
+native_color: messaging-1 allocation score on controller-0: -INFINITY
+native_color: messaging-1 allocation score on controller-1: INFINITY
+native_color: messaging-1 allocation score on controller-2: -INFINITY
+native_color: messaging-1 allocation score on galera-0: -INFINITY
+native_color: messaging-1 allocation score on galera-1: -INFINITY
+native_color: messaging-1 allocation score on galera-2: -INFINITY
+native_color: messaging-1 allocation score on messaging-0: -INFINITY
+native_color: messaging-1 allocation score on messaging-1: -INFINITY
+native_color: messaging-1 allocation score on messaging-2: -INFINITY
+native_color: messaging-2 allocation score on controller-0: INFINITY
+native_color: messaging-2 allocation score on controller-1: 0
+native_color: messaging-2 allocation score on controller-2: 0
+native_color: messaging-2 allocation score on galera-0: -INFINITY
+native_color: messaging-2 allocation score on galera-1: -INFINITY
+native_color: messaging-2 allocation score on galera-2: -INFINITY
+native_color: messaging-2 allocation score on messaging-0: -INFINITY
+native_color: messaging-2 allocation score on messaging-1: -INFINITY
+native_color: messaging-2 allocation score on messaging-2: -INFINITY
+native_color: openstack-cinder-volume allocation score on controller-0: INFINITY
+native_color: openstack-cinder-volume allocation score on controller-1: 0
+native_color: openstack-cinder-volume allocation score on controller-2: 0
+native_color: openstack-cinder-volume allocation score on galera-0: -INFINITY
+native_color: openstack-cinder-volume allocation score on galera-1: -INFINITY
+native_color: openstack-cinder-volume allocation score on galera-2: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-0: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-1: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:0 allocation score on messaging-0: 0
+native_color: rabbitmq:0 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:0 allocation score on messaging-2: INFINITY
+native_color: rabbitmq:1 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:1 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:1 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:1 allocation score on messaging-0: INFINITY
+native_color: rabbitmq:1 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:1 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:2 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:2 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:2 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-2: -INFINITY
+native_color: redis:0 allocation score on controller-0: -INFINITY
+native_color: redis:0 allocation score on controller-1: -INFINITY
+native_color: redis:0 allocation score on controller-2: -INFINITY
+native_color: redis:0 allocation score on galera-0: -INFINITY
+native_color: redis:0 allocation score on galera-1: -INFINITY
+native_color: redis:0 allocation score on galera-2: -INFINITY
+native_color: redis:0 allocation score on messaging-0: -INFINITY
+native_color: redis:0 allocation score on messaging-1: -INFINITY
+native_color: redis:0 allocation score on messaging-2: -INFINITY
+native_color: redis:1 allocation score on controller-0: INFINITY
+native_color: redis:1 allocation score on controller-1: -INFINITY
+native_color: redis:1 allocation score on controller-2: 0
+native_color: redis:1 allocation score on galera-0: -INFINITY
+native_color: redis:1 allocation score on galera-1: -INFINITY
+native_color: redis:1 allocation score on galera-2: -INFINITY
+native_color: redis:1 allocation score on messaging-0: -INFINITY
+native_color: redis:1 allocation score on messaging-1: -INFINITY
+native_color: redis:1 allocation score on messaging-2: -INFINITY
+native_color: redis:2 allocation score on controller-0: -INFINITY
+native_color: redis:2 allocation score on controller-1: -INFINITY
+native_color: redis:2 allocation score on controller-2: INFINITY
+native_color: redis:2 allocation score on galera-0: -INFINITY
+native_color: redis:2 allocation score on galera-1: -INFINITY
+native_color: redis:2 allocation score on galera-2: -INFINITY
+native_color: redis:2 allocation score on messaging-0: -INFINITY
+native_color: redis:2 allocation score on messaging-1: -INFINITY
+native_color: redis:2 allocation score on messaging-2: -INFINITY
+native_color: redis:3 allocation score on controller-0: -INFINITY
+native_color: redis:3 allocation score on controller-1: -INFINITY
+native_color: redis:3 allocation score on controller-2: -INFINITY
+native_color: redis:3 allocation score on galera-0: -INFINITY
+native_color: redis:3 allocation score on galera-1: -INFINITY
+native_color: redis:3 allocation score on galera-2: -INFINITY
+native_color: redis:3 allocation score on messaging-0: -INFINITY
+native_color: redis:3 allocation score on messaging-1: -INFINITY
+native_color: redis:3 allocation score on messaging-2: -INFINITY
+native_color: redis:4 allocation score on controller-0: -INFINITY
+native_color: redis:4 allocation score on controller-1: -INFINITY
+native_color: redis:4 allocation score on controller-2: -INFINITY
+native_color: redis:4 allocation score on galera-0: -INFINITY
+native_color: redis:4 allocation score on galera-1: -INFINITY
+native_color: redis:4 allocation score on galera-2: -INFINITY
+native_color: redis:4 allocation score on messaging-0: -INFINITY
+native_color: redis:4 allocation score on messaging-1: -INFINITY
+native_color: redis:4 allocation score on messaging-2: -INFINITY
+native_color: redis:5 allocation score on controller-0: -INFINITY
+native_color: redis:5 allocation score on controller-1: -INFINITY
+native_color: redis:5 allocation score on controller-2: -INFINITY
+native_color: redis:5 allocation score on galera-0: -INFINITY
+native_color: redis:5 allocation score on galera-1: -INFINITY
+native_color: redis:5 allocation score on galera-2: -INFINITY
+native_color: redis:5 allocation score on messaging-0: -INFINITY
+native_color: redis:5 allocation score on messaging-1: -INFINITY
+native_color: redis:5 allocation score on messaging-2: -INFINITY
+native_color: redis:6 allocation score on controller-0: -INFINITY
+native_color: redis:6 allocation score on controller-1: -INFINITY
+native_color: redis:6 allocation score on controller-2: -INFINITY
+native_color: redis:6 allocation score on galera-0: -INFINITY
+native_color: redis:6 allocation score on galera-1: -INFINITY
+native_color: redis:6 allocation score on galera-2: -INFINITY
+native_color: redis:6 allocation score on messaging-0: -INFINITY
+native_color: redis:6 allocation score on messaging-1: -INFINITY
+native_color: redis:6 allocation score on messaging-2: -INFINITY
+native_color: redis:7 allocation score on controller-0: -INFINITY
+native_color: redis:7 allocation score on controller-1: -INFINITY
+native_color: redis:7 allocation score on controller-2: -INFINITY
+native_color: redis:7 allocation score on galera-0: -INFINITY
+native_color: redis:7 allocation score on galera-1: -INFINITY
+native_color: redis:7 allocation score on galera-2: -INFINITY
+native_color: redis:7 allocation score on messaging-0: -INFINITY
+native_color: redis:7 allocation score on messaging-1: -INFINITY
+native_color: redis:7 allocation score on messaging-2: -INFINITY
+native_color: redis:8 allocation score on controller-0: -INFINITY
+native_color: redis:8 allocation score on controller-1: -INFINITY
+native_color: redis:8 allocation score on controller-2: -INFINITY
+native_color: redis:8 allocation score on galera-0: -INFINITY
+native_color: redis:8 allocation score on galera-1: -INFINITY
+native_color: redis:8 allocation score on galera-2: -INFINITY
+native_color: redis:8 allocation score on messaging-0: -INFINITY
+native_color: redis:8 allocation score on messaging-1: -INFINITY
+native_color: redis:8 allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-1: INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-2: 0
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-0: INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-2: 0
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-0: INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-1: 0
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-2: -INFINITY
+redis:0 promotion score on none: 0
+redis:1 promotion score on controller-0: 1
+redis:2 promotion score on controller-2: 1
+redis:3 promotion score on none: 0
+redis:4 promotion score on none: 0
+redis:5 promotion score on none: 0
+redis:6 promotion score on none: 0
+redis:7 promotion score on none: 0
+redis:8 promotion score on none: 0
diff --git a/pengine/test10/remote-recover-all.summary b/pengine/test10/remote-recover-all.summary
new file mode 100644
index 0000000..387c7f3
--- /dev/null
+++ b/pengine/test10/remote-recover-all.summary
@@ -0,0 +1,152 @@
+Using the original execution date of: 2017-05-03 13:33:24Z
+
+Current cluster status:
+Node controller-1 (2): UNCLEAN (offline)
+Online: [ controller-0 controller-2 ]
+RemoteOnline: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+
+ messaging-0	(ocf::pacemaker:remote):	Started controller-0
+ messaging-1	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ messaging-2	(ocf::pacemaker:remote):	Started controller-0
+ galera-0	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ galera-1	(ocf::pacemaker:remote):	Started controller-0
+ galera-2	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ Clone Set: rabbitmq-clone [rabbitmq]
+     Started: [ messaging-0 messaging-1 messaging-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 ]
+ Master/Slave Set: galera-master [galera]
+     Masters: [ galera-0 galera-1 galera-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 messaging-0 messaging-1 messaging-2 ]
+ Master/Slave Set: redis-master [redis]
+     redis	(ocf::heartbeat:redis):	Slave controller-1 (UNCLEAN)
+     Masters: [ controller-0 ]
+     Slaves: [ controller-2 ]
+     Stopped: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ ip-192.168.24.6	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-10.0.0.102	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.1.14	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ ip-172.17.1.17	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ ip-172.17.3.15	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.4.11	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ Clone Set: haproxy-clone [haproxy]
+     haproxy	(systemd:haproxy):	Started controller-1 (UNCLEAN)
+     Started: [ controller-0 controller-2 ]
+     Stopped: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ openstack-cinder-volume	(systemd:openstack-cinder-volume):	Started controller-0
+ stonith-fence_ipmilan-525400bbf613	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-525400b4f6bd	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-5254005bdbb5	(stonith:fence_ipmilan):	Started controller-1 (UNCLEAN)
+
+Transition Summary:
+ * Stop    messaging-1	(controller-1)
+ * Stop    galera-0	(controller-1)
+ * Stop    galera-2	(controller-1)
+ * Stop    rabbitmq:2	(messaging-1)
+ * Demote  galera:1	(Master -> Stopped galera-2)
+ * Demote  galera:2	(Master -> Stopped galera-0)
+ * Stop    redis:0	(controller-1)
+ * Move    ip-172.17.1.14	(Started controller-1 -> controller-2)
+ * Move    ip-172.17.1.17	(Started controller-1 -> controller-2)
+ * Move    ip-172.17.4.11	(Started controller-1 -> controller-2)
+ * Stop    haproxy:0	(controller-1)
+ * Restart stonith-fence_ipmilan-525400bbf613	(Started controller-0)
+ * Restart stonith-fence_ipmilan-525400b4f6bd	(Started controller-0)
+ * Move    stonith-fence_ipmilan-5254005bdbb5	(Started controller-1 -> controller-2)
+
+Executing cluster transition:
+ * Pseudo action:   galera-master_demote_0
+ * Pseudo action:   redis-master_pre_notify_stop_0
+ * Resource action: stonith-fence_ipmilan-525400bbf613 stop on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd stop on controller-0
+ * Pseudo action:   stonith-fence_ipmilan-5254005bdbb5_stop_0
+ * Fencing controller-1 (reboot)
+ * Pseudo action:   redis_post_notify_stop_0
+ * Resource action: redis           notify on controller-0
+ * Resource action: redis           notify on controller-2
+ * Pseudo action:   redis-master_confirmed-pre_notify_stop_0
+ * Pseudo action:   redis-master_stop_0
+ * Pseudo action:   haproxy-clone_stop_0
+ * Fencing galera-0 (reboot)
+ * Pseudo action:   galera_demote_0
+ * Pseudo action:   redis_stop_0
+ * Pseudo action:   redis-master_stopped_0
+ * Pseudo action:   haproxy_stop_0
+ * Pseudo action:   haproxy-clone_stopped_0
+ * Fencing galera-2 (reboot)
+ * Pseudo action:   galera_demote_0
+ * Pseudo action:   galera-master_demoted_0
+ * Pseudo action:   galera-master_stop_0
+ * Pseudo action:   redis-master_post_notify_stopped_0
+ * Pseudo action:   ip-172.17.1.14_stop_0
+ * Pseudo action:   ip-172.17.1.17_stop_0
+ * Pseudo action:   ip-172.17.4.11_stop_0
+ * Fencing messaging-1 (reboot)
+ * Pseudo action:   stonith_complete
+ * Pseudo action:   rabbitmq_post_notify_stop_0
+ * Pseudo action:   rabbitmq-clone_stop_0
+ * Pseudo action:   galera_stop_0
+ * Resource action: redis           notify on controller-0
+ * Resource action: redis           notify on controller-2
+ * Pseudo action:   redis-master_confirmed-post_notify_stopped_0
+ * Resource action: ip-172.17.1.14  start on controller-2
+ * Resource action: ip-172.17.1.17  start on controller-2
+ * Resource action: ip-172.17.4.11  start on controller-2
+ * Pseudo action:   galera-0_stop_0
+ * Resource action: rabbitmq        notify on messaging-2
+ * Resource action: rabbitmq        notify on messaging-0
+ * Pseudo action:   rabbitmq_notified_0
+ * Pseudo action:   rabbitmq_stop_0
+ * Pseudo action:   rabbitmq-clone_stopped_0
+ * Pseudo action:   galera_stop_0
+ * Pseudo action:   galera-master_stopped_0
+ * Pseudo action:   redis_notified_0
+ * Resource action: ip-172.17.1.14  monitor=10000 on controller-2
+ * Resource action: ip-172.17.1.17  monitor=10000 on controller-2
+ * Resource action: ip-172.17.4.11  monitor=10000 on controller-2
+ * Pseudo action:   messaging-1_stop_0
+ * Pseudo action:   galera-2_stop_0
+ * Pseudo action:   all_stopped
+ * Resource action: stonith-fence_ipmilan-525400bbf613 start on controller-0
+ * Resource action: stonith-fence_ipmilan-525400bbf613 monitor=60000 on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd start on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd monitor=60000 on controller-0
+ * Resource action: stonith-fence_ipmilan-5254005bdbb5 start on controller-2
+ * Resource action: stonith-fence_ipmilan-5254005bdbb5 monitor=60000 on controller-2
+Using the original execution date of: 2017-05-03 13:33:24Z
+
+Revised cluster status:
+Online: [ controller-0 controller-2 ]
+OFFLINE: [ controller-1 ]
+RemoteOnline: [ galera-1 messaging-0 messaging-2 ]
+RemoteOFFLINE: [ galera-0 galera-2 messaging-1 ]
+
+ messaging-0	(ocf::pacemaker:remote):	Started controller-0
+ messaging-1	(ocf::pacemaker:remote):	Stopped
+ messaging-2	(ocf::pacemaker:remote):	Started controller-0
+ galera-0	(ocf::pacemaker:remote):	Stopped
+ galera-1	(ocf::pacemaker:remote):	Started controller-0
+ galera-2	(ocf::pacemaker:remote):	Stopped
+ Clone Set: rabbitmq-clone [rabbitmq]
+     Started: [ messaging-0 messaging-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-1 ]
+ Master/Slave Set: galera-master [galera]
+     Masters: [ galera-1 ]
+     Stopped: [ controller-0 controller-1 controller-2 galera-0 galera-2 messaging-0 messaging-1 messaging-2 ]
+ Master/Slave Set: redis-master [redis]
+     Masters: [ controller-0 ]
+     Slaves: [ controller-2 ]
+     Stopped: [ controller-1 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ ip-192.168.24.6	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-10.0.0.102	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.1.14	(ocf::heartbeat:IPaddr2):	Started controller-2
+ ip-172.17.1.17	(ocf::heartbeat:IPaddr2):	Started controller-2
+ ip-172.17.3.15	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.4.11	(ocf::heartbeat:IPaddr2):	Started controller-2
+ Clone Set: haproxy-clone [haproxy]
+     Started: [ controller-0 controller-2 ]
+     Stopped: [ controller-1 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ openstack-cinder-volume	(systemd:openstack-cinder-volume):	Started controller-0
+ stonith-fence_ipmilan-525400bbf613	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-525400b4f6bd	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-5254005bdbb5	(stonith:fence_ipmilan):	Started controller-2
+
diff --git a/pengine/test10/remote-recover-all.xml b/pengine/test10/remote-recover-all.xml
new file mode 100644
index 0000000..24fa469
--- /dev/null
+++ b/pengine/test10/remote-recover-all.xml
@@ -0,0 +1,745 @@
+<cib crm_feature_set="3.0.10" validate-with="pacemaker-2.5" epoch="183" num_updates="0" admin_epoch="0" cib-last-written="Wed May  3 13:24:28 2017" update-origin="controller-0" update-client="crm_attribute" update-user="root" have-quorum="1" dc-uuid="1" execution-date="1493818404">
+  <configuration>
+    <crm_config>
+      <cluster_property_set id="cib-bootstrap-options">
+        <nvpair id="cib-bootstrap-options-have-watchdog" name="have-watchdog" value="false"/>
+        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.15-11.el7_3.4-e174ec8"/>
+        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="corosync"/>
+        <nvpair id="cib-bootstrap-options-cluster-name" name="cluster-name" value="tripleo_cluster"/>
+        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="true"/>
+        <nvpair id="cib-bootstrap-options-cluster-recheck-interval" name="cluster-recheck-interval" value="60s"/>
+        <nvpair id="cib-bootstrap-options-maintenance-mode" name="maintenance-mode" value="false"/>
+        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1493817755"/>
+      </cluster_property_set>
+      <cluster_property_set id="redis_replication">
+        <nvpair id="redis_replication-redis_REPL_INFO" name="redis_REPL_INFO" value="controller-0"/>
+      </cluster_property_set>
+    </crm_config>
+    <nodes>
+      <node id="1" uname="controller-0">
+        <instance_attributes id="nodes-1">
+          <nvpair id="nodes-1-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-1-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-1-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="2" uname="controller-1">
+        <instance_attributes id="nodes-2">
+          <nvpair id="nodes-2-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-2-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-2-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="3" uname="controller-2">
+        <instance_attributes id="nodes-3">
+          <nvpair id="nodes-3-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-3-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-3-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-1" type="remote" uname="messaging-1">
+        <instance_attributes id="nodes-messaging-1">
+          <nvpair id="nodes-messaging-1-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-1-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-1"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-1" type="remote" uname="galera-1">
+        <instance_attributes id="nodes-galera-1">
+          <nvpair id="nodes-galera-1-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-0" type="remote" uname="messaging-0">
+        <instance_attributes id="nodes-messaging-0">
+          <nvpair id="nodes-messaging-0-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-0-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-0"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-2" type="remote" uname="galera-2">
+        <instance_attributes id="nodes-galera-2">
+          <nvpair id="nodes-galera-2-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-2" type="remote" uname="messaging-2">
+        <instance_attributes id="nodes-messaging-2">
+          <nvpair id="nodes-messaging-2-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-2-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-2"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-0" type="remote" uname="galera-0">
+        <instance_attributes id="nodes-galera-0">
+          <nvpair id="nodes-galera-0-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+    </nodes>
+    <resources>
+      <primitive class="ocf" id="messaging-0" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-0-instance_attributes">
+          <nvpair id="messaging-0-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-0-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-0-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-0-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="messaging-1" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-1-instance_attributes">
+          <nvpair id="messaging-1-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-1-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-1-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-1-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="messaging-2" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-2-instance_attributes">
+          <nvpair id="messaging-2-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-2-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-2-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-2-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-0" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-0-instance_attributes">
+          <nvpair id="galera-0-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-0-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-0-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-0-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-1" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-1-instance_attributes">
+          <nvpair id="galera-1-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-1-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-1-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-1-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-2" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-2-instance_attributes">
+          <nvpair id="galera-2-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-2-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-2-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-2-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <clone id="rabbitmq-clone">
+        <primitive class="ocf" id="rabbitmq" provider="heartbeat" type="rabbitmq-cluster">
+          <instance_attributes id="rabbitmq-instance_attributes">
+            <nvpair id="rabbitmq-instance_attributes-set_policy" name="set_policy" value="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+          </instance_attributes>
+          <meta_attributes id="rabbitmq-meta_attributes">
+            <nvpair id="rabbitmq-meta_attributes-notify" name="notify" value="true"/>
+          </meta_attributes>
+          <operations>
+            <op id="rabbitmq-monitor-interval-10" interval="10" name="monitor" timeout="40"/>
+            <op id="rabbitmq-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="rabbitmq-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="rabbitmq-clone-meta_attributes">
+          <nvpair id="rabbitmq-clone-meta_attributes-interleave" name="interleave" value="true"/>
+          <nvpair id="rabbitmq-clone-meta_attributes-ordered" name="ordered" value="true"/>
+        </meta_attributes>
+      </clone>
+      <master id="galera-master">
+        <primitive class="ocf" id="galera" provider="heartbeat" type="galera">
+          <instance_attributes id="galera-instance_attributes">
+            <nvpair id="galera-instance_attributes-additional_parameters" name="additional_parameters" value="--open-files-limit=16384"/>
+            <nvpair id="galera-instance_attributes-enable_creation" name="enable_creation" value="true"/>
+            <nvpair id="galera-instance_attributes-wsrep_cluster_address" name="wsrep_cluster_address" value="gcomm://galera-0,galera-1,galera-2"/>
+          </instance_attributes>
+          <operations>
+            <op id="galera-start-interval-0s" interval="0s" name="start" timeout="120"/>
+            <op id="galera-stop-interval-0s" interval="0s" name="stop" timeout="120"/>
+            <op id="galera-monitor-interval-20" interval="20" name="monitor" timeout="30"/>
+            <op id="galera-monitor-interval-10" interval="10" name="monitor" role="Master" timeout="30"/>
+            <op id="galera-monitor-interval-30" interval="30" name="monitor" role="Slave" timeout="30"/>
+            <op id="galera-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="galera-promote-interval-0s" interval="0s" name="promote" on-fail="block" timeout="300s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="galera-master-meta_attributes">
+          <nvpair id="galera-master-meta_attributes-ordered" name="ordered" value="true"/>
+          <nvpair id="galera-master-meta_attributes-master-max" name="master-max" value="3"/>
+        </meta_attributes>
+      </master>
+      <master id="redis-master">
+        <primitive class="ocf" id="redis" provider="heartbeat" type="redis">
+          <instance_attributes id="redis-instance_attributes">
+            <nvpair id="redis-instance_attributes-wait_last_known_master" name="wait_last_known_master" value="true"/>
+          </instance_attributes>
+          <operations>
+            <op id="redis-monitor-interval-45" interval="45" name="monitor" timeout="60"/>
+            <op id="redis-monitor-interval-20" interval="20" name="monitor" role="Master" timeout="60"/>
+            <op id="redis-monitor-interval-60" interval="60" name="monitor" role="Slave" timeout="60"/>
+            <op id="redis-promote-interval-0s" interval="0s" name="promote" timeout="120"/>
+            <op id="redis-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="redis-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="redis-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="redis-master-meta_attributes">
+          <nvpair id="redis-master-meta_attributes-interleave" name="interleave" value="true"/>
+          <nvpair id="redis-master-meta_attributes-ordered" name="ordered" value="true"/>
+          <nvpair id="redis-master-meta_attributes-notify" name="notify" value="true"/>
+        </meta_attributes>
+      </master>
+      <primitive class="ocf" id="ip-192.168.24.6" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-192.168.24.6-instance_attributes">
+          <nvpair id="ip-192.168.24.6-instance_attributes-ip" name="ip" value="192.168.24.6"/>
+          <nvpair id="ip-192.168.24.6-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-192.168.24.6-meta_attributes"/>
+        <operations>
+          <op id="ip-192.168.24.6-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-192.168.24.6-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-192.168.24.6-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-10.0.0.102" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-10.0.0.102-instance_attributes">
+          <nvpair id="ip-10.0.0.102-instance_attributes-ip" name="ip" value="10.0.0.102"/>
+          <nvpair id="ip-10.0.0.102-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-10.0.0.102-meta_attributes"/>
+        <operations>
+          <op id="ip-10.0.0.102-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-10.0.0.102-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-10.0.0.102-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.1.14" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.1.14-instance_attributes">
+          <nvpair id="ip-172.17.1.14-instance_attributes-ip" name="ip" value="172.17.1.14"/>
+          <nvpair id="ip-172.17.1.14-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.1.14-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.1.14-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.1.14-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.1.14-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.1.17" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.1.17-instance_attributes">
+          <nvpair id="ip-172.17.1.17-instance_attributes-ip" name="ip" value="172.17.1.17"/>
+          <nvpair id="ip-172.17.1.17-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.1.17-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.1.17-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.1.17-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.1.17-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.3.15" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.3.15-instance_attributes">
+          <nvpair id="ip-172.17.3.15-instance_attributes-ip" name="ip" value="172.17.3.15"/>
+          <nvpair id="ip-172.17.3.15-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.3.15-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.3.15-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.3.15-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.3.15-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.4.11" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.4.11-instance_attributes">
+          <nvpair id="ip-172.17.4.11-instance_attributes-ip" name="ip" value="172.17.4.11"/>
+          <nvpair id="ip-172.17.4.11-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.4.11-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.4.11-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.4.11-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.4.11-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <clone id="haproxy-clone">
+        <primitive class="systemd" id="haproxy" type="haproxy">
+          <instance_attributes id="haproxy-instance_attributes"/>
+          <meta_attributes id="haproxy-meta_attributes"/>
+          <operations>
+            <op id="haproxy-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="haproxy-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+            <op id="haproxy-monitor-interval-60s" interval="60s" name="monitor"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="haproxy-clone-meta_attributes"/>
+      </clone>
+      <primitive class="systemd" id="openstack-cinder-volume" type="openstack-cinder-volume">
+        <instance_attributes id="openstack-cinder-volume-instance_attributes"/>
+        <meta_attributes id="openstack-cinder-volume-meta_attributes"/>
+        <operations>
+          <op id="openstack-cinder-volume-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+          <op id="openstack-cinder-volume-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          <op id="openstack-cinder-volume-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-525400bbf613-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-2"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-ipport" name="ipport" value="6237"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-525400bbf613-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-525400bbf613-meta_attributes"/>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-1"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-ipport" name="ipport" value="6236"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-525400b4f6bd-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-525400b4f6bd-meta_attributes"/>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-0"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-ipport" name="ipport" value="6235"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-5254005bdbb5-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-5254005bdbb5-meta_attributes"/>
+      </primitive>
+    </resources>
+    <constraints>
+      <rsc_location id="location-rabbitmq-clone" resource-discovery="exclusive" rsc="rabbitmq-clone">
+        <rule id="location-rabbitmq-clone-rule" score="0">
+          <expression attribute="rabbitmq-role" id="location-rabbitmq-clone-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-galera-master" resource-discovery="exclusive" rsc="galera-master">
+        <rule id="location-galera-master-rule" score="0">
+          <expression attribute="galera-role" id="location-galera-master-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-redis-master" resource-discovery="exclusive" rsc="redis-master">
+        <rule id="location-redis-master-rule" score="0">
+          <expression attribute="redis-role" id="location-redis-master-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-192.168.24.6" resource-discovery="exclusive" rsc="ip-192.168.24.6">
+        <rule id="location-ip-192.168.24.6-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-192.168.24.6-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-10.0.0.102" resource-discovery="exclusive" rsc="ip-10.0.0.102">
+        <rule id="location-ip-10.0.0.102-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-10.0.0.102-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.1.14" resource-discovery="exclusive" rsc="ip-172.17.1.14">
+        <rule id="location-ip-172.17.1.14-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.1.14-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.1.17" resource-discovery="exclusive" rsc="ip-172.17.1.17">
+        <rule id="location-ip-172.17.1.17-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.1.17-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.3.15" resource-discovery="exclusive" rsc="ip-172.17.3.15">
+        <rule id="location-ip-172.17.3.15-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.3.15-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.4.11" resource-discovery="exclusive" rsc="ip-172.17.4.11">
+        <rule id="location-ip-172.17.4.11-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.4.11-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-haproxy-clone" resource-discovery="exclusive" rsc="haproxy-clone">
+        <rule id="location-haproxy-clone-rule" score="0">
+          <expression attribute="haproxy-role" id="location-haproxy-clone-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_order first="ip-192.168.24.6" first-action="start" id="order-ip-192.168.24.6-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-192.168.24.6-haproxy-clone-INFINITY" rsc="ip-192.168.24.6" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-10.0.0.102" first-action="start" id="order-ip-10.0.0.102-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-10.0.0.102-haproxy-clone-INFINITY" rsc="ip-10.0.0.102" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.1.14" first-action="start" id="order-ip-172.17.1.14-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.1.14-haproxy-clone-INFINITY" rsc="ip-172.17.1.14" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.1.17" first-action="start" id="order-ip-172.17.1.17-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.1.17-haproxy-clone-INFINITY" rsc="ip-172.17.1.17" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.3.15" first-action="start" id="order-ip-172.17.3.15-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.3.15-haproxy-clone-INFINITY" rsc="ip-172.17.3.15" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.4.11" first-action="start" id="order-ip-172.17.4.11-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.4.11-haproxy-clone-INFINITY" rsc="ip-172.17.4.11" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_location id="location-openstack-cinder-volume" resource-discovery="exclusive" rsc="openstack-cinder-volume">
+        <rule id="location-openstack-cinder-volume-rule" score="0">
+          <expression attribute="cinder-volume-role" id="location-openstack-cinder-volume-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-stonith-fence_ipmilan-525400bbf613-controller-2--INFINITY" node="controller-2" rsc="stonith-fence_ipmilan-525400bbf613" score="-INFINITY"/>
+      <rsc_location id="location-stonith-fence_ipmilan-525400b4f6bd-controller-1--INFINITY" node="controller-1" rsc="stonith-fence_ipmilan-525400b4f6bd" score="-INFINITY"/>
+      <rsc_location id="location-stonith-fence_ipmilan-5254005bdbb5-controller-0--INFINITY" node="controller-0" rsc="stonith-fence_ipmilan-5254005bdbb5" score="-INFINITY"/>
+      <rsc_location id="cli-ban-messaging-1-on-controller-0" rsc="messaging-1" role="Started" node="controller-0" score="-INFINITY"/>
+      <rsc_location id="cli-ban-messaging-1-on-controller-2" rsc="messaging-1" role="Started" node="controller-2" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-0-on-controller-2" rsc="galera-0" role="Started" node="controller-2" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-0-on-controller-0" rsc="galera-0" role="Started" node="controller-0" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-2-on-controller-0" rsc="galera-2" role="Started" node="controller-0" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-2-on-controller-2" rsc="galera-2" role="Started" node="controller-2" score="-INFINITY"/>
+    </constraints>
+    <rsc_defaults>
+      <meta_attributes id="rsc_defaults-options">
+        <nvpair id="rsc_defaults-options-resource-stickiness" name="resource-stickiness" value="INFINITY"/>
+      </meta_attributes>
+    </rsc_defaults>
+  </configuration>
+  <status>
+    <node_state id="2" uname="controller-1" in_ccm="false" crmd="offline" crm-debug-origin="post_cache_update" join="member" expected="member">
+      <lrm id="2">
+        <lrm_resources>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="37:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;37:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="20" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="44" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="138:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;138:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="46" rc-code="0" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="2088" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;119:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="63" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817892" exec-time="1" queue-time="1" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="43:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;43:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="45" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="118:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;118:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="70" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="58" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+            <lrm_rsc_op id="ip-172.17.4.11_monitor_10000" operation_key="ip-172.17.4.11_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;119:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="71" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="38" queue-time="0" op-digest="392445a354e2da75dcd4cbe6eee1268b"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="29:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;29:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="1" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="38:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;38:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="7" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-1_monitor_20000" operation_key="messaging-1_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;36:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="10" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="31:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;31:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="3" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;36:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="16" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="49" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="40:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;40:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="32" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="45" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="110:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;110:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="69" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="60" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+            <lrm_rsc_op id="ip-172.17.1.14_monitor_10000" operation_key="ip-172.17.1.14_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="111:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;111:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="72" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="36" queue-time="0" op-digest="19c32490a75539eb9cf2ca18727e305e"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="113:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;113:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="68" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="62" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+            <lrm_rsc_op id="ip-172.17.1.17_monitor_10000" operation_key="ip-172.17.1.17_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="114:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;114:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="73" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="36" queue-time="0" op-digest="637be44014a8de2a8162cb2b062f6955"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="44:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;44:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="50" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="3" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="148:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;148:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="65" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="79" queue-time="0" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="149:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;149:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="66" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817963" exec-time="80" queue-time="0" op-digest="e8a37549d88ca88c76d297b973759a8d" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="95:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;95:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="55" rc-code="0" op-status="0" interval="0" last-run="1493817890" last-rc-change="1493817890" exec-time="2553" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_45000" operation_key="redis_monitor_45000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="73:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;73:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="62" rc-code="0" op-status="0" interval="45000" last-rc-change="1493817892" exec-time="124" queue-time="135" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_60000" operation_key="redis_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="74:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;74:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="61" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817892" exec-time="135" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="48:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;48:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="8" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-0_monitor_20000" operation_key="galera-0_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="38:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;38:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="11" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="33:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;33:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="5" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="55:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;55:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="9" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-2_monitor_20000" operation_key="galera-2_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="44:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;44:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="12" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="45:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;45:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="54" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="0" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="1" uname="controller-0" crmd="online" crm-debug-origin="post_cache_update" in_ccm="true" join="member" expected="member">
+      <transient_attributes id="1">
+        <instance_attributes id="status-1">
+          <nvpair id="status-1-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-1-master-redis" name="master-redis" value="1"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="1">
+        <lrm_resources>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;119:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="143" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="497" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+            <lrm_rsc_op id="ip-10.0.0.102_monitor_10000" operation_key="ip-10.0.0.102_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="120:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;120:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="147" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817835" exec-time="48" queue-time="0" op-digest="83daeb09ea7f361d0c80eb34aaf106f9"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_failure_0" operation_key="haproxy_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="114" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="114" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="113:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;113:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="133" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817765" exec-time="4" queue-time="0" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;119:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="150" rc-code="0" op-status="0" interval="0" last-run="1493817868" last-rc-change="1493817868" exec-time="2105" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="openstack-cinder-volume_monitor_60000" operation_key="openstack-cinder-volume_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="145:1:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;145:1:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="154" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817878" exec-time="3" queue-time="1" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="14:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;14:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="109" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="66" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;36:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="13" rc-code="0" op-status="0" interval="0" last-run="1493817832" last-rc-change="1493817832" exec-time="0" queue-time="0" migrate_source="controller-1" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-0_monitor_20000" operation_key="messaging-0_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="34:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;34:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="15" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817832" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="3:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;3:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="8" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="43:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;43:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="17" rc-code="0" op-status="0" interval="0" last-run="1493817962" last-rc-change="1493817962" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-2_monitor_20000" operation_key="messaging-2_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="41:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;41:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="18" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="11:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;11:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="97" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="60" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="124:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;124:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="134" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="83" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_monitor_60000" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="129:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;129:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="136" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817768" exec-time="68" queue-time="0" op-digest="31be355d25ac30183b5d304f3275ec16" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="12:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;12:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="101" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="68" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="19:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;19:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="130" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="126:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;126:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="141" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="66" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+            <lrm_rsc_op id="ip-172.17.3.15_monitor_10000" operation_key="ip-172.17.3.15_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="127:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;127:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="144" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817834" exec-time="428" queue-time="0" op-digest="9f5ae0b4f77392ad67e6a430d3259ec4"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="116:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;116:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="142" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="498" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+            <lrm_rsc_op id="ip-192.168.24.6_monitor_10000" operation_key="ip-192.168.24.6_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="117:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;117:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="146" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817835" exec-time="38" queue-time="0" op-digest="53892658d5fe65d671f4c791888c8c7c"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_failure_0" operation_key="redis_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="8:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;8:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="85" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="171" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_promote_0" operation="promote" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="71:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;71:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="152" rc-code="0" op-status="0" interval="0" last-run="1493817868" last-rc-change="1493817868" exec-time="255" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_20000" operation_key="redis_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="74:4:8:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:8;74:4:8:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="159" rc-code="8" op-status="0" interval="20000" last-rc-change="1493817884" exec-time="147" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="5:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;5:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="10" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="50:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;50:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="14" rc-code="0" op-status="0" interval="0" last-run="1493817832" last-rc-change="1493817832" exec-time="0" queue-time="0" migrate_source="controller-1" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-1_monitor_20000" operation_key="galera-1_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="48:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;48:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="16" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817832" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="7:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;7:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="12" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="126:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;126:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="135" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="80" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="132:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;132:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="137" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817768" exec-time="69" queue-time="0" op-digest="08b6ad9edc64306555c732c45bcf4995" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-1" remote_node="true" uname="galera-1" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="galera-1">
+        <instance_attributes id="status-galera-1">
+          <nvpair id="status-galera-1-last-failure-galera" name="last-failure-galera" value="1493336863"/>
+          <nvpair id="status-galera-1-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-1">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34745" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="463" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34745" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="463" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="52:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;52:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34756" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="65" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-2" remote_node="true" uname="galera-2" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="galera-2">
+        <instance_attributes id="status-galera-2">
+          <nvpair id="status-galera-2-last-failure-galera" name="last-failure-galera" value="1493172798"/>
+          <nvpair id="status-galera-2-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-2">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34779" rc-code="8" op-status="0" interval="0" last-run="1493817766" last-rc-change="1493817766" exec-time="1419" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34779" rc-code="8" op-status="0" interval="0" last-run="1493817766" last-rc-change="1493817766" exec-time="1419" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="57:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;57:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34789" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="61" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-0" remote_node="true" uname="galera-0" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="galera-0">
+        <instance_attributes id="status-galera-0">
+          <nvpair id="status-galera-0-last-failure-galera" name="last-failure-galera" value="1493172797"/>
+          <nvpair id="status-galera-0-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-0">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35583" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="1739" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35583" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="1739" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="62:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;62:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35593" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="60" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="3" uname="controller-2" in_ccm="true" crmd="online" crm-debug-origin="post_cache_update" join="member" expected="member">
+      <lrm id="3">
+        <lrm_resources>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="29:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;29:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="1" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="30:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;30:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="2" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="31:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;31:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="3" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="32:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;32:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="4" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="33:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;33:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="5" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="34:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;34:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="6" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="138:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;138:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="46" rc-code="0" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2103" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="123:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;123:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="63" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817975" exec-time="3" queue-time="0" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="43:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;43:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="45" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="36:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;36:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="16" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="42" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="38:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;38:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="24" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="52" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+          </lrm_resource>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="37:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;37:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="20" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="59" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="40:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;40:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="32" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="52" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="41:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;41:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="36" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="50" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="39:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;39:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="28" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="55" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="44:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;44:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="50" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="45:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;45:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="54" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="95:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;95:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="59" rc-code="0" op-status="0" interval="0" last-run="1493817972" last-rc-change="1493817972" exec-time="2559" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_60000" operation_key="redis_monitor_60000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="80:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;80:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="61" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817975" exec-time="121" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_45000" operation_key="redis_monitor_45000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="79:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;79:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="62" rc-code="0" op-status="0" interval="45000" last-rc-change="1493817975" exec-time="117" queue-time="120" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="46:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;46:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="58" rc-code="7" op-status="0" interval="0" last-run="1493817972" last-rc-change="1493817972" exec-time="0" queue-time="1" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="3">
+        <instance_attributes id="status-3">
+          <nvpair id="status-3-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-3-master-redis" name="master-redis" value="1"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="messaging-2" remote_node="true" uname="messaging-2" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="messaging-2">
+        <instance_attributes id="status-messaging-2">
+          <nvpair id="status-messaging-2-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-2"/>
+          <nvpair id="status-messaging-2-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493172992"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-2">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041497" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3053" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041497" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3053" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="37:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;37:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041515" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="3053" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="messaging-0" remote_node="true" uname="messaging-0" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="messaging-0">
+        <instance_attributes id="status-messaging-0">
+          <nvpair id="status-messaging-0-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-0"/>
+          <nvpair id="status-messaging-0-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493330172"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-0">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875374" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3026" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875374" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3026" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="40:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;40:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875393" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="2985" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="messaging-1" remote_node="true" uname="messaging-1" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="messaging-1">
+        <instance_attributes id="status-messaging-1">
+          <nvpair id="status-messaging-1-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-1"/>
+          <nvpair id="status-messaging-1-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493336946"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-1">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251547" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3074" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251547" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3074" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="43:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;43:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251566" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="3025" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+  </status>
+</cib>
diff --git a/pengine/test10/remote-recover-connection.dot b/pengine/test10/remote-recover-connection.dot
new file mode 100644
index 0000000..d6fdefe
--- /dev/null
+++ b/pengine/test10/remote-recover-connection.dot
@@ -0,0 +1,131 @@
+digraph "g" {
+"all_stopped" [ style=bold color="green" fontcolor="orange"]
+"galera-0_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
+"galera-0_start_0 controller-2" -> "galera-0_monitor_20000 controller-2" [ style = bold]
+"galera-0_start_0 controller-2" -> "galera_monitor_10000 galera-0" [ style = bold]
+"galera-0_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"galera-0_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"galera-0_stop_0 controller-1" -> "galera-0_start_0 controller-2" [ style = bold]
+"galera-0_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"galera-2_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
+"galera-2_start_0 controller-2" -> "galera-2_monitor_20000 controller-2" [ style = bold]
+"galera-2_start_0 controller-2" -> "galera_monitor_10000 galera-2" [ style = bold]
+"galera-2_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"galera-2_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"galera-2_stop_0 controller-1" -> "galera-2_start_0 controller-2" [ style = bold]
+"galera-2_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"galera_monitor_10000 galera-0" [ style=bold color="green" fontcolor="black"]
+"galera_monitor_10000 galera-2" [ style=bold color="green" fontcolor="black"]
+"haproxy-clone_stop_0" -> "haproxy-clone_stopped_0" [ style = bold]
+"haproxy-clone_stop_0" -> "haproxy_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stop_0" [ style=bold color="green" fontcolor="orange"]
+"haproxy-clone_stopped_0" -> "ip-172.17.1.14_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" -> "ip-172.17.1.17_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" -> "ip-172.17.4.11_stop_0 controller-1" [ style = bold]
+"haproxy-clone_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"haproxy_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"haproxy_stop_0 controller-1" -> "haproxy-clone_stopped_0" [ style = bold]
+"haproxy_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.1.14_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.14_start_0 controller-2" -> "ip-172.17.1.14_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.1.14_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.14_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.1.14_stop_0 controller-1" -> "ip-172.17.1.14_start_0 controller-2" [ style = bold]
+"ip-172.17.1.14_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.1.17_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.17_start_0 controller-2" -> "ip-172.17.1.17_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.1.17_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.1.17_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.1.17_stop_0 controller-1" -> "ip-172.17.1.17_start_0 controller-2" [ style = bold]
+"ip-172.17.1.17_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"ip-172.17.4.11_monitor_10000 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.4.11_start_0 controller-2" -> "ip-172.17.4.11_monitor_10000 controller-2" [ style = bold]
+"ip-172.17.4.11_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"ip-172.17.4.11_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"ip-172.17.4.11_stop_0 controller-1" -> "ip-172.17.4.11_start_0 controller-2" [ style = bold]
+"ip-172.17.4.11_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"messaging-1_monitor_20000 controller-2" [ style=bold color="green" fontcolor="black"]
+"messaging-1_start_0 controller-2" -> "messaging-1_monitor_20000 controller-2" [ style = bold]
+"messaging-1_start_0 controller-2" -> "rabbitmq_monitor_10000 messaging-1" [ style = bold]
+"messaging-1_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"messaging-1_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"messaging-1_stop_0 controller-1" -> "messaging-1_start_0 controller-2" [ style = bold]
+"messaging-1_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"rabbitmq_monitor_10000 messaging-1" [ style=bold color="green" fontcolor="black"]
+"redis-master_confirmed-post_notify_stopped_0" -> "all_stopped" [ style = bold]
+"redis-master_confirmed-post_notify_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_confirmed-pre_notify_stop_0" -> "redis-master_post_notify_stopped_0" [ style = bold]
+"redis-master_confirmed-pre_notify_stop_0" -> "redis-master_stop_0" [ style = bold]
+"redis-master_confirmed-pre_notify_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_post_notify_stopped_0" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis-master_post_notify_stopped_0" -> "redis_post_notify_stonith_0 controller-0" [ style = bold]
+"redis-master_post_notify_stopped_0" -> "redis_post_notify_stonith_0 controller-2" [ style = bold]
+"redis-master_post_notify_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_pre_notify_stop_0" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis-master_pre_notify_stop_0" -> "redis_pre_notify_stop_0 controller-0" [ style = bold]
+"redis-master_pre_notify_stop_0" -> "redis_pre_notify_stop_0 controller-2" [ style = bold]
+"redis-master_pre_notify_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_stop_0" -> "redis-master_stopped_0" [ style = bold]
+"redis-master_stop_0" -> "redis_stop_0 controller-1" [ style = bold]
+"redis-master_stop_0" [ style=bold color="green" fontcolor="orange"]
+"redis-master_stopped_0" -> "redis-master_post_notify_stopped_0" [ style = bold]
+"redis-master_stopped_0" [ style=bold color="green" fontcolor="orange"]
+"redis_confirmed-post_notify_stonith_0" -> "all_stopped" [ style = bold]
+"redis_confirmed-post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"redis_post_notify_stonith_0 controller-0" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-0" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"redis_post_notify_stonith_0 controller-2" -> "redis-master_confirmed-post_notify_stopped_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-2" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"redis_post_notify_stonith_0" -> "redis_confirmed-post_notify_stonith_0" [ style = bold]
+"redis_post_notify_stonith_0" -> "redis_post_notify_stonith_0 controller-0" [ style = bold]
+"redis_post_notify_stonith_0" -> "redis_post_notify_stonith_0 controller-2" [ style = bold]
+"redis_post_notify_stonith_0" [ style=bold color="green" fontcolor="orange"]
+"redis_pre_notify_stop_0 controller-0" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis_pre_notify_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"redis_pre_notify_stop_0 controller-2" -> "redis-master_confirmed-pre_notify_stop_0" [ style = bold]
+"redis_pre_notify_stop_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"redis_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"redis_stop_0 controller-1" -> "redis-master_stopped_0" [ style = bold]
+"redis_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"stonith 'reboot' controller-1" -> "galera-0_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "galera-2_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "haproxy-clone_stop_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "haproxy_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.1.14_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.1.17_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "ip-172.17.4.11_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "messaging-1_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis-master_stop_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis_post_notify_stonith_0" [ style = bold]
+"stonith 'reboot' controller-1" -> "redis_stop_0 controller-1" [ style = bold]
+"stonith 'reboot' controller-1" -> "stonith_complete" [ style = bold]
+"stonith 'reboot' controller-1" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_monitor_60000 controller-2" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" -> "stonith-fence_ipmilan-5254005bdbb5_monitor_60000 controller-2" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" -> "stonith-fence_ipmilan-5254005bdbb5_start_0 controller-2" [ style = bold]
+"stonith-fence_ipmilan-5254005bdbb5_stop_0 controller-1" [ style=bold color="green" fontcolor="orange"]
+"stonith-fence_ipmilan-525400b4f6bd_monitor_60000 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" -> "stonith-fence_ipmilan-525400b4f6bd_monitor_60000 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" -> "stonith-fence_ipmilan-525400b4f6bd_start_0 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400b4f6bd_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_monitor_60000 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_start_0 controller-0" -> "stonith-fence_ipmilan-525400bbf613_monitor_60000 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_start_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" -> "all_stopped" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" -> "stonith-fence_ipmilan-525400bbf613_start_0 controller-0" [ style = bold]
+"stonith-fence_ipmilan-525400bbf613_stop_0 controller-0" [ style=bold color="green" fontcolor="black"]
+"stonith_complete" -> "all_stopped" [ style = bold]
+"stonith_complete" -> "galera-0_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "galera-2_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "ip-172.17.1.14_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "ip-172.17.1.17_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "ip-172.17.4.11_start_0 controller-2" [ style = bold]
+"stonith_complete" -> "messaging-1_start_0 controller-2" [ style = bold]
+"stonith_complete" [ style=bold color="green" fontcolor="orange"]
+}
diff --git a/pengine/test10/remote-recover-connection.exp b/pengine/test10/remote-recover-connection.exp
new file mode 100644
index 0000000..62860f0
--- /dev/null
+++ b/pengine/test10/remote-recover-connection.exp
@@ -0,0 +1,708 @@
+<transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
+  <synapse id="0">
+    <action_set>
+      <rsc_op id="28" operation="monitor" operation_key="messaging-1_monitor_20000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="messaging-1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_interval="20000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="1">
+    <action_set>
+      <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="messaging-1" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="26" operation="stop" operation_key="messaging-1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="2">
+    <action_set>
+      <pseudo_event id="26" operation="stop" operation_key="messaging-1_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="3">
+    <action_set>
+      <rsc_op id="33" operation="monitor" operation_key="galera-0_monitor_20000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="galera-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_interval="20000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="4">
+    <action_set>
+      <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="galera-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="31" operation="stop" operation_key="galera-0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="5">
+    <action_set>
+      <pseudo_event id="31" operation="stop" operation_key="galera-0_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="6">
+    <action_set>
+      <rsc_op id="38" operation="monitor" operation_key="galera-2_monitor_20000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="galera-2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_interval="20000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="7">
+    <action_set>
+      <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="galera-2" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="36" operation="stop" operation_key="galera-2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="8">
+    <action_set>
+      <pseudo_event id="36" operation="stop" operation_key="galera-2_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="60000"  reconnect_interval="60"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="9">
+    <action_set>
+      <rsc_op id="20" operation="monitor" operation_key="rabbitmq_monitor_10000" internal_operation_key="rabbitmq:2_monitor_10000" on_node="messaging-1" on_node_uuid="messaging-1" router_node="controller-2">
+        <primitive id="rabbitmq" long-id="rabbitmq:2" class="ocf" provider="heartbeat" type="rabbitmq-cluster"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="messaging-1" CRM_meta_on_node_uuid="messaging-1" CRM_meta_timeout="40000"  set_policy="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="27" operation="start" operation_key="messaging-1_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="10">
+    <action_set>
+      <rsc_op id="13" operation="monitor" operation_key="galera_monitor_10000" internal_operation_key="galera:1_monitor_10000" on_node="galera-2" on_node_uuid="galera-2" router_node="controller-2">
+        <primitive id="galera" long-id="galera:1" class="ocf" provider="heartbeat" type="galera"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="galera-2" CRM_meta_on_node_uuid="galera-2" CRM_meta_op_target_rc="8" CRM_meta_role="Master" CRM_meta_timeout="30000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="37" operation="start" operation_key="galera-2_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="11">
+    <action_set>
+      <rsc_op id="14" operation="monitor" operation_key="galera_monitor_10000" internal_operation_key="galera:2_monitor_10000" on_node="galera-0" on_node_uuid="galera-0" router_node="controller-2">
+        <primitive id="galera" long-id="galera:2" class="ocf" provider="heartbeat" type="galera"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_interval="10000" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_name="monitor" CRM_meta_notify="false" CRM_meta_on_node="galera-0" CRM_meta_on_node_uuid="galera-0" CRM_meta_op_target_rc="8" CRM_meta_role="Master" CRM_meta_timeout="30000" additional_parameters="--open-files-limit=16384"  enable_creation="true" wsrep_cluster_address="gcomm://galera-0,galera-1,galera-2"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="32" operation="start" operation_key="galera-0_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="12" priority="1000000">
+    <action_set>
+      <pseudo_event id="134" operation="notified" operation_key="redis_notified_0" internal_operation_key="redis:0_confirmed-post_notify_stonith_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="133" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="135" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="136" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="13" priority="1000000">
+    <action_set>
+      <pseudo_event id="133" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="14">
+    <action_set>
+      <pseudo_event id="69" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_name="stop" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_timeout="200000"  wait_last_known_master="true"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="82" operation="stop" operation_key="redis-master_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="15">
+    <action_set>
+      <rsc_op id="193" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:1_pre_notify_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="pre" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="84" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="16" priority="1000000">
+    <action_set>
+      <rsc_op id="135" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="redis" long-id="redis:1" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="1" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="post" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="86" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="133" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="17">
+    <action_set>
+      <rsc_op id="194" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:2_pre_notify_stop_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="pre" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="84" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="18" priority="1000000">
+    <action_set>
+      <rsc_op id="136" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="redis" long-id="redis:2" class="ocf" provider="heartbeat" type="redis"/>
+        <attributes CRM_meta_clone="2" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_active_resource="redis:0 redis:1 redis:2" CRM_meta_notify_active_uname="controller-1 controller-0 controller-2" CRM_meta_notify_all_uname="controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2" CRM_meta_notify_available_uname="controller-2 controller-1 controller-0" CRM_meta_notify_demote_resource=" " CRM_meta_notify_demote_uname=" " CRM_meta_notify_inactive_resource="redis:3 redis:4 redis:5 redis:6 redis:7 redis:8" CRM_meta_notify_key_operation="stonith" CRM_meta_notify_key_type="post" CRM_meta_notify_master_resource="redis:1" CRM_meta_notify_master_uname="controller-0" CRM_meta_notify_operation="stop" CRM_meta_notify_promote_resource=" " CRM_meta_notify_promote_uname=" " CRM_meta_notify_slave_resource="redis:0 redis:2" CRM_meta_notify_slave_uname="controller-1 controller-2" CRM_meta_notify_start_resource=" " CRM_meta_notify_start_uname=" " CRM_meta_notify_stop_resource="redis:0" CRM_meta_notify_stop_uname="controller-1" CRM_meta_notify_type="post" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000"  wait_last_known_master="true"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="86" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="133" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:0_post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="19" priority="1000000">
+    <action_set>
+      <pseudo_event id="87" operation="notified" operation_key="redis-master_confirmed-post_notify_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="86" operation="notify" operation_key="redis-master_post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="135" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:1_post_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="136" operation="notify" operation_key="redis_post_notify_stop_0" internal_operation_key="redis:2_post_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="20" priority="1000000">
+    <action_set>
+      <pseudo_event id="86" operation="notify" operation_key="redis-master_post_notify_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stopped" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="stop" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="83" operation="stopped" operation_key="redis-master_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="85" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="21">
+    <action_set>
+      <pseudo_event id="85" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="84" operation="notify" operation_key="redis-master_pre_notify_stop_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="193" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:1_pre_notify_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="194" operation="notify" operation_key="redis_pre_notify_stop_0" internal_operation_key="redis:2_pre_notify_stop_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="22">
+    <action_set>
+      <pseudo_event id="84" operation="notify" operation_key="redis-master_pre_notify_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="stop" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="stop" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="23" priority="1000000">
+    <action_set>
+      <pseudo_event id="83" operation="stopped" operation_key="redis-master_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="69" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="82" operation="stop" operation_key="redis-master_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="24">
+    <action_set>
+      <pseudo_event id="82" operation="stop" operation_key="redis-master_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="85" operation="notified" operation_key="redis-master_confirmed-pre_notify_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="25">
+    <action_set>
+      <rsc_op id="106" operation="monitor" operation_key="ip-172.17.1.14_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="105" operation="start" operation_key="ip-172.17.1.14_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="26">
+    <action_set>
+      <rsc_op id="105" operation="start" operation_key="ip-172.17.1.14_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.14" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="104" operation="stop" operation_key="ip-172.17.1.14_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="27">
+    <action_set>
+      <pseudo_event id="104" operation="stop" operation_key="ip-172.17.1.14_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.14"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="123" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="28">
+    <action_set>
+      <rsc_op id="109" operation="monitor" operation_key="ip-172.17.1.17_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="108" operation="start" operation_key="ip-172.17.1.17_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="29">
+    <action_set>
+      <rsc_op id="108" operation="start" operation_key="ip-172.17.1.17_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.1.17" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="107" operation="stop" operation_key="ip-172.17.1.17_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="30">
+    <action_set>
+      <pseudo_event id="107" operation="stop" operation_key="ip-172.17.1.17_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.1.17"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="123" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="31">
+    <action_set>
+      <rsc_op id="114" operation="monitor" operation_key="ip-172.17.4.11_monitor_10000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_interval="10000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="113" operation="start" operation_key="ip-172.17.4.11_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="32">
+    <action_set>
+      <rsc_op id="113" operation="start" operation_key="ip-172.17.4.11_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="ip-172.17.4.11" class="ocf" provider="heartbeat" type="IPaddr2"/>
+        <attributes CRM_meta_name="start" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="112" operation="stop" operation_key="ip-172.17.4.11_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="33">
+    <action_set>
+      <pseudo_event id="112" operation="stop" operation_key="ip-172.17.4.11_stop_0">
+        <attributes CRM_meta_name="stop" CRM_meta_timeout="20000" cidr_netmask="32"  ip="172.17.4.11"/>
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="123" operation="stopped" operation_key="haproxy-clone_stopped_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="34">
+    <action_set>
+      <pseudo_event id="115" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0">
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_name="stop" CRM_meta_notify="false" CRM_meta_timeout="200000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="122" operation="stop" operation_key="haproxy-clone_stop_0"/>
+      </trigger>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="35" priority="1000000">
+    <action_set>
+      <pseudo_event id="123" operation="stopped" operation_key="haproxy-clone_stopped_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="115" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="122" operation="stop" operation_key="haproxy-clone_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="36">
+    <action_set>
+      <pseudo_event id="122" operation="stop" operation_key="haproxy-clone_stop_0">
+        <attributes CRM_meta_clone_max="9" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_notify="false" CRM_meta_timeout="20000" />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="37">
+    <action_set>
+      <rsc_op id="126" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="38">
+    <action_set>
+      <rsc_op id="22" operation="start" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="126" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="39">
+    <action_set>
+      <rsc_op id="6" operation="monitor" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_60000" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400bbf613" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6237" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-2" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="22" operation="start" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="40">
+    <action_set>
+      <rsc_op id="127" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="41">
+    <action_set>
+      <rsc_op id="23" operation="start" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="127" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="42">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" on_node="controller-0" on_node_uuid="1">
+        <primitive id="stonith-fence_ipmilan-525400b4f6bd" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-0" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6236" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-1" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="23" operation="start" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="43">
+    <action_set>
+      <rsc_op id="130" operation="monitor" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" on_node="controller-2" on_node_uuid="3">
+        <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <rsc_op id="129" operation="start" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" on_node="controller-2" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="44">
+    <action_set>
+      <rsc_op id="129" operation="start" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" on_node="controller-2" on_node_uuid="3">
+        <primitive id="stonith-fence_ipmilan-5254005bdbb5" class="stonith" type="fence_ipmilan"/>
+        <attributes CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </rsc_op>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="128" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="45">
+    <action_set>
+      <pseudo_event id="128" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0">
+        <attributes CRM_meta_timeout="20000" action="reboot"  ipaddr="172.16.0.1" ipport="6235" lanplus="true" login="admin" passwd="****" pcmk_host_list="controller-0" privlvl="administrator"/>
+      </pseudo_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="46">
+    <action_set>
+      <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2">
+        <attributes CRM_meta_cinder_volume_role="true" CRM_meta_haproxy_role="true" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_redis_role="true" CRM_meta_stonith_action="reboot" />
+        <downed>
+          <node id="2"/>
+        </downed>
+      </crm_event>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="47">
+    <action_set>
+      <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete">
+        <attributes />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <crm_event id="132" operation="stonith" operation_key="stonith-controller-1-reboot" on_node="controller-1" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
+  </synapse>
+  <synapse id="48">
+    <action_set>
+      <pseudo_event id="21" operation="all_stopped" operation_key="all_stopped">
+        <attributes />
+      </pseudo_event>
+    </action_set>
+    <inputs>
+      <trigger>
+        <pseudo_event id="26" operation="stop" operation_key="messaging-1_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="31" operation="stop" operation_key="galera-0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="36" operation="stop" operation_key="galera-2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="69" operation="stop" operation_key="redis_stop_0" internal_operation_key="redis:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="87" operation="notified" operation_key="redis-master_confirmed-post_notify_stopped_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="104" operation="stop" operation_key="ip-172.17.1.14_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="107" operation="stop" operation_key="ip-172.17.1.17_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="112" operation="stop" operation_key="ip-172.17.4.11_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="115" operation="stop" operation_key="haproxy_stop_0" internal_operation_key="haproxy:0_stop_0"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="126" operation="stop" operation_key="stonith-fence_ipmilan-525400bbf613_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <rsc_op id="127" operation="stop" operation_key="stonith-fence_ipmilan-525400b4f6bd_stop_0" on_node="controller-0" on_node_uuid="1"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="128" operation="stop" operation_key="stonith-fence_ipmilan-5254005bdbb5_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="131" operation="stonith_complete" operation_key="stonith_complete"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="134" operation="notified" operation_key="redis_notified_0" internal_operation_key="redis:0_confirmed-post_notify_stonith_0"/>
+      </trigger>
+    </inputs>
+  </synapse>
+</transition_graph>
diff --git a/pengine/test10/remote-recover-connection.scores b/pengine/test10/remote-recover-connection.scores
new file mode 100644
index 0000000..56a18eb
--- /dev/null
+++ b/pengine/test10/remote-recover-connection.scores
@@ -0,0 +1,848 @@
+Allocation scores:
+Using the original execution date of: 2017-05-03 13:33:24Z
+clone_color: galera-master allocation score on controller-0: -INFINITY
+clone_color: galera-master allocation score on controller-1: -INFINITY
+clone_color: galera-master allocation score on controller-2: -INFINITY
+clone_color: galera-master allocation score on galera-0: 0
+clone_color: galera-master allocation score on galera-1: 0
+clone_color: galera-master allocation score on galera-2: 0
+clone_color: galera-master allocation score on messaging-0: -INFINITY
+clone_color: galera-master allocation score on messaging-1: -INFINITY
+clone_color: galera-master allocation score on messaging-2: -INFINITY
+clone_color: galera:0 allocation score on controller-0: -INFINITY
+clone_color: galera:0 allocation score on controller-1: -INFINITY
+clone_color: galera:0 allocation score on controller-2: -INFINITY
+clone_color: galera:0 allocation score on galera-0: 0
+clone_color: galera:0 allocation score on galera-1: INFINITY
+clone_color: galera:0 allocation score on galera-2: 0
+clone_color: galera:0 allocation score on messaging-0: -INFINITY
+clone_color: galera:0 allocation score on messaging-1: -INFINITY
+clone_color: galera:0 allocation score on messaging-2: -INFINITY
+clone_color: galera:1 allocation score on controller-0: -INFINITY
+clone_color: galera:1 allocation score on controller-1: -INFINITY
+clone_color: galera:1 allocation score on controller-2: -INFINITY
+clone_color: galera:1 allocation score on galera-0: 0
+clone_color: galera:1 allocation score on galera-1: 0
+clone_color: galera:1 allocation score on galera-2: INFINITY
+clone_color: galera:1 allocation score on messaging-0: -INFINITY
+clone_color: galera:1 allocation score on messaging-1: -INFINITY
+clone_color: galera:1 allocation score on messaging-2: -INFINITY
+clone_color: galera:2 allocation score on controller-0: -INFINITY
+clone_color: galera:2 allocation score on controller-1: -INFINITY
+clone_color: galera:2 allocation score on controller-2: -INFINITY
+clone_color: galera:2 allocation score on galera-0: INFINITY
+clone_color: galera:2 allocation score on galera-1: 0
+clone_color: galera:2 allocation score on galera-2: 0
+clone_color: galera:2 allocation score on messaging-0: -INFINITY
+clone_color: galera:2 allocation score on messaging-1: -INFINITY
+clone_color: galera:2 allocation score on messaging-2: -INFINITY
+clone_color: galera:3 allocation score on controller-0: -INFINITY
+clone_color: galera:3 allocation score on controller-1: -INFINITY
+clone_color: galera:3 allocation score on controller-2: -INFINITY
+clone_color: galera:3 allocation score on galera-0: 0
+clone_color: galera:3 allocation score on galera-1: 0
+clone_color: galera:3 allocation score on galera-2: 0
+clone_color: galera:3 allocation score on messaging-0: -INFINITY
+clone_color: galera:3 allocation score on messaging-1: -INFINITY
+clone_color: galera:3 allocation score on messaging-2: -INFINITY
+clone_color: galera:4 allocation score on controller-0: -INFINITY
+clone_color: galera:4 allocation score on controller-1: -INFINITY
+clone_color: galera:4 allocation score on controller-2: -INFINITY
+clone_color: galera:4 allocation score on galera-0: 0
+clone_color: galera:4 allocation score on galera-1: 0
+clone_color: galera:4 allocation score on galera-2: 0
+clone_color: galera:4 allocation score on messaging-0: -INFINITY
+clone_color: galera:4 allocation score on messaging-1: -INFINITY
+clone_color: galera:4 allocation score on messaging-2: -INFINITY
+clone_color: galera:5 allocation score on controller-0: -INFINITY
+clone_color: galera:5 allocation score on controller-1: -INFINITY
+clone_color: galera:5 allocation score on controller-2: -INFINITY
+clone_color: galera:5 allocation score on galera-0: 0
+clone_color: galera:5 allocation score on galera-1: 0
+clone_color: galera:5 allocation score on galera-2: 0
+clone_color: galera:5 allocation score on messaging-0: -INFINITY
+clone_color: galera:5 allocation score on messaging-1: -INFINITY
+clone_color: galera:5 allocation score on messaging-2: -INFINITY
+clone_color: galera:6 allocation score on controller-0: -INFINITY
+clone_color: galera:6 allocation score on controller-1: -INFINITY
+clone_color: galera:6 allocation score on controller-2: -INFINITY
+clone_color: galera:6 allocation score on galera-0: 0
+clone_color: galera:6 allocation score on galera-1: 0
+clone_color: galera:6 allocation score on galera-2: 0
+clone_color: galera:6 allocation score on messaging-0: -INFINITY
+clone_color: galera:6 allocation score on messaging-1: -INFINITY
+clone_color: galera:6 allocation score on messaging-2: -INFINITY
+clone_color: galera:7 allocation score on controller-0: -INFINITY
+clone_color: galera:7 allocation score on controller-1: -INFINITY
+clone_color: galera:7 allocation score on controller-2: -INFINITY
+clone_color: galera:7 allocation score on galera-0: 0
+clone_color: galera:7 allocation score on galera-1: 0
+clone_color: galera:7 allocation score on galera-2: 0
+clone_color: galera:7 allocation score on messaging-0: -INFINITY
+clone_color: galera:7 allocation score on messaging-1: -INFINITY
+clone_color: galera:7 allocation score on messaging-2: -INFINITY
+clone_color: galera:8 allocation score on controller-0: -INFINITY
+clone_color: galera:8 allocation score on controller-1: -INFINITY
+clone_color: galera:8 allocation score on controller-2: -INFINITY
+clone_color: galera:8 allocation score on galera-0: 0
+clone_color: galera:8 allocation score on galera-1: 0
+clone_color: galera:8 allocation score on galera-2: 0
+clone_color: galera:8 allocation score on messaging-0: -INFINITY
+clone_color: galera:8 allocation score on messaging-1: -INFINITY
+clone_color: galera:8 allocation score on messaging-2: -INFINITY
+clone_color: haproxy-clone allocation score on controller-0: INFINITY
+clone_color: haproxy-clone allocation score on controller-1: 0
+clone_color: haproxy-clone allocation score on controller-2: 0
+clone_color: haproxy-clone allocation score on galera-0: -INFINITY
+clone_color: haproxy-clone allocation score on galera-1: -INFINITY
+clone_color: haproxy-clone allocation score on galera-2: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-0: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-1: -INFINITY
+clone_color: haproxy-clone allocation score on messaging-2: -INFINITY
+clone_color: haproxy:0 allocation score on controller-0: 0
+clone_color: haproxy:0 allocation score on controller-1: INFINITY
+clone_color: haproxy:0 allocation score on controller-2: 0
+clone_color: haproxy:0 allocation score on galera-0: -INFINITY
+clone_color: haproxy:0 allocation score on galera-1: -INFINITY
+clone_color: haproxy:0 allocation score on galera-2: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:0 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:1 allocation score on controller-0: INFINITY
+clone_color: haproxy:1 allocation score on controller-1: 0
+clone_color: haproxy:1 allocation score on controller-2: 0
+clone_color: haproxy:1 allocation score on galera-0: -INFINITY
+clone_color: haproxy:1 allocation score on galera-1: -INFINITY
+clone_color: haproxy:1 allocation score on galera-2: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:1 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:2 allocation score on controller-0: 0
+clone_color: haproxy:2 allocation score on controller-1: 0
+clone_color: haproxy:2 allocation score on controller-2: INFINITY
+clone_color: haproxy:2 allocation score on galera-0: -INFINITY
+clone_color: haproxy:2 allocation score on galera-1: -INFINITY
+clone_color: haproxy:2 allocation score on galera-2: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:2 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:3 allocation score on controller-0: 0
+clone_color: haproxy:3 allocation score on controller-1: 0
+clone_color: haproxy:3 allocation score on controller-2: 0
+clone_color: haproxy:3 allocation score on galera-0: -INFINITY
+clone_color: haproxy:3 allocation score on galera-1: -INFINITY
+clone_color: haproxy:3 allocation score on galera-2: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:3 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:4 allocation score on controller-0: 0
+clone_color: haproxy:4 allocation score on controller-1: 0
+clone_color: haproxy:4 allocation score on controller-2: 0
+clone_color: haproxy:4 allocation score on galera-0: -INFINITY
+clone_color: haproxy:4 allocation score on galera-1: -INFINITY
+clone_color: haproxy:4 allocation score on galera-2: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:4 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:5 allocation score on controller-0: 0
+clone_color: haproxy:5 allocation score on controller-1: 0
+clone_color: haproxy:5 allocation score on controller-2: 0
+clone_color: haproxy:5 allocation score on galera-0: -INFINITY
+clone_color: haproxy:5 allocation score on galera-1: -INFINITY
+clone_color: haproxy:5 allocation score on galera-2: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:5 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:6 allocation score on controller-0: 0
+clone_color: haproxy:6 allocation score on controller-1: 0
+clone_color: haproxy:6 allocation score on controller-2: 0
+clone_color: haproxy:6 allocation score on galera-0: -INFINITY
+clone_color: haproxy:6 allocation score on galera-1: -INFINITY
+clone_color: haproxy:6 allocation score on galera-2: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:6 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:7 allocation score on controller-0: 0
+clone_color: haproxy:7 allocation score on controller-1: 0
+clone_color: haproxy:7 allocation score on controller-2: 0
+clone_color: haproxy:7 allocation score on galera-0: -INFINITY
+clone_color: haproxy:7 allocation score on galera-1: -INFINITY
+clone_color: haproxy:7 allocation score on galera-2: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:7 allocation score on messaging-2: -INFINITY
+clone_color: haproxy:8 allocation score on controller-0: 0
+clone_color: haproxy:8 allocation score on controller-1: 0
+clone_color: haproxy:8 allocation score on controller-2: 0
+clone_color: haproxy:8 allocation score on galera-0: -INFINITY
+clone_color: haproxy:8 allocation score on galera-1: -INFINITY
+clone_color: haproxy:8 allocation score on galera-2: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-0: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-1: -INFINITY
+clone_color: haproxy:8 allocation score on messaging-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-0: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-1: -INFINITY
+clone_color: rabbitmq-clone allocation score on controller-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-0: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-1: -INFINITY
+clone_color: rabbitmq-clone allocation score on galera-2: -INFINITY
+clone_color: rabbitmq-clone allocation score on messaging-0: 0
+clone_color: rabbitmq-clone allocation score on messaging-1: 0
+clone_color: rabbitmq-clone allocation score on messaging-2: 0
+clone_color: rabbitmq:0 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:0 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:0 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:0 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:0 allocation score on messaging-0: 0
+clone_color: rabbitmq:0 allocation score on messaging-1: 0
+clone_color: rabbitmq:0 allocation score on messaging-2: INFINITY
+clone_color: rabbitmq:1 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:1 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:1 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:1 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:1 allocation score on messaging-0: INFINITY
+clone_color: rabbitmq:1 allocation score on messaging-1: 0
+clone_color: rabbitmq:1 allocation score on messaging-2: 0
+clone_color: rabbitmq:2 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:2 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:2 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:2 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:2 allocation score on messaging-0: 0
+clone_color: rabbitmq:2 allocation score on messaging-1: INFINITY
+clone_color: rabbitmq:2 allocation score on messaging-2: 0
+clone_color: rabbitmq:3 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:3 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:3 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:3 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:3 allocation score on messaging-0: 0
+clone_color: rabbitmq:3 allocation score on messaging-1: 0
+clone_color: rabbitmq:3 allocation score on messaging-2: 0
+clone_color: rabbitmq:4 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:4 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:4 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:4 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:4 allocation score on messaging-0: 0
+clone_color: rabbitmq:4 allocation score on messaging-1: 0
+clone_color: rabbitmq:4 allocation score on messaging-2: 0
+clone_color: rabbitmq:5 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:5 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:5 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:5 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:5 allocation score on messaging-0: 0
+clone_color: rabbitmq:5 allocation score on messaging-1: 0
+clone_color: rabbitmq:5 allocation score on messaging-2: 0
+clone_color: rabbitmq:6 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:6 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:6 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:6 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:6 allocation score on messaging-0: 0
+clone_color: rabbitmq:6 allocation score on messaging-1: 0
+clone_color: rabbitmq:6 allocation score on messaging-2: 0
+clone_color: rabbitmq:7 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:7 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:7 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:7 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:7 allocation score on messaging-0: 0
+clone_color: rabbitmq:7 allocation score on messaging-1: 0
+clone_color: rabbitmq:7 allocation score on messaging-2: 0
+clone_color: rabbitmq:8 allocation score on controller-0: -INFINITY
+clone_color: rabbitmq:8 allocation score on controller-1: -INFINITY
+clone_color: rabbitmq:8 allocation score on controller-2: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-0: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-1: -INFINITY
+clone_color: rabbitmq:8 allocation score on galera-2: -INFINITY
+clone_color: rabbitmq:8 allocation score on messaging-0: 0
+clone_color: rabbitmq:8 allocation score on messaging-1: 0
+clone_color: rabbitmq:8 allocation score on messaging-2: 0
+clone_color: redis-master allocation score on controller-0: 0
+clone_color: redis-master allocation score on controller-1: 0
+clone_color: redis-master allocation score on controller-2: 0
+clone_color: redis-master allocation score on galera-0: -INFINITY
+clone_color: redis-master allocation score on galera-1: -INFINITY
+clone_color: redis-master allocation score on galera-2: -INFINITY
+clone_color: redis-master allocation score on messaging-0: -INFINITY
+clone_color: redis-master allocation score on messaging-1: -INFINITY
+clone_color: redis-master allocation score on messaging-2: -INFINITY
+clone_color: redis:0 allocation score on controller-0: 0
+clone_color: redis:0 allocation score on controller-1: INFINITY
+clone_color: redis:0 allocation score on controller-2: 0
+clone_color: redis:0 allocation score on galera-0: -INFINITY
+clone_color: redis:0 allocation score on galera-1: -INFINITY
+clone_color: redis:0 allocation score on galera-2: -INFINITY
+clone_color: redis:0 allocation score on messaging-0: -INFINITY
+clone_color: redis:0 allocation score on messaging-1: -INFINITY
+clone_color: redis:0 allocation score on messaging-2: -INFINITY
+clone_color: redis:1 allocation score on controller-0: INFINITY
+clone_color: redis:1 allocation score on controller-1: 0
+clone_color: redis:1 allocation score on controller-2: 0
+clone_color: redis:1 allocation score on galera-0: -INFINITY
+clone_color: redis:1 allocation score on galera-1: -INFINITY
+clone_color: redis:1 allocation score on galera-2: -INFINITY
+clone_color: redis:1 allocation score on messaging-0: -INFINITY
+clone_color: redis:1 allocation score on messaging-1: -INFINITY
+clone_color: redis:1 allocation score on messaging-2: -INFINITY
+clone_color: redis:2 allocation score on controller-0: 0
+clone_color: redis:2 allocation score on controller-1: 0
+clone_color: redis:2 allocation score on controller-2: INFINITY
+clone_color: redis:2 allocation score on galera-0: -INFINITY
+clone_color: redis:2 allocation score on galera-1: -INFINITY
+clone_color: redis:2 allocation score on galera-2: -INFINITY
+clone_color: redis:2 allocation score on messaging-0: -INFINITY
+clone_color: redis:2 allocation score on messaging-1: -INFINITY
+clone_color: redis:2 allocation score on messaging-2: -INFINITY
+clone_color: redis:3 allocation score on controller-0: 0
+clone_color: redis:3 allocation score on controller-1: 0
+clone_color: redis:3 allocation score on controller-2: 0
+clone_color: redis:3 allocation score on galera-0: -INFINITY
+clone_color: redis:3 allocation score on galera-1: -INFINITY
+clone_color: redis:3 allocation score on galera-2: -INFINITY
+clone_color: redis:3 allocation score on messaging-0: -INFINITY
+clone_color: redis:3 allocation score on messaging-1: -INFINITY
+clone_color: redis:3 allocation score on messaging-2: -INFINITY
+clone_color: redis:4 allocation score on controller-0: 0
+clone_color: redis:4 allocation score on controller-1: 0
+clone_color: redis:4 allocation score on controller-2: 0
+clone_color: redis:4 allocation score on galera-0: -INFINITY
+clone_color: redis:4 allocation score on galera-1: -INFINITY
+clone_color: redis:4 allocation score on galera-2: -INFINITY
+clone_color: redis:4 allocation score on messaging-0: -INFINITY
+clone_color: redis:4 allocation score on messaging-1: -INFINITY
+clone_color: redis:4 allocation score on messaging-2: -INFINITY
+clone_color: redis:5 allocation score on controller-0: 0
+clone_color: redis:5 allocation score on controller-1: 0
+clone_color: redis:5 allocation score on controller-2: 0
+clone_color: redis:5 allocation score on galera-0: -INFINITY
+clone_color: redis:5 allocation score on galera-1: -INFINITY
+clone_color: redis:5 allocation score on galera-2: -INFINITY
+clone_color: redis:5 allocation score on messaging-0: -INFINITY
+clone_color: redis:5 allocation score on messaging-1: -INFINITY
+clone_color: redis:5 allocation score on messaging-2: -INFINITY
+clone_color: redis:6 allocation score on controller-0: 0
+clone_color: redis:6 allocation score on controller-1: 0
+clone_color: redis:6 allocation score on controller-2: 0
+clone_color: redis:6 allocation score on galera-0: -INFINITY
+clone_color: redis:6 allocation score on galera-1: -INFINITY
+clone_color: redis:6 allocation score on galera-2: -INFINITY
+clone_color: redis:6 allocation score on messaging-0: -INFINITY
+clone_color: redis:6 allocation score on messaging-1: -INFINITY
+clone_color: redis:6 allocation score on messaging-2: -INFINITY
+clone_color: redis:7 allocation score on controller-0: 0
+clone_color: redis:7 allocation score on controller-1: 0
+clone_color: redis:7 allocation score on controller-2: 0
+clone_color: redis:7 allocation score on galera-0: -INFINITY
+clone_color: redis:7 allocation score on galera-1: -INFINITY
+clone_color: redis:7 allocation score on galera-2: -INFINITY
+clone_color: redis:7 allocation score on messaging-0: -INFINITY
+clone_color: redis:7 allocation score on messaging-1: -INFINITY
+clone_color: redis:7 allocation score on messaging-2: -INFINITY
+clone_color: redis:8 allocation score on controller-0: 0
+clone_color: redis:8 allocation score on controller-1: 0
+clone_color: redis:8 allocation score on controller-2: 0
+clone_color: redis:8 allocation score on galera-0: -INFINITY
+clone_color: redis:8 allocation score on galera-1: -INFINITY
+clone_color: redis:8 allocation score on galera-2: -INFINITY
+clone_color: redis:8 allocation score on messaging-0: -INFINITY
+clone_color: redis:8 allocation score on messaging-1: -INFINITY
+clone_color: redis:8 allocation score on messaging-2: -INFINITY
+galera:0 promotion score on galera-1: 100
+galera:1 promotion score on galera-2: 100
+galera:2 promotion score on galera-0: 100
+galera:3 promotion score on none: 0
+galera:4 promotion score on none: 0
+galera:5 promotion score on none: 0
+galera:6 promotion score on none: 0
+galera:7 promotion score on none: 0
+galera:8 promotion score on none: 0
+native_color: galera-0 allocation score on controller-0: 0
+native_color: galera-0 allocation score on controller-1: INFINITY
+native_color: galera-0 allocation score on controller-2: 0
+native_color: galera-0 allocation score on galera-0: -INFINITY
+native_color: galera-0 allocation score on galera-1: -INFINITY
+native_color: galera-0 allocation score on galera-2: -INFINITY
+native_color: galera-0 allocation score on messaging-0: -INFINITY
+native_color: galera-0 allocation score on messaging-1: -INFINITY
+native_color: galera-0 allocation score on messaging-2: -INFINITY
+native_color: galera-1 allocation score on controller-0: INFINITY
+native_color: galera-1 allocation score on controller-1: 0
+native_color: galera-1 allocation score on controller-2: 0
+native_color: galera-1 allocation score on galera-0: -INFINITY
+native_color: galera-1 allocation score on galera-1: -INFINITY
+native_color: galera-1 allocation score on galera-2: -INFINITY
+native_color: galera-1 allocation score on messaging-0: -INFINITY
+native_color: galera-1 allocation score on messaging-1: -INFINITY
+native_color: galera-1 allocation score on messaging-2: -INFINITY
+native_color: galera-2 allocation score on controller-0: 0
+native_color: galera-2 allocation score on controller-1: INFINITY
+native_color: galera-2 allocation score on controller-2: 0
+native_color: galera-2 allocation score on galera-0: -INFINITY
+native_color: galera-2 allocation score on galera-1: -INFINITY
+native_color: galera-2 allocation score on galera-2: -INFINITY
+native_color: galera-2 allocation score on messaging-0: -INFINITY
+native_color: galera-2 allocation score on messaging-1: -INFINITY
+native_color: galera-2 allocation score on messaging-2: -INFINITY
+native_color: galera:0 allocation score on controller-0: -INFINITY
+native_color: galera:0 allocation score on controller-1: -INFINITY
+native_color: galera:0 allocation score on controller-2: -INFINITY
+native_color: galera:0 allocation score on galera-0: 0
+native_color: galera:0 allocation score on galera-1: INFINITY
+native_color: galera:0 allocation score on galera-2: 0
+native_color: galera:0 allocation score on messaging-0: -INFINITY
+native_color: galera:0 allocation score on messaging-1: -INFINITY
+native_color: galera:0 allocation score on messaging-2: -INFINITY
+native_color: galera:1 allocation score on controller-0: -INFINITY
+native_color: galera:1 allocation score on controller-1: -INFINITY
+native_color: galera:1 allocation score on controller-2: -INFINITY
+native_color: galera:1 allocation score on galera-0: 0
+native_color: galera:1 allocation score on galera-1: -INFINITY
+native_color: galera:1 allocation score on galera-2: INFINITY
+native_color: galera:1 allocation score on messaging-0: -INFINITY
+native_color: galera:1 allocation score on messaging-1: -INFINITY
+native_color: galera:1 allocation score on messaging-2: -INFINITY
+native_color: galera:2 allocation score on controller-0: -INFINITY
+native_color: galera:2 allocation score on controller-1: -INFINITY
+native_color: galera:2 allocation score on controller-2: -INFINITY
+native_color: galera:2 allocation score on galera-0: INFINITY
+native_color: galera:2 allocation score on galera-1: -INFINITY
+native_color: galera:2 allocation score on galera-2: -INFINITY
+native_color: galera:2 allocation score on messaging-0: -INFINITY
+native_color: galera:2 allocation score on messaging-1: -INFINITY
+native_color: galera:2 allocation score on messaging-2: -INFINITY
+native_color: galera:3 allocation score on controller-0: -INFINITY
+native_color: galera:3 allocation score on controller-1: -INFINITY
+native_color: galera:3 allocation score on controller-2: -INFINITY
+native_color: galera:3 allocation score on galera-0: -INFINITY
+native_color: galera:3 allocation score on galera-1: -INFINITY
+native_color: galera:3 allocation score on galera-2: -INFINITY
+native_color: galera:3 allocation score on messaging-0: -INFINITY
+native_color: galera:3 allocation score on messaging-1: -INFINITY
+native_color: galera:3 allocation score on messaging-2: -INFINITY
+native_color: galera:4 allocation score on controller-0: -INFINITY
+native_color: galera:4 allocation score on controller-1: -INFINITY
+native_color: galera:4 allocation score on controller-2: -INFINITY
+native_color: galera:4 allocation score on galera-0: -INFINITY
+native_color: galera:4 allocation score on galera-1: -INFINITY
+native_color: galera:4 allocation score on galera-2: -INFINITY
+native_color: galera:4 allocation score on messaging-0: -INFINITY
+native_color: galera:4 allocation score on messaging-1: -INFINITY
+native_color: galera:4 allocation score on messaging-2: -INFINITY
+native_color: galera:5 allocation score on controller-0: -INFINITY
+native_color: galera:5 allocation score on controller-1: -INFINITY
+native_color: galera:5 allocation score on controller-2: -INFINITY
+native_color: galera:5 allocation score on galera-0: -INFINITY
+native_color: galera:5 allocation score on galera-1: -INFINITY
+native_color: galera:5 allocation score on galera-2: -INFINITY
+native_color: galera:5 allocation score on messaging-0: -INFINITY
+native_color: galera:5 allocation score on messaging-1: -INFINITY
+native_color: galera:5 allocation score on messaging-2: -INFINITY
+native_color: galera:6 allocation score on controller-0: -INFINITY
+native_color: galera:6 allocation score on controller-1: -INFINITY
+native_color: galera:6 allocation score on controller-2: -INFINITY
+native_color: galera:6 allocation score on galera-0: -INFINITY
+native_color: galera:6 allocation score on galera-1: -INFINITY
+native_color: galera:6 allocation score on galera-2: -INFINITY
+native_color: galera:6 allocation score on messaging-0: -INFINITY
+native_color: galera:6 allocation score on messaging-1: -INFINITY
+native_color: galera:6 allocation score on messaging-2: -INFINITY
+native_color: galera:7 allocation score on controller-0: -INFINITY
+native_color: galera:7 allocation score on controller-1: -INFINITY
+native_color: galera:7 allocation score on controller-2: -INFINITY
+native_color: galera:7 allocation score on galera-0: -INFINITY
+native_color: galera:7 allocation score on galera-1: -INFINITY
+native_color: galera:7 allocation score on galera-2: -INFINITY
+native_color: galera:7 allocation score on messaging-0: -INFINITY
+native_color: galera:7 allocation score on messaging-1: -INFINITY
+native_color: galera:7 allocation score on messaging-2: -INFINITY
+native_color: galera:8 allocation score on controller-0: -INFINITY
+native_color: galera:8 allocation score on controller-1: -INFINITY
+native_color: galera:8 allocation score on controller-2: -INFINITY
+native_color: galera:8 allocation score on galera-0: -INFINITY
+native_color: galera:8 allocation score on galera-1: -INFINITY
+native_color: galera:8 allocation score on galera-2: -INFINITY
+native_color: galera:8 allocation score on messaging-0: -INFINITY
+native_color: galera:8 allocation score on messaging-1: -INFINITY
+native_color: galera:8 allocation score on messaging-2: -INFINITY
+native_color: haproxy:0 allocation score on controller-0: -INFINITY
+native_color: haproxy:0 allocation score on controller-1: -INFINITY
+native_color: haproxy:0 allocation score on controller-2: -INFINITY
+native_color: haproxy:0 allocation score on galera-0: -INFINITY
+native_color: haproxy:0 allocation score on galera-1: -INFINITY
+native_color: haproxy:0 allocation score on galera-2: -INFINITY
+native_color: haproxy:0 allocation score on messaging-0: -INFINITY
+native_color: haproxy:0 allocation score on messaging-1: -INFINITY
+native_color: haproxy:0 allocation score on messaging-2: -INFINITY
+native_color: haproxy:1 allocation score on controller-0: INFINITY
+native_color: haproxy:1 allocation score on controller-1: -INFINITY
+native_color: haproxy:1 allocation score on controller-2: 0
+native_color: haproxy:1 allocation score on galera-0: -INFINITY
+native_color: haproxy:1 allocation score on galera-1: -INFINITY
+native_color: haproxy:1 allocation score on galera-2: -INFINITY
+native_color: haproxy:1 allocation score on messaging-0: -INFINITY
+native_color: haproxy:1 allocation score on messaging-1: -INFINITY
+native_color: haproxy:1 allocation score on messaging-2: -INFINITY
+native_color: haproxy:2 allocation score on controller-0: -INFINITY
+native_color: haproxy:2 allocation score on controller-1: -INFINITY
+native_color: haproxy:2 allocation score on controller-2: INFINITY
+native_color: haproxy:2 allocation score on galera-0: -INFINITY
+native_color: haproxy:2 allocation score on galera-1: -INFINITY
+native_color: haproxy:2 allocation score on galera-2: -INFINITY
+native_color: haproxy:2 allocation score on messaging-0: -INFINITY
+native_color: haproxy:2 allocation score on messaging-1: -INFINITY
+native_color: haproxy:2 allocation score on messaging-2: -INFINITY
+native_color: haproxy:3 allocation score on controller-0: -INFINITY
+native_color: haproxy:3 allocation score on controller-1: -INFINITY
+native_color: haproxy:3 allocation score on controller-2: -INFINITY
+native_color: haproxy:3 allocation score on galera-0: -INFINITY
+native_color: haproxy:3 allocation score on galera-1: -INFINITY
+native_color: haproxy:3 allocation score on galera-2: -INFINITY
+native_color: haproxy:3 allocation score on messaging-0: -INFINITY
+native_color: haproxy:3 allocation score on messaging-1: -INFINITY
+native_color: haproxy:3 allocation score on messaging-2: -INFINITY
+native_color: haproxy:4 allocation score on controller-0: -INFINITY
+native_color: haproxy:4 allocation score on controller-1: -INFINITY
+native_color: haproxy:4 allocation score on controller-2: -INFINITY
+native_color: haproxy:4 allocation score on galera-0: -INFINITY
+native_color: haproxy:4 allocation score on galera-1: -INFINITY
+native_color: haproxy:4 allocation score on galera-2: -INFINITY
+native_color: haproxy:4 allocation score on messaging-0: -INFINITY
+native_color: haproxy:4 allocation score on messaging-1: -INFINITY
+native_color: haproxy:4 allocation score on messaging-2: -INFINITY
+native_color: haproxy:5 allocation score on controller-0: -INFINITY
+native_color: haproxy:5 allocation score on controller-1: -INFINITY
+native_color: haproxy:5 allocation score on controller-2: -INFINITY
+native_color: haproxy:5 allocation score on galera-0: -INFINITY
+native_color: haproxy:5 allocation score on galera-1: -INFINITY
+native_color: haproxy:5 allocation score on galera-2: -INFINITY
+native_color: haproxy:5 allocation score on messaging-0: -INFINITY
+native_color: haproxy:5 allocation score on messaging-1: -INFINITY
+native_color: haproxy:5 allocation score on messaging-2: -INFINITY
+native_color: haproxy:6 allocation score on controller-0: -INFINITY
+native_color: haproxy:6 allocation score on controller-1: -INFINITY
+native_color: haproxy:6 allocation score on controller-2: -INFINITY
+native_color: haproxy:6 allocation score on galera-0: -INFINITY
+native_color: haproxy:6 allocation score on galera-1: -INFINITY
+native_color: haproxy:6 allocation score on galera-2: -INFINITY
+native_color: haproxy:6 allocation score on messaging-0: -INFINITY
+native_color: haproxy:6 allocation score on messaging-1: -INFINITY
+native_color: haproxy:6 allocation score on messaging-2: -INFINITY
+native_color: haproxy:7 allocation score on controller-0: -INFINITY
+native_color: haproxy:7 allocation score on controller-1: -INFINITY
+native_color: haproxy:7 allocation score on controller-2: -INFINITY
+native_color: haproxy:7 allocation score on galera-0: -INFINITY
+native_color: haproxy:7 allocation score on galera-1: -INFINITY
+native_color: haproxy:7 allocation score on galera-2: -INFINITY
+native_color: haproxy:7 allocation score on messaging-0: -INFINITY
+native_color: haproxy:7 allocation score on messaging-1: -INFINITY
+native_color: haproxy:7 allocation score on messaging-2: -INFINITY
+native_color: haproxy:8 allocation score on controller-0: -INFINITY
+native_color: haproxy:8 allocation score on controller-1: -INFINITY
+native_color: haproxy:8 allocation score on controller-2: -INFINITY
+native_color: haproxy:8 allocation score on galera-0: -INFINITY
+native_color: haproxy:8 allocation score on galera-1: -INFINITY
+native_color: haproxy:8 allocation score on galera-2: -INFINITY
+native_color: haproxy:8 allocation score on messaging-0: -INFINITY
+native_color: haproxy:8 allocation score on messaging-1: -INFINITY
+native_color: haproxy:8 allocation score on messaging-2: -INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-0: INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on controller-2: 0
+native_color: ip-10.0.0.102 allocation score on galera-0: -INFINITY
+native_color: ip-10.0.0.102 allocation score on galera-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on galera-2: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-0: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-1: -INFINITY
+native_color: ip-10.0.0.102 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.1.14 allocation score on controller-0: 0
+native_color: ip-172.17.1.14 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on controller-2: 0
+native_color: ip-172.17.1.14 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.1.14 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.1.14 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.1.17 allocation score on controller-0: 0
+native_color: ip-172.17.1.17 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on controller-2: 0
+native_color: ip-172.17.1.17 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.1.17 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.1.17 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-0: INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on controller-2: 0
+native_color: ip-172.17.3.15 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.3.15 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.3.15 allocation score on messaging-2: -INFINITY
+native_color: ip-172.17.4.11 allocation score on controller-0: 0
+native_color: ip-172.17.4.11 allocation score on controller-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on controller-2: 0
+native_color: ip-172.17.4.11 allocation score on galera-0: -INFINITY
+native_color: ip-172.17.4.11 allocation score on galera-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on galera-2: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-0: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-1: -INFINITY
+native_color: ip-172.17.4.11 allocation score on messaging-2: -INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-0: INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on controller-2: 0
+native_color: ip-192.168.24.6 allocation score on galera-0: -INFINITY
+native_color: ip-192.168.24.6 allocation score on galera-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on galera-2: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-0: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-1: -INFINITY
+native_color: ip-192.168.24.6 allocation score on messaging-2: -INFINITY
+native_color: messaging-0 allocation score on controller-0: INFINITY
+native_color: messaging-0 allocation score on controller-1: 0
+native_color: messaging-0 allocation score on controller-2: 0
+native_color: messaging-0 allocation score on galera-0: -INFINITY
+native_color: messaging-0 allocation score on galera-1: -INFINITY
+native_color: messaging-0 allocation score on galera-2: -INFINITY
+native_color: messaging-0 allocation score on messaging-0: -INFINITY
+native_color: messaging-0 allocation score on messaging-1: -INFINITY
+native_color: messaging-0 allocation score on messaging-2: -INFINITY
+native_color: messaging-1 allocation score on controller-0: 0
+native_color: messaging-1 allocation score on controller-1: INFINITY
+native_color: messaging-1 allocation score on controller-2: 0
+native_color: messaging-1 allocation score on galera-0: -INFINITY
+native_color: messaging-1 allocation score on galera-1: -INFINITY
+native_color: messaging-1 allocation score on galera-2: -INFINITY
+native_color: messaging-1 allocation score on messaging-0: -INFINITY
+native_color: messaging-1 allocation score on messaging-1: -INFINITY
+native_color: messaging-1 allocation score on messaging-2: -INFINITY
+native_color: messaging-2 allocation score on controller-0: INFINITY
+native_color: messaging-2 allocation score on controller-1: 0
+native_color: messaging-2 allocation score on controller-2: 0
+native_color: messaging-2 allocation score on galera-0: -INFINITY
+native_color: messaging-2 allocation score on galera-1: -INFINITY
+native_color: messaging-2 allocation score on galera-2: -INFINITY
+native_color: messaging-2 allocation score on messaging-0: -INFINITY
+native_color: messaging-2 allocation score on messaging-1: -INFINITY
+native_color: messaging-2 allocation score on messaging-2: -INFINITY
+native_color: openstack-cinder-volume allocation score on controller-0: INFINITY
+native_color: openstack-cinder-volume allocation score on controller-1: 0
+native_color: openstack-cinder-volume allocation score on controller-2: 0
+native_color: openstack-cinder-volume allocation score on galera-0: -INFINITY
+native_color: openstack-cinder-volume allocation score on galera-1: -INFINITY
+native_color: openstack-cinder-volume allocation score on galera-2: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-0: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-1: -INFINITY
+native_color: openstack-cinder-volume allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:0 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:0 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:0 allocation score on messaging-0: 0
+native_color: rabbitmq:0 allocation score on messaging-1: 0
+native_color: rabbitmq:0 allocation score on messaging-2: INFINITY
+native_color: rabbitmq:1 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:1 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:1 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:1 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:1 allocation score on messaging-0: INFINITY
+native_color: rabbitmq:1 allocation score on messaging-1: 0
+native_color: rabbitmq:1 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:2 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:2 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:2 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:2 allocation score on messaging-1: INFINITY
+native_color: rabbitmq:2 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:3 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:3 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:3 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:4 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:4 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:4 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:5 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:5 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:5 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:6 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:6 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:6 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:7 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:7 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:7 allocation score on messaging-2: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-0: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-1: -INFINITY
+native_color: rabbitmq:8 allocation score on controller-2: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-0: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-1: -INFINITY
+native_color: rabbitmq:8 allocation score on galera-2: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-0: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-1: -INFINITY
+native_color: rabbitmq:8 allocation score on messaging-2: -INFINITY
+native_color: redis:0 allocation score on controller-0: -INFINITY
+native_color: redis:0 allocation score on controller-1: -INFINITY
+native_color: redis:0 allocation score on controller-2: -INFINITY
+native_color: redis:0 allocation score on galera-0: -INFINITY
+native_color: redis:0 allocation score on galera-1: -INFINITY
+native_color: redis:0 allocation score on galera-2: -INFINITY
+native_color: redis:0 allocation score on messaging-0: -INFINITY
+native_color: redis:0 allocation score on messaging-1: -INFINITY
+native_color: redis:0 allocation score on messaging-2: -INFINITY
+native_color: redis:1 allocation score on controller-0: INFINITY
+native_color: redis:1 allocation score on controller-1: -INFINITY
+native_color: redis:1 allocation score on controller-2: 0
+native_color: redis:1 allocation score on galera-0: -INFINITY
+native_color: redis:1 allocation score on galera-1: -INFINITY
+native_color: redis:1 allocation score on galera-2: -INFINITY
+native_color: redis:1 allocation score on messaging-0: -INFINITY
+native_color: redis:1 allocation score on messaging-1: -INFINITY
+native_color: redis:1 allocation score on messaging-2: -INFINITY
+native_color: redis:2 allocation score on controller-0: -INFINITY
+native_color: redis:2 allocation score on controller-1: -INFINITY
+native_color: redis:2 allocation score on controller-2: INFINITY
+native_color: redis:2 allocation score on galera-0: -INFINITY
+native_color: redis:2 allocation score on galera-1: -INFINITY
+native_color: redis:2 allocation score on galera-2: -INFINITY
+native_color: redis:2 allocation score on messaging-0: -INFINITY
+native_color: redis:2 allocation score on messaging-1: -INFINITY
+native_color: redis:2 allocation score on messaging-2: -INFINITY
+native_color: redis:3 allocation score on controller-0: -INFINITY
+native_color: redis:3 allocation score on controller-1: -INFINITY
+native_color: redis:3 allocation score on controller-2: -INFINITY
+native_color: redis:3 allocation score on galera-0: -INFINITY
+native_color: redis:3 allocation score on galera-1: -INFINITY
+native_color: redis:3 allocation score on galera-2: -INFINITY
+native_color: redis:3 allocation score on messaging-0: -INFINITY
+native_color: redis:3 allocation score on messaging-1: -INFINITY
+native_color: redis:3 allocation score on messaging-2: -INFINITY
+native_color: redis:4 allocation score on controller-0: -INFINITY
+native_color: redis:4 allocation score on controller-1: -INFINITY
+native_color: redis:4 allocation score on controller-2: -INFINITY
+native_color: redis:4 allocation score on galera-0: -INFINITY
+native_color: redis:4 allocation score on galera-1: -INFINITY
+native_color: redis:4 allocation score on galera-2: -INFINITY
+native_color: redis:4 allocation score on messaging-0: -INFINITY
+native_color: redis:4 allocation score on messaging-1: -INFINITY
+native_color: redis:4 allocation score on messaging-2: -INFINITY
+native_color: redis:5 allocation score on controller-0: -INFINITY
+native_color: redis:5 allocation score on controller-1: -INFINITY
+native_color: redis:5 allocation score on controller-2: -INFINITY
+native_color: redis:5 allocation score on galera-0: -INFINITY
+native_color: redis:5 allocation score on galera-1: -INFINITY
+native_color: redis:5 allocation score on galera-2: -INFINITY
+native_color: redis:5 allocation score on messaging-0: -INFINITY
+native_color: redis:5 allocation score on messaging-1: -INFINITY
+native_color: redis:5 allocation score on messaging-2: -INFINITY
+native_color: redis:6 allocation score on controller-0: -INFINITY
+native_color: redis:6 allocation score on controller-1: -INFINITY
+native_color: redis:6 allocation score on controller-2: -INFINITY
+native_color: redis:6 allocation score on galera-0: -INFINITY
+native_color: redis:6 allocation score on galera-1: -INFINITY
+native_color: redis:6 allocation score on galera-2: -INFINITY
+native_color: redis:6 allocation score on messaging-0: -INFINITY
+native_color: redis:6 allocation score on messaging-1: -INFINITY
+native_color: redis:6 allocation score on messaging-2: -INFINITY
+native_color: redis:7 allocation score on controller-0: -INFINITY
+native_color: redis:7 allocation score on controller-1: -INFINITY
+native_color: redis:7 allocation score on controller-2: -INFINITY
+native_color: redis:7 allocation score on galera-0: -INFINITY
+native_color: redis:7 allocation score on galera-1: -INFINITY
+native_color: redis:7 allocation score on galera-2: -INFINITY
+native_color: redis:7 allocation score on messaging-0: -INFINITY
+native_color: redis:7 allocation score on messaging-1: -INFINITY
+native_color: redis:7 allocation score on messaging-2: -INFINITY
+native_color: redis:8 allocation score on controller-0: -INFINITY
+native_color: redis:8 allocation score on controller-1: -INFINITY
+native_color: redis:8 allocation score on controller-2: -INFINITY
+native_color: redis:8 allocation score on galera-0: -INFINITY
+native_color: redis:8 allocation score on galera-1: -INFINITY
+native_color: redis:8 allocation score on galera-2: -INFINITY
+native_color: redis:8 allocation score on messaging-0: -INFINITY
+native_color: redis:8 allocation score on messaging-1: -INFINITY
+native_color: redis:8 allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-1: INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on controller-2: 0
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-5254005bdbb5 allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-0: INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on controller-2: 0
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400b4f6bd allocation score on messaging-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-0: INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-1: 0
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on controller-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on galera-2: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-0: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-1: -INFINITY
+native_color: stonith-fence_ipmilan-525400bbf613 allocation score on messaging-2: -INFINITY
+redis:0 promotion score on none: 0
+redis:1 promotion score on controller-0: 1
+redis:2 promotion score on controller-2: 1
+redis:3 promotion score on none: 0
+redis:4 promotion score on none: 0
+redis:5 promotion score on none: 0
+redis:6 promotion score on none: 0
+redis:7 promotion score on none: 0
+redis:8 promotion score on none: 0
diff --git a/pengine/test10/remote-recover-connection.summary b/pengine/test10/remote-recover-connection.summary
new file mode 100644
index 0000000..57b5e01
--- /dev/null
+++ b/pengine/test10/remote-recover-connection.summary
@@ -0,0 +1,139 @@
+Using the original execution date of: 2017-05-03 13:33:24Z
+
+Current cluster status:
+Node controller-1 (2): UNCLEAN (offline)
+Online: [ controller-0 controller-2 ]
+RemoteOnline: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+
+ messaging-0	(ocf::pacemaker:remote):	Started controller-0
+ messaging-1	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ messaging-2	(ocf::pacemaker:remote):	Started controller-0
+ galera-0	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ galera-1	(ocf::pacemaker:remote):	Started controller-0
+ galera-2	(ocf::pacemaker:remote):	Started controller-1 (UNCLEAN)
+ Clone Set: rabbitmq-clone [rabbitmq]
+     Started: [ messaging-0 messaging-1 messaging-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 ]
+ Master/Slave Set: galera-master [galera]
+     Masters: [ galera-0 galera-1 galera-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 messaging-0 messaging-1 messaging-2 ]
+ Master/Slave Set: redis-master [redis]
+     redis	(ocf::heartbeat:redis):	Slave controller-1 (UNCLEAN)
+     Masters: [ controller-0 ]
+     Slaves: [ controller-2 ]
+     Stopped: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ ip-192.168.24.6	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-10.0.0.102	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.1.14	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ ip-172.17.1.17	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ ip-172.17.3.15	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.4.11	(ocf::heartbeat:IPaddr2):	Started controller-1 (UNCLEAN)
+ Clone Set: haproxy-clone [haproxy]
+     haproxy	(systemd:haproxy):	Started controller-1 (UNCLEAN)
+     Started: [ controller-0 controller-2 ]
+     Stopped: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ openstack-cinder-volume	(systemd:openstack-cinder-volume):	Started controller-0
+ stonith-fence_ipmilan-525400bbf613	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-525400b4f6bd	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-5254005bdbb5	(stonith:fence_ipmilan):	Started controller-1 (UNCLEAN)
+
+Transition Summary:
+ * Move    messaging-1	(Started controller-1 -> controller-2)
+ * Move    galera-0	(Started controller-1 -> controller-2)
+ * Move    galera-2	(Started controller-1 -> controller-2)
+ * Stop    redis:0	(controller-1)
+ * Move    ip-172.17.1.14	(Started controller-1 -> controller-2)
+ * Move    ip-172.17.1.17	(Started controller-1 -> controller-2)
+ * Move    ip-172.17.4.11	(Started controller-1 -> controller-2)
+ * Stop    haproxy:0	(controller-1)
+ * Restart stonith-fence_ipmilan-525400bbf613	(Started controller-0)
+ * Restart stonith-fence_ipmilan-525400b4f6bd	(Started controller-0)
+ * Move    stonith-fence_ipmilan-5254005bdbb5	(Started controller-1 -> controller-2)
+
+Executing cluster transition:
+ * Pseudo action:   redis-master_pre_notify_stop_0
+ * Resource action: stonith-fence_ipmilan-525400bbf613 stop on controller-0
+ * Resource action: stonith-fence_ipmilan-525400bbf613 start on controller-0
+ * Resource action: stonith-fence_ipmilan-525400bbf613 monitor=60000 on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd stop on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd start on controller-0
+ * Resource action: stonith-fence_ipmilan-525400b4f6bd monitor=60000 on controller-0
+ * Pseudo action:   stonith-fence_ipmilan-5254005bdbb5_stop_0
+ * Fencing controller-1 (reboot)
+ * Pseudo action:   stonith_complete
+ * Pseudo action:   messaging-1_stop_0
+ * Pseudo action:   galera-0_stop_0
+ * Pseudo action:   galera-2_stop_0
+ * Pseudo action:   redis_post_notify_stop_0
+ * Resource action: redis           notify on controller-0
+ * Resource action: redis           notify on controller-2
+ * Pseudo action:   redis-master_confirmed-pre_notify_stop_0
+ * Pseudo action:   redis-master_stop_0
+ * Pseudo action:   haproxy-clone_stop_0
+ * Resource action: stonith-fence_ipmilan-5254005bdbb5 start on controller-2
+ * Resource action: messaging-1     start on controller-2
+ * Resource action: galera-0        start on controller-2
+ * Resource action: galera-2        start on controller-2
+ * Resource action: rabbitmq        monitor=10000 on messaging-1
+ * Resource action: galera          monitor=10000 on galera-2
+ * Resource action: galera          monitor=10000 on galera-0
+ * Pseudo action:   redis_stop_0
+ * Pseudo action:   redis-master_stopped_0
+ * Pseudo action:   haproxy_stop_0
+ * Pseudo action:   haproxy-clone_stopped_0
+ * Resource action: stonith-fence_ipmilan-5254005bdbb5 monitor=60000 on controller-2
+ * Resource action: messaging-1     monitor=20000 on controller-2
+ * Resource action: galera-0        monitor=20000 on controller-2
+ * Resource action: galera-2        monitor=20000 on controller-2
+ * Pseudo action:   redis-master_post_notify_stopped_0
+ * Pseudo action:   ip-172.17.1.14_stop_0
+ * Pseudo action:   ip-172.17.1.17_stop_0
+ * Pseudo action:   ip-172.17.4.11_stop_0
+ * Resource action: redis           notify on controller-0
+ * Resource action: redis           notify on controller-2
+ * Pseudo action:   redis-master_confirmed-post_notify_stopped_0
+ * Resource action: ip-172.17.1.14  start on controller-2
+ * Resource action: ip-172.17.1.17  start on controller-2
+ * Resource action: ip-172.17.4.11  start on controller-2
+ * Pseudo action:   redis_notified_0
+ * Resource action: ip-172.17.1.14  monitor=10000 on controller-2
+ * Resource action: ip-172.17.1.17  monitor=10000 on controller-2
+ * Resource action: ip-172.17.4.11  monitor=10000 on controller-2
+ * Pseudo action:   all_stopped
+Using the original execution date of: 2017-05-03 13:33:24Z
+
+Revised cluster status:
+Online: [ controller-0 controller-2 ]
+OFFLINE: [ controller-1 ]
+RemoteOnline: [ galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+
+ messaging-0	(ocf::pacemaker:remote):	Started controller-0
+ messaging-1	(ocf::pacemaker:remote):	Started controller-2
+ messaging-2	(ocf::pacemaker:remote):	Started controller-0
+ galera-0	(ocf::pacemaker:remote):	Started controller-2
+ galera-1	(ocf::pacemaker:remote):	Started controller-0
+ galera-2	(ocf::pacemaker:remote):	Started controller-2
+ Clone Set: rabbitmq-clone [rabbitmq]
+     Started: [ messaging-0 messaging-1 messaging-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 galera-0 galera-1 galera-2 ]
+ Master/Slave Set: galera-master [galera]
+     Masters: [ galera-0 galera-1 galera-2 ]
+     Stopped: [ controller-0 controller-1 controller-2 messaging-0 messaging-1 messaging-2 ]
+ Master/Slave Set: redis-master [redis]
+     Masters: [ controller-0 ]
+     Slaves: [ controller-2 ]
+     Stopped: [ controller-1 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ ip-192.168.24.6	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-10.0.0.102	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.1.14	(ocf::heartbeat:IPaddr2):	Started controller-2
+ ip-172.17.1.17	(ocf::heartbeat:IPaddr2):	Started controller-2
+ ip-172.17.3.15	(ocf::heartbeat:IPaddr2):	Started controller-0
+ ip-172.17.4.11	(ocf::heartbeat:IPaddr2):	Started controller-2
+ Clone Set: haproxy-clone [haproxy]
+     Started: [ controller-0 controller-2 ]
+     Stopped: [ controller-1 galera-0 galera-1 galera-2 messaging-0 messaging-1 messaging-2 ]
+ openstack-cinder-volume	(systemd:openstack-cinder-volume):	Started controller-0
+ stonith-fence_ipmilan-525400bbf613	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-525400b4f6bd	(stonith:fence_ipmilan):	Started controller-0
+ stonith-fence_ipmilan-5254005bdbb5	(stonith:fence_ipmilan):	Started controller-2
+
diff --git a/pengine/test10/remote-recover-connection.xml b/pengine/test10/remote-recover-connection.xml
new file mode 100644
index 0000000..f921dfe
--- /dev/null
+++ b/pengine/test10/remote-recover-connection.xml
@@ -0,0 +1,739 @@
+<cib crm_feature_set="3.0.10" validate-with="pacemaker-2.5" epoch="177" num_updates="291" admin_epoch="0" cib-last-written="Wed May  3 13:24:28 2017" update-origin="controller-0" update-client="crm_attribute" update-user="root" have-quorum="1" dc-uuid="1" execution-date="1493818404">
+  <configuration>
+    <crm_config>
+      <cluster_property_set id="cib-bootstrap-options">
+        <nvpair id="cib-bootstrap-options-have-watchdog" name="have-watchdog" value="false"/>
+        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.15-11.el7_3.4-e174ec8"/>
+        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="corosync"/>
+        <nvpair id="cib-bootstrap-options-cluster-name" name="cluster-name" value="tripleo_cluster"/>
+        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="true"/>
+        <nvpair id="cib-bootstrap-options-cluster-recheck-interval" name="cluster-recheck-interval" value="60s"/>
+        <nvpair id="cib-bootstrap-options-maintenance-mode" name="maintenance-mode" value="false"/>
+        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1493817755"/>
+      </cluster_property_set>
+      <cluster_property_set id="redis_replication">
+        <nvpair id="redis_replication-redis_REPL_INFO" name="redis_REPL_INFO" value="controller-0"/>
+      </cluster_property_set>
+    </crm_config>
+    <nodes>
+      <node id="1" uname="controller-0">
+        <instance_attributes id="nodes-1">
+          <nvpair id="nodes-1-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-1-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-1-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="2" uname="controller-1">
+        <instance_attributes id="nodes-2">
+          <nvpair id="nodes-2-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-2-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-2-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="3" uname="controller-2">
+        <instance_attributes id="nodes-3">
+          <nvpair id="nodes-3-cinder-volume-role" name="cinder-volume-role" value="true"/>
+          <nvpair id="nodes-3-haproxy-role" name="haproxy-role" value="true"/>
+          <nvpair id="nodes-3-redis-role" name="redis-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-1" type="remote" uname="messaging-1">
+        <instance_attributes id="nodes-messaging-1">
+          <nvpair id="nodes-messaging-1-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-1-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-1"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-1" type="remote" uname="galera-1">
+        <instance_attributes id="nodes-galera-1">
+          <nvpair id="nodes-galera-1-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-0" type="remote" uname="messaging-0">
+        <instance_attributes id="nodes-messaging-0">
+          <nvpair id="nodes-messaging-0-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-0-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-0"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-2" type="remote" uname="galera-2">
+        <instance_attributes id="nodes-galera-2">
+          <nvpair id="nodes-galera-2-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+      <node id="messaging-2" type="remote" uname="messaging-2">
+        <instance_attributes id="nodes-messaging-2">
+          <nvpair id="nodes-messaging-2-rabbitmq-role" name="rabbitmq-role" value="true"/>
+          <nvpair id="nodes-messaging-2-rmq-node-attr-last-known-rabbitmq" name="rmq-node-attr-last-known-rabbitmq" value="rabbit@messaging-2"/>
+        </instance_attributes>
+      </node>
+      <node id="galera-0" type="remote" uname="galera-0">
+        <instance_attributes id="nodes-galera-0">
+          <nvpair id="nodes-galera-0-galera-role" name="galera-role" value="true"/>
+        </instance_attributes>
+      </node>
+    </nodes>
+    <resources>
+      <primitive class="ocf" id="messaging-0" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-0-instance_attributes">
+          <nvpair id="messaging-0-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-0-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-0-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-0-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="messaging-1" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-1-instance_attributes">
+          <nvpair id="messaging-1-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-1-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-1-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-1-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="messaging-2" provider="pacemaker" type="remote">
+        <instance_attributes id="messaging-2-instance_attributes">
+          <nvpair id="messaging-2-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="messaging-2-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="messaging-2-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="messaging-2-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-0" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-0-instance_attributes">
+          <nvpair id="galera-0-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-0-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-0-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-0-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-1" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-1-instance_attributes">
+          <nvpair id="galera-1-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-1-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-1-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-1-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="galera-2" provider="pacemaker" type="remote">
+        <instance_attributes id="galera-2-instance_attributes">
+          <nvpair id="galera-2-instance_attributes-reconnect_interval" name="reconnect_interval" value="60"/>
+        </instance_attributes>
+        <operations>
+          <op id="galera-2-start-interval-0s" interval="0s" name="start" timeout="60"/>
+          <op id="galera-2-stop-interval-0s" interval="0s" name="stop" timeout="60"/>
+          <op id="galera-2-monitor-interval-20" interval="20" name="monitor"/>
+        </operations>
+      </primitive>
+      <clone id="rabbitmq-clone">
+        <primitive class="ocf" id="rabbitmq" provider="heartbeat" type="rabbitmq-cluster">
+          <instance_attributes id="rabbitmq-instance_attributes">
+            <nvpair id="rabbitmq-instance_attributes-set_policy" name="set_policy" value="ha-all ^(?!amq\.).* {&quot;ha-mode&quot;:&quot;exactly&quot;,&quot;ha-params&quot;:2}"/>
+          </instance_attributes>
+          <meta_attributes id="rabbitmq-meta_attributes">
+            <nvpair id="rabbitmq-meta_attributes-notify" name="notify" value="true"/>
+          </meta_attributes>
+          <operations>
+            <op id="rabbitmq-monitor-interval-10" interval="10" name="monitor" timeout="40"/>
+            <op id="rabbitmq-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="rabbitmq-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="rabbitmq-clone-meta_attributes">
+          <nvpair id="rabbitmq-clone-meta_attributes-interleave" name="interleave" value="true"/>
+          <nvpair id="rabbitmq-clone-meta_attributes-ordered" name="ordered" value="true"/>
+        </meta_attributes>
+      </clone>
+      <master id="galera-master">
+        <primitive class="ocf" id="galera" provider="heartbeat" type="galera">
+          <instance_attributes id="galera-instance_attributes">
+            <nvpair id="galera-instance_attributes-additional_parameters" name="additional_parameters" value="--open-files-limit=16384"/>
+            <nvpair id="galera-instance_attributes-enable_creation" name="enable_creation" value="true"/>
+            <nvpair id="galera-instance_attributes-wsrep_cluster_address" name="wsrep_cluster_address" value="gcomm://galera-0,galera-1,galera-2"/>
+          </instance_attributes>
+          <operations>
+            <op id="galera-start-interval-0s" interval="0s" name="start" timeout="120"/>
+            <op id="galera-stop-interval-0s" interval="0s" name="stop" timeout="120"/>
+            <op id="galera-monitor-interval-20" interval="20" name="monitor" timeout="30"/>
+            <op id="galera-monitor-interval-10" interval="10" name="monitor" role="Master" timeout="30"/>
+            <op id="galera-monitor-interval-30" interval="30" name="monitor" role="Slave" timeout="30"/>
+            <op id="galera-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="galera-promote-interval-0s" interval="0s" name="promote" on-fail="block" timeout="300s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="galera-master-meta_attributes">
+          <nvpair id="galera-master-meta_attributes-ordered" name="ordered" value="true"/>
+          <nvpair id="galera-master-meta_attributes-master-max" name="master-max" value="3"/>
+        </meta_attributes>
+      </master>
+      <master id="redis-master">
+        <primitive class="ocf" id="redis" provider="heartbeat" type="redis">
+          <instance_attributes id="redis-instance_attributes">
+            <nvpair id="redis-instance_attributes-wait_last_known_master" name="wait_last_known_master" value="true"/>
+          </instance_attributes>
+          <operations>
+            <op id="redis-monitor-interval-45" interval="45" name="monitor" timeout="60"/>
+            <op id="redis-monitor-interval-20" interval="20" name="monitor" role="Master" timeout="60"/>
+            <op id="redis-monitor-interval-60" interval="60" name="monitor" role="Slave" timeout="60"/>
+            <op id="redis-promote-interval-0s" interval="0s" name="promote" timeout="120"/>
+            <op id="redis-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="redis-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="redis-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="redis-master-meta_attributes">
+          <nvpair id="redis-master-meta_attributes-interleave" name="interleave" value="true"/>
+          <nvpair id="redis-master-meta_attributes-ordered" name="ordered" value="true"/>
+          <nvpair id="redis-master-meta_attributes-notify" name="notify" value="true"/>
+        </meta_attributes>
+      </master>
+      <primitive class="ocf" id="ip-192.168.24.6" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-192.168.24.6-instance_attributes">
+          <nvpair id="ip-192.168.24.6-instance_attributes-ip" name="ip" value="192.168.24.6"/>
+          <nvpair id="ip-192.168.24.6-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-192.168.24.6-meta_attributes"/>
+        <operations>
+          <op id="ip-192.168.24.6-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-192.168.24.6-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-192.168.24.6-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-10.0.0.102" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-10.0.0.102-instance_attributes">
+          <nvpair id="ip-10.0.0.102-instance_attributes-ip" name="ip" value="10.0.0.102"/>
+          <nvpair id="ip-10.0.0.102-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-10.0.0.102-meta_attributes"/>
+        <operations>
+          <op id="ip-10.0.0.102-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-10.0.0.102-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-10.0.0.102-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.1.14" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.1.14-instance_attributes">
+          <nvpair id="ip-172.17.1.14-instance_attributes-ip" name="ip" value="172.17.1.14"/>
+          <nvpair id="ip-172.17.1.14-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.1.14-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.1.14-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.1.14-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.1.14-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.1.17" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.1.17-instance_attributes">
+          <nvpair id="ip-172.17.1.17-instance_attributes-ip" name="ip" value="172.17.1.17"/>
+          <nvpair id="ip-172.17.1.17-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.1.17-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.1.17-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.1.17-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.1.17-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.3.15" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.3.15-instance_attributes">
+          <nvpair id="ip-172.17.3.15-instance_attributes-ip" name="ip" value="172.17.3.15"/>
+          <nvpair id="ip-172.17.3.15-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.3.15-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.3.15-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.3.15-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.3.15-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <primitive class="ocf" id="ip-172.17.4.11" provider="heartbeat" type="IPaddr2">
+        <instance_attributes id="ip-172.17.4.11-instance_attributes">
+          <nvpair id="ip-172.17.4.11-instance_attributes-ip" name="ip" value="172.17.4.11"/>
+          <nvpair id="ip-172.17.4.11-instance_attributes-cidr_netmask" name="cidr_netmask" value="32"/>
+        </instance_attributes>
+        <meta_attributes id="ip-172.17.4.11-meta_attributes"/>
+        <operations>
+          <op id="ip-172.17.4.11-start-interval-0s" interval="0s" name="start" timeout="20s"/>
+          <op id="ip-172.17.4.11-stop-interval-0s" interval="0s" name="stop" timeout="20s"/>
+          <op id="ip-172.17.4.11-monitor-interval-10s" interval="10s" name="monitor" timeout="20s"/>
+        </operations>
+      </primitive>
+      <clone id="haproxy-clone">
+        <primitive class="systemd" id="haproxy" type="haproxy">
+          <instance_attributes id="haproxy-instance_attributes"/>
+          <meta_attributes id="haproxy-meta_attributes"/>
+          <operations>
+            <op id="haproxy-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+            <op id="haproxy-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+            <op id="haproxy-monitor-interval-60s" interval="60s" name="monitor"/>
+          </operations>
+        </primitive>
+        <meta_attributes id="haproxy-clone-meta_attributes"/>
+      </clone>
+      <primitive class="systemd" id="openstack-cinder-volume" type="openstack-cinder-volume">
+        <instance_attributes id="openstack-cinder-volume-instance_attributes"/>
+        <meta_attributes id="openstack-cinder-volume-meta_attributes"/>
+        <operations>
+          <op id="openstack-cinder-volume-start-interval-0s" interval="0s" name="start" timeout="200s"/>
+          <op id="openstack-cinder-volume-stop-interval-0s" interval="0s" name="stop" timeout="200s"/>
+          <op id="openstack-cinder-volume-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-525400bbf613-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-2"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-ipport" name="ipport" value="6237"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-525400bbf613-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-525400bbf613-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-525400bbf613-meta_attributes"/>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-1"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-ipport" name="ipport" value="6236"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-525400b4f6bd-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-525400b4f6bd-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-525400b4f6bd-meta_attributes"/>
+      </primitive>
+      <primitive class="stonith" id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan">
+        <instance_attributes id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes">
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-pcmk_host_list" name="pcmk_host_list" value="controller-0"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-ipaddr" name="ipaddr" value="172.16.0.1"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-ipport" name="ipport" value="6235"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-passwd" name="passwd" value="****"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-lanplus" name="lanplus" value="true"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-login" name="login" value="admin"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-action" name="action" value="reboot"/>
+          <nvpair id="stonith-fence_ipmilan-5254005bdbb5-instance_attributes-privlvl" name="privlvl" value="administrator"/>
+        </instance_attributes>
+        <operations>
+          <op id="stonith-fence_ipmilan-5254005bdbb5-monitor-interval-60s" interval="60s" name="monitor"/>
+        </operations>
+        <meta_attributes id="stonith-fence_ipmilan-5254005bdbb5-meta_attributes"/>
+      </primitive>
+    </resources>
+    <constraints>
+      <rsc_location id="location-rabbitmq-clone" resource-discovery="exclusive" rsc="rabbitmq-clone">
+        <rule id="location-rabbitmq-clone-rule" score="0">
+          <expression attribute="rabbitmq-role" id="location-rabbitmq-clone-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-galera-master" resource-discovery="exclusive" rsc="galera-master">
+        <rule id="location-galera-master-rule" score="0">
+          <expression attribute="galera-role" id="location-galera-master-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-redis-master" resource-discovery="exclusive" rsc="redis-master">
+        <rule id="location-redis-master-rule" score="0">
+          <expression attribute="redis-role" id="location-redis-master-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-192.168.24.6" resource-discovery="exclusive" rsc="ip-192.168.24.6">
+        <rule id="location-ip-192.168.24.6-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-192.168.24.6-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-10.0.0.102" resource-discovery="exclusive" rsc="ip-10.0.0.102">
+        <rule id="location-ip-10.0.0.102-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-10.0.0.102-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.1.14" resource-discovery="exclusive" rsc="ip-172.17.1.14">
+        <rule id="location-ip-172.17.1.14-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.1.14-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.1.17" resource-discovery="exclusive" rsc="ip-172.17.1.17">
+        <rule id="location-ip-172.17.1.17-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.1.17-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.3.15" resource-discovery="exclusive" rsc="ip-172.17.3.15">
+        <rule id="location-ip-172.17.3.15-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.3.15-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-ip-172.17.4.11" resource-discovery="exclusive" rsc="ip-172.17.4.11">
+        <rule id="location-ip-172.17.4.11-rule" score="0">
+          <expression attribute="haproxy-role" id="location-ip-172.17.4.11-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-haproxy-clone" resource-discovery="exclusive" rsc="haproxy-clone">
+        <rule id="location-haproxy-clone-rule" score="0">
+          <expression attribute="haproxy-role" id="location-haproxy-clone-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_order first="ip-192.168.24.6" first-action="start" id="order-ip-192.168.24.6-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-192.168.24.6-haproxy-clone-INFINITY" rsc="ip-192.168.24.6" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-10.0.0.102" first-action="start" id="order-ip-10.0.0.102-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-10.0.0.102-haproxy-clone-INFINITY" rsc="ip-10.0.0.102" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.1.14" first-action="start" id="order-ip-172.17.1.14-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.1.14-haproxy-clone-INFINITY" rsc="ip-172.17.1.14" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.1.17" first-action="start" id="order-ip-172.17.1.17-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.1.17-haproxy-clone-INFINITY" rsc="ip-172.17.1.17" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.3.15" first-action="start" id="order-ip-172.17.3.15-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.3.15-haproxy-clone-INFINITY" rsc="ip-172.17.3.15" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_order first="ip-172.17.4.11" first-action="start" id="order-ip-172.17.4.11-haproxy-clone-Optional" kind="Optional" then="haproxy-clone" then-action="start"/>
+      <rsc_colocation id="colocation-ip-172.17.4.11-haproxy-clone-INFINITY" rsc="ip-172.17.4.11" score="INFINITY" with-rsc="haproxy-clone"/>
+      <rsc_location id="location-openstack-cinder-volume" resource-discovery="exclusive" rsc="openstack-cinder-volume">
+        <rule id="location-openstack-cinder-volume-rule" score="0">
+          <expression attribute="cinder-volume-role" id="location-openstack-cinder-volume-rule-expr" operation="eq" value="true"/>
+        </rule>
+      </rsc_location>
+      <rsc_location id="location-stonith-fence_ipmilan-525400bbf613-controller-2--INFINITY" node="controller-2" rsc="stonith-fence_ipmilan-525400bbf613" score="-INFINITY"/>
+      <rsc_location id="location-stonith-fence_ipmilan-525400b4f6bd-controller-1--INFINITY" node="controller-1" rsc="stonith-fence_ipmilan-525400b4f6bd" score="-INFINITY"/>
+      <rsc_location id="location-stonith-fence_ipmilan-5254005bdbb5-controller-0--INFINITY" node="controller-0" rsc="stonith-fence_ipmilan-5254005bdbb5" score="-INFINITY"/>
+    </constraints>
+    <rsc_defaults>
+      <meta_attributes id="rsc_defaults-options">
+        <nvpair id="rsc_defaults-options-resource-stickiness" name="resource-stickiness" value="INFINITY"/>
+      </meta_attributes>
+    </rsc_defaults>
+  </configuration>
+  <status>
+    <node_state id="2" uname="controller-1" in_ccm="false" crmd="offline" crm-debug-origin="post_cache_update" join="member" expected="member">
+      <lrm id="2">
+        <lrm_resources>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="37:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;37:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="20" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="44" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="138:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;138:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="46" rc-code="0" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="2088" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;119:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="63" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817892" exec-time="1" queue-time="1" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="43:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;43:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="45" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="118:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;118:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="70" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="58" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+            <lrm_rsc_op id="ip-172.17.4.11_monitor_10000" operation_key="ip-172.17.4.11_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;119:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="71" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="38" queue-time="0" op-digest="392445a354e2da75dcd4cbe6eee1268b"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="29:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;29:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="1" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="38:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;38:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="7" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-1_monitor_20000" operation_key="messaging-1_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;36:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="10" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="31:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;31:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="3" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;36:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="16" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="49" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="40:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;40:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="32" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="45" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="110:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;110:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="69" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="60" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+            <lrm_rsc_op id="ip-172.17.1.14_monitor_10000" operation_key="ip-172.17.1.14_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="111:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;111:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="72" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="36" queue-time="0" op-digest="19c32490a75539eb9cf2ca18727e305e"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="113:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;113:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="68" rc-code="0" op-status="0" interval="0" last-run="1493817963" last-rc-change="1493817963" exec-time="62" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+            <lrm_rsc_op id="ip-172.17.1.17_monitor_10000" operation_key="ip-172.17.1.17_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="114:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;114:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="73" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817964" exec-time="36" queue-time="0" op-digest="637be44014a8de2a8162cb2b062f6955"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="44:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;44:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="50" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="3" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="148:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;148:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="65" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="79" queue-time="0" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="149:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;149:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="66" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817963" exec-time="80" queue-time="0" op-digest="e8a37549d88ca88c76d297b973759a8d" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="95:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;95:5:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="55" rc-code="0" op-status="0" interval="0" last-run="1493817890" last-rc-change="1493817890" exec-time="2553" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_45000" operation_key="redis_monitor_45000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="73:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;73:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="62" rc-code="0" op-status="0" interval="45000" last-rc-change="1493817892" exec-time="124" queue-time="135" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_60000" operation_key="redis_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="74:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;74:6:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="61" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817892" exec-time="135" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="48:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;48:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="8" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-0_monitor_20000" operation_key="galera-0_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="38:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;38:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="11" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="33:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;33:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="5" rc-code="7" op-status="0" interval="0" last-run="1493817888" last-rc-change="1493817888" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="55:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;55:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="9" rc-code="0" op-status="0" interval="0" last-run="1493817961" last-rc-change="1493817961" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-1" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-2_monitor_20000" operation_key="galera-2_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="44:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;44:9:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="12" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="45:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:7;45:5:7:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-1" call-id="54" rc-code="7" op-status="0" interval="0" last-run="1493817889" last-rc-change="1493817889" exec-time="0" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="1" uname="controller-0" crmd="online" crm-debug-origin="post_cache_update" in_ccm="true" join="member" expected="member">
+      <transient_attributes id="1">
+        <instance_attributes id="status-1">
+          <nvpair id="status-1-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-1-master-redis" name="master-redis" value="1"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="1">
+        <lrm_resources>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;119:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="143" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="497" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+            <lrm_rsc_op id="ip-10.0.0.102_monitor_10000" operation_key="ip-10.0.0.102_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="120:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;120:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="147" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817835" exec-time="48" queue-time="0" op-digest="83daeb09ea7f361d0c80eb34aaf106f9"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_failure_0" operation_key="haproxy_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="114" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;15:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="114" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="113:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;113:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="133" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817765" exec-time="4" queue-time="0" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="119:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;119:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="150" rc-code="0" op-status="0" interval="0" last-run="1493817868" last-rc-change="1493817868" exec-time="2105" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="openstack-cinder-volume_monitor_60000" operation_key="openstack-cinder-volume_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="145:1:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;145:1:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="154" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817878" exec-time="3" queue-time="1" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="14:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;14:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="109" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="66" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="36:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;36:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="13" rc-code="0" op-status="0" interval="0" last-run="1493817832" last-rc-change="1493817832" exec-time="0" queue-time="0" migrate_source="controller-1" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-0_monitor_20000" operation_key="messaging-0_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="34:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;34:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="15" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817832" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="3:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;3:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="8" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="43:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;43:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="17" rc-code="0" op-status="0" interval="0" last-run="1493817962" last-rc-change="1493817962" exec-time="0" queue-time="0" migrate_source="controller-2" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="messaging-2_monitor_20000" operation_key="messaging-2_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="41:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:0;41:8:0:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="18" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817963" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="11:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;11:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="97" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="60" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="124:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;124:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="134" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="83" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_monitor_60000" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="129:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;129:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="136" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817768" exec-time="68" queue-time="0" op-digest="31be355d25ac30183b5d304f3275ec16" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="12:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;12:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="101" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="68" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="19:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;19:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="130" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="126:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;126:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="141" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="66" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+            <lrm_rsc_op id="ip-172.17.3.15_monitor_10000" operation_key="ip-172.17.3.15_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="127:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;127:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="144" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817834" exec-time="428" queue-time="0" op-digest="9f5ae0b4f77392ad67e6a430d3259ec4"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="116:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;116:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="142" rc-code="0" op-status="0" interval="0" last-run="1493817834" last-rc-change="1493817834" exec-time="498" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+            <lrm_rsc_op id="ip-192.168.24.6_monitor_10000" operation_key="ip-192.168.24.6_monitor_10000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="117:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;117:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="146" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817835" exec-time="38" queue-time="0" op-digest="53892658d5fe65d671f4c791888c8c7c"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_failure_0" operation_key="redis_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="8:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;8:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="85" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="171" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_promote_0" operation="promote" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="71:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;71:23:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="152" rc-code="0" op-status="0" interval="0" last-run="1493817868" last-rc-change="1493817868" exec-time="255" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_20000" operation_key="redis_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="74:4:8:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" transition-magic="0:8;74:4:8:5c19b904-a6d8-4a4f-9b6d-9ab13f4f6b57" on_node="controller-0" call-id="159" rc-code="8" op-status="0" interval="20000" last-rc-change="1493817884" exec-time="147" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="5:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;5:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="10" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_migrate_from_0" operation="migrate_from" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="50:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;50:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="14" rc-code="0" op-status="0" interval="0" last-run="1493817832" last-rc-change="1493817832" exec-time="0" queue-time="0" migrate_source="controller-1" migrate_target="controller-0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="galera-1_monitor_20000" operation_key="galera-1_monitor_20000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="48:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;48:22:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="16" rc-code="0" op-status="0" interval="20000" last-rc-change="1493817832" exec-time="0" queue-time="0" op-digest="6e5bb737f46c381d8a46fb4162afd9e0"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_monitor_0" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="7:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:7;7:16:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="12" rc-code="7" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_start_0" operation="start" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="126:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;126:17:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="135" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="80" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_60000" operation="monitor" crm-debug-origin="build_active_RAs" crm_feature_set="3.0.10" transition-key="132:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;132:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-0" call-id="137" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817768" exec-time="69" queue-time="0" op-digest="08b6ad9edc64306555c732c45bcf4995" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-1" remote_node="true" uname="galera-1" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="galera-1">
+        <instance_attributes id="status-galera-1">
+          <nvpair id="status-galera-1-last-failure-galera" name="last-failure-galera" value="1493336863"/>
+          <nvpair id="status-galera-1-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-1">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34745" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="463" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;3:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34745" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="463" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="52:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;52:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="34756" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="65" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-2" remote_node="true" uname="galera-2" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="galera-2">
+        <instance_attributes id="status-galera-2">
+          <nvpair id="status-galera-2-last-failure-galera" name="last-failure-galera" value="1493172798"/>
+          <nvpair id="status-galera-2-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-2">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34779" rc-code="8" op-status="0" interval="0" last-run="1493817766" last-rc-change="1493817766" exec-time="1419" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;4:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34779" rc-code="8" op-status="0" interval="0" last-run="1493817766" last-rc-change="1493817766" exec-time="1419" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="57:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;57:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="34789" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="61" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="galera-0" remote_node="true" uname="galera-0" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="galera-0">
+        <instance_attributes id="status-galera-0">
+          <nvpair id="status-galera-0-last-failure-galera" name="last-failure-galera" value="1493172797"/>
+          <nvpair id="status-galera-0-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="galera-0">
+        <lrm_resources>
+          <lrm_resource id="galera" type="galera" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera_last_failure_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35583" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="1739" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_last_0" operation_key="galera_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;2:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35583" rc-code="8" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="1739" queue-time="0" op-digest="e773372fde8a6c242c1993820114d5c3" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+            <lrm_rsc_op id="galera_monitor_10000" operation_key="galera_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="62:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:8;62:18:8:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="35593" rc-code="8" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="60" queue-time="0" op-digest="20ec44e3280211739f6ba9523159629e" op-secure-params=" user " op-secure-digest="e773372fde8a6c242c1993820114d5c3"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="3" uname="controller-2" in_ccm="true" crmd="online" crm-debug-origin="post_cache_update" join="member" expected="member">
+      <lrm id="3">
+        <lrm_resources>
+          <lrm_resource id="messaging-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-0_last_0" operation_key="messaging-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="29:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;29:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="1" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-1_last_0" operation_key="messaging-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="30:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;30:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="2" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="messaging-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="messaging-2_last_0" operation_key="messaging-2_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="31:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;31:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="3" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-0" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-0_last_0" operation_key="galera-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="32:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;32:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="4" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-1" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-1_last_0" operation_key="galera-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="33:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;33:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="5" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-2" type="remote" class="ocf" provider="pacemaker">
+            <lrm_rsc_op id="galera-2_last_0" operation_key="galera-2_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="34:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;34:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="6" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="a48beba1b11f09d6b1c15da8db5bb0a2" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="haproxy" type="haproxy" class="systemd">
+            <lrm_rsc_op id="haproxy_last_0" operation_key="haproxy_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="138:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;138:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="46" rc-code="0" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2103" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+            <lrm_rsc_op id="haproxy_monitor_60000" operation_key="haproxy_monitor_60000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="123:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;123:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="63" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817975" exec-time="3" queue-time="0" op-digest="4811cef7f7f94e3a35a70be7916cb2fd"/>
+          </lrm_resource>
+          <lrm_resource id="openstack-cinder-volume" type="openstack-cinder-volume" class="systemd">
+            <lrm_rsc_op id="openstack-cinder-volume_last_0" operation_key="openstack-cinder-volume_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="43:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;43:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="45" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2" queue-time="0" op-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="ip-192.168.24.6" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-192.168.24.6_last_0" operation_key="ip-192.168.24.6_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="36:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;36:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="16" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="42" queue-time="0" op-digest="22692fc1751093fc15ab6c0d90fafe22"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.14" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.14_last_0" operation_key="ip-172.17.1.14_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="38:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;38:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="24" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="52" queue-time="0" op-digest="1fab2783a8d283e33a945588908e98a4"/>
+          </lrm_resource>
+          <lrm_resource id="ip-10.0.0.102" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-10.0.0.102_last_0" operation_key="ip-10.0.0.102_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="37:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;37:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="20" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="59" queue-time="0" op-digest="194c484ea9d1eb9955c0cfdaf53ccdae"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.3.15" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.3.15_last_0" operation_key="ip-172.17.3.15_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="40:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;40:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="32" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="52" queue-time="0" op-digest="27e0700bb641af6a5b0fea09d0ea2482"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.4.11" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.4.11_last_0" operation_key="ip-172.17.4.11_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="41:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;41:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="36" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="50" queue-time="0" op-digest="fe27c3edbb73480aff571d34c88b21a7"/>
+          </lrm_resource>
+          <lrm_resource id="ip-172.17.1.17" type="IPaddr2" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="ip-172.17.1.17_last_0" operation_key="ip-172.17.1.17_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="39:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;39:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="28" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="55" queue-time="0" op-digest="edc8fdae4cc326c15a779f36f28eb3f8"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400bbf613" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400bbf613_last_0" operation_key="stonith-fence_ipmilan-525400bbf613_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="44:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;44:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="50" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="2" queue-time="0" op-digest="a1b3d562a7e722cbf686e1c2750888a3" op-secure-params=" passwd " op-secure-digest="2d0324390caa209c81283f07749d6dae"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-525400b4f6bd" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-525400b4f6bd_last_0" operation_key="stonith-fence_ipmilan-525400b4f6bd_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="45:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;45:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="54" rc-code="7" op-status="0" interval="0" last-run="1493817971" last-rc-change="1493817971" exec-time="0" queue-time="0" op-digest="190a5d7184e8c0736ea8d50b25d1896b" op-secure-params=" passwd " op-secure-digest="e710ff47e4fa69f83f5f46f9de9570b6"/>
+          </lrm_resource>
+          <lrm_resource id="redis" type="redis" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="redis_last_0" operation_key="redis_start_0" operation="start" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="95:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;95:1:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="59" rc-code="0" op-status="0" interval="0" last-run="1493817972" last-rc-change="1493817972" exec-time="2559" queue-time="0" op-digest="a5b2a4f5c557278af14d6cbffc5a229d" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_60000" operation_key="redis_monitor_60000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="80:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;80:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="61" rc-code="0" op-status="0" interval="60000" last-rc-change="1493817975" exec-time="121" queue-time="0" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+            <lrm_rsc_op id="redis_monitor_45000" operation_key="redis_monitor_45000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="79:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:0;79:2:0:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="62" rc-code="0" op-status="0" interval="45000" last-rc-change="1493817975" exec-time="117" queue-time="120" op-digest="992feffd37882eb5ce9bfc847b2fa75e" op-secure-params=" user " op-secure-digest="a5b2a4f5c557278af14d6cbffc5a229d"/>
+          </lrm_resource>
+          <lrm_resource id="stonith-fence_ipmilan-5254005bdbb5" type="fence_ipmilan" class="stonith">
+            <lrm_rsc_op id="stonith-fence_ipmilan-5254005bdbb5_last_0" operation_key="stonith-fence_ipmilan-5254005bdbb5_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="46:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" transition-magic="0:7;46:1:7:e9fa94e7-ffc2-40ab-91b6-b69d0f610c13" on_node="controller-2" call-id="58" rc-code="7" op-status="0" interval="0" last-run="1493817972" last-rc-change="1493817972" exec-time="0" queue-time="1" op-digest="25087bde0e53bf4f4e4efb2b0bd9d0de" op-secure-params=" passwd " op-secure-digest="ecf31bd4bca13bb934be683ab04ee8cf"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="3">
+        <instance_attributes id="status-3">
+          <nvpair id="status-3-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-3-master-redis" name="master-redis" value="1"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="messaging-2" remote_node="true" uname="messaging-2" crm-debug-origin="post_cache_update" in_ccm="true">
+      <transient_attributes id="messaging-2">
+        <instance_attributes id="status-messaging-2">
+          <nvpair id="status-messaging-2-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-2"/>
+          <nvpair id="status-messaging-2-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493172992"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-2">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041497" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3053" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;7:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041497" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3053" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="37:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;37:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-2" call-id="1041515" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="3053" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="messaging-0" remote_node="true" uname="messaging-0" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="messaging-0">
+        <instance_attributes id="status-messaging-0">
+          <nvpair id="status-messaging-0-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-0"/>
+          <nvpair id="status-messaging-0-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493330172"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-0">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875374" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3026" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;5:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875374" rc-code="0" op-status="0" interval="0" last-run="1493817764" last-rc-change="1493817764" exec-time="3026" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="40:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;40:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="875393" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="2985" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+    <node_state id="messaging-1" remote_node="true" uname="messaging-1" in_ccm="true" crm-debug-origin="post_cache_update">
+      <transient_attributes id="messaging-1">
+        <instance_attributes id="status-messaging-1">
+          <nvpair id="status-messaging-1-rmq-node-attr-rabbitmq" name="rmq-node-attr-rabbitmq" value="rabbit@messaging-1"/>
+          <nvpair id="status-messaging-1-last-failure-rabbitmq" name="last-failure-rabbitmq" value="1493336946"/>
+        </instance_attributes>
+      </transient_attributes>
+      <lrm id="messaging-1">
+        <lrm_resources>
+          <lrm_resource id="rabbitmq" type="rabbitmq-cluster" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="rabbitmq_last_failure_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251547" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3074" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_last_0" operation_key="rabbitmq_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;6:17:7:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251547" rc-code="0" op-status="0" interval="0" last-run="1493817765" last-rc-change="1493817765" exec-time="3074" queue-time="0" op-digest="497e3cffa03bc3ed4830dc4b0ba109ae"/>
+            <lrm_rsc_op id="rabbitmq_monitor_10000" operation_key="rabbitmq_monitor_10000" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.10" transition-key="43:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" transition-magic="0:0;43:18:0:e47e0f5b-bac4-432e-9993-f38bc43128ea" on_node="controller-1" call-id="251566" rc-code="0" op-status="0" interval="10000" last-rc-change="1493817768" exec-time="3025" queue-time="0" op-digest="41cce5252b1fb189afe9efa00fb5e2cb"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+    </node_state>
+  </status>
+</cib>
-- 
1.8.3.1


From 1d735f077f7d2e6dfd7338c5e558564385535a77 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Thu, 25 May 2017 17:27:17 +1000
Subject: [PATCH 6/6] Test: PE: Update regression tests for remote ordering

---
 pengine/test10/remote-fence-before-reconnect.dot     | 1 +
 pengine/test10/remote-fence-before-reconnect.exp     | 6 +++++-
 pengine/test10/remote-fence-before-reconnect.summary | 4 ++--
 pengine/test10/remote-fence-unclean.dot              | 1 +
 pengine/test10/remote-fence-unclean.exp              | 6 +++++-
 pengine/test10/remote-fence-unclean.summary          | 8 ++++----
 pengine/test10/remote-recover-fail.dot               | 2 ++
 pengine/test10/remote-recover-fail.exp               | 9 ++++++++-
 pengine/test10/remote-recover-fail.summary           | 8 ++++----
 9 files changed, 32 insertions(+), 13 deletions(-)

diff --git a/pengine/test10/remote-fence-before-reconnect.dot b/pengine/test10/remote-fence-before-reconnect.dot
index 2022b4c..ef2b047 100644
--- a/pengine/test10/remote-fence-before-reconnect.dot
+++ b/pengine/test10/remote-fence-before-reconnect.dot
@@ -6,6 +6,7 @@
 "fake2_start_0 c7auto1" -> "fake2_monitor_10000 c7auto1" [ style = bold]
 "fake2_start_0 c7auto1" [ style=bold color="green" fontcolor="black"]
 "fake2_stop_0 c7auto4" -> "all_stopped" [ style = bold]
+"fake2_stop_0 c7auto4" -> "c7auto4_stop_0 c7auto1" [ style = bold]
 "fake2_stop_0 c7auto4" -> "fake2_start_0 c7auto1" [ style = bold]
 "fake2_stop_0 c7auto4" [ style=bold color="green" fontcolor="orange"]
 "stonith 'reboot' c7auto4" -> "fake2_stop_0 c7auto4" [ style = bold]
diff --git a/pengine/test10/remote-fence-before-reconnect.exp b/pengine/test10/remote-fence-before-reconnect.exp
index 2c9ee6c..54c9106 100644
--- a/pengine/test10/remote-fence-before-reconnect.exp
+++ b/pengine/test10/remote-fence-before-reconnect.exp
@@ -9,7 +9,11 @@
         </downed>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <pseudo_event id="13" operation="stop" operation_key="fake2_stop_0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="1">
     <action_set>
diff --git a/pengine/test10/remote-fence-before-reconnect.summary b/pengine/test10/remote-fence-before-reconnect.summary
index 5cd8dd9..88ca48c 100644
--- a/pengine/test10/remote-fence-before-reconnect.summary
+++ b/pengine/test10/remote-fence-before-reconnect.summary
@@ -16,12 +16,12 @@ Transition Summary:
  * Move    fake2	(Started c7auto4 -> c7auto1)
 
 Executing cluster transition:
- * Resource action: c7auto4         stop on c7auto1
  * Fencing c7auto4 (reboot)
  * Pseudo action:   stonith_complete
  * Pseudo action:   fake2_stop_0
- * Pseudo action:   all_stopped
+ * Resource action: c7auto4         stop on c7auto1
  * Resource action: fake2           start on c7auto1
+ * Pseudo action:   all_stopped
  * Resource action: fake2           monitor=10000 on c7auto1
 
 Revised cluster status:
diff --git a/pengine/test10/remote-fence-unclean.dot b/pengine/test10/remote-fence-unclean.dot
index e956a91..b2829a7 100644
--- a/pengine/test10/remote-fence-unclean.dot
+++ b/pengine/test10/remote-fence-unclean.dot
@@ -4,6 +4,7 @@
 "FAKE2_start_0 18builder" [ style=bold color="green" fontcolor="black"]
 "FAKE2_stop_0 remote1" -> "FAKE2_start_0 18builder" [ style = bold]
 "FAKE2_stop_0 remote1" -> "all_stopped" [ style = bold]
+"FAKE2_stop_0 remote1" -> "remote1_stop_0 18node1" [ style = bold]
 "FAKE2_stop_0 remote1" [ style=bold color="green" fontcolor="orange"]
 "FAKE3_monitor_60000 18node1" [ style=bold color="green" fontcolor="black"]
 "FAKE3_start_0 18node1" -> "FAKE3_monitor_60000 18node1" [ style = bold]
diff --git a/pengine/test10/remote-fence-unclean.exp b/pengine/test10/remote-fence-unclean.exp
index 125366e..d2c3617 100644
--- a/pengine/test10/remote-fence-unclean.exp
+++ b/pengine/test10/remote-fence-unclean.exp
@@ -25,7 +25,11 @@
         </downed>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <pseudo_event id="13" operation="stop" operation_key="FAKE2_stop_0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="2">
     <action_set>
diff --git a/pengine/test10/remote-fence-unclean.summary b/pengine/test10/remote-fence-unclean.summary
index 60e70a5..cd246e4 100644
--- a/pengine/test10/remote-fence-unclean.summary
+++ b/pengine/test10/remote-fence-unclean.summary
@@ -17,20 +17,20 @@ Transition Summary:
  * Move    FAKE4	(Started 18node1 -> 18node2)
 
 Executing cluster transition:
- * Resource action: remote1         stop on 18node1
  * Resource action: FAKE3           stop on 18builder
  * Resource action: FAKE4           stop on 18node1
  * Fencing remote1 (reboot)
  * Pseudo action:   stonith_complete
- * Resource action: remote1         start on 18node1
- * Resource action: remote1         monitor=60000 on 18node1
  * Pseudo action:   FAKE2_stop_0
  * Resource action: FAKE3           start on 18node1
  * Resource action: FAKE4           start on 18node2
- * Pseudo action:   all_stopped
+ * Resource action: remote1         stop on 18node1
  * Resource action: FAKE2           start on 18builder
  * Resource action: FAKE3           monitor=60000 on 18node1
  * Resource action: FAKE4           monitor=60000 on 18node2
+ * Pseudo action:   all_stopped
+ * Resource action: remote1         start on 18node1
+ * Resource action: remote1         monitor=60000 on 18node1
  * Resource action: FAKE2           monitor=60000 on 18builder
 
 Revised cluster status:
diff --git a/pengine/test10/remote-recover-fail.dot b/pengine/test10/remote-recover-fail.dot
index a920089..7b6edaa 100644
--- a/pengine/test10/remote-recover-fail.dot
+++ b/pengine/test10/remote-recover-fail.dot
@@ -7,6 +7,7 @@
 "FAKE2_start_0 rhel7-auto3" [ style=bold color="green" fontcolor="black"]
 "FAKE2_stop_0 rhel7-auto4" -> "FAKE2_start_0 rhel7-auto3" [ style = bold]
 "FAKE2_stop_0 rhel7-auto4" -> "all_stopped" [ style = bold]
+"FAKE2_stop_0 rhel7-auto4" -> "rhel7-auto4_stop_0 rhel7-auto2" [ style = bold]
 "FAKE2_stop_0 rhel7-auto4" [ style=bold color="green" fontcolor="orange"]
 "FAKE3_monitor_10000 rhel7-auto2" [ style=bold color="green" fontcolor="black"]
 "FAKE4_monitor_10000 rhel7-auto3" [ style=bold color="green" fontcolor="black"]
@@ -15,6 +16,7 @@
 "FAKE6_start_0 rhel7-auto2" [ style=bold color="green" fontcolor="black"]
 "FAKE6_stop_0 rhel7-auto4" -> "FAKE6_start_0 rhel7-auto2" [ style = bold]
 "FAKE6_stop_0 rhel7-auto4" -> "all_stopped" [ style = bold]
+"FAKE6_stop_0 rhel7-auto4" -> "rhel7-auto4_stop_0 rhel7-auto2" [ style = bold]
 "FAKE6_stop_0 rhel7-auto4" [ style=bold color="green" fontcolor="orange"]
 "all_stopped" [ style=bold color="green" fontcolor="orange"]
 "rhel7-auto4_monitor_60000 rhel7-auto2" [ style=bold color="green" fontcolor="black"]
diff --git a/pengine/test10/remote-recover-fail.exp b/pengine/test10/remote-recover-fail.exp
index 1daa510..be45b88 100644
--- a/pengine/test10/remote-recover-fail.exp
+++ b/pengine/test10/remote-recover-fail.exp
@@ -38,7 +38,14 @@
         </downed>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <pseudo_event id="11" operation="stop" operation_key="FAKE2_stop_0"/>
+      </trigger>
+      <trigger>
+        <pseudo_event id="22" operation="stop" operation_key="FAKE6_stop_0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="3">
     <action_set>
diff --git a/pengine/test10/remote-recover-fail.summary b/pengine/test10/remote-recover-fail.summary
index 8584745..5953e34 100644
--- a/pengine/test10/remote-recover-fail.summary
+++ b/pengine/test10/remote-recover-fail.summary
@@ -20,22 +20,22 @@ Transition Summary:
  * Move    FAKE6	(Started rhel7-auto4 -> rhel7-auto2)
 
 Executing cluster transition:
- * Resource action: rhel7-auto4     stop on rhel7-auto2
  * Resource action: FAKE3           monitor=10000 on rhel7-auto2
  * Resource action: FAKE4           monitor=10000 on rhel7-auto3
  * Fencing rhel7-auto4 (reboot)
  * Pseudo action:   stonith_complete
- * Resource action: rhel7-auto4     start on rhel7-auto2
  * Resource action: FAKE1           start on rhel7-auto2
  * Pseudo action:   FAKE2_stop_0
  * Pseudo action:   FAKE6_stop_0
- * Pseudo action:   all_stopped
- * Resource action: rhel7-auto4     monitor=60000 on rhel7-auto2
+ * Resource action: rhel7-auto4     stop on rhel7-auto2
  * Resource action: FAKE1           monitor=10000 on rhel7-auto2
  * Resource action: FAKE2           start on rhel7-auto3
  * Resource action: FAKE6           start on rhel7-auto2
+ * Pseudo action:   all_stopped
+ * Resource action: rhel7-auto4     start on rhel7-auto2
  * Resource action: FAKE2           monitor=10000 on rhel7-auto3
  * Resource action: FAKE6           monitor=10000 on rhel7-auto2
+ * Resource action: rhel7-auto4     monitor=60000 on rhel7-auto2
 
 Revised cluster status:
 Online: [ rhel7-auto2 rhel7-auto3 ]
-- 
1.8.3.1

