From 2bf3f0bff047ca85919d99e8e43d1725a88e59d0 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Fri, 13 Oct 2017 21:40:41 +1100
Subject: [PATCH 1/3] Log: PE: Detailed resource information should include
 connection resource state

---
 lib/pengine/native.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/lib/pengine/native.c b/lib/pengine/native.c
index 777dcf3..d23b588 100644
--- a/lib/pengine/native.c
+++ b/lib/pengine/native.c
@@ -488,7 +488,7 @@ common_print(resource_t * rsc, const char *pre_text, const char *name, node_t *n
 
     if (rsc->meta) {
         const char *is_internal = g_hash_table_lookup(rsc->meta, XML_RSC_ATTR_INTERNAL_RSC);
-        if (crm_is_true(is_internal)) {
+        if (crm_is_true(is_internal) && is_not_set(options, pe_print_clone_details)) {
             crm_trace("skipping print of internal resource %s", rsc->id);
             return;
         }
-- 
1.8.3.1


From c3d4ec0377a5e742a7aca5b129139f1ad970e4f7 Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Fri, 13 Oct 2017 21:45:28 +1100
Subject: [PATCH 2/3] Fix: PE: Do not probe connection resources until the
 container is active

Otherwise we cannot rely on the REMOTE_CONTAINER_HACK logic for
replacing 'addr' with the node where the container is running.

This leads to monitor operations that include addr="#uname" or even
the wrong node.

If these operations detect the resource as running (after a cleanup)
then the digests won't match when the PE runs next, it will appear
the resource has changed definition and we will reload/restart it.
---
 include/crm/pengine/status.h |  4 ++++
 pengine/container.c          | 35 ++++++++++++++++++++++++++++-------
 pengine/graph.c              | 20 ++++++++++++++++++++
 3 files changed, 52 insertions(+), 7 deletions(-)

diff --git a/include/crm/pengine/status.h b/include/crm/pengine/status.h
index 17787dd..3786ca9 100644
--- a/include/crm/pengine/status.h
+++ b/include/crm/pengine/status.h
@@ -429,6 +429,10 @@ enum pe_ordering {
                                                  * ensure instances of 'then' on 'nodeX' are too.
                                                  * Only really useful if 'then' is a clone and 'first' is not
                                                  */
+    pe_order_probe                 = 0x800,     /* If 'first->rsc' is
+                                                 *  - running but about to stop, ignore the constraint
+                                                 *  - otherwise, behave as runnable_left
+                                                 */
 
     pe_order_restart               = 0x1000,    /* 'then' is runnable if 'first' is optional or runnable */
     pe_order_stonith_stop          = 0x2000,    /* only applies if the action is non-pseudo */
diff --git a/pengine/container.c b/pengine/container.c
index df5a238..a884516 100644
--- a/pengine/container.c
+++ b/pengine/container.c
@@ -823,16 +823,27 @@ container_expand(resource_t * rsc, pe_working_set_t * data_set)
     for (GListPtr gIter = container_data->tuples; gIter != NULL; gIter = gIter->next) {
         container_grouping_t *tuple = (container_grouping_t *)gIter->data;
 
-
         CRM_ASSERT(tuple);
-        if (tuple->docker && tuple->remote && tuple->docker->allocated_to
-            && fix_remote_addr(tuple->remote)) {
+        if (tuple->remote && tuple->docker && fix_remote_addr(tuple->remote)) {
 
             // REMOTE_CONTAINER_HACK: Allow remote nodes that start containers with pacemaker remote inside
+            pe_node_t *node = tuple->docker->allocated_to;
             xmlNode *nvpair = get_xpath_object("//nvpair[@name='addr']", tuple->remote->xml, LOG_ERR);
 
-            g_hash_table_replace(tuple->remote->parameters, strdup("addr"), strdup(tuple->docker->allocated_to->details->uname));
-            crm_xml_add(nvpair, "value", tuple->docker->allocated_to->details->uname);
+            if(node == NULL && tuple->docker->running_on) {
+                /* If it wont be running anywhere after the
+                 * transition, go with where it's running now.
+                 */
+                node = tuple->docker->running_on->data;
+            }
+
+            if(node != NULL) {
+                g_hash_table_replace(tuple->remote->parameters, strdup("addr"), strdup(node->details->uname));
+                crm_xml_add(nvpair, "value", node->details->uname);
+
+            } else if(fix_remote_addr(tuple->remote)) {
+                crm_trace("Cannot fix address for %s", tuple->remote->id);
+            }
         }
         if(tuple->ip) {
             tuple->ip->cmds->expand(tuple->ip, data_set);
@@ -897,8 +908,18 @@ container_create_probe(resource_t * rsc, node_t * node, action_t * complete,
                 }
             }
         }
-        if(tuple->remote) {
-            any_created |= tuple->remote->cmds->create_probe(tuple->remote, node, complete, force, data_set);
+        if(tuple->remote && tuple->remote->cmds->create_probe(tuple->remote, node, complete, force, data_set)) {
+            /* Do not probe the remote resource until we know where docker is running
+             * Required for REMOTE_CONTAINER_HACK to correctly probe remote resources
+             */
+            char *probe_uuid = generate_op_key(tuple->remote->id, RSC_STATUS, 0);
+            action_t *probe = find_first_action(tuple->remote->actions, probe_uuid, NULL, node);
+            any_created = TRUE;
+
+            crm_trace("Ordering %s probe on %s", tuple->remote->id, node->details->uname);
+            custom_action_order(tuple->docker, generate_op_key(tuple->docker->id, RSC_START, 0), NULL,
+                                tuple->remote, NULL, probe, pe_order_probe, data_set);
+            free(probe_uuid);
         }
     }
     return any_created;
diff --git a/pengine/graph.c b/pengine/graph.c
index 822e1c7..e3ee4fc 100644
--- a/pengine/graph.c
+++ b/pengine/graph.c
@@ -294,6 +294,26 @@ graph_update_action(action_t * first, action_t * then, node_t * node,
         }
     }
 
+    if (then->rsc && is_set(type, pe_order_probe)) {
+        processed = TRUE;
+
+        if (is_not_set(first_flags, pe_action_runnable) && first->rsc->running_on != NULL) {
+            pe_rsc_trace(then->rsc, "Ignoring %s then %s - %s is about to be stopped",
+                         first->uuid, then->uuid, first->rsc->id);
+
+        } else {
+            pe_rsc_trace(then->rsc, "Enforcing %s then %s", first->uuid, then->uuid);
+            changed |= then->rsc->cmds->update_actions(first, then, node, first_flags,
+                                                       pe_action_runnable, pe_order_runnable_left);
+        }
+
+        if (changed) {
+            pe_rsc_trace(then->rsc, "runnable: %s then %s: changed", first->uuid, then->uuid);
+        } else {
+            crm_trace("runnable: %s then %s", first->uuid, then->uuid);
+        }
+    }
+
     if (type & pe_order_runnable_left) {
         processed = TRUE;
         if (then->rsc) {
-- 
1.8.3.1


From b2ca8d533e1fa076da9df5ce966747344fd0813e Mon Sep 17 00:00:00 2001
From: Andrew Beekhof <andrew@beekhof.net>
Date: Fri, 13 Oct 2017 21:53:53 +1100
Subject: [PATCH 3/3] Test: PE: Do not probe connection resources until the
 container is active

---
 pengine/regression.sh                              |   4 +
 pengine/test10/bundle-nested-colocation.dot        |  18 +++
 pengine/test10/bundle-nested-colocation.exp        | 108 ++++++++++++---
 pengine/test10/bundle-nested-colocation.summary    |  28 ++--
 pengine/test10/bundle-order-fencing.exp            |  18 +--
 pengine/test10/bundle-order-partial-start.dot      |   1 +
 pengine/test10/bundle-order-partial-start.exp      |   6 +-
 pengine/test10/bundle-order-partial-start.summary  |   4 +-
 pengine/test10/bundle-order-partial-stop.exp       |   6 +-
 pengine/test10/bundle-order-startup-clone-2.dot    |  18 +++
 pengine/test10/bundle-order-startup-clone-2.exp    | 108 ++++++++++++---
 .../test10/bundle-order-startup-clone-2.summary    |  58 ++++----
 pengine/test10/bundle-order-startup-clone.dot      |  12 +-
 pengine/test10/bundle-order-startup-clone.exp      | 101 ++++++--------
 pengine/test10/bundle-order-startup-clone.summary  |  13 +-
 pengine/test10/bundle-order-startup.dot            |   3 +
 pengine/test10/bundle-order-startup.exp            |  18 ++-
 pengine/test10/bundle-order-startup.summary        |  24 ++--
 pengine/test10/bundle-order-stop-clone.exp         |   6 +-
 pengine/test10/bundle-order-stop.exp               |   6 +-
 pengine/test10/bundle-probe-order-1.dot            |  11 ++
 pengine/test10/bundle-probe-order-1.exp            |  83 ++++++++++++
 pengine/test10/bundle-probe-order-1.scores         | 149 +++++++++++++++++++++
 pengine/test10/bundle-probe-order-1.summary        |  32 +++++
 pengine/test10/bundle-probe-order-1.xml            |  95 +++++++++++++
 pengine/test10/bundle-probe-order-2.dot            |   9 ++
 pengine/test10/bundle-probe-order-2.exp            |  65 +++++++++
 pengine/test10/bundle-probe-order-2.scores         | 149 +++++++++++++++++++++
 pengine/test10/bundle-probe-order-2.summary        |  32 +++++
 pengine/test10/bundle-probe-order-2.xml            | 127 ++++++++++++++++++
 pengine/test10/bundle-probe-order-3.dot            |  10 ++
 pengine/test10/bundle-probe-order-3.exp            |  74 ++++++++++
 pengine/test10/bundle-probe-order-3.scores         | 149 +++++++++++++++++++++
 pengine/test10/bundle-probe-order-3.summary        |  31 +++++
 pengine/test10/bundle-probe-order-3.xml            | 117 ++++++++++++++++
 35 files changed, 1509 insertions(+), 184 deletions(-)
 create mode 100644 pengine/test10/bundle-probe-order-1.dot
 create mode 100644 pengine/test10/bundle-probe-order-1.exp
 create mode 100644 pengine/test10/bundle-probe-order-1.scores
 create mode 100644 pengine/test10/bundle-probe-order-1.summary
 create mode 100644 pengine/test10/bundle-probe-order-1.xml
 create mode 100644 pengine/test10/bundle-probe-order-2.dot
 create mode 100644 pengine/test10/bundle-probe-order-2.exp
 create mode 100644 pengine/test10/bundle-probe-order-2.scores
 create mode 100644 pengine/test10/bundle-probe-order-2.summary
 create mode 100644 pengine/test10/bundle-probe-order-2.xml
 create mode 100644 pengine/test10/bundle-probe-order-3.dot
 create mode 100644 pengine/test10/bundle-probe-order-3.exp
 create mode 100644 pengine/test10/bundle-probe-order-3.scores
 create mode 100644 pengine/test10/bundle-probe-order-3.summary
 create mode 100644 pengine/test10/bundle-probe-order-3.xml

diff --git a/pengine/regression.sh b/pengine/regression.sh
index aeff13a..6ec5848 100755
--- a/pengine/regression.sh
+++ b/pengine/regression.sh
@@ -823,6 +823,10 @@ do_test bundle-nested-colocation "Colocation of nested connection resources"
 
 do_test bundle-order-fencing "Order pseudo bundle fencing after parent node fencing if both are happening"
 
+do_test bundle-probe-order-1 "order 1"
+do_test bundle-probe-order-2 "order 2"
+do_test bundle-probe-order-3 "order 3"
+
 echo ""
 do_test whitebox-fail1 "Fail whitebox container rsc."
 do_test whitebox-fail2 "Fail whitebox container rsc lrmd connection."
diff --git a/pengine/test10/bundle-nested-colocation.dot b/pengine/test10/bundle-nested-colocation.dot
index 21c9700..46cc569 100644
--- a/pengine/test10/bundle-nested-colocation.dot
+++ b/pengine/test10/bundle-nested-colocation.dot
@@ -77,6 +77,12 @@ digraph "g" {
 "rabbitmq-bundle-clone_start_0" -> "rabbitmq:2_start_0 rabbitmq-bundle-2" [ style = bold]
 "rabbitmq-bundle-clone_start_0" [ style=bold color="green" fontcolor="orange"]
 "rabbitmq-bundle-docker-0_monitor_60000 overcloud-rabbit-0" [ style=bold color="green" fontcolor="black"]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-controller-0" [ style = bold]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-controller-1" [ style = bold]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-controller-2" [ style = bold]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-galera-0" [ style = bold]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-galera-1" [ style = bold]
+"rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_monitor_0 overcloud-galera-2" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-0_start_0 overcloud-controller-0" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle-docker-0_monitor_60000 overcloud-rabbit-0" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 overcloud-rabbit-0" -> "rabbitmq-bundle_running_0" [ style = bold]
@@ -87,6 +93,12 @@ digraph "g" {
 "rabbitmq-bundle-docker-0_stop_0 overcloud-rabbit-0" -> "rabbitmq-bundle_stopped_0" [ style = bold]
 "rabbitmq-bundle-docker-0_stop_0 overcloud-rabbit-0" [ style=bold color="green" fontcolor="black"]
 "rabbitmq-bundle-docker-1_monitor_60000 overcloud-rabbit-1" [ style=bold color="green" fontcolor="black"]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-controller-0" [ style = bold]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-controller-1" [ style = bold]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-controller-2" [ style = bold]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-galera-0" [ style = bold]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-galera-1" [ style = bold]
+"rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_monitor_0 overcloud-galera-2" [ style = bold]
 "rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-1_start_0 overcloud-controller-1" [ style = bold]
 "rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle-docker-1_monitor_60000 overcloud-rabbit-1" [ style = bold]
 "rabbitmq-bundle-docker-1_start_0 overcloud-rabbit-1" -> "rabbitmq-bundle_running_0" [ style = bold]
@@ -97,6 +109,12 @@ digraph "g" {
 "rabbitmq-bundle-docker-1_stop_0 overcloud-rabbit-1" -> "rabbitmq-bundle_stopped_0" [ style = bold]
 "rabbitmq-bundle-docker-1_stop_0 overcloud-rabbit-1" [ style=bold color="green" fontcolor="black"]
 "rabbitmq-bundle-docker-2_monitor_60000 overcloud-rabbit-2" [ style=bold color="green" fontcolor="black"]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-controller-0" [ style = bold]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-controller-1" [ style = bold]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-controller-2" [ style = bold]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-galera-0" [ style = bold]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-galera-1" [ style = bold]
+"rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_monitor_0 overcloud-galera-2" [ style = bold]
 "rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-2_start_0 overcloud-controller-2" [ style = bold]
 "rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle-docker-2_monitor_60000 overcloud-rabbit-2" [ style = bold]
 "rabbitmq-bundle-docker-2_start_0 overcloud-rabbit-2" -> "rabbitmq-bundle_running_0" [ style = bold]
diff --git a/pengine/test10/bundle-nested-colocation.exp b/pengine/test10/bundle-nested-colocation.exp
index 1f2396e..fe77003 100644
--- a/pengine/test10/bundle-nested-colocation.exp
+++ b/pengine/test10/bundle-nested-colocation.exp
@@ -391,7 +391,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-galera-2" CRM_meta_on_node_uuid="6" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="24">
     <action_set>
@@ -400,7 +404,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-galera-1" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="25">
     <action_set>
@@ -409,7 +417,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-galera-0" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="26">
     <action_set>
@@ -418,7 +430,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="27">
     <action_set>
@@ -427,7 +443,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="28">
     <action_set>
@@ -436,7 +456,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="overcloud-controller-0" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-0"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="11" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="overcloud-rabbit-0" on_node_uuid="overcloud-rabbit-0" router_node="overcloud-controller-0"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="29">
     <action_set>
@@ -531,7 +555,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-galera-2" CRM_meta_on_node_uuid="6" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="35">
     <action_set>
@@ -540,7 +568,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-galera-1" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="36">
     <action_set>
@@ -549,7 +581,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-galera-0" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="37">
     <action_set>
@@ -558,7 +594,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="38">
     <action_set>
@@ -567,7 +607,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="39">
     <action_set>
@@ -576,7 +620,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-1" CRM_meta_on_node="overcloud-controller-0" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-1"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="12" operation="start" operation_key="rabbitmq-bundle-docker-1_start_0" on_node="overcloud-rabbit-1" on_node_uuid="overcloud-rabbit-1" router_node="overcloud-controller-1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="40">
     <action_set>
@@ -671,7 +719,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-galera-2" CRM_meta_on_node_uuid="6" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="46">
     <action_set>
@@ -680,7 +732,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-galera-1" CRM_meta_on_node_uuid="5" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="47">
     <action_set>
@@ -689,7 +745,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-galera-0" CRM_meta_on_node_uuid="4" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="48">
     <action_set>
@@ -698,7 +758,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="49">
     <action_set>
@@ -707,7 +771,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="50">
     <action_set>
@@ -716,7 +784,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-2" CRM_meta_on_node="overcloud-controller-0" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="overcloud-rabbit-2"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="13" operation="start" operation_key="rabbitmq-bundle-docker-2_start_0" on_node="overcloud-rabbit-2" on_node_uuid="overcloud-rabbit-2" router_node="overcloud-controller-2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="51" priority="1000000">
     <action_set>
diff --git a/pengine/test10/bundle-nested-colocation.summary b/pengine/test10/bundle-nested-colocation.summary
index 1986763..2eee05e 100644
--- a/pengine/test10/bundle-nested-colocation.summary
+++ b/pengine/test10/bundle-nested-colocation.summary
@@ -29,41 +29,41 @@ Transition Summary:
 
 Executing cluster transition:
  * Pseudo action:   rabbitmq-bundle-clone_pre_notify_start_0
+ * Pseudo action:   rabbitmq-bundle_stop_0
+ * Pseudo action:   rabbitmq-bundle_start_0
+ * Pseudo action:   rabbitmq-bundle-clone_confirmed-pre_notify_start_0
+ * Resource action: rabbitmq-bundle-docker-0 stop on overcloud-rabbit-0
+ * Resource action: rabbitmq-bundle-docker-0 start on overcloud-rabbit-0
+ * Resource action: rabbitmq-bundle-docker-0 monitor=60000 on overcloud-rabbit-0
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-galera-2
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-galera-1
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-galera-0
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-controller-2
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-controller-1
  * Resource action: rabbitmq-bundle-0 monitor on overcloud-controller-0
+ * Resource action: rabbitmq-bundle-docker-1 stop on overcloud-rabbit-1
+ * Resource action: rabbitmq-bundle-docker-1 start on overcloud-rabbit-1
+ * Resource action: rabbitmq-bundle-docker-1 monitor=60000 on overcloud-rabbit-1
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-galera-2
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-galera-1
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-galera-0
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-controller-2
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-controller-1
  * Resource action: rabbitmq-bundle-1 monitor on overcloud-controller-0
+ * Resource action: rabbitmq-bundle-docker-2 stop on overcloud-rabbit-2
+ * Resource action: rabbitmq-bundle-docker-2 start on overcloud-rabbit-2
+ * Resource action: rabbitmq-bundle-docker-2 monitor=60000 on overcloud-rabbit-2
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-galera-2
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-galera-1
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-galera-0
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-controller-2
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-controller-1
  * Resource action: rabbitmq-bundle-2 monitor on overcloud-controller-0
- * Pseudo action:   rabbitmq-bundle_stop_0
- * Pseudo action:   rabbitmq-bundle_start_0
- * Pseudo action:   rabbitmq-bundle-clone_confirmed-pre_notify_start_0
- * Resource action: rabbitmq-bundle-docker-0 stop on overcloud-rabbit-0
- * Resource action: rabbitmq-bundle-docker-0 start on overcloud-rabbit-0
- * Resource action: rabbitmq-bundle-docker-0 monitor=60000 on overcloud-rabbit-0
+ * Pseudo action:   rabbitmq-bundle_stopped_0
+ * Pseudo action:   all_stopped
  * Resource action: rabbitmq-bundle-0 start on overcloud-controller-0
- * Resource action: rabbitmq-bundle-docker-1 stop on overcloud-rabbit-1
- * Resource action: rabbitmq-bundle-docker-1 start on overcloud-rabbit-1
- * Resource action: rabbitmq-bundle-docker-1 monitor=60000 on overcloud-rabbit-1
  * Resource action: rabbitmq-bundle-1 start on overcloud-controller-1
- * Resource action: rabbitmq-bundle-docker-2 stop on overcloud-rabbit-2
- * Resource action: rabbitmq-bundle-docker-2 start on overcloud-rabbit-2
- * Resource action: rabbitmq-bundle-docker-2 monitor=60000 on overcloud-rabbit-2
  * Resource action: rabbitmq-bundle-2 start on overcloud-controller-2
- * Pseudo action:   rabbitmq-bundle_stopped_0
- * Pseudo action:   all_stopped
  * Resource action: rabbitmq:0      monitor on rabbitmq-bundle-0
  * Resource action: rabbitmq:1      monitor on rabbitmq-bundle-1
  * Resource action: rabbitmq:2      monitor on rabbitmq-bundle-2
diff --git a/pengine/test10/bundle-order-fencing.exp b/pengine/test10/bundle-order-fencing.exp
index 6782060..dab0dd4 100644
--- a/pengine/test10/bundle-order-fencing.exp
+++ b/pengine/test10/bundle-order-fencing.exp
@@ -379,7 +379,7 @@
   <synapse id="25">
     <action_set>
       <pseudo_event id="43" operation="stop" operation_key="rabbitmq-bundle-0_stop_0">
-        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_timeout="20000" addr="#uname"  port="3122"/>
+        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_timeout="20000" addr="controller-0"  port="3122"/>
       </pseudo_event>
     </action_set>
     <inputs>
@@ -398,7 +398,7 @@
     <action_set>
       <rsc_op id="36" operation="monitor" operation_key="rabbitmq-bundle-0_monitor_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="rabbitmq-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3122"/>
+        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3122"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -407,7 +407,7 @@
     <action_set>
       <rsc_op id="30" operation="monitor" operation_key="rabbitmq-bundle-0_monitor_0" on_node="controller-1" on_node_uuid="2">
         <primitive id="rabbitmq-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3122"/>
+        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3122"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -577,7 +577,7 @@
   <synapse id="39">
     <action_set>
       <pseudo_event id="78" operation="stop" operation_key="galera-bundle-0_stop_0">
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_timeout="20000" addr="controller-0"  port="3123"/>
       </pseudo_event>
     </action_set>
     <inputs>
@@ -596,7 +596,7 @@
     <action_set>
       <rsc_op id="38" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3123"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -605,7 +605,7 @@
     <action_set>
       <rsc_op id="32" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="controller-1" on_node_uuid="2">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3123"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -1437,7 +1437,7 @@
   <synapse id="96">
     <action_set>
       <pseudo_event id="119" operation="stop" operation_key="redis-bundle-0_stop_0">
-        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_timeout="20000" addr="#uname"  port="3124"/>
+        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_timeout="20000" addr="controller-0"  port="3124"/>
       </pseudo_event>
     </action_set>
     <inputs>
@@ -1456,7 +1456,7 @@
     <action_set>
       <rsc_op id="40" operation="monitor" operation_key="redis-bundle-0_monitor_0" on_node="controller-2" on_node_uuid="3">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3124"/>
+        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="controller-2" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3124"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -1465,7 +1465,7 @@
     <action_set>
       <rsc_op id="34" operation="monitor" operation_key="redis-bundle-0_monitor_0" on_node="controller-1" on_node_uuid="2">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3124"/>
+        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="controller-1" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="controller-0"  port="3124"/>
       </rsc_op>
     </action_set>
     <inputs/>
diff --git a/pengine/test10/bundle-order-partial-start.dot b/pengine/test10/bundle-order-partial-start.dot
index 1106b28..f8292eb 100644
--- a/pengine/test10/bundle-order-partial-start.dot
+++ b/pengine/test10/bundle-order-partial-start.dot
@@ -11,6 +11,7 @@ digraph "g" {
 "galera-bundle-docker-0_monitor_0 undercloud" -> "galera-bundle-master_start_0" [ style = bold]
 "galera-bundle-docker-0_monitor_0 undercloud" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-0_monitor_60000 undercloud" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-0_monitor_0 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-0_start_0 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-docker-0_monitor_60000 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle_running_0" [ style = bold]
diff --git a/pengine/test10/bundle-order-partial-start.exp b/pengine/test10/bundle-order-partial-start.exp
index e883a3b..037c3e0 100644
--- a/pengine/test10/bundle-order-partial-start.exp
+++ b/pengine/test10/bundle-order-partial-start.exp
@@ -288,7 +288,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="undercloud"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="39" operation="start" operation_key="galera-bundle-docker-0_start_0" on_node="undercloud" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="21" priority="1000000">
     <action_set>
diff --git a/pengine/test10/bundle-order-partial-start.summary b/pengine/test10/bundle-order-partial-start.summary
index fb8e7de..a79fbf3 100644
--- a/pengine/test10/bundle-order-partial-start.summary
+++ b/pengine/test10/bundle-order-partial-start.summary
@@ -32,7 +32,6 @@ Executing cluster transition:
  * Resource action: rabbitmq:0      monitor on rabbitmq-bundle-0
  * Pseudo action:   rabbitmq-bundle-clone_pre_notify_start_0
  * Resource action: galera-bundle-docker-0 monitor on undercloud
- * Resource action: galera-bundle-0 monitor on undercloud
  * Pseudo action:   redis-bundle-master_pre_notify_promote_0
  * Resource action: haproxy-bundle-docker-0 monitor on undercloud
  * Pseudo action:   haproxy-bundle_start_0
@@ -63,10 +62,11 @@ Executing cluster transition:
  * Pseudo action:   galera-bundle_start_0
  * Pseudo action:   galera-bundle-master_start_0
  * Resource action: galera-bundle-docker-0 start on undercloud
+ * Resource action: galera-bundle-0 monitor on undercloud
+ * Resource action: galera-bundle-docker-0 monitor=60000 on undercloud
  * Resource action: galera-bundle-0 start on undercloud
  * Resource action: galera:0        start on galera-bundle-0
  * Pseudo action:   galera-bundle-master_running_0
- * Resource action: galera-bundle-docker-0 monitor=60000 on undercloud
  * Resource action: galera-bundle-0 monitor=60000 on undercloud
  * Pseudo action:   galera-bundle_running_0
  * Resource action: galera:0        monitor=30000 on galera-bundle-0
diff --git a/pengine/test10/bundle-order-partial-stop.exp b/pengine/test10/bundle-order-partial-stop.exp
index 1dff657..c0724c7 100644
--- a/pengine/test10/bundle-order-partial-stop.exp
+++ b/pengine/test10/bundle-order-partial-stop.exp
@@ -128,7 +128,7 @@
     <action_set>
       <rsc_op id="20" operation="stop" operation_key="rabbitmq-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="rabbitmq-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3121"/>
+        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3121"/>
         <downed>
           <node id="rabbitmq-bundle-0"/>
         </downed>
@@ -261,7 +261,7 @@
     <action_set>
       <rsc_op id="40" operation="stop" operation_key="galera-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3123"/>
         <downed>
           <node id="galera-bundle-0"/>
         </downed>
@@ -549,7 +549,7 @@
     <action_set>
       <rsc_op id="63" operation="stop" operation_key="redis-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3124"/>
+        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3124"/>
         <downed>
           <node id="redis-bundle-0"/>
         </downed>
diff --git a/pengine/test10/bundle-order-startup-clone-2.dot b/pengine/test10/bundle-order-startup-clone-2.dot
index 6026530..59a4fb4 100644
--- a/pengine/test10/bundle-order-startup-clone-2.dot
+++ b/pengine/test10/bundle-order-startup-clone-2.dot
@@ -51,6 +51,9 @@ digraph "g" {
 "galera-bundle-docker-0_monitor_0 metal-3" -> "galera-bundle-master_start_0" [ style = bold]
 "galera-bundle-docker-0_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-0_monitor_60000 metal-1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-1" [ style = bold]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-2" [ style = bold]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-3" [ style = bold]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_start_0 metal-1" [ style = bold]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-docker-0_monitor_60000 metal-1" [ style = bold]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle_running_0" [ style = bold]
@@ -72,6 +75,9 @@ digraph "g" {
 "galera-bundle-docker-1_monitor_0 metal-3" -> "galera-bundle-master_start_0" [ style = bold]
 "galera-bundle-docker-1_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-1_monitor_60000 metal-2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle-1_monitor_0 metal-1" [ style = bold]
+"galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle-1_monitor_0 metal-2" [ style = bold]
+"galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle-1_monitor_0 metal-3" [ style = bold]
 "galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle-1_start_0 metal-2" [ style = bold]
 "galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle-docker-1_monitor_60000 metal-2" [ style = bold]
 "galera-bundle-docker-1_start_0 metal-2" -> "galera-bundle_running_0" [ style = bold]
@@ -93,6 +99,9 @@ digraph "g" {
 "galera-bundle-docker-2_monitor_0 metal-3" -> "galera-bundle-master_start_0" [ style = bold]
 "galera-bundle-docker-2_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-2_monitor_60000 metal-3" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle-2_monitor_0 metal-1" [ style = bold]
+"galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle-2_monitor_0 metal-2" [ style = bold]
+"galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle-2_monitor_0 metal-3" [ style = bold]
 "galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle-2_start_0 metal-3" [ style = bold]
 "galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle-docker-2_monitor_60000 metal-3" [ style = bold]
 "galera-bundle-docker-2_start_0 metal-3" -> "galera-bundle_running_0" [ style = bold]
@@ -237,6 +246,9 @@ digraph "g" {
 "redis-bundle-docker-0_monitor_0 metal-3" -> "redis-bundle-master_start_0" [ style = bold]
 "redis-bundle-docker-0_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "redis-bundle-docker-0_monitor_60000 metal-1" [ style=bold color="green" fontcolor="black"]
+"redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle-0_monitor_0 metal-1" [ style = bold]
+"redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle-0_monitor_0 metal-2" [ style = bold]
+"redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle-0_monitor_0 metal-3" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle-0_start_0 metal-1" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle-docker-0_monitor_60000 metal-1" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-1" -> "redis-bundle_running_0" [ style = bold]
@@ -259,6 +271,9 @@ digraph "g" {
 "redis-bundle-docker-1_monitor_0 metal-3" -> "redis-bundle-master_start_0" [ style = bold]
 "redis-bundle-docker-1_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "redis-bundle-docker-1_monitor_60000 metal-2" [ style=bold color="green" fontcolor="black"]
+"redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle-1_monitor_0 metal-1" [ style = bold]
+"redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle-1_monitor_0 metal-2" [ style = bold]
+"redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle-1_monitor_0 metal-3" [ style = bold]
 "redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle-1_start_0 metal-2" [ style = bold]
 "redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle-docker-1_monitor_60000 metal-2" [ style = bold]
 "redis-bundle-docker-1_start_0 metal-2" -> "redis-bundle_running_0" [ style = bold]
@@ -281,6 +296,9 @@ digraph "g" {
 "redis-bundle-docker-2_monitor_0 metal-3" -> "redis-bundle-master_start_0" [ style = bold]
 "redis-bundle-docker-2_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "redis-bundle-docker-2_monitor_60000 metal-3" [ style=bold color="green" fontcolor="black"]
+"redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle-2_monitor_0 metal-1" [ style = bold]
+"redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle-2_monitor_0 metal-2" [ style = bold]
+"redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle-2_monitor_0 metal-3" [ style = bold]
 "redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle-2_start_0 metal-3" [ style = bold]
 "redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle-docker-2_monitor_60000 metal-3" [ style = bold]
 "redis-bundle-docker-2_start_0 metal-3" -> "redis-bundle_running_0" [ style = bold]
diff --git a/pengine/test10/bundle-order-startup-clone-2.exp b/pengine/test10/bundle-order-startup-clone-2.exp
index ae499c0..b2bbf52 100644
--- a/pengine/test10/bundle-order-startup-clone-2.exp
+++ b/pengine/test10/bundle-order-startup-clone-2.exp
@@ -597,7 +597,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="68" operation="start" operation_key="galera-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="37">
     <action_set>
@@ -606,7 +610,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="68" operation="start" operation_key="galera-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="38">
     <action_set>
@@ -615,7 +623,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="68" operation="start" operation_key="galera-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="39">
     <action_set>
@@ -739,7 +751,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-1" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="72" operation="start" operation_key="galera-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="47">
     <action_set>
@@ -748,7 +764,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-1" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="72" operation="start" operation_key="galera-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="48">
     <action_set>
@@ -757,7 +777,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-1" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="72" operation="start" operation_key="galera-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="49">
     <action_set>
@@ -881,7 +905,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-2" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="76" operation="start" operation_key="galera-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="57">
     <action_set>
@@ -890,7 +918,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-2" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="76" operation="start" operation_key="galera-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="58">
     <action_set>
@@ -899,7 +931,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-2" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="76" operation="start" operation_key="galera-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="59">
     <action_set>
@@ -1814,7 +1850,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="115" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="112">
     <action_set>
@@ -1823,7 +1863,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="115" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="113">
     <action_set>
@@ -1832,7 +1876,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="115" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-1" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="114">
     <action_set>
@@ -1956,7 +2004,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-1" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="119" operation="start" operation_key="redis-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="122">
     <action_set>
@@ -1965,7 +2017,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-1" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="119" operation="start" operation_key="redis-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="123">
     <action_set>
@@ -1974,7 +2030,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-1" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="119" operation="start" operation_key="redis-bundle-docker-1_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="124">
     <action_set>
@@ -2098,7 +2158,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-2" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="123" operation="start" operation_key="redis-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="132">
     <action_set>
@@ -2107,7 +2171,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-2" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="123" operation="start" operation_key="redis-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="133">
     <action_set>
@@ -2116,7 +2184,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-2" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-3"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="123" operation="start" operation_key="redis-bundle-docker-2_start_0" on_node="metal-3" on_node_uuid="3"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="134" priority="1000000">
     <action_set>
diff --git a/pengine/test10/bundle-order-startup-clone-2.summary b/pengine/test10/bundle-order-startup-clone-2.summary
index 07e6f00..f2dd8c3 100644
--- a/pengine/test10/bundle-order-startup-clone-2.summary
+++ b/pengine/test10/bundle-order-startup-clone-2.summary
@@ -52,21 +52,12 @@ Executing cluster transition:
  * Resource action: galera-bundle-docker-0 monitor on metal-3
  * Resource action: galera-bundle-docker-0 monitor on metal-2
  * Resource action: galera-bundle-docker-0 monitor on metal-1
- * Resource action: galera-bundle-0 monitor on metal-3
- * Resource action: galera-bundle-0 monitor on metal-2
- * Resource action: galera-bundle-0 monitor on metal-1
  * Resource action: galera-bundle-docker-1 monitor on metal-3
  * Resource action: galera-bundle-docker-1 monitor on metal-2
  * Resource action: galera-bundle-docker-1 monitor on metal-1
- * Resource action: galera-bundle-1 monitor on metal-3
- * Resource action: galera-bundle-1 monitor on metal-2
- * Resource action: galera-bundle-1 monitor on metal-1
  * Resource action: galera-bundle-docker-2 monitor on metal-3
  * Resource action: galera-bundle-docker-2 monitor on metal-2
  * Resource action: galera-bundle-docker-2 monitor on metal-1
- * Resource action: galera-bundle-2 monitor on metal-3
- * Resource action: galera-bundle-2 monitor on metal-2
- * Resource action: galera-bundle-2 monitor on metal-1
  * Resource action: haproxy-bundle-docker-0 monitor on metal-3
  * Resource action: haproxy-bundle-docker-0 monitor on metal-2
  * Resource action: haproxy-bundle-docker-0 monitor on metal-1
@@ -80,21 +71,12 @@ Executing cluster transition:
  * Resource action: redis-bundle-docker-0 monitor on metal-3
  * Resource action: redis-bundle-docker-0 monitor on metal-2
  * Resource action: redis-bundle-docker-0 monitor on metal-1
- * Resource action: redis-bundle-0  monitor on metal-3
- * Resource action: redis-bundle-0  monitor on metal-2
- * Resource action: redis-bundle-0  monitor on metal-1
  * Resource action: redis-bundle-docker-1 monitor on metal-3
  * Resource action: redis-bundle-docker-1 monitor on metal-2
  * Resource action: redis-bundle-docker-1 monitor on metal-1
- * Resource action: redis-bundle-1  monitor on metal-3
- * Resource action: redis-bundle-1  monitor on metal-2
- * Resource action: redis-bundle-1  monitor on metal-1
  * Resource action: redis-bundle-docker-2 monitor on metal-3
  * Resource action: redis-bundle-docker-2 monitor on metal-2
  * Resource action: redis-bundle-docker-2 monitor on metal-1
- * Resource action: redis-bundle-2  monitor on metal-3
- * Resource action: redis-bundle-2  monitor on metal-2
- * Resource action: redis-bundle-2  monitor on metal-1
  * Pseudo action:   redis-bundle_start_0
  * Pseudo action:   haproxy-bundle_start_0
  * Pseudo action:   storage-clone_confirmed-pre_notify_start_0
@@ -104,24 +86,33 @@ Executing cluster transition:
  * Pseudo action:   redis-bundle-master_confirmed-pre_notify_start_0
  * Pseudo action:   redis-bundle-master_start_0
  * Resource action: redis-bundle-docker-0 start on metal-1
- * Resource action: redis-bundle-0  start on metal-1
+ * Resource action: redis-bundle-0  monitor on metal-3
+ * Resource action: redis-bundle-0  monitor on metal-2
+ * Resource action: redis-bundle-0  monitor on metal-1
  * Resource action: redis-bundle-docker-1 start on metal-2
- * Resource action: redis-bundle-1  start on metal-2
+ * Resource action: redis-bundle-1  monitor on metal-3
+ * Resource action: redis-bundle-1  monitor on metal-2
+ * Resource action: redis-bundle-1  monitor on metal-1
  * Resource action: redis-bundle-docker-2 start on metal-3
- * Resource action: redis-bundle-2  start on metal-3
+ * Resource action: redis-bundle-2  monitor on metal-3
+ * Resource action: redis-bundle-2  monitor on metal-2
+ * Resource action: redis-bundle-2  monitor on metal-1
  * Pseudo action:   haproxy-bundle_running_0
  * Resource action: haproxy-bundle-docker-0 monitor=60000 on metal-1
  * Resource action: haproxy-bundle-docker-1 monitor=60000 on metal-2
  * Resource action: haproxy-bundle-docker-2 monitor=60000 on metal-3
+ * Resource action: redis-bundle-docker-0 monitor=60000 on metal-1
+ * Resource action: redis-bundle-0  start on metal-1
+ * Resource action: redis-bundle-docker-1 monitor=60000 on metal-2
+ * Resource action: redis-bundle-1  start on metal-2
+ * Resource action: redis-bundle-docker-2 monitor=60000 on metal-3
+ * Resource action: redis-bundle-2  start on metal-3
  * Resource action: redis:0         start on redis-bundle-0
  * Resource action: redis:1         start on redis-bundle-1
  * Resource action: redis:2         start on redis-bundle-2
  * Pseudo action:   redis-bundle-master_running_0
- * Resource action: redis-bundle-docker-0 monitor=60000 on metal-1
  * Resource action: redis-bundle-0  monitor=60000 on metal-1
- * Resource action: redis-bundle-docker-1 monitor=60000 on metal-2
  * Resource action: redis-bundle-1  monitor=60000 on metal-2
- * Resource action: redis-bundle-docker-2 monitor=60000 on metal-3
  * Resource action: redis-bundle-2  monitor=60000 on metal-3
  * Pseudo action:   redis-bundle-master_post_notify_running_0
  * Resource action: redis:0         notify on redis-bundle-0
@@ -165,20 +156,29 @@ Executing cluster transition:
  * Resource action: storage:2       monitor=30000 on metal-3
  * Pseudo action:   galera-bundle-master_start_0
  * Resource action: galera-bundle-docker-0 start on metal-1
- * Resource action: galera-bundle-0 start on metal-1
+ * Resource action: galera-bundle-0 monitor on metal-3
+ * Resource action: galera-bundle-0 monitor on metal-2
+ * Resource action: galera-bundle-0 monitor on metal-1
  * Resource action: galera-bundle-docker-1 start on metal-2
- * Resource action: galera-bundle-1 start on metal-2
+ * Resource action: galera-bundle-1 monitor on metal-3
+ * Resource action: galera-bundle-1 monitor on metal-2
+ * Resource action: galera-bundle-1 monitor on metal-1
  * Resource action: galera-bundle-docker-2 start on metal-3
+ * Resource action: galera-bundle-2 monitor on metal-3
+ * Resource action: galera-bundle-2 monitor on metal-2
+ * Resource action: galera-bundle-2 monitor on metal-1
+ * Resource action: galera-bundle-docker-0 monitor=60000 on metal-1
+ * Resource action: galera-bundle-0 start on metal-1
+ * Resource action: galera-bundle-docker-1 monitor=60000 on metal-2
+ * Resource action: galera-bundle-1 start on metal-2
+ * Resource action: galera-bundle-docker-2 monitor=60000 on metal-3
  * Resource action: galera-bundle-2 start on metal-3
  * Resource action: galera:0        start on galera-bundle-0
  * Resource action: galera:1        start on galera-bundle-1
  * Resource action: galera:2        start on galera-bundle-2
  * Pseudo action:   galera-bundle-master_running_0
- * Resource action: galera-bundle-docker-0 monitor=60000 on metal-1
  * Resource action: galera-bundle-0 monitor=60000 on metal-1
- * Resource action: galera-bundle-docker-1 monitor=60000 on metal-2
  * Resource action: galera-bundle-1 monitor=60000 on metal-2
- * Resource action: galera-bundle-docker-2 monitor=60000 on metal-3
  * Resource action: galera-bundle-2 monitor=60000 on metal-3
  * Pseudo action:   galera-bundle_running_0
  * Resource action: galera:0        monitor=30000 on galera-bundle-0
diff --git a/pengine/test10/bundle-order-startup-clone.dot b/pengine/test10/bundle-order-startup-clone.dot
index 39f3635..8426bd2 100644
--- a/pengine/test10/bundle-order-startup-clone.dot
+++ b/pengine/test10/bundle-order-startup-clone.dot
@@ -1,10 +1,10 @@
 digraph "g" {
 "galera-bundle-0_monitor_0 metal-1" -> "galera-bundle-0_start_0 metal-1" [ style = dashed]
-"galera-bundle-0_monitor_0 metal-1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-0_monitor_0 metal-1" [ style=dashed color="red" fontcolor="black"]
 "galera-bundle-0_monitor_0 metal-2" -> "galera-bundle-0_start_0 metal-1" [ style = dashed]
-"galera-bundle-0_monitor_0 metal-2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-0_monitor_0 metal-2" [ style=dashed color="red" fontcolor="black"]
 "galera-bundle-0_monitor_0 metal-3" -> "galera-bundle-0_start_0 metal-1" [ style = dashed]
-"galera-bundle-0_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-0_monitor_0 metal-3" [ style=dashed color="red" fontcolor="black"]
 "galera-bundle-0_monitor_60000 metal-1" [ style=dashed color="red" fontcolor="black"]
 "galera-bundle-0_start_0 metal-1" -> "galera-bundle-0_monitor_60000 metal-1" [ style = dashed]
 "galera-bundle-0_start_0 metal-1" -> "galera:0_monitor_20000 galera-bundle-0" [ style = dashed]
@@ -21,6 +21,9 @@ digraph "g" {
 "galera-bundle-docker-0_monitor_0 metal-3" -> "galera-bundle-master_start_0" [ style = dashed]
 "galera-bundle-docker-0_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-0_monitor_60000 metal-1" [ style=dashed color="red" fontcolor="black"]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-1" [ style = dashed]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-2" [ style = dashed]
+"galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_monitor_0 metal-3" [ style = dashed]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-0_start_0 metal-1" [ style = dashed]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle-docker-0_monitor_60000 metal-1" [ style = dashed]
 "galera-bundle-docker-0_start_0 metal-1" -> "galera-bundle_running_0" [ style = dashed]
@@ -77,6 +80,9 @@ digraph "g" {
 "redis-bundle-docker-0_monitor_0 metal-3" -> "redis-bundle-master_start_0" [ style = bold]
 "redis-bundle-docker-0_monitor_0 metal-3" [ style=bold color="green" fontcolor="black"]
 "redis-bundle-docker-0_monitor_60000 metal-2" [ style=bold color="green" fontcolor="black"]
+"redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle-0_monitor_0 metal-1" [ style = bold]
+"redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle-0_monitor_0 metal-2" [ style = bold]
+"redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle-0_monitor_0 metal-3" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle-0_start_0 metal-2" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle-docker-0_monitor_60000 metal-2" [ style = bold]
 "redis-bundle-docker-0_start_0 metal-2" -> "redis-bundle_running_0" [ style = bold]
diff --git a/pengine/test10/bundle-order-startup-clone.exp b/pengine/test10/bundle-order-startup-clone.exp
index 9e3dd9b..46d969c 100644
--- a/pengine/test10/bundle-order-startup-clone.exp
+++ b/pengine/test10/bundle-order-startup-clone.exp
@@ -55,33 +55,6 @@
   </synapse>
   <synapse id="6">
     <action_set>
-      <rsc_op id="16" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="metal-3" on_node_uuid="3">
-        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
-      </rsc_op>
-    </action_set>
-    <inputs/>
-  </synapse>
-  <synapse id="7">
-    <action_set>
-      <rsc_op id="10" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="metal-2" on_node_uuid="2">
-        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
-      </rsc_op>
-    </action_set>
-    <inputs/>
-  </synapse>
-  <synapse id="8">
-    <action_set>
-      <rsc_op id="4" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="metal-1" on_node_uuid="1">
-        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
-      </rsc_op>
-    </action_set>
-    <inputs/>
-  </synapse>
-  <synapse id="9">
-    <action_set>
       <rsc_op id="62" operation="monitor" operation_key="haproxy-bundle-docker-0_monitor_60000" on_node="metal-2" on_node_uuid="2">
         <primitive id="haproxy-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
         <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="192.168.24.1:8787/tripleoupstream/centos-binary-haproxy:latest" monitor_cmd="/bin/true" mount_points="" reuse="false" run_cmd="/bin/bash /usr/local/bin/kolla_start" run_opts=" --restart=no --net=host -e PCMK_remote_port=3121 -v /var/lib/kolla/config_files/haproxy.json:/var/lib/kolla/config_files/config.json:ro -v /var/lib/config-data/haproxy/etc:/etc:ro -v /etc/hosts:/etc/hosts:ro -v /etc/localtime:/etc/localtime:ro -v /etc/pki/ca-trust/extracted:/etc/pki/ca-trust/extracted:ro -v /etc/pki/tls/certs/ca-bundle.crt:/etc/pki/tls/certs/ca-bundle.crt:ro -v /etc/pki/tls/certs/ca-bundle.trust.crt:/etc/pki/tls/certs/ca-bundle.trust.crt:ro -v /etc/pki/tls/cert.pem:/etc/pki/tls/cert.pem:ro -v /dev/log:/dev/log:rw --user=root --log-driver=journald -e KOLLA_CONFIG_STRATEGY=COPY_ALWAYS "/>
@@ -93,7 +66,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="10">
+  <synapse id="7">
     <action_set>
       <rsc_op id="61" operation="start" operation_key="haproxy-bundle-docker-0_start_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="haproxy-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -115,7 +88,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="11">
+  <synapse id="8">
     <action_set>
       <rsc_op id="17" operation="monitor" operation_key="haproxy-bundle-docker-0_monitor_0" on_node="metal-3" on_node_uuid="3">
         <primitive id="haproxy-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -124,7 +97,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="12">
+  <synapse id="9">
     <action_set>
       <rsc_op id="11" operation="monitor" operation_key="haproxy-bundle-docker-0_monitor_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="haproxy-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -133,7 +106,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="13">
+  <synapse id="10">
     <action_set>
       <rsc_op id="5" operation="monitor" operation_key="haproxy-bundle-docker-0_monitor_0" on_node="metal-1" on_node_uuid="1">
         <primitive id="haproxy-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -142,7 +115,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="14" priority="1000000">
+  <synapse id="11" priority="1000000">
     <action_set>
       <rsc_op id="112" operation="notify" operation_key="redis:0_post_notify_start_0" on_node="redis-bundle-0" on_node_uuid="redis-bundle-0" router_node="metal-2">
         <primitive id="redis" long-id="redis:0" class="ocf" provider="heartbeat" type="redis"/>
@@ -155,7 +128,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="15">
+  <synapse id="12">
     <action_set>
       <rsc_op id="77" operation="monitor" operation_key="redis:0_monitor_60000" on_node="redis-bundle-0" on_node_uuid="redis-bundle-0" router_node="metal-2">
         <primitive id="redis" long-id="redis:0" class="ocf" provider="heartbeat" type="redis"/>
@@ -174,7 +147,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="16">
+  <synapse id="13">
     <action_set>
       <rsc_op id="76" operation="monitor" operation_key="redis:0_monitor_45000" on_node="redis-bundle-0" on_node_uuid="redis-bundle-0" router_node="metal-2">
         <primitive id="redis" long-id="redis:0" class="ocf" provider="heartbeat" type="redis"/>
@@ -193,7 +166,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="17">
+  <synapse id="14">
     <action_set>
       <rsc_op id="75" operation="start" operation_key="redis:0_start_0" on_node="redis-bundle-0" on_node_uuid="redis-bundle-0" router_node="metal-2">
         <primitive id="redis" long-id="redis:0" class="ocf" provider="heartbeat" type="redis"/>
@@ -212,7 +185,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="18" priority="1000000">
+  <synapse id="15" priority="1000000">
     <action_set>
       <pseudo_event id="83" operation="notified" operation_key="redis-bundle-master_confirmed-post_notify_running_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="running" CRM_meta_notify_key_type="confirmed-post" CRM_meta_notify_operation="start" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
@@ -227,7 +200,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="19" priority="1000000">
+  <synapse id="16" priority="1000000">
     <action_set>
       <pseudo_event id="82" operation="notify" operation_key="redis-bundle-master_post_notify_running_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="running" CRM_meta_notify_key_type="post" CRM_meta_notify_operation="start" CRM_meta_notify_type="post" CRM_meta_timeout="20000" />
@@ -242,7 +215,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="20">
+  <synapse id="17">
     <action_set>
       <pseudo_event id="81" operation="notified" operation_key="redis-bundle-master_confirmed-pre_notify_start_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="start" CRM_meta_notify_key_type="confirmed-pre" CRM_meta_notify_operation="start" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
@@ -254,7 +227,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="21">
+  <synapse id="18">
     <action_set>
       <pseudo_event id="80" operation="notify" operation_key="redis-bundle-master_pre_notify_start_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_notify_key_operation="start" CRM_meta_notify_key_type="pre" CRM_meta_notify_operation="start" CRM_meta_notify_type="pre" CRM_meta_timeout="20000" />
@@ -262,7 +235,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="22" priority="1000000">
+  <synapse id="19" priority="1000000">
     <action_set>
       <pseudo_event id="79" operation="running" operation_key="redis-bundle-master_running_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
@@ -277,7 +250,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="23">
+  <synapse id="20">
     <action_set>
       <pseudo_event id="78" operation="start" operation_key="redis-bundle-master_start_0">
         <attributes CRM_meta_clone_max="1" CRM_meta_clone_node_max="1" CRM_meta_globally_unique="false" CRM_meta_master_max="1" CRM_meta_master_node_max="1" CRM_meta_notify="true" CRM_meta_timeout="20000" />
@@ -301,7 +274,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="24">
+  <synapse id="21">
     <action_set>
       <rsc_op id="68" operation="monitor" operation_key="redis-bundle-docker-0_monitor_60000" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -314,7 +287,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="25">
+  <synapse id="22">
     <action_set>
       <rsc_op id="67" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -336,7 +309,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="26">
+  <synapse id="23">
     <action_set>
       <rsc_op id="18" operation="monitor" operation_key="redis-bundle-docker-0_monitor_0" on_node="metal-3" on_node_uuid="3">
         <primitive id="redis-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -345,7 +318,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="27">
+  <synapse id="24">
     <action_set>
       <rsc_op id="12" operation="monitor" operation_key="redis-bundle-docker-0_monitor_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -354,7 +327,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="28">
+  <synapse id="25">
     <action_set>
       <rsc_op id="6" operation="monitor" operation_key="redis-bundle-docker-0_monitor_0" on_node="metal-1" on_node_uuid="1">
         <primitive id="redis-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
@@ -363,7 +336,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="29">
+  <synapse id="26">
     <action_set>
       <rsc_op id="70" operation="monitor" operation_key="redis-bundle-0_monitor_60000" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
@@ -376,7 +349,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="30">
+  <synapse id="27">
     <action_set>
       <rsc_op id="69" operation="start" operation_key="redis-bundle-0_start_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
@@ -398,34 +371,46 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="31">
+  <synapse id="28">
     <action_set>
       <rsc_op id="19" operation="monitor" operation_key="redis-bundle-0_monitor_0" on_node="metal-3" on_node_uuid="3">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="67" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
-  <synapse id="32">
+  <synapse id="29">
     <action_set>
       <rsc_op id="13" operation="monitor" operation_key="redis-bundle-0_monitor_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="67" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
-  <synapse id="33">
+  <synapse id="30">
     <action_set>
       <rsc_op id="7" operation="monitor" operation_key="redis-bundle-0_monitor_0" on_node="metal-1" on_node_uuid="1">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-2"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="67" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="metal-2" on_node_uuid="2"/>
+      </trigger>
+    </inputs>
   </synapse>
-  <synapse id="34" priority="1000000">
+  <synapse id="31" priority="1000000">
     <action_set>
       <pseudo_event id="72" operation="running" operation_key="redis-bundle_running_0">
         <attributes CRM_meta_timeout="20000" />
@@ -440,7 +425,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="35">
+  <synapse id="32">
     <action_set>
       <pseudo_event id="71" operation="start" operation_key="redis-bundle_start_0">
         <attributes CRM_meta_timeout="20000" />
@@ -448,7 +433,7 @@
     </action_set>
     <inputs/>
   </synapse>
-  <synapse id="36" priority="1000000">
+  <synapse id="33" priority="1000000">
     <action_set>
       <pseudo_event id="64" operation="running" operation_key="haproxy-bundle_running_0">
         <attributes CRM_meta_timeout="20000" />
@@ -460,7 +445,7 @@
       </trigger>
     </inputs>
   </synapse>
-  <synapse id="37">
+  <synapse id="34">
     <action_set>
       <pseudo_event id="63" operation="start" operation_key="haproxy-bundle_start_0">
         <attributes CRM_meta_timeout="20000" />
diff --git a/pengine/test10/bundle-order-startup-clone.summary b/pengine/test10/bundle-order-startup-clone.summary
index 1346bda..8a737fd 100644
--- a/pengine/test10/bundle-order-startup-clone.summary
+++ b/pengine/test10/bundle-order-startup-clone.summary
@@ -31,9 +31,6 @@ Executing cluster transition:
  * Resource action: galera-bundle-docker-0 monitor on metal-3
  * Resource action: galera-bundle-docker-0 monitor on metal-2
  * Resource action: galera-bundle-docker-0 monitor on metal-1
- * Resource action: galera-bundle-0 monitor on metal-3
- * Resource action: galera-bundle-0 monitor on metal-2
- * Resource action: galera-bundle-0 monitor on metal-1
  * Resource action: haproxy-bundle-docker-0 monitor on metal-3
  * Resource action: haproxy-bundle-docker-0 monitor on metal-2
  * Resource action: haproxy-bundle-docker-0 monitor on metal-1
@@ -41,21 +38,21 @@ Executing cluster transition:
  * Resource action: redis-bundle-docker-0 monitor on metal-3
  * Resource action: redis-bundle-docker-0 monitor on metal-2
  * Resource action: redis-bundle-docker-0 monitor on metal-1
- * Resource action: redis-bundle-0  monitor on metal-3
- * Resource action: redis-bundle-0  monitor on metal-2
- * Resource action: redis-bundle-0  monitor on metal-1
  * Pseudo action:   redis-bundle_start_0
  * Pseudo action:   haproxy-bundle_start_0
  * Resource action: haproxy-bundle-docker-0 start on metal-2
  * Pseudo action:   redis-bundle-master_confirmed-pre_notify_start_0
  * Pseudo action:   redis-bundle-master_start_0
  * Resource action: redis-bundle-docker-0 start on metal-2
- * Resource action: redis-bundle-0  start on metal-2
+ * Resource action: redis-bundle-0  monitor on metal-3
+ * Resource action: redis-bundle-0  monitor on metal-2
+ * Resource action: redis-bundle-0  monitor on metal-1
  * Pseudo action:   haproxy-bundle_running_0
  * Resource action: haproxy-bundle-docker-0 monitor=60000 on metal-2
+ * Resource action: redis-bundle-docker-0 monitor=60000 on metal-2
+ * Resource action: redis-bundle-0  start on metal-2
  * Resource action: redis:0         start on redis-bundle-0
  * Pseudo action:   redis-bundle-master_running_0
- * Resource action: redis-bundle-docker-0 monitor=60000 on metal-2
  * Resource action: redis-bundle-0  monitor=60000 on metal-2
  * Pseudo action:   redis-bundle-master_post_notify_running_0
  * Resource action: redis:0         notify on redis-bundle-0
diff --git a/pengine/test10/bundle-order-startup.dot b/pengine/test10/bundle-order-startup.dot
index 213fa4c..0f7bfd2 100644
--- a/pengine/test10/bundle-order-startup.dot
+++ b/pengine/test10/bundle-order-startup.dot
@@ -11,6 +11,7 @@ digraph "g" {
 "galera-bundle-docker-0_monitor_0 undercloud" -> "galera-bundle-master_start_0" [ style = bold]
 "galera-bundle-docker-0_monitor_0 undercloud" [ style=bold color="green" fontcolor="black"]
 "galera-bundle-docker-0_monitor_60000 undercloud" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-0_monitor_0 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-0_start_0 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle-docker-0_monitor_60000 undercloud" [ style = bold]
 "galera-bundle-docker-0_start_0 undercloud" -> "galera-bundle_running_0" [ style = bold]
@@ -113,6 +114,7 @@ digraph "g" {
 "rabbitmq-bundle-docker-0_monitor_0 undercloud" -> "rabbitmq-bundle-docker-0_start_0 undercloud" [ style = bold]
 "rabbitmq-bundle-docker-0_monitor_0 undercloud" [ style=bold color="green" fontcolor="black"]
 "rabbitmq-bundle-docker-0_monitor_60000 undercloud" [ style=bold color="green" fontcolor="black"]
+"rabbitmq-bundle-docker-0_start_0 undercloud" -> "rabbitmq-bundle-0_monitor_0 undercloud" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 undercloud" -> "rabbitmq-bundle-0_start_0 undercloud" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 undercloud" -> "rabbitmq-bundle-docker-0_monitor_60000 undercloud" [ style = bold]
 "rabbitmq-bundle-docker-0_start_0 undercloud" -> "rabbitmq-bundle_running_0" [ style = bold]
@@ -140,6 +142,7 @@ digraph "g" {
 "redis-bundle-docker-0_monitor_0 undercloud" -> "redis-bundle-master_start_0" [ style = bold]
 "redis-bundle-docker-0_monitor_0 undercloud" [ style=bold color="green" fontcolor="black"]
 "redis-bundle-docker-0_monitor_60000 undercloud" [ style=bold color="green" fontcolor="black"]
+"redis-bundle-docker-0_start_0 undercloud" -> "redis-bundle-0_monitor_0 undercloud" [ style = bold]
 "redis-bundle-docker-0_start_0 undercloud" -> "redis-bundle-0_start_0 undercloud" [ style = bold]
 "redis-bundle-docker-0_start_0 undercloud" -> "redis-bundle-docker-0_monitor_60000 undercloud" [ style = bold]
 "redis-bundle-docker-0_start_0 undercloud" -> "redis-bundle_running_0" [ style = bold]
diff --git a/pengine/test10/bundle-order-startup.exp b/pengine/test10/bundle-order-startup.exp
index 77e67bd..3f50562 100644
--- a/pengine/test10/bundle-order-startup.exp
+++ b/pengine/test10/bundle-order-startup.exp
@@ -207,7 +207,11 @@
         <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="undercloud"  port="3121"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="16" operation="start" operation_key="rabbitmq-bundle-docker-0_start_0" on_node="undercloud" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="15">
     <action_set>
@@ -364,7 +368,11 @@
         <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="undercloud"  port="3123"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="38" operation="start" operation_key="galera-bundle-docker-0_start_0" on_node="undercloud" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="26" priority="1000000">
     <action_set>
@@ -593,7 +601,11 @@
         <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="undercloud"  port="3124"/>
       </rsc_op>
     </action_set>
-    <inputs/>
+    <inputs>
+      <trigger>
+        <rsc_op id="61" operation="start" operation_key="redis-bundle-docker-0_start_0" on_node="undercloud" on_node_uuid="1"/>
+      </trigger>
+    </inputs>
   </synapse>
   <synapse id="42">
     <action_set>
diff --git a/pengine/test10/bundle-order-startup.summary b/pengine/test10/bundle-order-startup.summary
index 8e6b685..5512692 100644
--- a/pengine/test10/bundle-order-startup.summary
+++ b/pengine/test10/bundle-order-startup.summary
@@ -41,12 +41,9 @@ Transition Summary:
 Executing cluster transition:
  * Pseudo action:   rabbitmq-bundle-clone_pre_notify_start_0
  * Resource action: rabbitmq-bundle-docker-0 monitor on undercloud
- * Resource action: rabbitmq-bundle-0 monitor on undercloud
  * Resource action: galera-bundle-docker-0 monitor on undercloud
- * Resource action: galera-bundle-0 monitor on undercloud
  * Pseudo action:   redis-bundle-master_pre_notify_start_0
  * Resource action: redis-bundle-docker-0 monitor on undercloud
- * Resource action: redis-bundle-0  monitor on undercloud
  * Resource action: ip-192.168.122.254 monitor on undercloud
  * Resource action: ip-192.168.122.250 monitor on undercloud
  * Resource action: ip-192.168.122.249 monitor on undercloud
@@ -60,7 +57,7 @@ Executing cluster transition:
  * Pseudo action:   rabbitmq-bundle-clone_confirmed-pre_notify_start_0
  * Pseudo action:   rabbitmq-bundle-clone_start_0
  * Resource action: rabbitmq-bundle-docker-0 start on undercloud
- * Resource action: rabbitmq-bundle-0 start on undercloud
+ * Resource action: rabbitmq-bundle-0 monitor on undercloud
  * Pseudo action:   redis-bundle-master_confirmed-pre_notify_start_0
  * Resource action: ip-192.168.122.254 start on undercloud
  * Resource action: ip-192.168.122.250 start on undercloud
@@ -71,10 +68,8 @@ Executing cluster transition:
  * Resource action: openstack-cinder-volume-docker-0 start on undercloud
  * Pseudo action:   openstack-cinder-volume_running_0
  * Pseudo action:   haproxy-bundle_start_0
- * Resource action: rabbitmq:0      start on rabbitmq-bundle-0
- * Pseudo action:   rabbitmq-bundle-clone_running_0
  * Resource action: rabbitmq-bundle-docker-0 monitor=60000 on undercloud
- * Resource action: rabbitmq-bundle-0 monitor=60000 on undercloud
+ * Resource action: rabbitmq-bundle-0 start on undercloud
  * Resource action: ip-192.168.122.254 monitor=10000 on undercloud
  * Resource action: ip-192.168.122.250 monitor=10000 on undercloud
  * Resource action: ip-192.168.122.249 monitor=10000 on undercloud
@@ -85,16 +80,20 @@ Executing cluster transition:
  * Resource action: openstack-cinder-volume-docker-0 monitor=60000 on undercloud
  * Pseudo action:   haproxy-bundle_running_0
  * Pseudo action:   redis-bundle_start_0
- * Pseudo action:   rabbitmq-bundle-clone_post_notify_running_0
+ * Resource action: rabbitmq:0      start on rabbitmq-bundle-0
+ * Pseudo action:   rabbitmq-bundle-clone_running_0
+ * Resource action: rabbitmq-bundle-0 monitor=60000 on undercloud
  * Pseudo action:   redis-bundle-master_start_0
  * Resource action: redis-bundle-docker-0 start on undercloud
- * Resource action: redis-bundle-0  start on undercloud
+ * Resource action: redis-bundle-0  monitor on undercloud
  * Resource action: haproxy-bundle-docker-0 monitor=60000 on undercloud
+ * Pseudo action:   rabbitmq-bundle-clone_post_notify_running_0
+ * Resource action: redis-bundle-docker-0 monitor=60000 on undercloud
+ * Resource action: redis-bundle-0  start on undercloud
  * Resource action: rabbitmq:0      notify on rabbitmq-bundle-0
  * Pseudo action:   rabbitmq-bundle-clone_confirmed-post_notify_running_0
  * Resource action: redis:0         start on redis-bundle-0
  * Pseudo action:   redis-bundle-master_running_0
- * Resource action: redis-bundle-docker-0 monitor=60000 on undercloud
  * Resource action: redis-bundle-0  monitor=60000 on undercloud
  * Pseudo action:   rabbitmq-bundle_running_0
  * Resource action: rabbitmq:0      monitor=10000 on rabbitmq-bundle-0
@@ -105,12 +104,13 @@ Executing cluster transition:
  * Pseudo action:   galera-bundle_start_0
  * Pseudo action:   galera-bundle-master_start_0
  * Resource action: galera-bundle-docker-0 start on undercloud
- * Resource action: galera-bundle-0 start on undercloud
+ * Resource action: galera-bundle-0 monitor on undercloud
  * Resource action: redis:0         monitor=60000 on redis-bundle-0
  * Resource action: redis:0         monitor=45000 on redis-bundle-0
+ * Resource action: galera-bundle-docker-0 monitor=60000 on undercloud
+ * Resource action: galera-bundle-0 start on undercloud
  * Resource action: galera:0        start on galera-bundle-0
  * Pseudo action:   galera-bundle-master_running_0
- * Resource action: galera-bundle-docker-0 monitor=60000 on undercloud
  * Resource action: galera-bundle-0 monitor=60000 on undercloud
  * Pseudo action:   galera-bundle_running_0
  * Resource action: galera:0        monitor=30000 on galera-bundle-0
diff --git a/pengine/test10/bundle-order-stop-clone.exp b/pengine/test10/bundle-order-stop-clone.exp
index a1106aa..71e2bf7 100644
--- a/pengine/test10/bundle-order-stop-clone.exp
+++ b/pengine/test10/bundle-order-stop-clone.exp
@@ -259,7 +259,7 @@
     <action_set>
       <rsc_op id="59" operation="stop" operation_key="galera-bundle-0_stop_0" on_node="metal-1" on_node_uuid="1">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-1" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
         <downed>
           <node id="galera-bundle-0"/>
         </downed>
@@ -281,7 +281,7 @@
     <action_set>
       <rsc_op id="37" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="metal-3" on_node_uuid="3">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
       </rsc_op>
     </action_set>
     <inputs/>
@@ -290,7 +290,7 @@
     <action_set>
       <rsc_op id="33" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="metal-2" on_node_uuid="2">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="metal-2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="metal-1"  port="3123"/>
       </rsc_op>
     </action_set>
     <inputs/>
diff --git a/pengine/test10/bundle-order-stop.exp b/pengine/test10/bundle-order-stop.exp
index 1dff657..c0724c7 100644
--- a/pengine/test10/bundle-order-stop.exp
+++ b/pengine/test10/bundle-order-stop.exp
@@ -128,7 +128,7 @@
     <action_set>
       <rsc_op id="20" operation="stop" operation_key="rabbitmq-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="rabbitmq-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3121"/>
+        <attributes CRM_meta_container="rabbitmq-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3121"/>
         <downed>
           <node id="rabbitmq-bundle-0"/>
         </downed>
@@ -261,7 +261,7 @@
     <action_set>
       <rsc_op id="40" operation="stop" operation_key="galera-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3123"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3123"/>
         <downed>
           <node id="galera-bundle-0"/>
         </downed>
@@ -549,7 +549,7 @@
     <action_set>
       <rsc_op id="63" operation="stop" operation_key="redis-bundle-0_stop_0" on_node="undercloud" on_node_uuid="1">
         <primitive id="redis-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
-        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="#uname"  port="3124"/>
+        <attributes CRM_meta_container="redis-bundle-docker-0" CRM_meta_on_node="undercloud" CRM_meta_on_node_uuid="1" CRM_meta_timeout="20000" addr="undercloud"  port="3124"/>
         <downed>
           <node id="redis-bundle-0"/>
         </downed>
diff --git a/pengine/test10/bundle-probe-order-1.dot b/pengine/test10/bundle-probe-order-1.dot
new file mode 100644
index 0000000..8ba1e50
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-1.dot
@@ -0,0 +1,11 @@
+digraph "g" {
+"galera-bundle-docker-0_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+}
diff --git a/pengine/test10/bundle-probe-order-1.exp b/pengine/test10/bundle-probe-order-1.exp
new file mode 100644
index 0000000..51d6d2e
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-1.exp
@@ -0,0 +1,83 @@
+<transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
+  <synapse id="0">
+    <action_set>
+      <rsc_op id="13" operation="monitor" operation_key="galera-bundle-docker-0_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-0" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-0:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="1">
+    <action_set>
+      <rsc_op id="7" operation="monitor" operation_key="galera-bundle-docker-0_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-0" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-0:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="2">
+    <action_set>
+      <rsc_op id="1" operation="monitor" operation_key="galera-bundle-docker-0_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-0" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-0:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="3">
+    <action_set>
+      <rsc_op id="15" operation="monitor" operation_key="galera-bundle-docker-1_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-docker-1" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-1" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-1:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="4">
+    <action_set>
+      <rsc_op id="9" operation="monitor" operation_key="galera-bundle-docker-1_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-1" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-1" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-1:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="5">
+    <action_set>
+      <rsc_op id="3" operation="monitor" operation_key="galera-bundle-docker-1_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-docker-1" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-1" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-1:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="6">
+    <action_set>
+      <rsc_op id="17" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="7">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="8">
+    <action_set>
+      <rsc_op id="5" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+</transition_graph>
diff --git a/pengine/test10/bundle-probe-order-1.scores b/pengine/test10/bundle-probe-order-1.scores
new file mode 100644
index 0000000..48e1355
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-1.scores
@@ -0,0 +1,149 @@
+Allocation scores:
+Using the original execution date of: 2017-10-12 07:31:56Z
+clone_color: galera-bundle-master allocation score on centos1: -INFINITY
+clone_color: galera-bundle-master allocation score on centos2: -INFINITY
+clone_color: galera-bundle-master allocation score on centos3: -INFINITY
+clone_color: galera-bundle-master allocation score on galera-bundle-0: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-1: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-2: 0
+clone_color: galera:0 allocation score on centos1: -INFINITY
+clone_color: galera:0 allocation score on centos2: -INFINITY
+clone_color: galera:0 allocation score on centos3: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-0: INFINITY
+clone_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:1 allocation score on centos1: -INFINITY
+clone_color: galera:1 allocation score on centos2: -INFINITY
+clone_color: galera:1 allocation score on centos3: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-1: INFINITY
+clone_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:2 allocation score on centos1: -INFINITY
+clone_color: galera:2 allocation score on centos2: -INFINITY
+clone_color: galera:2 allocation score on centos3: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-2: INFINITY
+container_color: galera-bundle allocation score on centos1: -INFINITY
+container_color: galera-bundle allocation score on centos2: 0
+container_color: galera-bundle allocation score on centos3: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-0 allocation score on centos1: 0
+container_color: galera-bundle-0 allocation score on centos2: 0
+container_color: galera-bundle-0 allocation score on centos3: 0
+container_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-1 allocation score on centos1: 0
+container_color: galera-bundle-1 allocation score on centos2: 0
+container_color: galera-bundle-1 allocation score on centos3: 0
+container_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-2 allocation score on centos1: 0
+container_color: galera-bundle-2 allocation score on centos2: 0
+container_color: galera-bundle-2 allocation score on centos3: 0
+container_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos2: 0
+container_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos2: 0
+container_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos2: 0
+container_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-master allocation score on centos1: 0
+container_color: galera-bundle-master allocation score on centos2: 0
+container_color: galera-bundle-master allocation score on centos3: 0
+container_color: galera-bundle-master allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-2: -INFINITY
+container_color: galera:0 allocation score on centos1: 0
+container_color: galera:0 allocation score on centos2: 0
+container_color: galera:0 allocation score on centos3: 0
+container_color: galera:0 allocation score on galera-bundle-0: 500
+container_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:1 allocation score on centos1: 0
+container_color: galera:1 allocation score on centos2: 0
+container_color: galera:1 allocation score on centos3: 0
+container_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:1 allocation score on galera-bundle-1: 500
+container_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:2 allocation score on centos1: 0
+container_color: galera:2 allocation score on centos2: 0
+container_color: galera:2 allocation score on centos3: 0
+container_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-2: 500
+galera:0 promotion score on none: 0
+galera:1 promotion score on none: 0
+galera:2 promotion score on none: 0
+native_color: galera-bundle-0 allocation score on centos1: 0
+native_color: galera-bundle-0 allocation score on centos2: 0
+native_color: galera-bundle-0 allocation score on centos3: 0
+native_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-1 allocation score on centos1: 0
+native_color: galera-bundle-1 allocation score on centos2: 0
+native_color: galera-bundle-1 allocation score on centos3: 0
+native_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-2 allocation score on centos1: 0
+native_color: galera-bundle-2 allocation score on centos2: 0
+native_color: galera-bundle-2 allocation score on centos3: 0
+native_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos2: 0
+native_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos2: 0
+native_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos2: 0
+native_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:0 allocation score on centos1: -INFINITY
+native_color: galera:0 allocation score on centos2: -INFINITY
+native_color: galera:0 allocation score on centos3: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-0: INFINITY
+native_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:1 allocation score on centos1: -INFINITY
+native_color: galera:1 allocation score on centos2: -INFINITY
+native_color: galera:1 allocation score on centos3: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-1: INFINITY
+native_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:2 allocation score on centos1: -INFINITY
+native_color: galera:2 allocation score on centos2: -INFINITY
+native_color: galera:2 allocation score on centos3: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-2: INFINITY
diff --git a/pengine/test10/bundle-probe-order-1.summary b/pengine/test10/bundle-probe-order-1.summary
new file mode 100644
index 0000000..23cc84f
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-1.summary
@@ -0,0 +1,32 @@
+Using the original execution date of: 2017-10-12 07:31:56Z
+
+Current cluster status:
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
+Transition Summary:
+
+Executing cluster transition:
+ * Resource action: galera-bundle-docker-0 monitor on centos3
+ * Resource action: galera-bundle-docker-0 monitor on centos2
+ * Resource action: galera-bundle-docker-0 monitor on centos1
+ * Resource action: galera-bundle-docker-1 monitor on centos3
+ * Resource action: galera-bundle-docker-1 monitor on centos2
+ * Resource action: galera-bundle-docker-1 monitor on centos1
+ * Resource action: galera-bundle-docker-2 monitor on centos3
+ * Resource action: galera-bundle-docker-2 monitor on centos2
+ * Resource action: galera-bundle-docker-2 monitor on centos1
+Using the original execution date of: 2017-10-12 07:31:56Z
+
+Revised cluster status:
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
diff --git a/pengine/test10/bundle-probe-order-1.xml b/pengine/test10/bundle-probe-order-1.xml
new file mode 100644
index 0000000..fb4f10d
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-1.xml
@@ -0,0 +1,95 @@
+<cib crm_feature_set="3.0.12" validate-with="pacemaker-2.8" epoch="295" num_updates="0" admin_epoch="0" cib-last-written="Thu Oct 12 09:31:55 2017" update-origin="centos1" update-client="crmd" update-user="hacluster" have-quorum="1" dc-uuid="1" execution-date="1507793516">
+  <configuration>
+    <crm_config>
+      <cluster_property_set id="cib-bootstrap-options">
+        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="false"/>
+        <nvpair id="cib-bootstrap-options-have-watchdog" name="have-watchdog" value="false"/>
+        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.16-12.bundle.3.el7.centos.4-94ff4df"/>
+        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="corosync"/>
+        <nvpair id="cib-bootstrap-options-cluster-name" name="cluster-name" value="ratester"/>
+        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1507793515"/>
+      </cluster_property_set>
+    </crm_config>
+    <nodes>
+      <node id="1" uname="centos1"/>
+      <node id="2" uname="centos2"/>
+      <node id="3" uname="centos3"/>
+    </nodes>
+    <resources>
+      <bundle id="galera-bundle">
+        <meta_attributes id="galera-bundle-meta_attributes">
+          <nvpair id="galera-bundle-meta_attributes-is-managed" name="is-managed" value="false"/>
+        </meta_attributes>
+        <docker masters="3" network="host" replicas="3" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" run-command="/usr/sbin/pacemaker_remoted" options="--user=root --log-driver=journald"/>
+        <network control-port="3123"/>
+        <storage>
+          <storage-mapping target-dir="/etc/libqb/force-filesystem-sockets" options="ro" id="map1" source-dir="/foo"/>
+          <storage-mapping target-dir="/etc/my.cnf.d/galera.cnf" options="ro" id="map2" source-dir="/etc/my.cnf.d/galera.cnf"/>
+          <storage-mapping target-dir="/var/lib/mysql" options="rw" id="map3" source-dir="/var/lib/mysql"/>
+        </storage>
+        <primitive class="ocf" id="galera" provider="heartbeat" type="galera">
+          <instance_attributes id="galera-instance_attributes">
+            <nvpair id="galera-instance_attributes-cluster_host_map" name="cluster_host_map" value="centos1:centos1;centos2:centos2;centos3:centos3"/>
+            <nvpair id="galera-instance_attributes-enable_creation" name="enable_creation" value="true"/>
+            <nvpair id="galera-instance_attributes-wsrep_cluster_address" name="wsrep_cluster_address" value="gcomm://centos1,centos2,centos3"/>
+          </instance_attributes>
+          <meta_attributes id="galera-meta_attributes">
+            <nvpair id="galera-meta_attributes-container-attribute-target" name="container-attribute-target" value="host"/>
+            <nvpair id="galera-meta_attributes-is-managed" name="is-managed" value="false"/>
+          </meta_attributes>
+          <operations>
+            <op id="galera-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="galera-monitor-interval-20" interval="20" name="monitor" timeout="30"/>
+            <op id="galera-monitor-interval-10" interval="10" name="monitor" role="Master" timeout="30"/>
+            <op id="galera-monitor-interval-30" interval="30" name="monitor" role="Slave" timeout="30"/>
+            <op id="galera-promote-interval-0s" interval="0s" name="promote" on-fail="block"/>
+            <op id="galera-start-interval-0s" interval="0s" name="start" timeout="120"/>
+            <op id="galera-stop-interval-0s" interval="0s" name="stop" timeout="120"/>
+          </operations>
+        </primitive>
+      </bundle>
+    </resources>
+    <constraints>
+      <rsc_location id="cli-ban-galera-bundle-on-centos1" rsc="galera-bundle" role="Started" node="centos1" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-bundle-on-centos3" rsc="galera-bundle" role="Started" node="centos3" score="-INFINITY"/>
+    </constraints>
+  </configuration>
+  <status>
+    <node_state id="3" uname="centos3" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="3">
+        <lrm_resources/>
+      </lrm>
+      <transient_attributes id="3">
+        <instance_attributes id="status-3">
+          <nvpair id="status-3-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="1" uname="centos1" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="1">
+        <lrm_resources/>
+      </lrm>
+      <transient_attributes id="1">
+        <instance_attributes id="status-1">
+          <nvpair id="status-1-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="2" uname="centos2" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="2">
+        <lrm_resources/>
+      </lrm>
+      <transient_attributes id="2">
+        <instance_attributes id="status-2">
+          <nvpair id="status-2-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-2-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state remote_node="true" id="galera-bundle-0" uname="galera-bundle-0" in_ccm="true" crm-debug-origin="remote_ra_maintenance" node_fenced="0" node_in_maintenance="1">
+      <lrm id="galera-bundle-0">
+        <lrm_resources/>
+      </lrm>
+    </node_state>
+  </status>
+</cib>
diff --git a/pengine/test10/bundle-probe-order-2.dot b/pengine/test10/bundle-probe-order-2.dot
new file mode 100644
index 0000000..4fba741
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-2.dot
@@ -0,0 +1,9 @@
+digraph "g" {
+"galera-bundle-0_monitor_60000 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_monitor_60000 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+"galera:0_monitor_0 galera-bundle-0" [ style=bold color="green" fontcolor="black"]
+}
diff --git a/pengine/test10/bundle-probe-order-2.exp b/pengine/test10/bundle-probe-order-2.exp
new file mode 100644
index 0000000..222ec81
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-2.exp
@@ -0,0 +1,65 @@
+<transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
+  <synapse id="0">
+    <action_set>
+      <rsc_op id="10" operation="monitor" operation_key="galera:0_monitor_0" on_node="galera-bundle-0" on_node_uuid="galera-bundle-0" router_node="centos2">
+        <primitive id="galera" long-id="galera:0" class="ocf" provider="heartbeat" type="galera"/>
+        <attributes CRM_meta_clone="0" CRM_meta_clone_max="3" CRM_meta_clone_node_max="1" CRM_meta_container_attribute_target="host" CRM_meta_globally_unique="false" CRM_meta_master_max="3" CRM_meta_master_node_max="1" CRM_meta_notify="false" CRM_meta_on_node="galera-bundle-0" CRM_meta_on_node_uuid="galera-bundle-0" CRM_meta_op_target_rc="7" CRM_meta_physical_host="centos2" CRM_meta_timeout="30000" cluster_host_map="centos1:centos1;centos2:centos2;centos3:centos3"  enable_creation="true" wsrep_cluster_address="gcomm://centos1,centos2,centos3"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="1">
+    <action_set>
+      <rsc_op id="13" operation="monitor" operation_key="galera-bundle-docker-0_monitor_60000" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-0" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-0:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="2">
+    <action_set>
+      <rsc_op id="16" operation="monitor" operation_key="galera-bundle-0_monitor_60000" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" addr="centos2"  port="3123"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="3">
+    <action_set>
+      <rsc_op id="3" operation="monitor" operation_key="galera-bundle-docker-1_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-1" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-1" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-1:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="4">
+    <action_set>
+      <rsc_op id="8" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="5">
+    <action_set>
+      <rsc_op id="5" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="6">
+    <action_set>
+      <rsc_op id="1" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+</transition_graph>
diff --git a/pengine/test10/bundle-probe-order-2.scores b/pengine/test10/bundle-probe-order-2.scores
new file mode 100644
index 0000000..1d2c261
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-2.scores
@@ -0,0 +1,149 @@
+Allocation scores:
+Using the original execution date of: 2017-10-12 07:31:57Z
+clone_color: galera-bundle-master allocation score on centos1: -INFINITY
+clone_color: galera-bundle-master allocation score on centos2: -INFINITY
+clone_color: galera-bundle-master allocation score on centos3: -INFINITY
+clone_color: galera-bundle-master allocation score on galera-bundle-0: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-1: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-2: 0
+clone_color: galera:0 allocation score on centos1: -INFINITY
+clone_color: galera:0 allocation score on centos2: -INFINITY
+clone_color: galera:0 allocation score on centos3: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-0: INFINITY
+clone_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:1 allocation score on centos1: -INFINITY
+clone_color: galera:1 allocation score on centos2: -INFINITY
+clone_color: galera:1 allocation score on centos3: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-1: INFINITY
+clone_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:2 allocation score on centos1: -INFINITY
+clone_color: galera:2 allocation score on centos2: -INFINITY
+clone_color: galera:2 allocation score on centos3: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-2: INFINITY
+container_color: galera-bundle allocation score on centos1: -INFINITY
+container_color: galera-bundle allocation score on centos2: 0
+container_color: galera-bundle allocation score on centos3: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-0 allocation score on centos1: 0
+container_color: galera-bundle-0 allocation score on centos2: INFINITY
+container_color: galera-bundle-0 allocation score on centos3: 0
+container_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-1 allocation score on centos1: 0
+container_color: galera-bundle-1 allocation score on centos2: 0
+container_color: galera-bundle-1 allocation score on centos3: 0
+container_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-2 allocation score on centos1: 0
+container_color: galera-bundle-2 allocation score on centos2: 0
+container_color: galera-bundle-2 allocation score on centos3: 0
+container_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos2: INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos2: 0
+container_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos2: 0
+container_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-master allocation score on centos1: 0
+container_color: galera-bundle-master allocation score on centos2: 0
+container_color: galera-bundle-master allocation score on centos3: 0
+container_color: galera-bundle-master allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-2: -INFINITY
+container_color: galera:0 allocation score on centos1: 0
+container_color: galera:0 allocation score on centos2: 0
+container_color: galera:0 allocation score on centos3: 0
+container_color: galera:0 allocation score on galera-bundle-0: 500
+container_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:1 allocation score on centos1: 0
+container_color: galera:1 allocation score on centos2: 0
+container_color: galera:1 allocation score on centos3: 0
+container_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:1 allocation score on galera-bundle-1: 500
+container_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:2 allocation score on centos1: 0
+container_color: galera:2 allocation score on centos2: 0
+container_color: galera:2 allocation score on centos3: 0
+container_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-2: 500
+galera:0 promotion score on none: 0
+galera:1 promotion score on none: 0
+galera:2 promotion score on none: 0
+native_color: galera-bundle-0 allocation score on centos1: 0
+native_color: galera-bundle-0 allocation score on centos2: INFINITY
+native_color: galera-bundle-0 allocation score on centos3: 0
+native_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-1 allocation score on centos1: 0
+native_color: galera-bundle-1 allocation score on centos2: 0
+native_color: galera-bundle-1 allocation score on centos3: 0
+native_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-2 allocation score on centos1: 0
+native_color: galera-bundle-2 allocation score on centos2: 0
+native_color: galera-bundle-2 allocation score on centos3: 0
+native_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos2: INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos2: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos2: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:0 allocation score on centos1: -INFINITY
+native_color: galera:0 allocation score on centos2: -INFINITY
+native_color: galera:0 allocation score on centos3: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-0: INFINITY
+native_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:1 allocation score on centos1: -INFINITY
+native_color: galera:1 allocation score on centos2: -INFINITY
+native_color: galera:1 allocation score on centos3: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-1: INFINITY
+native_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:2 allocation score on centos1: -INFINITY
+native_color: galera:2 allocation score on centos2: -INFINITY
+native_color: galera:2 allocation score on centos3: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-2: INFINITY
diff --git a/pengine/test10/bundle-probe-order-2.summary b/pengine/test10/bundle-probe-order-2.summary
new file mode 100644
index 0000000..e094e26
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-2.summary
@@ -0,0 +1,32 @@
+Using the original execution date of: 2017-10-12 07:31:57Z
+
+Current cluster status:
+ContainerNode galera-bundle-0:galera-bundle-docker-0: maintenance
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped centos2 (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
+Transition Summary:
+
+Executing cluster transition:
+ * Resource action: galera:0        monitor on galera-bundle-0
+ * Resource action: galera-bundle-docker-0 monitor=60000 on centos2
+ * Resource action: galera-bundle-0 monitor=60000 on centos2
+ * Resource action: galera-bundle-docker-1 monitor on centos2
+ * Resource action: galera-bundle-docker-2 monitor on centos3
+ * Resource action: galera-bundle-docker-2 monitor on centos2
+ * Resource action: galera-bundle-docker-2 monitor on centos1
+Using the original execution date of: 2017-10-12 07:31:57Z
+
+Revised cluster status:
+ContainerNode galera-bundle-0:galera-bundle-docker-0: maintenance
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped centos2 (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
diff --git a/pengine/test10/bundle-probe-order-2.xml b/pengine/test10/bundle-probe-order-2.xml
new file mode 100644
index 0000000..e5a3959
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-2.xml
@@ -0,0 +1,127 @@
+<cib crm_feature_set="3.0.12" validate-with="pacemaker-2.8" epoch="295" num_updates="9" admin_epoch="0" cib-last-written="Thu Oct 12 09:31:55 2017" update-origin="centos1" update-client="crmd" update-user="hacluster" have-quorum="1" dc-uuid="1" execution-date="1507793517">
+  <configuration>
+    <crm_config>
+      <cluster_property_set id="cib-bootstrap-options">
+        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="false"/>
+        <nvpair id="cib-bootstrap-options-have-watchdog" name="have-watchdog" value="false"/>
+        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.16-12.bundle.3.el7.centos.4-94ff4df"/>
+        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="corosync"/>
+        <nvpair id="cib-bootstrap-options-cluster-name" name="cluster-name" value="ratester"/>
+        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1507793515"/>
+      </cluster_property_set>
+    </crm_config>
+    <nodes>
+      <node id="1" uname="centos1"/>
+      <node id="2" uname="centos2"/>
+      <node id="3" uname="centos3"/>
+    </nodes>
+    <resources>
+      <bundle id="galera-bundle">
+        <meta_attributes id="galera-bundle-meta_attributes">
+          <nvpair id="galera-bundle-meta_attributes-is-managed" name="is-managed" value="false"/>
+        </meta_attributes>
+        <docker masters="3" network="host" replicas="3" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" run-command="/usr/sbin/pacemaker_remoted" options="--user=root --log-driver=journald"/>
+        <network control-port="3123"/>
+        <storage>
+          <storage-mapping target-dir="/etc/libqb/force-filesystem-sockets" options="ro" id="map1" source-dir="/foo"/>
+          <storage-mapping target-dir="/etc/my.cnf.d/galera.cnf" options="ro" id="map2" source-dir="/etc/my.cnf.d/galera.cnf"/>
+          <storage-mapping target-dir="/var/lib/mysql" options="rw" id="map3" source-dir="/var/lib/mysql"/>
+        </storage>
+        <primitive class="ocf" id="galera" provider="heartbeat" type="galera">
+          <instance_attributes id="galera-instance_attributes">
+            <nvpair id="galera-instance_attributes-cluster_host_map" name="cluster_host_map" value="centos1:centos1;centos2:centos2;centos3:centos3"/>
+            <nvpair id="galera-instance_attributes-enable_creation" name="enable_creation" value="true"/>
+            <nvpair id="galera-instance_attributes-wsrep_cluster_address" name="wsrep_cluster_address" value="gcomm://centos1,centos2,centos3"/>
+          </instance_attributes>
+          <meta_attributes id="galera-meta_attributes">
+            <nvpair id="galera-meta_attributes-container-attribute-target" name="container-attribute-target" value="host"/>
+            <nvpair id="galera-meta_attributes-is-managed" name="is-managed" value="false"/>
+          </meta_attributes>
+          <operations>
+            <op id="galera-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="galera-monitor-interval-20" interval="20" name="monitor" timeout="30"/>
+            <op id="galera-monitor-interval-10" interval="10" name="monitor" role="Master" timeout="30"/>
+            <op id="galera-monitor-interval-30" interval="30" name="monitor" role="Slave" timeout="30"/>
+            <op id="galera-promote-interval-0s" interval="0s" name="promote" on-fail="block"/>
+            <op id="galera-start-interval-0s" interval="0s" name="start" timeout="120"/>
+            <op id="galera-stop-interval-0s" interval="0s" name="stop" timeout="120"/>
+          </operations>
+        </primitive>
+      </bundle>
+    </resources>
+    <constraints>
+      <rsc_location id="cli-ban-galera-bundle-on-centos1" rsc="galera-bundle" role="Started" node="centos1" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-bundle-on-centos3" rsc="galera-bundle" role="Started" node="centos3" score="-INFINITY"/>
+    </constraints>
+  </configuration>
+  <status>
+    <node_state id="3" uname="centos3" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="3">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-0" type="remote" class="ocf" provider="pacemaker" container="galera-bundle-docker-0">
+            <lrm_rsc_op id="galera-bundle-0_last_0" operation_key="galera-bundle-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="14:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;14:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos3" call-id="10" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="13:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;13:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos3" call-id="71" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="61" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-1" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-1_last_0" operation_key="galera-bundle-docker-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="15:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;15:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos3" call-id="75" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="69" queue-time="0" op-digest="5360882c871c1235885143790c91b5f0"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="3">
+        <instance_attributes id="status-3">
+          <nvpair id="status-3-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="1" uname="centos1" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="1">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-0" type="remote" class="ocf" provider="pacemaker" container="galera-bundle-docker-0">
+            <lrm_rsc_op id="galera-bundle-0_last_0" operation_key="galera-bundle-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="2:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;2:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="10" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0" op-digest="9f3901600fcaa04276113ecd13872e61" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="1:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;1:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="69" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="51" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-1" type="remote" class="ocf" provider="pacemaker" container="galera-bundle-docker-1">
+            <lrm_rsc_op id="galera-bundle-1_last_0" operation_key="galera-bundle-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="4:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;4:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="11" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0" op-digest="9f3901600fcaa04276113ecd13872e61" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-1" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-1_last_0" operation_key="galera-bundle-docker-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="3:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;3:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="73" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="91" queue-time="0" op-digest="5360882c871c1235885143790c91b5f0"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="1">
+        <instance_attributes id="status-1">
+          <nvpair id="status-1-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="2" uname="centos2" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="2">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-0" type="remote" class="ocf" provider="pacemaker" container="galera-bundle-docker-0">
+            <lrm_rsc_op id="galera-bundle-0_last_failure_0" operation_key="galera-bundle-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="8:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;8:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="19" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0"  op-digest="b453de0dc04a6db30bbf86d12fee7dca"/>
+            <lrm_rsc_op id="galera-bundle-0_last_0" operation_key="galera-bundle-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="8:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;8:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="19" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0" op-force-restart=" server " op-digest="b453de0dc04a6db30bbf86d12fee7dca"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_failure_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="80" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="135" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="80" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="135" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="2">
+        <instance_attributes id="status-2">
+          <nvpair id="status-2-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-2-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state remote_node="true" id="galera-bundle-0" uname="galera-bundle-0" in_ccm="true" crm-debug-origin="remote_ra_maintenance" node_fenced="0" node_in_maintenance="1">
+      <lrm id="galera-bundle-0">
+        <lrm_resources/>
+      </lrm>
+    </node_state>
+  </status>
+</cib>
diff --git a/pengine/test10/bundle-probe-order-3.dot b/pengine/test10/bundle-probe-order-3.dot
new file mode 100644
index 0000000..4dc54b5
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-3.dot
@@ -0,0 +1,10 @@
+digraph "g" {
+"galera-bundle-0_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-0_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-0_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-0_monitor_60000 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-1_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos1" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos2" [ style=bold color="green" fontcolor="black"]
+"galera-bundle-docker-2_monitor_0 centos3" [ style=bold color="green" fontcolor="black"]
+}
diff --git a/pengine/test10/bundle-probe-order-3.exp b/pengine/test10/bundle-probe-order-3.exp
new file mode 100644
index 0000000..5546bc9
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-3.exp
@@ -0,0 +1,74 @@
+<transition_graph cluster-delay="60s" stonith-timeout="60s" failed-stop-offset="INFINITY" failed-start-offset="INFINITY"  transition_id="0">
+  <synapse id="0">
+    <action_set>
+      <rsc_op id="16" operation="monitor" operation_key="galera-bundle-docker-0_monitor_60000" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-0" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_interval="60000" CRM_meta_name="monitor" CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-0" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-0:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="1">
+    <action_set>
+      <rsc_op id="9" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="centos2"  port="3123"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="2">
+    <action_set>
+      <rsc_op id="4" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="centos2"  port="3123"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="3">
+    <action_set>
+      <rsc_op id="1" operation="monitor" operation_key="galera-bundle-0_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-0" class="ocf" provider="pacemaker" type="remote"/>
+        <attributes CRM_meta_container="galera-bundle-docker-0" CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" addr="centos2"  port="3123"/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="4">
+    <action_set>
+      <rsc_op id="5" operation="monitor" operation_key="galera-bundle-docker-1_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-1" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-1" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-1:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="5">
+    <action_set>
+      <rsc_op id="11" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos3" on_node_uuid="3">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos3" CRM_meta_on_node_uuid="3" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="6">
+    <action_set>
+      <rsc_op id="7" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos2" on_node_uuid="2">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos2" CRM_meta_on_node_uuid="2" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+  <synapse id="7">
+    <action_set>
+      <rsc_op id="2" operation="monitor" operation_key="galera-bundle-docker-2_monitor_0" on_node="centos1" on_node_uuid="1">
+        <primitive id="galera-bundle-docker-2" class="ocf" provider="heartbeat" type="docker"/>
+        <attributes CRM_meta_on_node="centos1" CRM_meta_on_node_uuid="1" CRM_meta_op_target_rc="7" CRM_meta_timeout="20000" allow_pull="true"  force_kill="false" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" monitor_cmd="/bin/true" mount_points="/var/log/pacemaker/bundles/galera-bundle-2" reuse="false" run_cmd="/usr/sbin/pacemaker_remoted" run_opts=" --restart=no --net=host -e PCMK_remote_port=3123 -v /foo:/etc/libqb/force-filesystem-sockets:ro -v /etc/my.cnf.d/galera.cnf:/etc/my.cnf.d/galera.cnf:ro -v /var/lib/mysql:/var/lib/mysql:rw -v /etc/pacemaker/authkey:/etc/pacemaker/authkey -v /var/log/pacemaker/bundles/galera-bundle-2:/var/log -p 3123:3123 --user=root --log-driver=journald "/>
+      </rsc_op>
+    </action_set>
+    <inputs/>
+  </synapse>
+</transition_graph>
diff --git a/pengine/test10/bundle-probe-order-3.scores b/pengine/test10/bundle-probe-order-3.scores
new file mode 100644
index 0000000..d3338e4
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-3.scores
@@ -0,0 +1,149 @@
+Allocation scores:
+Using the original execution date of: 2017-10-12 07:31:57Z
+clone_color: galera-bundle-master allocation score on centos1: -INFINITY
+clone_color: galera-bundle-master allocation score on centos2: -INFINITY
+clone_color: galera-bundle-master allocation score on centos3: -INFINITY
+clone_color: galera-bundle-master allocation score on galera-bundle-0: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-1: 0
+clone_color: galera-bundle-master allocation score on galera-bundle-2: 0
+clone_color: galera:0 allocation score on centos1: -INFINITY
+clone_color: galera:0 allocation score on centos2: -INFINITY
+clone_color: galera:0 allocation score on centos3: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-0: INFINITY
+clone_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:1 allocation score on centos1: -INFINITY
+clone_color: galera:1 allocation score on centos2: -INFINITY
+clone_color: galera:1 allocation score on centos3: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:1 allocation score on galera-bundle-1: INFINITY
+clone_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+clone_color: galera:2 allocation score on centos1: -INFINITY
+clone_color: galera:2 allocation score on centos2: -INFINITY
+clone_color: galera:2 allocation score on centos3: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+clone_color: galera:2 allocation score on galera-bundle-2: INFINITY
+container_color: galera-bundle allocation score on centos1: -INFINITY
+container_color: galera-bundle allocation score on centos2: 0
+container_color: galera-bundle allocation score on centos3: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-0 allocation score on centos1: 0
+container_color: galera-bundle-0 allocation score on centos2: 0
+container_color: galera-bundle-0 allocation score on centos3: 0
+container_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-1 allocation score on centos1: 0
+container_color: galera-bundle-1 allocation score on centos2: 0
+container_color: galera-bundle-1 allocation score on centos3: 0
+container_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-2 allocation score on centos1: 0
+container_color: galera-bundle-2 allocation score on centos2: 0
+container_color: galera-bundle-2 allocation score on centos3: 0
+container_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos2: INFINITY
+container_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on centos2: 0
+container_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on centos2: 0
+container_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+container_color: galera-bundle-master allocation score on centos1: 0
+container_color: galera-bundle-master allocation score on centos2: 0
+container_color: galera-bundle-master allocation score on centos3: 0
+container_color: galera-bundle-master allocation score on galera-bundle-0: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-1: -INFINITY
+container_color: galera-bundle-master allocation score on galera-bundle-2: -INFINITY
+container_color: galera:0 allocation score on centos1: 0
+container_color: galera:0 allocation score on centos2: 0
+container_color: galera:0 allocation score on centos3: 0
+container_color: galera:0 allocation score on galera-bundle-0: 500
+container_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:1 allocation score on centos1: 0
+container_color: galera:1 allocation score on centos2: 0
+container_color: galera:1 allocation score on centos3: 0
+container_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:1 allocation score on galera-bundle-1: 500
+container_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+container_color: galera:2 allocation score on centos1: 0
+container_color: galera:2 allocation score on centos2: 0
+container_color: galera:2 allocation score on centos3: 0
+container_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+container_color: galera:2 allocation score on galera-bundle-2: 500
+galera:0 promotion score on none: 0
+galera:1 promotion score on none: 0
+galera:2 promotion score on none: 0
+native_color: galera-bundle-0 allocation score on centos1: 0
+native_color: galera-bundle-0 allocation score on centos2: 0
+native_color: galera-bundle-0 allocation score on centos3: 0
+native_color: galera-bundle-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-1 allocation score on centos1: 0
+native_color: galera-bundle-1 allocation score on centos2: 0
+native_color: galera-bundle-1 allocation score on centos3: 0
+native_color: galera-bundle-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-2 allocation score on centos1: 0
+native_color: galera-bundle-2 allocation score on centos2: 0
+native_color: galera-bundle-2 allocation score on centos3: 0
+native_color: galera-bundle-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos2: INFINITY
+native_color: galera-bundle-docker-0 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos2: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos2: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on centos3: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera-bundle-docker-2 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:0 allocation score on centos1: -INFINITY
+native_color: galera:0 allocation score on centos2: -INFINITY
+native_color: galera:0 allocation score on centos3: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-0: INFINITY
+native_color: galera:0 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:0 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:1 allocation score on centos1: -INFINITY
+native_color: galera:1 allocation score on centos2: -INFINITY
+native_color: galera:1 allocation score on centos3: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:1 allocation score on galera-bundle-1: INFINITY
+native_color: galera:1 allocation score on galera-bundle-2: -INFINITY
+native_color: galera:2 allocation score on centos1: -INFINITY
+native_color: galera:2 allocation score on centos2: -INFINITY
+native_color: galera:2 allocation score on centos3: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-0: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-1: -INFINITY
+native_color: galera:2 allocation score on galera-bundle-2: INFINITY
diff --git a/pengine/test10/bundle-probe-order-3.summary b/pengine/test10/bundle-probe-order-3.summary
new file mode 100644
index 0000000..4faaa6d
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-3.summary
@@ -0,0 +1,31 @@
+Using the original execution date of: 2017-10-12 07:31:57Z
+
+Current cluster status:
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped centos2 (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
+Transition Summary:
+
+Executing cluster transition:
+ * Resource action: galera-bundle-docker-0 monitor=60000 on centos2
+ * Resource action: galera-bundle-0 monitor on centos3
+ * Resource action: galera-bundle-0 monitor on centos2
+ * Resource action: galera-bundle-0 monitor on centos1
+ * Resource action: galera-bundle-docker-1 monitor on centos2
+ * Resource action: galera-bundle-docker-2 monitor on centos3
+ * Resource action: galera-bundle-docker-2 monitor on centos2
+ * Resource action: galera-bundle-docker-2 monitor on centos1
+Using the original execution date of: 2017-10-12 07:31:57Z
+
+Revised cluster status:
+Online: [ centos1 centos2 centos3 ]
+
+ Docker container set: galera-bundle [docker.io/tripleoupstream/centos-binary-mariadb:latest] (unmanaged)
+   galera-bundle-0	(ocf::heartbeat:galera):	Stopped centos2 (unmanaged)
+   galera-bundle-1	(ocf::heartbeat:galera):	Stopped (unmanaged)
+   galera-bundle-2	(ocf::heartbeat:galera):	Stopped (unmanaged)
+
diff --git a/pengine/test10/bundle-probe-order-3.xml b/pengine/test10/bundle-probe-order-3.xml
new file mode 100644
index 0000000..c33543e
--- /dev/null
+++ b/pengine/test10/bundle-probe-order-3.xml
@@ -0,0 +1,117 @@
+<cib crm_feature_set="3.0.12" validate-with="pacemaker-2.8" epoch="295" num_updates="9" admin_epoch="0" cib-last-written="Thu Oct 12 09:31:55 2017" update-origin="centos1" update-client="crmd" update-user="hacluster" have-quorum="1" dc-uuid="1" execution-date="1507793517">
+  <configuration>
+    <crm_config>
+      <cluster_property_set id="cib-bootstrap-options">
+        <nvpair id="cib-bootstrap-options-stonith-enabled" name="stonith-enabled" value="false"/>
+        <nvpair id="cib-bootstrap-options-have-watchdog" name="have-watchdog" value="false"/>
+        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.16-12.bundle.3.el7.centos.4-94ff4df"/>
+        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="corosync"/>
+        <nvpair id="cib-bootstrap-options-cluster-name" name="cluster-name" value="ratester"/>
+        <nvpair id="cib-bootstrap-options-last-lrm-refresh" name="last-lrm-refresh" value="1507793515"/>
+      </cluster_property_set>
+    </crm_config>
+    <nodes>
+      <node id="1" uname="centos1"/>
+      <node id="2" uname="centos2"/>
+      <node id="3" uname="centos3"/>
+    </nodes>
+    <resources>
+      <bundle id="galera-bundle">
+        <meta_attributes id="galera-bundle-meta_attributes">
+          <nvpair id="galera-bundle-meta_attributes-is-managed" name="is-managed" value="false"/>
+        </meta_attributes>
+        <docker masters="3" network="host" replicas="3" image="docker.io/tripleoupstream/centos-binary-mariadb:latest" run-command="/usr/sbin/pacemaker_remoted" options="--user=root --log-driver=journald"/>
+        <network control-port="3123"/>
+        <storage>
+          <storage-mapping target-dir="/etc/libqb/force-filesystem-sockets" options="ro" id="map1" source-dir="/foo"/>
+          <storage-mapping target-dir="/etc/my.cnf.d/galera.cnf" options="ro" id="map2" source-dir="/etc/my.cnf.d/galera.cnf"/>
+          <storage-mapping target-dir="/var/lib/mysql" options="rw" id="map3" source-dir="/var/lib/mysql"/>
+        </storage>
+        <primitive class="ocf" id="galera" provider="heartbeat" type="galera">
+          <instance_attributes id="galera-instance_attributes">
+            <nvpair id="galera-instance_attributes-cluster_host_map" name="cluster_host_map" value="centos1:centos1;centos2:centos2;centos3:centos3"/>
+            <nvpair id="galera-instance_attributes-enable_creation" name="enable_creation" value="true"/>
+            <nvpair id="galera-instance_attributes-wsrep_cluster_address" name="wsrep_cluster_address" value="gcomm://centos1,centos2,centos3"/>
+          </instance_attributes>
+          <meta_attributes id="galera-meta_attributes">
+            <nvpair id="galera-meta_attributes-container-attribute-target" name="container-attribute-target" value="host"/>
+            <nvpair id="galera-meta_attributes-is-managed" name="is-managed" value="false"/>
+          </meta_attributes>
+          <operations>
+            <op id="galera-demote-interval-0s" interval="0s" name="demote" timeout="120"/>
+            <op id="galera-monitor-interval-20" interval="20" name="monitor" timeout="30"/>
+            <op id="galera-monitor-interval-10" interval="10" name="monitor" role="Master" timeout="30"/>
+            <op id="galera-monitor-interval-30" interval="30" name="monitor" role="Slave" timeout="30"/>
+            <op id="galera-promote-interval-0s" interval="0s" name="promote" on-fail="block"/>
+            <op id="galera-start-interval-0s" interval="0s" name="start" timeout="120"/>
+            <op id="galera-stop-interval-0s" interval="0s" name="stop" timeout="120"/>
+          </operations>
+        </primitive>
+      </bundle>
+    </resources>
+    <constraints>
+      <rsc_location id="cli-ban-galera-bundle-on-centos1" rsc="galera-bundle" role="Started" node="centos1" score="-INFINITY"/>
+      <rsc_location id="cli-ban-galera-bundle-on-centos3" rsc="galera-bundle" role="Started" node="centos3" score="-INFINITY"/>
+    </constraints>
+  </configuration>
+  <status>
+    <node_state id="3" uname="centos3" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="3">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="13:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;13:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos3" call-id="71" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="61" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-1" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-1_last_0" operation_key="galera-bundle-docker-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="15:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;15:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos3" call-id="75" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="69" queue-time="0" op-digest="5360882c871c1235885143790c91b5f0"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="3">
+        <instance_attributes id="status-3">
+          <nvpair id="status-3-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="1" uname="centos1" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="1">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="1:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;1:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="69" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="51" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-1" type="remote" class="ocf" provider="pacemaker" container="galera-bundle-docker-1">
+            <lrm_rsc_op id="galera-bundle-1_last_0" operation_key="galera-bundle-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="4:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;4:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="11" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="0" queue-time="0" op-digest="9f3901600fcaa04276113ecd13872e61" op-force-restart=" server " op-restart-digest="f2317cad3d54cec5d7d7aa7d0bf35cf8"/>
+          </lrm_resource>
+          <lrm_resource id="galera-bundle-docker-1" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-1_last_0" operation_key="galera-bundle-docker-1_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="3:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:7;3:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos1" call-id="73" rc-code="7" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="91" queue-time="0" op-digest="5360882c871c1235885143790c91b5f0"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="1">
+        <instance_attributes id="status-1">
+          <nvpair id="status-1-shutdown" name="shutdown" value="0"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state id="2" uname="centos2" in_ccm="true" crmd="online" crm-debug-origin="do_update_resource" join="member" expected="member">
+      <lrm id="2">
+        <lrm_resources>
+          <lrm_resource id="galera-bundle-docker-0" type="docker" class="ocf" provider="heartbeat">
+            <lrm_rsc_op id="galera-bundle-docker-0_last_failure_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="80" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="135" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+            <lrm_rsc_op id="galera-bundle-docker-0_last_0" operation_key="galera-bundle-docker-0_monitor_0" operation="monitor" crm-debug-origin="do_update_resource" crm_feature_set="3.0.12" transition-key="7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" transition-magic="0:0;7:83:7:43285c5e-b25f-4c08-8e26-b680d050db82" on_node="centos2" call-id="80" rc-code="0" op-status="0" interval="0" last-run="1507793516" last-rc-change="1507793516" exec-time="135" queue-time="0" op-digest="22ac554c0c3ba5fdd85d5f4134db6003"/>
+          </lrm_resource>
+        </lrm_resources>
+      </lrm>
+      <transient_attributes id="2">
+        <instance_attributes id="status-2">
+          <nvpair id="status-2-shutdown" name="shutdown" value="0"/>
+          <nvpair id="status-2-master-galera" name="master-galera" value="100"/>
+        </instance_attributes>
+      </transient_attributes>
+    </node_state>
+    <node_state remote_node="true" id="galera-bundle-0" uname="galera-bundle-0" in_ccm="true" crm-debug-origin="remote_ra_maintenance" node_fenced="0" node_in_maintenance="1">
+      <lrm id="galera-bundle-0">
+        <lrm_resources/>
+      </lrm>
+    </node_state>
+  </status>
+</cib>
-- 
1.8.3.1

