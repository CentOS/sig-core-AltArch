commit 4f41c682f3f0a0ad69eeac38a6b270f4362c3a02
Author: Siddhesh Poyarekar <siddhesh@redhat.com>
Date:   Mon Nov 24 15:03:45 2014 +0530

    Remove NOT_IN_libc
    
    Replace with !IS_IN (libc).  This completes the transition from
    the IS_IN/NOT_IN macros to the IN_MODULE macro set.
    
    The generated code is unchanged on x86_64.
    
    	* stdlib/isomac.c (fmt): Replace NOT_IN_libc with IN_MODULE.
    	(get_null_defines): Adjust.
    	* sunrpc/Makefile: Adjust comment.
    	* Makerules (CPPFLAGS-nonlib): Remove NOT_IN_libc.
    	* elf/Makefile (CPPFLAGS-sotruss-lib): Likewise.
    	(CFLAGS-interp.c): Likewise.
    	(CFLAGS-ldconfig.c): Likewise.
    	(CPPFLAGS-.os): Likewise.
    	* elf/rtld-Rules (rtld-CPPFLAGS): Likewise.
    	* extra-lib.mk (CPPFLAGS-$(lib)): Likewise.
    	* extra-modules.mk (extra-modules.mk): Likewise.
    	* iconv/Makefile (CPPFLAGS-iconvprogs): Likewise.
    	* locale/Makefile (CPPFLAGS-locale_programs): Likewise.
    	* malloc/Makefile (CPPFLAGS-memusagestat): Likewise.
    	* nscd/Makefile (CPPFLAGS-nscd): Likewise.
    	* nss/Makefile (CPPFLAGS-nss_test1): Likewise.
    	* stdlib/Makefile (CFLAGS-tst-putenvmod.c): Likewise.
    	* sysdeps/gnu/Makefile ($(objpfx)errlist-compat.c): Likewise.
    	* sysdeps/unix/sysv/linux/Makefile (CPPFLAGS-lddlibc4): Likewise.
    	* iconvdata/Makefile (CPPFLAGS): Likewise.
    	(cpp-srcs-left): Add libof for all iconvdata routines.
    	* bits/stdio-lock.h: Replace NOT_IN_libc with IS_IN.
    	* include/assert.h: Likewise.
    	* include/ctype.h: Likewise.
    	* include/errno.h: Likewise.
    	* include/libc-symbols.h: Likewise.
    	* include/math.h: Likewise.
    	* include/netdb.h: Likewise.
    	* include/resolv.h: Likewise.
    	* include/stdio.h: Likewise.
    	* include/stdlib.h: Likewise.
    	* include/string.h: Likewise.
    	* include/sys/stat.h: Likewise.
    	* include/wctype.h: Likewise.
    	* intl/l10nflist.c: Likewise.
    	* libidn/idn-stub.c: Likewise.
    	* libio/libioP.h: Likewise.
    	* nptl/libc_multiple_threads.c: Likewise.
    	* nptl/pthreadP.h: Likewise.
    	* posix/regex_internal.h: Likewise.
    	* resolv/res_hconf.c: Likewise.
    	* sysdeps/arm/armv7/multiarch/memcpy.S: Likewise.
    	* sysdeps/arm/memmove.S: Likewise.
    	* sysdeps/arm/sysdep.h: Likewise.
    	* sysdeps/generic/_itoa.h: Likewise.
    	* sysdeps/generic/symbol-hacks.h: Likewise.
    	* sysdeps/gnu/errlist.awk: Likewise.
    	* sysdeps/gnu/errlist.c: Likewise.
    	* sysdeps/i386/i586/memcpy.S: Likewise.
    	* sysdeps/i386/i586/memset.S: Likewise.
    	* sysdeps/i386/i686/memcpy.S: Likewise.
    	* sysdeps/i386/i686/memmove.S: Likewise.
    	* sysdeps/i386/i686/mempcpy.S: Likewise.
    	* sysdeps/i386/i686/memset.S: Likewise.
    	* sysdeps/i386/i686/multiarch/bcopy.S: Likewise.
    	* sysdeps/i386/i686/multiarch/bzero.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memchr-sse2-bsf.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memchr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcmp-sse4.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcmp-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcmp.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcpy-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcpy.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memcpy_chk.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memmove.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memmove_chk.S: Likewise.
    	* sysdeps/i386/i686/multiarch/mempcpy.S: Likewise.
    	* sysdeps/i386/i686/multiarch/mempcpy_chk.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memrchr-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/memrchr-sse2-bsf.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memrchr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memrchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memset-sse2-rep.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memset-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memset.S: Likewise.
    	* sysdeps/i386/i686/multiarch/memset_chk.S: Likewise.
    	* sysdeps/i386/i686/multiarch/rawmemchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcat-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcat-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcat.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strchr-sse2-bsf.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strchr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcmp-sse4.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcmp-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcmp.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcpy-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcpy-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcpy.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strcspn.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strlen-sse2-bsf.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strlen-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strlen.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strnlen.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strrchr-sse2-bsf.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strrchr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strrchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/strspn.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcschr-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/wcschr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcschr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcscmp-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcscmp.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcscpy-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/wcscpy-ssse3.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcscpy.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcslen-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/wcslen-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcslen.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcsrchr-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/wcsrchr-sse2.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wcsrchr.S: Likewise.
    	* sysdeps/i386/i686/multiarch/wmemcmp-c.c: Likewise.
    	* sysdeps/i386/i686/multiarch/wmemcmp.S: Likewise.
    	* sysdeps/ia64/fpu/libm-symbols.h: Likewise.
    	* sysdeps/nptl/bits/libc-lock.h: Likewise.
    	* sysdeps/nptl/bits/libc-lockP.h: Likewise.
    	* sysdeps/nptl/bits/stdio-lock.h: Likewise.
    	* sysdeps/posix/closedir.c: Likewise.
    	* sysdeps/posix/opendir.c: Likewise.
    	* sysdeps/posix/readdir.c: Likewise.
    	* sysdeps/posix/rewinddir.c: Likewise.
    	* sysdeps/powerpc/novmx-sigjmp.c: Likewise.
    	* sysdeps/powerpc/powerpc32/__longjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc32/bsd-_setjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc32/fpu/__longjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc32/fpu/setjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/bzero.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memchr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memcmp-ppc32.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memcmp.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memcpy-ppc32.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memmove.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/mempcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memrchr-ppc32.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memrchr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memset-ppc32.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/memset.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/rawmemchr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strcasecmp.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strcasecmp_l.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strchr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strchrnul.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strlen-ppc32.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strlen.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strncase.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strncase_l.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strncmp-ppc32.S: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strncmp.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/strnlen.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcschr-ppc32.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcschr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcscpy-ppc32.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcscpy.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcsrchr-ppc32.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wcsrchr.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power4/multiarch/wordcopy.c: Likewise.
    	* sysdeps/powerpc/powerpc32/power6/memset.S: Likewise.
    	* sysdeps/powerpc/powerpc32/setjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc64/__longjmp.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/bzero.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memcmp-ppc64.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memcmp.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memcpy-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memmove-ppc64.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memmove.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/mempcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memrchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memset-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/memset.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/rawmemchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/stpcpy-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/stpcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/stpncpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcasecmp.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcasecmp_l.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcat.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strchrnul.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcmp-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcmp.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcpy-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strcspn.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strlen-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strlen.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncase.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncase_l.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncat.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncmp-ppc64.S: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncmp.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncpy-ppc64.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strncpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strnlen.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strpbrk.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strrchr-ppc64.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strrchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strspn-ppc64.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/strspn.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/wcschr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/wcscpy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/wcsrchr.c: Likewise.
    	* sysdeps/powerpc/powerpc64/multiarch/wordcopy.c: Likewise.
    	* sysdeps/powerpc/powerpc64/setjmp.S: Likewise.
    	* sysdeps/s390/s390-32/multiarch/ifunc-resolve.c: Likewise.
    	* sysdeps/s390/s390-32/multiarch/memcmp.S: Likewise.
    	* sysdeps/s390/s390-32/multiarch/memcpy.S: Likewise.
    	* sysdeps/s390/s390-32/multiarch/memset.S: Likewise.
    	* sysdeps/s390/s390-64/multiarch/ifunc-resolve.c: Likewise.
    	* sysdeps/s390/s390-64/multiarch/memcmp.S: Likewise.
    	* sysdeps/s390/s390-64/multiarch/memcpy.S: Likewise.
    	* sysdeps/s390/s390-64/multiarch/memset.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memcpy-niagara1.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memcpy-niagara2.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memcpy-niagara4.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memcpy-ultra3.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memcpy.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memset-niagara1.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memset-niagara4.S: Likewise.
    	* sysdeps/sparc/sparc64/multiarch/memset.S: Likewise.
    	* sysdeps/unix/alpha/sysdep.S: Likewise.
    	* sysdeps/unix/alpha/sysdep.h: Likewise.
    	* sysdeps/unix/make-syscalls.sh: Likewise.
    	* sysdeps/unix/sysv/linux/aarch64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/aarch64/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/alpha/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/alpha/vfork.S: Likewise.
    	* sysdeps/unix/sysv/linux/arm/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/arm/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/getpid.c: Likewise.
    	* sysdeps/unix/sysv/linux/hppa/nptl/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/hppa/nptl/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/i386/i486/lowlevellock.S: Likewise.
    	* sysdeps/unix/sysv/linux/i386/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/i386/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/i386/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/ia64/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/ia64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/ia64/sysdep.S: Likewise.
    	* sysdeps/unix/sysv/linux/ia64/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/lowlevellock-futex.h: Likewise.
    	* sysdeps/unix/sysv/linux/m68k/bits/m68k-vdso.h: Likewise.
    	* sysdeps/unix/sysv/linux/m68k/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/m68k/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/microblaze/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/microblaze/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/mips/mips64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/mips/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/not-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/powerpc/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/longjmp_chk.c: Likewise.
    	* sysdeps/unix/sysv/linux/s390/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep.S: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-32/vfork.S: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.S: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/s390/s390-64/vfork.S: Likewise.
    	* sysdeps/unix/sysv/linux/sh/lowlevellock.S: Likewise.
    	* sysdeps/unix/sysv/linux/sh/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/sh/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/sh/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/sh/vfork.S: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/sparc32/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/sparc64/brk.S: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/tile/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/tile/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/tile/sysdep.h: Likewise.
    	* sysdeps/unix/sysv/linux/tile/waitpid.S: Likewise.
    	* sysdeps/unix/sysv/linux/x86_64/lowlevellock.S: Likewise.
    	* sysdeps/unix/sysv/linux/x86_64/lowlevellock.h: Likewise.
    	* sysdeps/unix/sysv/linux/x86_64/sysdep-cancel.h: Likewise.
    	* sysdeps/unix/sysv/linux/x86_64/sysdep.h: Likewise.
    	* sysdeps/wordsize-32/symbol-hacks.h: Likewise.
    	* sysdeps/x86_64/memcpy.S: Likewise.
    	* sysdeps/x86_64/memmove.c: Likewise.
    	* sysdeps/x86_64/memset.S: Likewise.
    	* sysdeps/x86_64/multiarch/init-arch.h: Likewise.
    	* sysdeps/x86_64/multiarch/memcmp-sse4.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcmp-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcmp.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcpy-avx-unaligned.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcpy-ssse3-back.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcpy-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcpy.S: Likewise.
    	* sysdeps/x86_64/multiarch/memcpy_chk.S: Likewise.
    	* sysdeps/x86_64/multiarch/memmove.c: Likewise.
    	* sysdeps/x86_64/multiarch/mempcpy.S: Likewise.
    	* sysdeps/x86_64/multiarch/mempcpy_chk.S: Likewise.
    	* sysdeps/x86_64/multiarch/memset-avx2.S: Likewise.
    	* sysdeps/x86_64/multiarch/memset.S: Likewise.
    	* sysdeps/x86_64/multiarch/memset_chk.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcat-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcat.S: Likewise.
    	* sysdeps/x86_64/multiarch/strchr-sse2-no-bsf.S: Likewise.
    	* sysdeps/x86_64/multiarch/strchr.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcmp-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcmp.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcpy-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcpy.S: Likewise.
    	* sysdeps/x86_64/multiarch/strcspn.S: Likewise.
    	* sysdeps/x86_64/multiarch/strspn.S: Likewise.
    	* sysdeps/x86_64/multiarch/wcscpy-c.c: Likewise.
    	* sysdeps/x86_64/multiarch/wcscpy-ssse3.S: Likewise.
    	* sysdeps/x86_64/multiarch/wcscpy.S: Likewise.
    	* sysdeps/x86_64/multiarch/wmemcmp-c.c: Likewise.
    	* sysdeps/x86_64/multiarch/wmemcmp.S: Likewise.
    	* sysdeps/x86_64/strcmp.S: Likewise.

Index: glibc-2.17-c758a686/bits/stdio-lock.h
===================================================================
--- glibc-2.17-c758a686.orig/bits/stdio-lock.h
+++ glibc-2.17-c758a686/bits/stdio-lock.h
@@ -44,7 +44,7 @@ __libc_lock_define_recursive (typedef, _
 #define _IO_cleanup_region_end(_doit) \
   __libc_cleanup_region_end (_doit)
 
-#if defined _LIBC && !defined NOT_IN_libc
+#if defined _LIBC && IS_IN (libc)
 # define _IO_acquire_lock(_fp) \
   _IO_cleanup_region_start ((void (*) (void *)) _IO_funlockfile, (_fp));      \
   _IO_flockfile (_fp)
Index: glibc-2.17-c758a686/elf/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/elf/Makefile
+++ glibc-2.17-c758a686/elf/Makefile
@@ -99,7 +99,6 @@ install-others += $(inst_auditdir)/sotru
 install-bin-script += sotruss
 generated += sotruss
 libof-sotruss-lib = extramodules
-CPPFLAGS-sotruss-lib = -DNOT_IN_libc
 $(objpfx)sotruss-lib.so: $(objpfx)sotruss-lib.os
 	$(build-module-asneeded)
 $(objpfx)sotruss-lib.so: $(common-objpfx)libc.so $(objpfx)ld.so \
@@ -437,15 +436,12 @@ $(objpfx)pldd: $(pldd-modules:%=$(objpfx
 
 SYSCONF-FLAGS := -D'SYSCONFDIR="$(sysconfdir)"'
 CFLAGS-ldconfig.c = $(SYSCONF-FLAGS) -D'LIBDIR="$(libdir)"' \
-		    -D'SLIBDIR="$(slibdir)"' -DNOT_IN_libc
+		    -D'SLIBDIR="$(slibdir)"'
 libof-ldconfig = ldconfig
 CFLAGS-dl-cache.c = $(SYSCONF-FLAGS)
 CFLAGS-cache.c = $(SYSCONF-FLAGS)
 CFLAGS-rtld.c = $(SYSCONF-FLAGS)
 
-CPPFLAGS-.os += $(if $(filter $(@F),$(patsubst %,%.os,$(all-rtld-routines))),\
-		     -DNOT_IN_libc=1)
-
 # Disable any optimization which might result in function calls during early
 # dynamic loader startup. We disable -ftree-loop-distribute-patterns which
 # might convert code into calls to functions like memcpy or memset when the PLT
Index: glibc-2.17-c758a686/elf/rtld-Rules
===================================================================
--- glibc-2.17-c758a686.orig/elf/rtld-Rules
+++ glibc-2.17-c758a686/elf/rtld-Rules
@@ -128,12 +128,10 @@ ifdef rtld-depfiles
 -include $(rtld-depfiles)
 endif
 
+# This here is the whole point of all the shenanigans.
 # Set libof-* for each routine.
 cpp-srcs-left := $(rtld-modules:%.os=%)
 lib := rtld
 include $(patsubst %,$(..)cppflags-iterator.mk,$(cpp-srcs-left))
 
-# This here is the whole point of all the shenanigans.
-rtld-CPPFLAGS := -DNOT_IN_libc=1
-
 endif
Index: glibc-2.17-c758a686/extra-lib.mk
===================================================================
--- glibc-2.17-c758a686.orig/extra-lib.mk
+++ glibc-2.17-c758a686/extra-lib.mk
@@ -100,5 +100,3 @@ cpp-srcs-left := $($(lib)-routines) $($(
 ifneq (,$(cpp-srcs-left))
 include $(patsubst %,$(..)cppflags-iterator.mk,$(cpp-srcs-left))
 endif
-
-CPPFLAGS-$(lib) := -DNOT_IN_libc=1
Index: glibc-2.17-c758a686/extra-modules.mk
===================================================================
--- glibc-2.17-c758a686.orig/extra-modules.mk
+++ glibc-2.17-c758a686/extra-modules.mk
@@ -7,4 +7,3 @@ module := $(firstword $(extra-modules-le
 extra-modules-left := $(filter-out $(module),$(extra-modules-left))
 
 libof-$(notdir $(module)) := extramodules
-CPPFLAGS-$(module).c += -DNOT_IN_libc
Index: glibc-2.17-c758a686/iconv/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/iconv/Makefile
+++ glibc-2.17-c758a686/iconv/Makefile
@@ -53,8 +53,6 @@ CFLAGS-gconv_cache.c += -DGCONV_DIR='"$(
 CFLAGS-gconv_conf.c = -DGCONV_PATH='"$(gconvdir)"'
 CFLAGS-iconvconfig.c = -DGCONV_PATH='"$(gconvdir)"' -DGCONV_DIR='"$(gconvdir)"'
 
-CPPFLAGS-iconvprogs = -DNOT_IN_libc
-
 # Set libof-* for each routine.
 cpp-srcs-left := $(iconv_prog-modules) $(iconvconfig-modules)
 lib := iconvprogs
Index: glibc-2.17-c758a686/iconvdata/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/iconvdata/Makefile
+++ glibc-2.17-c758a686/iconvdata/Makefile
@@ -76,9 +76,6 @@ endif
 test-srcs := tst-table-from tst-table-to
 endif
 
-# No code here is in libc.so.
-CPPFLAGS += -DNOT_IN_libc
-
 libJIS-routines := jis0201 jis0208 jis0212
 libKSC-routines := ksc5601
 libGB-routines := gb2312
@@ -267,7 +264,9 @@ endif # build-shared = yes
 include ../Rules
 
 # Set libof-* for each routine.
-cpp-srcs-left := $(modules) $(generated-modules)
+cpp-srcs-left := $(modules) $(generated-modules) $(libJIS-routines) \
+		 $(libKSC-routines) $(libGB-routines) $(libCNS-routines) \
+		 $(libISOIR165-routines) $(libJISX0213-routines)
 lib := iconvdata
 include $(patsubst %,$(..)cppflags-iterator.mk,$(cpp-srcs-left))
 
Index: glibc-2.17-c758a686/include/assert.h
===================================================================
--- glibc-2.17-c758a686.orig/include/assert.h
+++ glibc-2.17-c758a686/include/assert.h
@@ -20,7 +20,7 @@ extern void __assert_fail_base (const ch
 				const char *function)
      __THROW  __attribute__ ((__noreturn__));
 
-# if !defined NOT_IN_libc || IS_IN (rtld)
+# if IS_IN (libc) || IS_IN (rtld)
 hidden_proto (__assert_fail)
 hidden_proto (__assert_perror_fail)
 # endif
Index: glibc-2.17-c758a686/include/errno.h
===================================================================
--- glibc-2.17-c758a686.orig/include/errno.h
+++ glibc-2.17-c758a686/include/errno.h
@@ -17,19 +17,19 @@
 #  define errno rtld_errno
 extern int rtld_errno attribute_hidden;
 
-# elif !defined NOT_IN_libc || IS_IN_LIB
+# elif IS_IN_LIB
 
 #  include <tls.h>
 
 #  undef  errno
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define errno __libc_errno
 #  else
 #   define errno errno		/* For #ifndef errno tests.  */
 #  endif
 extern __thread int errno attribute_tls_model_ie;
 
-# endif	/* !NOT_IN_libc || IS_IN_LIB */
+# endif	/* IS_IN_LIB */
 
 # define __set_errno(val) (errno = (val))
 
Index: glibc-2.17-c758a686/include/math.h
===================================================================
--- glibc-2.17-c758a686.orig/include/math.h
+++ glibc-2.17-c758a686/include/math.h
@@ -6,7 +6,7 @@
 /* Now define the internal interfaces.  */
 extern int __matherr (struct exception *__exc);
 
-# if !defined NOT_IN_libc || IS_IN (libm)
+# if IS_IN (libc) || IS_IN (libm)
 hidden_proto (__finite)
 hidden_proto (__isinf)
 hidden_proto (__isnan)
Index: glibc-2.17-c758a686/include/stdio.h
===================================================================
--- glibc-2.17-c758a686.orig/include/stdio.h
+++ glibc-2.17-c758a686/include/stdio.h
@@ -117,7 +117,7 @@ extern const char *const _sys_errlist_in
 extern int _sys_nerr_internal attribute_hidden;
 
 libc_hidden_proto (__asprintf)
-#  if !defined NOT_IN_libc
+#  if IS_IN (libc)
 extern _IO_FILE *_IO_new_fopen (const char*, const char*);
 #   define fopen(fname, mode) _IO_new_fopen (fname, mode)
 extern _IO_FILE *_IO_new_fdopen (int, const char*);
Index: glibc-2.17-c758a686/include/string.h
===================================================================
--- glibc-2.17-c758a686.orig/include/string.h
+++ glibc-2.17-c758a686/include/string.h
@@ -57,7 +57,7 @@ extern __typeof (strcasecmp_l) __strcase
 extern __typeof (strncasecmp_l) __strncasecmp_l;
 
 /* Alternative version which doesn't pollute glibc's namespace.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # undef strndupa
 # define strndupa(s, n)							      \
   (__extension__							      \
Index: glibc-2.17-c758a686/include/sys/stat.h
===================================================================
--- glibc-2.17-c758a686.orig/include/sys/stat.h
+++ glibc-2.17-c758a686/include/sys/stat.h
@@ -12,7 +12,7 @@ extern __mode_t __umask (__mode_t __mask
 extern int __mkdir (const char *__path, __mode_t __mode);
 extern int __mknod (const char *__path,
 		    __mode_t __mode, __dev_t __dev);
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 hidden_proto (__fxstat)
 hidden_proto (__fxstat64)
 hidden_proto (__lxstat)
Index: glibc-2.17-c758a686/include/wctype.h
===================================================================
--- glibc-2.17-c758a686.orig/include/wctype.h
+++ glibc-2.17-c758a686/include/wctype.h
@@ -89,7 +89,7 @@ libc_hidden_proto (__towupper_l)
 
 /* The spec says that isdigit must only match the decimal digits.  We
    can check this without a memory access.  */
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  undef iswdigit
 #  define iswdigit(c) ({ wint_t __c = (c); __c >= L'0' && __c <= L'9'; })
 #  undef iswdigit_l
Index: glibc-2.17-c758a686/intl/l10nflist.c
===================================================================
--- glibc-2.17-c758a686.orig/intl/l10nflist.c
+++ glibc-2.17-c758a686/intl/l10nflist.c
@@ -324,7 +324,7 @@ _nl_normalize_codeset (codeset, name_len
   char *retval;
   char *wp;
   size_t cnt;
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
   locale_t locale = newlocale (0, "C", NULL);
 #else
 # define locale _nl_C_locobj_ptr
Index: glibc-2.17-c758a686/libidn/idn-stub.c
===================================================================
--- glibc-2.17-c758a686.orig/libidn/idn-stub.c
+++ glibc-2.17-c758a686/libidn/idn-stub.c
@@ -130,7 +130,7 @@ __idna_to_ascii_lz (const char *input, c
 }
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 libc_freeres_fn (unload_libidn)
 {
   if (h != NULL && h != (void *) 1l)
Index: glibc-2.17-c758a686/libio/libioP.h
===================================================================
--- glibc-2.17-c758a686.orig/libio/libioP.h
+++ glibc-2.17-c758a686/libio/libioP.h
@@ -900,7 +900,7 @@ _IO_acquire_lock_clear_flags2_fct (_IO_F
     _IO_funlockfile (fp);
 }
 
-#if !defined _IO_MTSAFE_IO && !defined NOT_IN_libc
+#if !defined _IO_MTSAFE_IO && IS_IN (libc)
 # define _IO_acquire_lock(_fp)						      \
   do {									      \
     _IO_FILE *_IO_acquire_lock_file = NULL
Index: glibc-2.17-c758a686/malloc/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/malloc/Makefile
+++ glibc-2.17-c758a686/malloc/Makefile
@@ -56,8 +56,6 @@ extra-objs = mcheck-init.o libmcheck.a
 # Include the cleanup handler.
 aux := set-freeres thread-freeres
 
-CPPFLAGS-memusagestat = -DNOT_IN_libc
-
 # The Perl script to analyze the output of the mtrace functions.
 ifneq ($(PERL),no)
 install-bin-script = mtrace
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/libc_multiple_threads.c
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/libc_multiple_threads.c
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/libc_multiple_threads.c
@@ -18,7 +18,7 @@
 
 #include <pthreadP.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifndef TLS_MULTIPLE_THREADS_IN_TCB
 /* Variable set to a nonzero value either if more than one thread runs or ran,
    or if a single-threaded process is trying to cancel itself.  See
Index: glibc-2.17-c758a686/nptl/pthreadP.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/pthreadP.h
+++ glibc-2.17-c758a686/nptl/pthreadP.h
@@ -273,7 +273,7 @@ __do_cancel (void)
 #define CANCEL_RESET(oldtype) \
   __pthread_disable_asynccancel (oldtype)
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 /* Same as CANCEL_ASYNC, but for use in libc.so.  */
 # define LIBC_CANCEL_ASYNC() \
   __libc_enable_asynccancel ()
Index: glibc-2.17-c758a686/nscd/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/nscd/Makefile
+++ glibc-2.17-c758a686/nscd/Makefile
@@ -79,7 +79,7 @@ CFLAGS-nscd_gethst_r.c = -fexceptions
 CFLAGS-nscd_getai.c = -fexceptions
 CFLAGS-nscd_initgroups.c = -fexceptions
 
-CPPFLAGS-nscd += -D_FORTIFY_SOURCE=2 -DNOT_IN_libc
+CPPFLAGS-nscd += -D_FORTIFY_SOURCE=2
 
 ifeq (yesyes,$(have-fpie)$(build-shared))
 CFLAGS-nscd += $(pie-ccflag)
Index: glibc-2.17-c758a686/posix/regex_internal.h
===================================================================
--- glibc-2.17-c758a686.orig/posix/regex_internal.h
+++ glibc-2.17-c758a686/posix/regex_internal.h
@@ -385,7 +385,7 @@ typedef struct re_dfa_t re_dfa_t;
 # endif
 #endif
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 static reg_errcode_t re_string_realloc_buffers (re_string_t *pstr,
 						int new_buf_len)
      internal_function;
@@ -735,7 +735,7 @@ re_string_wchar_at (const re_string_t *p
   return (wint_t) pstr->wcs[idx];
 }
 
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 static int
 internal_function __attribute ((pure))
 re_string_elem_size_at (const re_string_t *pstr, int idx)
Index: glibc-2.17-c758a686/stdlib/isomac.c
===================================================================
--- glibc-2.17-c758a686.orig/stdlib/isomac.c
+++ glibc-2.17-c758a686/stdlib/isomac.c
@@ -176,7 +176,8 @@ static char *macros[] =
 /* Format string to build command to invoke compiler.  */
 static const char fmt[] = "\
 echo \"#include <%s>\" |\
-%s -E -dM -ansi -pedantic %s -D_LIBC -D_ISOMAC -DNOT_IN_libc -I. \
+%s -E -dM -ansi -pedantic %s -D_LIBC -D_ISOMAC \
+-DIN_MODULE=MODULE_extramodules -I. \
 -isystem `%s --print-prog-name=include` - 2> /dev/null > %s";
 
 
@@ -304,7 +305,7 @@ get_null_defines (void)
 	;
       result[result_len] = xstrndup (start, end - start);
 
-      if (strcmp (result[result_len], "NOT_IN_libc") != 0)
+      if (strcmp (result[result_len], "IN_MODULE") != 0)
 	{
 	  if (first)
 	    {
Index: glibc-2.17-c758a686/sunrpc/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/sunrpc/Makefile
+++ glibc-2.17-c758a686/sunrpc/Makefile
@@ -168,7 +168,7 @@ $(cross-rpcgen-objs): $(objpfx)cross-%.o
 $(objpfx)cross-rpcgen: $(cross-rpcgen-objs)
 	$(BUILD_CC) $^ $(BUILD_LDFLAGS) -o $@
 
-# This makes sure -DNOT_IN_libc is passed for all these modules.
+# This makes sure -DIN_MODULE is passed for all these modules.
 cpp-srcs-left := $(rpcgen-objs:.o=.c)
 lib := nonlib
 include $(patsubst %,$(..)cppflags-iterator.mk,$(cpp-srcs-left))
Index: glibc-2.17-c758a686/ports/sysdeps/arm/memmove.S
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/arm/memmove.S
+++ glibc-2.17-c758a686/ports/sysdeps/arm/memmove.S
@@ -65,7 +65,7 @@ ENTRY(memmove)
 
 		subs	ip, r0, r1
 		cmphi	r2, ip
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 		bls	memcpy
 #else
 		bls	HIDDEN_JUMPTARGET(memcpy)
Index: glibc-2.17-c758a686/sysdeps/generic/_itoa.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/generic/_itoa.h
+++ glibc-2.17-c758a686/sysdeps/generic/_itoa.h
@@ -46,12 +46,12 @@ extern char *_itoa (unsigned long long i
 
 extern const char _itoa_upper_digits[];
 extern const char _itoa_lower_digits[];
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 hidden_proto (_itoa_upper_digits)
 hidden_proto (_itoa_lower_digits)
 #endif
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 extern char *_itoa_word (_ITOA_WORD_TYPE value, char *buflim,
 			 unsigned int base, int upper_case);
 #else
Index: glibc-2.17-c758a686/sysdeps/generic/symbol-hacks.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/generic/symbol-hacks.h
+++ glibc-2.17-c758a686/sysdeps/generic/symbol-hacks.h
@@ -1,6 +1,6 @@
 /* Some compiler optimizations may transform loops into memset/memmove
    calls and without proper declaration it may generate PLT calls.  */
-#if !defined __ASSEMBLER__ && !defined NOT_IN_libc && defined SHARED
+#if !defined __ASSEMBLER__ && IS_IN (libc) && defined SHARED
 asm ("memmove = __GI_memmove");
 asm ("memset = __GI_memset");
 asm ("memcpy = __GI_memcpy");
Index: glibc-2.17-c758a686/sysdeps/gnu/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/gnu/Makefile
+++ glibc-2.17-c758a686/sysdeps/gnu/Makefile
@@ -41,7 +41,7 @@ $(objpfx)errlist-compat.c: $(errlist-c)
 endif
 	$(make-target-directory)
 	$(AWK) -v maxerr=`\
-	  $(CC) -S $(CPPFLAGS) $(CFLAGS) -DNOT_IN_libc -DEMIT_ERR_MAX $< -o - \
+	  $(CC) -S $(CPPFLAGS) $(CFLAGS) -DEMIT_ERR_MAX $< -o - \
 	  | sed -n 's/^.*@@@[^0-9]*\([0-9]*\)[^0-9]*@@@.*$$/\1/p'` \
 	       -f $(..)sysdeps/gnu/errlist-compat.awk \
 	       $(wildcard $(sysdirs:=/Versions)) > $@T
Index: glibc-2.17-c758a686/sysdeps/i386/i586/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i586/memset.S
+++ glibc-2.17-c758a686/sysdeps/i386/i586/memset.S
@@ -37,7 +37,7 @@
 #endif
 
         .text
-#if defined PIC && !defined NOT_IN_libc && !BZERO_P
+#if defined PIC && IS_IN (libc) && !BZERO_P
 ENTRY (__memset_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/memset.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/memset.S
@@ -38,7 +38,7 @@
 #endif
 
         .text
-#if defined PIC && !defined NOT_IN_libc && !BZERO_P
+#if defined PIC && IS_IN (libc) && !BZERO_P
 ENTRY_CHK (__memset_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
@@ -105,7 +105,7 @@ ENTRY (BP_SYM (memset))
 END (BP_SYM (memset))
 libc_hidden_builtin_def (memset)
 
-#if defined PIC && !defined NOT_IN_libc && !BZERO_P
+#if defined PIC && IS_IN (libc) && !BZERO_P
 strong_alias (__memset_chk, __memset_zero_constant_len_parameter)
 	.section .gnu.warning.__memset_zero_constant_len_parameter
 	.string "memset used with constant zero length parameter; this could be due to transposed parameters"
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/bcopy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/bcopy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/bcopy.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(bcopy)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/bzero.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/bzero.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/bzero.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__bzero)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr-sse2-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memchr-sse2-bsf.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr-sse2-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memchr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 # define CFI_POP(REG) \
 	cfi_adjust_cfa_offset (-4); \
 	cfi_restore (REG)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp-sse4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcmp-sse4.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp-sse4.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcmp-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcmp.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcmp.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(memcmp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy-ssse3-rep.S
@@ -19,7 +19,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc \
+#if IS_IN (libc) \
     && (defined SHARED \
 	|| defined USE_AS_MEMMOVE \
 	|| !defined USE_MULTIARCH)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if !defined NOT_IN_libc \
+#if IS_IN (libc) \
     && (defined SHARED \
 	|| defined USE_AS_MEMMOVE \
 	|| !defined USE_MULTIARCH)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  In static binaries we need memcpy before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(memcpy)
 	.type	memcpy, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memcpy_chk.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memcpy_chk.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  There are no multiarch memcpy functions for static binaries.
  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__memcpy_chk)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memmove.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memmove.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memmove.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(memmove)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memmove_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memmove_chk.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memmove_chk.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__memmove_chk)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/mempcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/mempcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/mempcpy.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  In static binaries we need mempcpy before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(__mempcpy)
 	.type	__mempcpy, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/mempcpy_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/mempcpy_chk.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/mempcpy_chk.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  There are no multiarch mempcpy functions for static binaries.
  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__mempcpy_chk)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memrchr-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-c.c
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define MEMRCHR  __memrchr_ia32
 # include <string.h>
 extern void *__memrchr_ia32 (const void *, int, size_t);
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-sse2-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memrchr-sse2-bsf.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-sse2-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memrchr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 # define CFI_PUSH(REG)	\
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memrchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memrchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 # define CFI_POP(REG) \
 	cfi_adjust_cfa_offset (-4); \
 	cfi_restore (REG)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset-sse2-rep.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memset-sse2-rep.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset-sse2-rep.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 #include <sysdep.h>
 #include "asm-syntax.h"
@@ -79,7 +79,7 @@
 #endif
 
 	.section .text.sse2,"ax",@progbits
-#if defined SHARED && !defined NOT_IN_libc && !defined USE_AS_BZERO
+#if defined SHARED && IS_IN (libc) && !defined USE_AS_BZERO
 ENTRY (__memset_chk_sse2_rep)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memset-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 #include <sysdep.h>
 #include "asm-syntax.h"
@@ -79,7 +79,7 @@
 #endif
 
 	.section .text.sse2,"ax",@progbits
-#if defined SHARED && !defined NOT_IN_libc && !defined USE_AS_BZERO
+#if defined SHARED && IS_IN (libc) && !defined USE_AS_BZERO
 ENTRY (__memset_chk_sse2)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memset.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(memset)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/memset_chk.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/memset_chk.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__memset_chk)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/rawmemchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/rawmemchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/rawmemchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 # define CFI_POP(REG) \
 	cfi_adjust_cfa_offset (-4); \
 	cfi_restore (REG)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcat-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat-sse2.S
@@ -18,7 +18,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcat-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat-ssse3.S
@@ -18,7 +18,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcat.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcat.S
@@ -43,7 +43,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strncat in static library since we
    need strncat before the initialization happened.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # ifdef SHARED
 	.text
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr-sse2-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strchr-sse2-bsf.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr-sse2-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strchr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(strchr)
 	.type	strchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp-sse4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcmp-sse4.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp-sse4.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 #include <sysdep.h>
 #include "asm-syntax.h"
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcmp-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 #include <sysdep.h>
 #include "asm-syntax.h"
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcmp.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcmp.S
@@ -50,7 +50,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strncmp in static library since we
    need strncmp before the initialization happened.  */
-#if (defined SHARED || !defined USE_AS_STRNCMP) && !defined NOT_IN_libc
+#if (defined SHARED || !defined USE_AS_STRNCMP) && IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(STRCMP)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcpy-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy-sse2.S
@@ -18,7 +18,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy-ssse3.S
@@ -18,7 +18,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # ifndef USE_AS_STRCAT
 #  include <sysdep.h>
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcpy.S
@@ -59,7 +59,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strncpy in static library since we
    need strncpy before the initialization happened.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # ifdef SHARED
 	.text
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcspn.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strcspn.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strcspn.S
@@ -41,7 +41,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strpbrk in static library since we
    need strpbrk before the initialization happened.  */
-#if (defined SHARED || !defined USE_AS_STRPBRK) && !defined NOT_IN_libc
+#if (defined SHARED || !defined USE_AS_STRPBRK) && IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(STRCSPN)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen-sse2-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strlen-sse2-bsf.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen-sse2-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 
 #include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strlen-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen-sse2.S
@@ -19,7 +19,7 @@
 
 /* for strlen only SHARED version is optimized, for strcat, strncat, strnlen both STATIC and SHARED are optimized */
 
-#if (defined USE_AS_STRNLEN || defined USE_AS_STRCAT || defined SHARED) && !defined NOT_IN_libc
+#if (defined USE_AS_STRNLEN || defined USE_AS_STRCAT || defined SHARED) && IS_IN (libc)
 
 # ifndef USE_AS_STRCAT
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strlen.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strlen.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in libc and for the
    DSO.  In static binaries, we need strlen before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(strlen)
 	.type	strlen, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strnlen.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strnlen.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strnlen.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(__strnlen)
 	.type	__strnlen, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr-sse2-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strrchr-sse2-bsf.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr-sse2-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strrchr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strrchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strrchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(strrchr)
 	.type	strrchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strspn.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/strspn.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/strspn.S
@@ -26,7 +26,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(strspn)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcschr-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr-c.c
@@ -1,6 +1,6 @@
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 #  undef libc_hidden_def
 #  define libc_hidden_def(name) \
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcschr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <sysdep.h>
 
 # define CFI_PUSH(REG)	\
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcschr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcschr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wcschr)
 	.type	wcschr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscmp-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcscmp-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscmp-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcscmp.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscmp.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in libc and for the
    DSO.  In static binaries, we need wcscmp before the initialization
    happened.  */
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wcscmp)
 	.type	wcscmp, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcscpy-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy-c.c
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define wcscpy  __wcscpy_ia32
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcscpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <sysdep.h>
 
 # define CFI_PUSH(REG)	\
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcscpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcscpy.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wcscpy)
 	.type	wcscpy, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcslen-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen-c.c
@@ -1,6 +1,6 @@
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define WCSLEN  __wcslen_ia32
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcslen-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <sysdep.h>
 # define STR	4
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcslen.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcslen.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(__wcslen)
 	.type	__wcslen, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcsrchr-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr-c.c
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define wcsrchr  __wcsrchr_ia32
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr-sse2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcsrchr-sse2.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr-sse2.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <sysdep.h>
 # define CFI_PUSH(REG)	\
 	cfi_adjust_cfa_offset (4);	\
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wcsrchr.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wcsrchr.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <init-arch.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wcsrchr)
 	.type	wcsrchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wmemcmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wmemcmp-c.c
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wmemcmp-c.c
@@ -1,6 +1,6 @@
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define WMEMCMP  __wmemcmp_ia32
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wmemcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/multiarch/wmemcmp.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/multiarch/wmemcmp.S
@@ -23,7 +23,7 @@
 
 /* Define multiple versions only for the definition in libc. */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wmemcmp)
 	.type	wmemcmp, @gnu_indirect_function
Index: glibc-2.17-c758a686/ports/sysdeps/ia64/fpu/libm-symbols.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/ia64/fpu/libm-symbols.h
+++ glibc-2.17-c758a686/ports/sysdeps/ia64/fpu/libm-symbols.h
@@ -53,6 +53,6 @@
  ASM_SIZE_DIRECTIVE(__ieee754_##name);			\
  .type __ieee754_##name, @function
 
-#if defined ASSEMBLER && !defined NOT_IN_libc
+#if defined ASSEMBLER && IS_IN (libc)
 # define __libm_error_support	HIDDEN_JUMPTARGET(__libm_error_support)
 #endif
Index: glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/libc-lock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/pthread/bits/libc-lock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/libc-lock.h
@@ -26,7 +26,7 @@
 
 /* Mutex type.  */
 #if defined _LIBC || defined _IO_MTSAFE_IO
-# if (defined NOT_IN_libc && !IS_IN (libpthread)) || !defined _LIBC
+# if (!IS_IN (libc) && !IS_IN (libpthread)) || !defined _LIBC
 typedef struct { pthread_mutex_t mutex; } __libc_lock_recursive_t;
 # else
 typedef struct { int lock; int cnt; void *owner; } __libc_lock_recursive_t;
@@ -47,7 +47,7 @@ typedef struct __libc_lock_recursive_opa
 
 /* Define an initialized recursive lock variable NAME with storage
    class CLASS.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 # if LLL_LOCK_INITIALIZER == 0
 #  define __libc_lock_define_initialized_recursive(CLASS,NAME) \
   CLASS __libc_lock_recursive_t NAME;
@@ -65,7 +65,7 @@ typedef struct __libc_lock_recursive_opa
 #endif
 
 /* Initialize a recursive mutex.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 # define __libc_lock_init_recursive(NAME) \
   ((NAME) = (__libc_lock_recursive_t) _LIBC_LOCK_RECURSIVE_INITIALIZER, 0)
 #else
@@ -83,7 +83,7 @@ typedef struct __libc_lock_recursive_opa
 #endif
 
 /* Finalize recursive named lock.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 # define __libc_lock_fini_recursive(NAME) ((void) 0)
 #else
 # define __libc_lock_fini_recursive(NAME) \
@@ -91,7 +91,7 @@ typedef struct __libc_lock_recursive_opa
 #endif
 
 /* Lock the recursive named lock variable.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 # define __libc_lock_lock_recursive(NAME) \
   do {									      \
     void *self = THREAD_SELF;						      \
@@ -108,7 +108,7 @@ typedef struct __libc_lock_recursive_opa
 #endif
 
 /* Try to lock the recursive named lock variable.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 # define __libc_lock_trylock_recursive(NAME) \
   ({									      \
     int result = 0;							      \
@@ -133,7 +133,7 @@ typedef struct __libc_lock_recursive_opa
 #endif
 
 /* Unlock the recursive named lock variable.  */
-#if defined _LIBC && (!defined NOT_IN_libc || IS_IN (libpthread))
+#if defined _LIBC && (IS_IN (libc) || IS_IN (libpthread))
 /* We do no error checking here.  */
 # define __libc_lock_unlock_recursive(NAME) \
   do {									      \
Index: glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/libc-lockP.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/pthread/bits/libc-lockP.h
+++ glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/libc-lockP.h
@@ -35,7 +35,7 @@
 #include <pthread-functions.h>
 
 /* Mutex type.  */
-#if defined NOT_IN_libc && !IS_IN (libpthread)
+#if !IS_IN (libc) && !IS_IN (libpthread)
 typedef pthread_mutex_t __libc_lock_t;
 #else
 typedef int __libc_lock_t;
@@ -69,7 +69,7 @@ typedef pthread_key_t __libc_key_t;
    initialized locks must be set to one due to the lack of normal
    atomic operations.) */
 
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # if LLL_LOCK_INITIALIZER == 0
 #  define __libc_lock_define_initialized(CLASS,NAME) \
   CLASS __libc_lock_t NAME;
@@ -113,7 +113,7 @@ typedef pthread_key_t __libc_key_t;
 #endif
 
 /* Call thread functions through the function pointer table.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # define PTFAVAIL(NAME) __libc_pthread_functions_init
 # define __libc_ptf_call(FUNC, ARGS, ELSE) \
   (__libc_pthread_functions_init ? PTHFCT_CALL (ptr_##FUNC, ARGS) : ELSE)
@@ -130,13 +130,13 @@ typedef pthread_key_t __libc_key_t;
 
 /* Initialize the named lock variable, leaving it in a consistent, unlocked
    state.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # define __libc_lock_init(NAME) ((NAME) = LLL_LOCK_INITIALIZER, 0)
 #else
 # define __libc_lock_init(NAME) \
   __libc_maybe_call (__pthread_mutex_init, (&(NAME), NULL), 0)
 #endif
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 /* ((NAME) = (__libc_rwlock_t) PTHREAD_RWLOCK_INITIALIZER, 0) is
    inefficient.  */
 # define __libc_rwlock_init(NAME) \
@@ -149,13 +149,13 @@ typedef pthread_key_t __libc_key_t;
 /* Finalize the named lock variable, which must be locked.  It cannot be
    used again until __libc_lock_init is called again on it.  This must be
    called on a lock variable before the containing storage is reused.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # define __libc_lock_fini(NAME) ((void) 0)
 #else
 # define __libc_lock_fini(NAME) \
   __libc_maybe_call (__pthread_mutex_destroy, (&(NAME)), 0)
 #endif
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # define __libc_rwlock_fini(NAME) ((void) 0)
 #else
 # define __libc_rwlock_fini(NAME) \
@@ -163,7 +163,7 @@ typedef pthread_key_t __libc_key_t;
 #endif
 
 /* Lock the named lock variable.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # ifndef __libc_lock_lock
 #  define __libc_lock_lock(NAME) \
   ({ lll_lock (NAME, LLL_PRIVATE); 0; })
@@ -179,7 +179,7 @@ typedef pthread_key_t __libc_key_t;
   __libc_ptf_call (__pthread_rwlock_wrlock, (&(NAME)), 0)
 
 /* Try to lock the named lock variable.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # ifndef __libc_lock_trylock
 #  define __libc_lock_trylock(NAME) \
   lll_trylock (NAME)
@@ -198,7 +198,7 @@ typedef pthread_key_t __libc_key_t;
   __libc_maybe_call (__pthread_mutex_trylock, (&(NAME).mutex), 0)
 
 /* Unlock the named lock variable.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread)
+#if IS_IN (libc) || IS_IN (libpthread)
 # define __libc_lock_unlock(NAME) \
   lll_unlock (NAME, LLL_PRIVATE)
 #else
Index: glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/stdio-lock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/pthread/bits/stdio-lock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/pthread/bits/stdio-lock.h
@@ -84,7 +84,7 @@ typedef struct { int lock; int cnt; void
 #define _IO_cleanup_region_end(_doit) \
   __libc_cleanup_region_end (_doit)
 
-#if defined _LIBC && !defined NOT_IN_libc
+#if defined _LIBC && IS_IN (libc)
 
 # ifdef __EXCEPTIONS
 #  define _IO_acquire_lock(_fp) \
Index: glibc-2.17-c758a686/sysdeps/posix/closedir.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/posix/closedir.c
+++ glibc-2.17-c758a686/sysdeps/posix/closedir.c
@@ -44,7 +44,7 @@ __closedir (DIR *dirp)
 
   fd = dirp->fd;
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_fini (dirp->lock);
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/posix/opendir.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/posix/opendir.c
+++ glibc-2.17-c758a686/sysdeps/posix/opendir.c
@@ -223,7 +223,7 @@ __alloc_dir (int fd, bool close_fd, int
     }
 
   dirp->fd = fd;
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_init (dirp->lock);
 #endif
   dirp->allocation = allocation;
Index: glibc-2.17-c758a686/sysdeps/posix/readdir.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/posix/readdir.c
+++ glibc-2.17-c758a686/sysdeps/posix/readdir.c
@@ -40,7 +40,7 @@ __READDIR (DIR *dirp)
   DIRENT_TYPE *dp;
   int saved_errno = errno;
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_lock (dirp->lock);
 #endif
 
@@ -110,7 +110,7 @@ __READDIR (DIR *dirp)
       /* Skip deleted files.  */
     } while (dp->d_ino == 0);
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_unlock (dirp->lock);
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/posix/rewinddir.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/posix/rewinddir.c
+++ glibc-2.17-c758a686/sysdeps/posix/rewinddir.c
@@ -26,7 +26,7 @@ void
 rewinddir (dirp)
      DIR *dirp;
 {
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_lock (dirp->lock);
 #endif
   (void) __lseek (dirp->fd, (off_t) 0, SEEK_SET);
@@ -34,7 +34,7 @@ rewinddir (dirp)
   dirp->offset = 0;
   dirp->size = 0;
   dirp->errcode = 0;
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
   __libc_lock_unlock (dirp->lock);
 #endif
 }
Index: glibc-2.17-c758a686/sysdeps/powerpc/novmx-sigjmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/novmx-sigjmp.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/novmx-sigjmp.c
@@ -20,7 +20,7 @@
 
 #include <bits/wordsize.h>
 #include <shlib-compat.h>
-#if !defined NOT_IN_libc && defined SHARED
+#if IS_IN (libc) && defined SHARED
 # if SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)
 #  include <stddef.h>
 #  include <novmxsetjmp.h>
@@ -41,4 +41,4 @@ __novmx__sigjmp_save (__novmx__sigjmp_bu
 }
 
 # endif /* SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4) */
-#endif /* !NOT_IN_libc && SHARED  */
+#endif /* IS_IN (libc) && SHARED  */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/__longjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/__longjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/__longjmp.S
@@ -19,11 +19,11 @@
 #include <libc-symbols.h>
 #include <shlib-compat.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "__longjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* !IS_IN (libc) */
 strong_alias (__vmx__longjmp, __longjmp);
 # define __longjmp  __vmx__longjmp
 # include "__longjmp-common.S"
@@ -35,4 +35,4 @@ strong_alias (__vmx__longjmp, __longjmp)
 #  define __longjmp  __novmx__longjmp
 #  include "__longjmp-common.S"
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/bsd-_setjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/bsd-_setjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/bsd-_setjmp.S
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 #include <bp-sym.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 ENTRY (BP_SYM (_setjmp))
 	li r4,0			/* Set second argument to 0.  */
@@ -55,4 +55,4 @@ ENTRY (BP_SYM (__vmx_setjmp))
 	b BP_SYM (__vmx__sigsetjmp@local)
 END (BP_SYM (__vmx_setjmp))
 libc_hidden_def (__vmx_setjmp)
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/fpu/__longjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/fpu/__longjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/fpu/__longjmp.S
@@ -20,11 +20,11 @@
 #include <rtld-global-offsets.h>
 #include <shlib-compat.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "__longjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* !IS_IN (libc) */
 /* Build a versioned object for libc.  */
 versioned_symbol (libc, __vmx__longjmp, __longjmp, GLIBC_2_3_4);
 # define __longjmp  __vmx__longjmp
@@ -38,4 +38,4 @@ compat_symbol (libc, __novmx__longjmp, _
 #  define __longjmp  __novmx__longjmp
 #  include "__longjmp-common.S"
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/fpu/setjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/fpu/setjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/fpu/setjmp.S
@@ -20,11 +20,11 @@
 #include <rtld-global-offsets.h>
 #include <shlib-compat.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "setjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* !IS_IN (libc) */
 /* Build a versioned object for libc.  */
 versioned_symbol (libc, __vmx__sigsetjmp, __sigsetjmp, GLIBC_2_3_4)
 # define __sigsetjmp __vmx__sigsetjmp
@@ -41,4 +41,4 @@ compat_symbol (libc, __novmx__sigsetjmp,
 #  define __sigjmp_save __novmx__sigjmp_save
 #  include "setjmp-common.S"
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power6/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/power6/memset.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power6/memset.S
@@ -230,7 +230,7 @@ L(nzCacheAligned128):
 	ori	r1,r1,0
         stw     rCHR,60(rMEMP3)
 	blt	cr6,L(cacheAligned1)
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	lfd	0,-128(rMEMP)
 #endif
 	b	L(nzCacheAligned256)
@@ -238,7 +238,7 @@ L(nzCacheAligned128):
 L(nzCacheAligned256):
 	cmplwi	cr1,rLEN,256
 	addi	rMEMP3,rMEMP,64
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 /* When we are not in libc we should use only GPRs to avoid the FPU lock
    interrupt.  */
 	stw	rCHR,0(rMEMP)
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/setjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/setjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/setjmp.S
@@ -19,11 +19,11 @@
 #include <shlib-compat.h>
 #include <libc-symbols.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "setjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* !IS_IN (libc) */
 /* Build a versioned object for libc.  */
 versioned_symbol (libc, __vmx__sigsetjmp, __sigsetjmp, GLIBC_2_3_4)
 # define __sigsetjmp __vmx__sigsetjmp
@@ -40,4 +40,4 @@ compat_symbol (libc, __novmx__sigsetjmp,
 #  define __sigjmp_save __novmx__sigjmp_save
 #  include "setjmp-common.S"
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/__longjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/__longjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/__longjmp.S
@@ -20,11 +20,11 @@
 #include <rtld-global-offsets.h>
 #include <shlib-compat.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "__longjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* IS_IN (libc) */
 strong_alias (__vmx__longjmp, __longjmp)
 # define __longjmp  __vmx__longjmp
 # include "__longjmp-common.S"
@@ -36,4 +36,4 @@ strong_alias (__vmx__longjmp, __longjmp)
 #  define __longjmp  __novmx__longjmp
 #  include "__longjmp-common.S"
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/bzero.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/bzero.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/bzero.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* Define multiple versions only for definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <strings.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memchr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcmp-ppc64.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memcmp-ppc64.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcmp-ppc64.c
@@ -22,7 +22,7 @@
 #define weak_alias(name, aliasname) \
   extern __typeof (__memcmp_ppc) aliasname \
     __attribute__ ((weak, alias ("__memcmp_ppc")));
-#if !defined(NOT_IN_libc) && defined(SHARED)
+#if IS_IN (libc) && defined(SHARED)
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) \
   __hidden_ver1(__memcmp_ppc, __GI_memcmp, __memcmp_ppc);
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memcmp.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcmp.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* Define multiple versions only for definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcpy-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memcpy-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcpy-ppc64.S
@@ -18,7 +18,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef EALIGN
 # define EALIGN(name, alignt, words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memcpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memcpy.c
@@ -19,7 +19,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  In static binaries we need memcpy before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 /* Redefine memcpy so that the compiler won't complain about the type
    mismatch with the IFUNC selector in strong_alias, below.  */
 # undef memcpy
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/mempcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/mempcpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/mempcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memrchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memrchr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memrchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memset-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memset-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memset-ppc64.S
@@ -29,7 +29,7 @@ ENTRY (__bzero_ppc)
 END_GEN_TB (__bzero_ppc,TB_TOCLESS)
 
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef EALIGN
 # define EALIGN(name, alignt, words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memset.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/memset.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/memset.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* Define multiple versions only for definition in libc.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 /* Redefine memset so that the compiler won't complain about the type
    mismatch with the IFUNC selector in strong_alias, below.  */
 # undef memset
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/rawmemchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/rawmemchr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/rawmemchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpcpy-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/stpcpy-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpcpy-ppc64.S
@@ -18,7 +18,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef EALIGN
 # define EALIGN(name, alignt, words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/stpcpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # define NO_MEMPCPY_STPCPY_REDIRECT
 # include <string.h>
 # include <shlib-compat.h>
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/stpncpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/stpncpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcasecmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcasecmp.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcasecmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # define strcasecmp __strcasecmp_ppc
 extern __typeof (__strcasecmp) __strcasecmp_ppc attribute_hidden;
@@ -26,7 +26,7 @@ extern __typeof (__strcasecmp) __strcase
 #include <string/strcasecmp.c>
 #undef strcasecmp
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <shlib-compat.h>
 # include "init-arch.h"
 
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcasecmp_l.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcasecmp_l.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcasecmp_l.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # define strcasecmp_l __strcasecmp_l_ppc
 extern __typeof (__strcasecmp_l) __strcasecmp_l_ppc attribute_hidden;
@@ -26,7 +26,7 @@ extern __typeof (__strcasecmp_l) __strca
 #include <string/strcasecmp_l.c>
 #undef strcasecmp_l
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <shlib-compat.h>
 # include "init-arch.h"
 
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcat.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcat.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcat.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strchr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strchr.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* Define multiple versions only for definition in libc.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strchrnul.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strchrnul.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strchrnul.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcmp-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcmp-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcmp-ppc64.S
@@ -18,7 +18,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef EALIGN
 # define EALIGN(name, alignt, words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcmp.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcpy-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcpy-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcpy-ppc64.S
@@ -18,7 +18,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef EALIGN
 # define EALIGN(name, alignt, words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strcpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strlen-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strlen-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strlen-ppc64.S
@@ -18,7 +18,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # undef ENTRY
 # define ENTRY(name)						\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strlen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strlen.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strlen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 /* Redefine strlen so that the compiler won't complain about the type
    mismatch with the IFUNC selector in strong_alias, below.  */
 # undef strlen
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncase.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncase.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncase.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # define strncasecmp __strncasecmp_ppc
 extern __typeof (__strncasecmp) __strncasecmp_ppc attribute_hidden;
@@ -26,7 +26,7 @@ extern __typeof (__strncasecmp) __strnca
 #include <string/strncase.c>
 #undef strncasecmp
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <shlib-compat.h>
 # include "init-arch.h"
 
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncase_l.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncase_l.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncase_l.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # define strncasecmp_l __strncasecmp_l_ppc
 extern __typeof (__strncasecmp_l) __strncasecmp_l_ppc attribute_hidden;
@@ -26,7 +26,7 @@ extern __typeof (__strncasecmp_l) __strn
 #include <string/strncase_l.c>
 #undef strncasecmp_l
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <shlib-compat.h>
 # include "init-arch.h"
 
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncmp-ppc64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncmp-ppc64.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncmp-ppc64.S
@@ -17,7 +17,7 @@
 
 #include <sysdep.h>
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 #undef EALIGN
 #define EALIGN(name,alignt,words)				\
   .section ".text";						\
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncmp.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncmp.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* Define multiple versions only for definition in libc.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncpy-ppc64.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncpy-ppc64.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncpy-ppc64.c
@@ -22,7 +22,7 @@
 #define weak_alias(name, aliasname) \
   extern __typeof (__strncpy_ppc) aliasname \
     __attribute__ ((weak, alias ("__strncpy_ppc")));
-#if !defined(NOT_IN_libc) && defined(SHARED)
+#if IS_IN (libc) && defined(SHARED)
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) \
   __hidden_ver1(__strncpy_ppc, __GI_strncpy, __strncpy_ppc);
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strncpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strncpy.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/ >.  */
 
 /* Define multiple versions only for definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strnlen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/strnlen.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/strnlen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <string.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcschr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/wcschr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcschr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <wchar.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcscpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/wcscpy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcscpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <wchar.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcsrchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/wcsrchr.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wcsrchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <wchar.h>
 # include <shlib-compat.h>
 # include "init-arch.h"
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wordcopy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/multiarch/wordcopy.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/multiarch/wordcopy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <stddef.h>
 # include <memcopy.h>
 # include <shlib-compat.h>
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/setjmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc64/setjmp.S
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc64/setjmp.S
@@ -20,11 +20,11 @@
 #include <rtld-global-offsets.h>
 #include <shlib-compat.h>
 
-#if defined NOT_IN_libc
+#if !IS_IN (libc)
 /* Build a non-versioned object for rtld-*.  */
 # include "setjmp-common.S"
 
-#else /* !NOT_IN_libc */
+#else /* !IS_IN (libc) */
 /* Build a versioned object for libc.  */
 versioned_symbol (libc, __vmxsetjmp, setjmp, GLIBC_2_3_4)
 versioned_symbol (libc, __vmx_setjmp, _setjmp, GLIBC_2_3_4)
@@ -54,4 +54,4 @@ compat_symbol (libc, __novmx__sigsetjmp,
 #  include "setjmp-common.S"
 strong_alias (__novmxsetjmp, __novmx__setjmp)
 # endif
-#endif /* !NOT_IN_libc */
+#endif /* IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara1.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memcpy-niagara1.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara1.S
@@ -35,7 +35,7 @@
 #define XCC xcc
 #endif
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2,#scratch
 	.register	%g3,#scratch
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara2.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memcpy-niagara2.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara2.S
@@ -137,7 +137,7 @@
 	LOAD(ldd, base + 0x28, %x5); \
 	LOAD(ldd, base + 0x30, %x6);
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2,#scratch
 	.register	%g3,#scratch
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memcpy-niagara4.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-niagara4.S
@@ -46,7 +46,7 @@
 #define STORE(type,src,addr)	type src, [addr]
 #define STORE_INIT(src,addr)	stxa src, [addr] STORE_ASI
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2,#scratch
 	.register	%g3,#scratch
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-ultra3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memcpy-ultra3.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy-ultra3.S
@@ -30,7 +30,7 @@
 #define XCC xcc
 #endif
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2,#scratch
 	.register	%g3,#scratch
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memcpy.S
@@ -20,7 +20,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(memcpy)
 	.type	memcpy, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset-niagara1.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memset-niagara1.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset-niagara1.S
@@ -28,7 +28,7 @@
 #define XCC xcc
 #endif
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2,#scratch
 
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset-niagara4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memset-niagara4.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset-niagara4.S
@@ -21,7 +21,7 @@
 
 #define ASI_BLK_INIT_QUAD_LDD_P	0xe2
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 
 	.register	%g2, #scratch
 	.register	%g3, #scratch
Index: glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/sparc/sparc64/multiarch/memset.S
+++ glibc-2.17-c758a686/sysdeps/sparc/sparc64/multiarch/memset.S
@@ -20,7 +20,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(memset)
 	.type	memset, @gnu_indirect_function
Index: glibc-2.17-c758a686/ports/sysdeps/unix/alpha/sysdep.S
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/alpha/sysdep.S
+++ glibc-2.17-c758a686/ports/sysdeps/unix/alpha/sysdep.S
@@ -29,7 +29,7 @@
 	.text
 #endif
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define SYSCALL_ERROR_ERRNO __libc_errno
 #else
 # define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/sysdeps/unix/make-syscalls.sh
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/make-syscalls.sh
+++ glibc-2.17-c758a686/sysdeps/unix/make-syscalls.sh
@@ -100,7 +100,7 @@ emit_weak_aliases()
       *@@*)
 	base=`echo $name | sed 's/@@.*//'`
 	ver=`echo $name | sed 's/.*@@//;s/\./_/g'`
-	echo "	 echo '#ifndef NOT_IN_libc'; \\"
+	echo "	 echo '#if IS_IN (libc)'; \\"
 	if test -z "$vcount" ; then
 	  source=$strong
 	  vcount=1
@@ -117,7 +117,7 @@ emit_weak_aliases()
       *@*)
 	base=`echo $name | sed 's/@.*//'`
 	ver=`echo $name | sed 's/.*@//;s/\./_/g'`
-	echo "	 echo '#ifndef NOT_IN_libc'; \\"
+	echo "	 echo '#if IS_IN (libc)'; \\"
 	if test -z "$vcount" ; then
 	  source=$strong
 	  vcount=1
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/Makefile
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/Makefile
@@ -160,7 +160,6 @@ sysdep-rtld-routines += dl-brk dl-sbrk d
 			dl-fxstatat64
 
 libof-lddlibc4 = lddlibc4
-CPPFLAGS-lddlibc4 += -DNOT_IN_libc
 endif
 
 ifeq ($(subdir),rt)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/aarch64/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/nptl/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				\
@@ -85,7 +85,7 @@ ENTRY (name);								\
 #  define CENABLE	bl __pthread_enable_asynccancel
 #  define CDISABLE	bl __pthread_disable_asynccancel
 #  define __local_multiple_threads __pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	bl __libc_enable_asynccancel
 #  define CDISABLE	bl __libc_disable_asynccancel
 #  define __local_multiple_threads __libc_multiple_threads
@@ -96,7 +96,7 @@ ENTRY (name);								\
 #  error Unsupported library
 # endif
 
-# if IS_IN (libpthread) || !defined NOT_IN_libc
+# if IS_IN (libpthread) || IS_IN (libc)
 #  ifndef __ASSEMBLER__
 extern int __local_multiple_threads attribute_hidden;
 #   define SINGLE_THREAD_P __builtin_expect (__local_multiple_threads == 0, 1)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/aarch64/sysdep.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/sysdep.h
@@ -93,7 +93,7 @@
 # define ret_ERRVAL ret
 
 # define SYSCALL_ERROR  .Lsyscall_error
-# if NOT_IN_libc
+# if !IS_IN (libc)
 #  if RTLD_PRIVATE_ERRNO
 #   define SYSCALL_ERROR_HANDLER				\
 .Lsyscall_error:						\
@@ -325,7 +325,7 @@
 
 /* Pointer mangling is supported for AArch64.  */
 #if (IS_IN (rtld)) || \
-     (!defined SHARED && (!defined NOT_IN_libc \
+     (!defined SHARED && (IS_IN (libc) \
 			  || IS_IN (libpthread)))
 # ifdef __ASSEMBLER__
 #  define PTR_MANGLE(dst, src, guard, tmp)                                \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/alpha/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/alpha/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/alpha/nptl/sysdep-cancel.h
@@ -21,7 +21,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 /* ??? Assumes that nothing comes between PSEUDO and PSEUDO_END
    besides "ret".  */
@@ -109,7 +109,7 @@ __LABEL($multi_error)						\
 #  define __local_enable_asynccancel	__pthread_enable_asynccancel
 #  define __local_disable_asynccancel	__pthread_disable_asynccancel
 #  define __local_multiple_threads	__pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define __local_enable_asynccancel	__libc_enable_asynccancel
 #  define __local_disable_asynccancel	__libc_disable_asynccancel
 #  define __local_multiple_threads	__libc_multiple_threads
@@ -128,7 +128,7 @@ __LABEL($multi_error)						\
 #  define CDISABLE	jsr ra, __local_disable_asynccancel; ldgp ra, 0(gp)
 # endif
 
-# if IS_IN (libpthread) || !defined NOT_IN_libc
+# if IS_IN (libpthread) || IS_IN (libc)
 #  ifndef __ASSEMBLER__
 extern int __local_multiple_threads attribute_hidden;
 #   define SINGLE_THREAD_P \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/arm/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/nptl/sysdep-cancel.h
@@ -21,7 +21,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 /* NOTE: We do mark syscalls with unwind annotations, for the benefit of
    cancellation; but they're really only accurate at the point of the
@@ -190,7 +190,7 @@
 #  define CENABLE	bl PLTJMP(__pthread_enable_asynccancel)
 #  define CDISABLE	bl PLTJMP(__pthread_disable_asynccancel)
 #  define __local_multiple_threads __pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	bl PLTJMP(__libc_enable_asynccancel)
 #  define CDISABLE	bl PLTJMP(__libc_disable_asynccancel)
 #  define __local_multiple_threads __libc_multiple_threads
@@ -201,7 +201,7 @@
 #  error Unsupported library
 # endif
 
-# if IS_IN (libpthread) || !defined NOT_IN_libc
+# if IS_IN (libpthread) || IS_IN (libc)
 #  ifndef __ASSEMBLER__
 extern int __local_multiple_threads attribute_hidden;
 #   define SINGLE_THREAD_P __builtin_expect (__local_multiple_threads == 0, 1)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/arm/sysdep.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/sysdep.h
@@ -104,7 +104,7 @@
 
 #define ret_ERRVAL PSEUDO_RET_NOERRNO
 
-#if NOT_IN_libc
+#if !IS_IN (libc)
 # define SYSCALL_ERROR __local_syscall_error
 # if RTLD_PRIVATE_ERRNO
 #  define SYSCALL_ERROR_HANDLER					\
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/getpid.c
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/getpid.c
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/getpid.c
@@ -21,7 +21,7 @@
 #include <sysdep.h>
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 static inline __attribute__((always_inline)) pid_t really_getpid (pid_t oldval);
 
 static inline __attribute__((always_inline)) pid_t
@@ -48,7 +48,7 @@ really_getpid (pid_t oldval)
 pid_t
 __getpid (void)
 {
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
   INTERNAL_SYSCALL_DECL (err);
   pid_t result = INTERNAL_SYSCALL (getpid, err, 0);
 #else
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/hppa/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/hppa/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/hppa/nptl/lowlevellock.h
@@ -56,7 +56,7 @@
 /* Initialize locks to zero.  */
 #define LLL_MUTEX_LOCK_INITIALIZER (0)
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/hppa/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/hppa/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/hppa/nptl/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # ifndef NO_ERROR
 #  define NO_ERROR -0x1000
@@ -216,7 +216,7 @@ L(pre_end):						ASM_LINE_SEP	\
 #   define CDISABLE .import __pthread_disable_asynccancel,code ASM_LINE_SEP \
 			bl __pthread_disable_asynccancel,%r2 ASM_LINE_SEP
 #  endif
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  ifdef PIC
 #   define CENABLE .import __libc_enable_asynccancel,code ASM_LINE_SEP \
 			bl __libc_enable_asynccancel,%r2 ASM_LINE_SEP
@@ -246,7 +246,7 @@ L(pre_end):						ASM_LINE_SEP	\
 
 # if IS_IN (libpthread)
 #  define __local_multiple_threads __pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define __local_multiple_threads __libc_multiple_threads
 # elif IS_IN (librt)
 #  define __local_multiple_threads __librt_multiple_threads
@@ -271,7 +271,7 @@ L(pre_end):						ASM_LINE_SEP	\
 # define NO_CANCELLATION 1
 
 #endif
-/* !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt) */
+/* IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt) */
 
 #ifndef __ASSEMBLER__
 # define RTLD_SINGLE_THREAD_P \
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/i486/lowlevellock.S
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/i386/i486/lowlevellock.S
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/i486/lowlevellock.S
@@ -115,7 +115,7 @@ __lll_lock_wait_private:
 	cfi_endproc
 	.size	__lll_lock_wait_private,.-__lll_lock_wait_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_lock_wait
 	.type	__lll_lock_wait,@function
 	.hidden	__lll_lock_wait
@@ -361,7 +361,7 @@ __lll_unlock_wake_private:
 	cfi_endproc
 	.size	__lll_unlock_wake_private,.-__lll_unlock_wake_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_unlock_wake
 	.type	__lll_unlock_wake,@function
 	.hidden	__lll_unlock_wake
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/i386/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/lowlevellock.h
@@ -71,7 +71,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
@@ -245,7 +245,7 @@ LLL_STUB_UNWIND_INFO_END
    value is zero.  In case the operation failed, the cmpxchg instruction
    has loaded the current value of the memory work which is guaranteed
    to be nonzero.  */
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_trylock_asm LOCK_INSTR "cmpxchgl %2, %1"
 #else
 # define __lll_trylock_asm "cmpl $0, %%gs:%P5\n\t" \
@@ -283,7 +283,7 @@ LLL_STUB_UNWIND_INFO_END
 		       : "memory");					      \
      ret; })
 
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_lock_asm_start LOCK_INSTR "cmpxchgl %1, %2\n\t"
 #else
 # define __lll_lock_asm_start "cmpl $0, %%gs:%P6\n\t"			      \
@@ -452,7 +452,7 @@ LLL_STUB_UNWIND_INFO_END
 		       : "memory");					      \
      result; })
 
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_unlock_asm LOCK_INSTR "subl $1, %0\n\t"
 #else
 # define __lll_unlock_asm "cmpl $0, %%gs:%P3\n\t"			      \
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/i386/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				      \
@@ -111,7 +111,7 @@
 # if IS_IN (libpthread)
 #  define CENABLE	call __pthread_enable_asynccancel;
 #  define CDISABLE	call __pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	call __libc_enable_asynccancel;
 #  define CDISABLE	call __libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/i386/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/i386/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/i386/sysdep.h
@@ -36,7 +36,7 @@
 #define SYS_ify(syscall_name)	__NR_##syscall_name
 
 #if defined USE_DL_SYSINFO \
-    && (!defined NOT_IN_libc || IS_IN (libpthread))
+    && (IS_IN (libc) || IS_IN (libpthread))
 # define I386_USE_SYSENTER	1
 #else
 # undef I386_USE_SYSENTER
@@ -117,7 +117,7 @@
 
 # elif defined _LIBC_REENTRANT
 
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/ia64/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/nptl/lowlevellock.h
@@ -50,7 +50,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/ia64/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/nptl/sysdep-cancel.h
@@ -22,11 +22,11 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  define SYSDEP_CANCEL_ERRNO __libc_errno
 # else
 #  define SYSDEP_CANCEL_ERRNO errno
@@ -163,7 +163,7 @@ __GC_##name:								      \
 # if IS_IN (libpthread)
 #  define CENABLE	br.call.sptk.many b0 = __pthread_enable_asynccancel
 #  define CDISABLE	br.call.sptk.many b0 = __pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	br.call.sptk.many b0 = __libc_enable_asynccancel
 #  define CDISABLE	br.call.sptk.many b0 = __libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/sysdep.S
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/ia64/sysdep.S
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/sysdep.S
@@ -34,7 +34,7 @@ ENTRY(__syscall_error)
 	st4	[r2]=r8
 	mov	r8=-1
 #else
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  define SYSCALL_ERROR_ERRNO __libc_errno
 # else
 #  define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/ia64/sysdep.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/ia64/sysdep.h
@@ -61,7 +61,7 @@
 #endif
 
 #if defined USE_DL_SYSINFO \
-	&& (!defined NOT_IN_libc \
+	&& (IS_IN (libc) \
 	    || IS_IN (libpthread) || IS_IN (librt))
 # define IA64_USE_NEW_STUB
 #else
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/bits/m68k-vdso.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/m68k/bits/m68k-vdso.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/bits/m68k-vdso.h
@@ -35,7 +35,7 @@
 
 /* We define __rtld_* copies for rtld.
    We need them visible in libc to initialize.  */
-#  if IS_IN (rtld) || !defined NOT_IN_libc
+#  if IS_IN (rtld) || IS_IN (libc)
 extern void *__rtld___vdso_read_tp;
 extern void *__rtld___vdso_atomic_cmpxchg_32;
 extern void *__rtld___vdso_atomic_barrier;
@@ -44,7 +44,7 @@ extern void *__rtld___vdso_atomic_barrie
 extern void __vdso_read_tp_stub (void);
 extern void __vdso_atomic_cmpxchg_32_stub (void);
 extern void __vdso_atomic_barrier_stub (void);
-#  endif /* IS_IN (rtld) || !NOT_IN_libc */
+#  endif /* IS_IN (rtld) || IS_IN (libc) */
 
 /* RTLD should only use its own copies.  */
 #  if !IS_IN (rtld)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/m68k/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/nptl/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				      \
@@ -103,7 +103,7 @@
 # if IS_IN (libpthread)
 #  define CENABLE	PSEUDO_JMP (__pthread_enable_asynccancel)
 #  define CDISABLE	PSEUDO_JMP (__pthread_disable_asynccancel)
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	PSEUDO_JMP (__libc_enable_asynccancel)
 #  define CDISABLE	PSEUDO_JMP (__libc_disable_asynccancel)
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/m68k/sysdep.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/sysdep.h
@@ -102,7 +102,7 @@ SYSCALL_ERROR_LABEL:							      \
     move.l %d0, %a0;							      \
     rts;
 # elif defined _LIBC_REENTRANT
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/mips64/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/mips/mips64/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/mips64/nptl/sysdep-cancel.h
@@ -27,7 +27,7 @@
    happen before any instructions.  So we use cfi_same_value instead of
    cfi_restore.  */
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 #ifdef __PIC__
 # undef PSEUDO
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/mips/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/nptl/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # ifdef __PIC__
 #  define PSEUDO_CPLOAD .cpload t9;
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/not-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/not-cancel.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/not-cancel.h
@@ -27,7 +27,7 @@
    INLINE_SYSCALL (open, 2, (const char *) (name), (flags))
 
 /* Uncancelable openat.  */
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 extern int __openat_nocancel (int fd, const char *fname, int oflag,
 			      mode_t mode) attribute_hidden;
 extern int __openat64_nocancel (int fd, const char *fname, int oflag,
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc32/sysdep-cancel.h
@@ -23,7 +23,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				\
@@ -84,7 +84,7 @@
 # if IS_IN (libpthread)
 #  define CENABLE	bl __pthread_enable_asynccancel@local
 #  define CDISABLE	bl __pthread_disable_asynccancel@local
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	bl __libc_enable_asynccancel@local
 #  define CDISABLE	bl __libc_disable_asynccancel@local
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/powerpc64/sysdep-cancel.h
@@ -23,7 +23,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # ifdef HAVE_ASM_GLOBAL_DOT_NAME
 #  define DASHDASHPFX(str) .__##str
@@ -107,7 +107,7 @@
 #   define CENABLE	bl JUMPTARGET(__pthread_enable_asynccancel); nop
 #   define CDISABLE	bl JUMPTARGET(__pthread_disable_asynccancel); nop
 #  endif
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  ifdef SHARED
 #   define CENABLE	bl JUMPTARGET(__libc_enable_asynccancel)
 #   define CDISABLE	bl JUMPTARGET(__libc_disable_asynccancel)
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/s390/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/lowlevellock.h
@@ -51,7 +51,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/s390-32/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/s390/s390-32/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/s390-32/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				      \
@@ -78,7 +78,7 @@ L(pseudo_end):
 # if IS_IN (libpthread)
 #  define CENABLE	__pthread_enable_asynccancel
 #  define CDISABLE	__pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	__libc_enable_asynccancel
 #  define CDISABLE	__libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.S
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.S
@@ -31,7 +31,7 @@
 	.text
 ENTRY(__syscall_error)
 #ifndef PIC
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  define SYSCALL_ERROR_ERRNO __libc_errno
 # else
 #  define SYSCALL_ERROR_ERRNO errno
@@ -54,7 +54,7 @@ ENTRY(__syscall_error)
 	br	%r14
 1:	.long	rtld_errno - 0b
 # else
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-32/sysdep.h
@@ -106,7 +106,7 @@
     br    %r14;								      \
 2:  .long rtld_errno-1b
 # elif defined _LIBC_REENTRANT
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/s390-64/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/s390/s390-64/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/s390/s390-64/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				      \
@@ -73,7 +73,7 @@ L(pseudo_end):
 #  define CENABLE	__pthread_enable_asynccancel
 #  define CDISABLE	__pthread_disable_asynccancel
 #  define __local_multiple_threads	__pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	__libc_enable_asynccancel
 #  define CDISABLE	__libc_disable_asynccancel
 #  define __local_multiple_threads	__libc_multiple_threads
@@ -111,7 +111,7 @@ L(pseudo_end):
 #define LR7_6		lg %r7,56+160(%r15); \
 			cfi_restore (%r7);
 
-# if IS_IN (libpthread) || !defined NOT_IN_libc
+# if IS_IN (libpthread) || IS_IN (libc)
 #  ifndef __ASSEMBLER__
 extern int __local_multiple_threads attribute_hidden;
 #   define SINGLE_THREAD_P \
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.S
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.S
@@ -32,7 +32,7 @@
 .text
 ENTRY(__syscall_error)
 #ifndef PIC
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  define SYSCALL_ERROR_ERRNO __libc_errno
 # else
 #  define SYSCALL_ERROR_ERRNO errno
@@ -55,7 +55,7 @@ ENTRY(__syscall_error)
 	lghi	%r2,-1
 	br	%r14
 # else
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/s390/s390-64/sysdep.h
@@ -114,7 +114,7 @@
     lghi  %r2,-1;							      \
     br    %r14
 # elif defined _LIBC_REENTRANT
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.S
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.S
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.S
@@ -172,7 +172,7 @@ __lll_lock_wait_private:
 	cfi_endproc
 	.size	__lll_lock_wait_private,.-__lll_lock_wait_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_lock_wait
 	.type	__lll_lock_wait,@function
 	.hidden	__lll_lock_wait
@@ -454,7 +454,7 @@ __lll_unlock_wake_private:
 	cfi_endproc
 	.size	__lll_unlock_wake_private,.-__lll_unlock_wake_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_unlock_wake
 	.type	__lll_unlock_wake,@function
 	.hidden	__lll_unlock_wake
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/lowlevellock.h
@@ -50,7 +50,7 @@
 #define LLL_SHARED     FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sh/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sh/sysdep-cancel.h
@@ -21,7 +21,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # define _IMM12 #-12
 # define _IMM16 #-16
@@ -108,7 +108,7 @@
 # if IS_IN (libpthread)
 #  define __local_enable_asynccancel	__pthread_enable_asynccancel
 #  define __local_disable_asynccancel	__pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define __local_enable_asynccancel	__libc_enable_asynccancel
 #  define __local_disable_asynccancel	__libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sh/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/sh/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sh/sysdep.h
@@ -116,7 +116,7 @@
 
 # elif defined _LIBC_REENTRANT
 
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sparc/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/lowlevellock.h
@@ -56,7 +56,7 @@ extern void __cpu_relax (void);
 #define BUSY_WAIT_NOP	__cpu_relax ()
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)	\
@@ -71,7 +71,7 @@ __##syscall_name##_nocancel:			\
 # if IS_IN (libpthread)
 #  define CENABLE	call __pthread_enable_asynccancel
 #  define CDISABLE	call __pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	call __libc_enable_asynccancel
 #  define CDISABLE	call __libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc32/sysdep.h
@@ -80,7 +80,7 @@ ENTRY(name);					\
 	 mov	-1, %o0;
 # elif defined _LIBC_REENTRANT
 
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc64/brk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/sparc/sparc64/brk.S
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc64/brk.S
@@ -89,7 +89,7 @@ ENTRY (__brk)
 #endif
 	st	%o0, [%g1]
 #else
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	call	HIDDEN_JUMPTARGET(__errno_location)
 #else
 	call	__errno_location
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)	\
@@ -69,7 +69,7 @@ __##syscall_name##_nocancel:			\
 # if IS_IN (libpthread)
 #  define CENABLE	call __pthread_enable_asynccancel
 #  define CDISABLE	call __pthread_disable_asynccancel
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	call __libc_enable_asynccancel
 #  define CDISABLE	call __libc_disable_asynccancel
 # elif IS_IN (librt)
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/sparc/sparc64/sysdep.h
@@ -90,7 +90,7 @@ ENTRY(name);					\
 	 mov	-1, %o0;
 # elif defined _LIBC_REENTRANT
 
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/tile/nptl/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 /* Allow hacking in some extra code if desired. */
 #ifndef PSEUDO_EXTRA
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/tile/sysdep.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/sysdep.h
@@ -45,7 +45,7 @@
 #ifndef PIC
 /* For static code, on error jump to __syscall_error directly. */
 # define SYSCALL_ERROR_NAME __syscall_error
-#elif !defined NOT_IN_libc || IS_IN (libpthread)
+#elif IS_IN (libc) || IS_IN (libpthread)
 /* Use the internal name for libc/libpthread shared objects. */
 # define SYSCALL_ERROR_NAME __GI___syscall_error
 #else
@@ -205,7 +205,7 @@
 #endif /* not __ASSEMBLER__ */
 
 /* Pointer mangling support.  */
-#if defined NOT_IN_libc && IS_IN (rtld)
+#if !IS_IN (libc) && IS_IN (rtld)
 /* We cannot use the thread descriptor because in ld.so we use setjmp
    earlier than the descriptor is initialized.  */
 #else
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/waitpid.S
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/tile/nptl/waitpid.S
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/waitpid.S
@@ -1,7 +1,7 @@
 /*
 extern pid_t __waitpid_nocancel (pid_t, int *, int) attribute_hidden;
 */
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 /* Call __NR_wait4, providing fourth argument (struct rusage *) as NULL. */
 #define PSEUDO_EXTRA move r3, zero;
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.S
@@ -108,7 +108,7 @@ __lll_lock_wait_private:
 	cfi_endproc
 	.size	__lll_lock_wait_private,.-__lll_lock_wait_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_lock_wait
 	.type	__lll_lock_wait,@function
 	.hidden	__lll_lock_wait
@@ -348,7 +348,7 @@ __lll_unlock_wake_private:
 	cfi_endproc
 	.size	__lll_unlock_wake_private,.-__lll_unlock_wake_private
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 	.globl	__lll_unlock_wake
 	.type	__lll_unlock_wake,@function
 	.hidden	__lll_unlock_wake
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/lowlevellock.h
@@ -72,7 +72,7 @@
 
 #ifndef __ASSEMBLER__
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
@@ -243,7 +243,7 @@ LLL_STUB_UNWIND_INFO_END
    value is zero.  In case the operation failed, the cmpxchg instruction
    has loaded the current value of the memory work which is guaranteed
    to be nonzero.  */
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_trylock_asm LOCK_INSTR "cmpxchgl %2, %1"
 #else
 # define __lll_trylock_asm "cmpl $0, __libc_multiple_threads(%%rip)\n\t"      \
@@ -280,7 +280,7 @@ LLL_STUB_UNWIND_INFO_END
 		       : "memory");					      \
      ret; })
 
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_lock_asm_start LOCK_INSTR "cmpxchgl %4, %2\n\t"		      \
 			      "jnz 1f\n\t"
 #else
@@ -450,7 +450,7 @@ LLL_STUB_UNWIND_INFO_END
 		       : "memory", "cx", "cc", "r10", "r11");		      \
      result; })
 
-#if defined NOT_IN_libc || defined UP
+#if !IS_IN (libc) || defined UP
 # define __lll_unlock_asm_start LOCK_INSTR "decl %0\n\t"		      \
 				"jne 1f\n\t"
 #else
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/x86_64/sysdep-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/x86_64/sysdep-cancel.h
@@ -22,7 +22,7 @@
 # include <nptl/pthreadP.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 /* The code to disable cancellation depends on the fact that the called
    functions are special.  They don't modify registers other than %rax
@@ -63,7 +63,7 @@
 #  define CENABLE	call __pthread_enable_asynccancel;
 #  define CDISABLE	call __pthread_disable_asynccancel;
 #  define __local_multiple_threads __pthread_multiple_threads
-# elif !defined NOT_IN_libc
+# elif IS_IN (libc)
 #  define CENABLE	call __libc_enable_asynccancel;
 #  define CDISABLE	call __libc_disable_asynccancel;
 #  define __local_multiple_threads __libc_multiple_threads
@@ -74,7 +74,7 @@
 #  error Unsupported library
 # endif
 
-# if IS_IN (libpthread) || !defined NOT_IN_libc
+# if IS_IN (libpthread) || IS_IN (libc)
 #  ifndef __ASSEMBLER__
 extern int __local_multiple_threads attribute_hidden;
 #   define SINGLE_THREAD_P \
Index: glibc-2.17-c758a686/sysdeps/unix/sysv/linux/x86_64/sysdep.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/unix/sysv/linux/x86_64/sysdep.h
+++ glibc-2.17-c758a686/sysdeps/unix/sysv/linux/x86_64/sysdep.h
@@ -117,7 +117,7 @@
   neg %eax;					\
   movl %eax, (%rcx)
 # else
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define SYSCALL_ERROR_ERRNO __libc_errno
 #  else
 #   define SYSCALL_ERROR_ERRNO errno
Index: glibc-2.17-c758a686/sysdeps/wordsize-32/symbol-hacks.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/wordsize-32/symbol-hacks.h
+++ glibc-2.17-c758a686/sysdeps/wordsize-32/symbol-hacks.h
@@ -23,7 +23,7 @@
    therefore we get PLTs.  Unnecessarily so.  Changing gcc is a big
    task which might not be worth it so we play tricks with the
    assembler.  */
-#if !defined __ASSEMBLER__ && !defined in_divdi3_c && !defined NOT_IN_libc && defined SHARED
+#if !defined __ASSEMBLER__ && !defined in_divdi3_c && IS_IN (libc) && defined SHARED
 asm ("__divdi3 = __divdi3_internal");
 asm ("__udivdi3 = __udivdi3_internal");
 asm ("__moddi3 = __moddi3_internal");
Index: glibc-2.17-c758a686/sysdeps/x86_64/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/memcpy.S
@@ -30,7 +30,7 @@
 #  define RETVAL	(0)
 #else
 #  define RETVAL	(-8)
-#  if defined SHARED && !defined USE_MULTIARCH && !defined NOT_IN_libc
+#  if defined SHARED && !defined USE_MULTIARCH && IS_IN (libc)
 #    define memcpy	__memcpy
 #    undef libc_hidden_builtin_def
 #    define libc_hidden_builtin_def(name) \
@@ -44,7 +44,7 @@
 
         .text
 
-#if defined PIC && !defined NOT_IN_libc
+#if defined PIC && IS_IN (libc)
 ENTRY_CHK (__memcpy_chk)
 
 	cmpq	%rdx, %rcx
@@ -253,14 +253,14 @@ L(32after):
 /* Handle blocks smaller than 1/2 L1. */
 
 L(fasttry):				/* first 1/2 L1 */
-#ifndef NOT_IN_libc			/* only up to this algorithm outside of libc.so */
+#if IS_IN (libc)			/* only up to this algorithm outside of libc.so */
 	mov	__x86_64_data_cache_size_half(%rip), %R11_LP
 	cmpq	%rdx, %r11		/* calculate the smaller of */
 	cmovaq	%rdx, %r11		/* remaining bytes and 1/2 L1 */
 #endif
 
 L(fast):				/* good ol' MOVS */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	movq	%r11, %rcx
 	andq	$-8, %r11
 #else
@@ -275,7 +275,7 @@ L(fast):				/* good ol' MOVS */
 	.p2align 4,, 4
 
 L(fastskip):
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	subq	%r11, %rdx		/* check for more */
 	testq	$-8, %rdx
 	jnz	L(fastafter)
@@ -294,7 +294,7 @@ L(fastskip):
 #endif
 	retq				/* exit */
 
-#ifndef NOT_IN_libc			/* none of the algorithms below for RTLD */
+#if IS_IN (libc)			/* none of the algorithms below for RTLD */
 
 	.p2align 4
 
@@ -570,13 +570,13 @@ L(NTskip):
 #endif
 	retq				/* exit */
 
-#endif /* !NOT_IN_libc */
+#endif /* IS_IN (libc) */
 
 END(memcpy)
 
 #ifndef USE_AS_MEMPCPY
 libc_hidden_builtin_def (memcpy)
-# if defined SHARED && !defined USE_MULTIARCH && !defined NOT_IN_libc
+# if defined SHARED && !defined USE_MULTIARCH && IS_IN (libc)
 #  undef memcpy
 #  include <shlib-compat.h>
 versioned_symbol (libc, __memcpy, memcpy, GLIBC_2_14);
Index: glibc-2.17-c758a686/sysdeps/x86_64/memmove.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/memmove.c
+++ glibc-2.17-c758a686/sysdeps/x86_64/memmove.c
@@ -17,7 +17,7 @@
 
 #include "string/memmove.c"
 
-#if !defined memmove && !defined NOT_IN_libc
+#if !defined memmove && IS_IN (libc)
 #include <shlib-compat.h>
 
 #if SHLIB_COMPAT (libc, GLIBC_2_2_5, GLIBC_2_14)
Index: glibc-2.17-c758a686/sysdeps/x86_64/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/memset.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/memset.S
@@ -23,7 +23,7 @@
 #define __STOS_UPPER_BOUNDARY	$65536
 
 	.text
-#if !defined NOT_IN_libc && !defined USE_MULTIARCH
+#if IS_IN (libc) && !defined USE_MULTIARCH
 ENTRY(__bzero)
 	mov	%rsi,%rdx	/* Adjust parameter.  */
 	xorl	%esi,%esi	/* Fill with 0s.  */
@@ -32,7 +32,7 @@ END(__bzero)
 weak_alias (__bzero, bzero)
 #endif
 
-#if defined PIC && !defined NOT_IN_libc
+#if defined PIC && IS_IN (libc)
 ENTRY_CHK (__memset_chk)
 	cmpq	%rdx, %rcx
 	jb	HIDDEN_JUMPTARGET (__chk_fail)
@@ -1354,7 +1354,7 @@ L(8byte_nt_move_skip):
 END (memset)
 libc_hidden_builtin_def (memset)
 
-#if defined PIC && !defined NOT_IN_libc && !defined USE_MULTIARCH
+#if defined PIC && IS_IN (libc) && !defined USE_MULTIARCH
 strong_alias (__memset_chk, __memset_zero_constant_len_parameter)
 	.section .gnu.warning.__memset_zero_constant_len_parameter
 	.string "memset used with constant zero length parameter; this could be due to transposed parameters"
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/init-arch.h
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/init-arch.h
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/init-arch.h
@@ -141,7 +141,7 @@ extern void __init_cpu_features (void) a
 extern const struct cpu_features *__get_cpu_features (void)
      __attribute__ ((const));
 
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  define __get_cpu_features()	(&__cpu_features)
 # endif
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp-sse4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcmp-sse4.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp-sse4.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcmp-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcmp.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcmp.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(memcmp)
 	.type	memcmp, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy-ssse3-back.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcpy-ssse3-back.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy-ssse3-back.S
@@ -19,7 +19,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc \
+#if IS_IN (libc) \
     && (defined SHARED \
         || defined USE_AS_MEMMOVE \
 	|| !defined USE_MULTIARCH)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy-ssse3.S
@@ -19,7 +19,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc \
+#if IS_IN (libc) \
     && (defined SHARED \
         || defined USE_AS_MEMMOVE \
 	|| !defined USE_MULTIARCH)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy.S
@@ -25,7 +25,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  In static binaries we need memcpy before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(__new_memcpy)
 	.type	__new_memcpy, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memcpy_chk.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memcpy_chk.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  There are no multiarch memcpy functions for static binaries.
  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__memcpy_chk)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memmove.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memmove.c
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memmove.c
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define MEMMOVE __memmove_sse2
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -39,7 +39,7 @@ extern __typeof (__redirect_memmove) __m
 
 #include "string/memmove.c"
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <shlib-compat.h>
 # include "init-arch.h"
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/mempcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/mempcpy.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/mempcpy.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  In static binaries we need mempcpy before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 ENTRY(__mempcpy)
 	.type	__mempcpy, @gnu_indirect_function
 	cmpl	$0, KIND_OFFSET+__cpu_features(%rip)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/mempcpy_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/mempcpy_chk.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/mempcpy_chk.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in lib and for
    DSO.  There are no multiarch mempcpy functions for static binaries.
  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 	.text
 ENTRY(__mempcpy_chk)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memset.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset.S
@@ -21,7 +21,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 ENTRY(memset)
 	.type	memset, @gnu_indirect_function
 	cmpl	$0, __cpu_features+KIND_OFFSET(%rip)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset_chk.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memset_chk.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset_chk.S
@@ -21,7 +21,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 ENTRY(__memset_chk)
 	.type	__memset_chk, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat-sse2-unaligned.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcat-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcat.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcat.S
@@ -43,7 +43,7 @@
 
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(STRCAT)
 	.type	STRCAT, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strchr-sse2-no-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strchr-sse2-no-bsf.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strchr-sse2-no-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef  NOT_IN_libc
+#if IS_IN (libc)
 
 # include <sysdep.h>
 # include "asm-syntax.h"
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strchr.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strchr.S
@@ -21,7 +21,7 @@
 
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(strchr)
 	.type	strchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcmp-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcmp-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcmp-ssse3.S
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define USE_SSSE3 1
 # define STRCMP __strcmp_ssse3
 # include "../strcmp.S"
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcmp.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcmp.S
@@ -79,7 +79,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strncmp in static library since we
    need strncmp before the initialization happened.  */
-#if (defined SHARED || !defined USE_AS_STRNCMP) && !defined NOT_IN_libc
+#if (defined SHARED || !defined USE_AS_STRNCMP) && IS_IN (libc)
 	.text
 ENTRY(STRCMP)
 	.type	STRCMP, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy-sse2-unaligned.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # ifndef USE_AS_STRCAT
 #  include <sysdep.h>
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 # ifndef USE_AS_STRCAT
 #  include <sysdep.h>
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcpy.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcpy.S
@@ -57,7 +57,7 @@
 
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(STRCPY)
 	.type	STRCPY, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcspn.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strcspn.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strcspn.S
@@ -41,7 +41,7 @@
 /* Define multiple versions only for the definition in libc.  Don't
    define multiple versions for strpbrk in static library since we
    need strpbrk before the initialization happened.  */
-#if (defined SHARED || !defined USE_AS_STRPBRK) && !defined NOT_IN_libc
+#if (defined SHARED || !defined USE_AS_STRPBRK) && IS_IN (libc)
 	.text
 ENTRY(STRCSPN)
 	.type	STRCSPN, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strspn.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strspn.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strspn.S
@@ -26,7 +26,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(strspn)
 	.type	strspn, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/wcscpy-c.c
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy-c.c
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define wcscpy  __wcscpy_sse2
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy-ssse3.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/wcscpy-ssse3.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy-ssse3.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <sysdep.h>
 
 	.section .text.ssse3,"ax",@progbits
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/wcscpy.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wcscpy.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 	.text
 ENTRY(wcscpy)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wmemcmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/wmemcmp-c.c
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wmemcmp-c.c
@@ -1,4 +1,4 @@
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <wchar.h>
 
 # define WMEMCMP  __wmemcmp_sse2
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wmemcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/wmemcmp.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/wmemcmp.S
@@ -22,7 +22,7 @@
 #include <init-arch.h>
 
 /* Define multiple versions only for the definition in libc. */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(wmemcmp)
 	.type	wmemcmp, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/strcmp.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/strcmp.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/strcmp.S
@@ -129,7 +129,7 @@ libc_hidden_def (__strncasecmp)
 #endif
 
 ENTRY (BP_SYM (STRCMP))
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 /* Simple version since we can't use SSE registers in ld.so.  */
 L(oop):	movb	(%rdi), %al
 	cmpb	(%rsi), %al
@@ -147,7 +147,7 @@ L(neq):	movl	$1, %eax
 	cmovbl	%ecx, %eax
 	ret
 END (BP_SYM (STRCMP))
-#else	/* NOT_IN_libc */
+#else	/* !IS_IN (libc) */
 # ifdef USE_AS_STRCASECMP_L
 	/* We have to fall back on the C implementation for locales
 	   with encodings not matching ASCII for single bytes.  */
@@ -2303,5 +2303,5 @@ LABEL(unaligned_table):
 	.int	LABEL(ashr_14) - LABEL(unaligned_table)
 	.int	LABEL(ashr_15) - LABEL(unaligned_table)
 	.int	LABEL(ashr_0) - LABEL(unaligned_table)
-#endif /* NOT_IN_libc */
+#endif /* !IS_IN (libc) */
 libc_hidden_builtin_def (STRCMP)
Index: glibc-2.17-c758a686/ChangeLog
===================================================================
--- glibc-2.17-c758a686.orig/ChangeLog
+++ glibc-2.17-c758a686/ChangeLog
@@ -4849,7 +4849,7 @@
 
 	* libio/genops.c (_IO_unbuffer_write): Conditionalize locking code on
 	[_IO_MTSAFE_IO].
-	* libio/libioP.h [!_IO_MTSAFE_IO && !NOT_IN_libc]
+	* libio/libioP.h [!_IO_MTSAFE_IO && !IS_IN (libc)]
 	(_IO_acquire_lock, _IO_acquire_lock_clear_flags2, _IO_release_lock):
 	New macros.
 
@@ -5014,7 +5014,7 @@
 	including <string.h>.
 
 	* sysdeps/x86_64/multiarch/memmove.c: Don't include <stddef.h>.
-	[!NOT_IN_libc]: Move #define and #undef of memmove to just before
+	[!IS_IN (libc)]: Move #define and #undef of memmove to just before
 	and after including <string.h>.  Move declarations of
 	__memmove_sse2, __memmove_ssse3, and __memmove_ssse3_back
 	to before #include "string/memmove.c".
@@ -7322,7 +7322,7 @@
 2012-05-30  Richard Henderson  <rth@twiddle.net>
 
 	* sysdeps/unix/make-syscalls.sh: Protect symbol_version output
-	with #ifndef NOT_IN_libc.
+	with #if IS_IN (libc).
 
 	* scripts/abilist.awk: Accept 8 fields.  Handle Alpha functions
 	marked to avoid plt entry.
Index: glibc-2.17-c758a686/ChangeLog.13
===================================================================
--- glibc-2.17-c758a686.orig/ChangeLog.13
+++ glibc-2.17-c758a686/ChangeLog.13
@@ -2465,7 +2465,7 @@
 	($(objpfx)errlist.d): Depend on $(..)sysdeps/gnu/errlist-compat.c.
 	* sysdeps/gnu/errlist.awk: Make output define _sys_errlist_internal
 	and _sys_nerr_internal instead of anything else.  Make it include
-	"errlist-compat.c" if [!NOT_IN_libc && !ERRLIST_NO_COMPAT].
+	"errlist-compat.c" if [!IS_IN (libc) && !ERRLIST_NO_COMPAT].
 	Make it emit some asm magic if [EMIT_ERR_MAX].
 	* sysdeps/gnu/errlist.c: Regenerated.
 	* sysdeps/gnu/errlist-compat.awk: New file.
Index: glibc-2.17-c758a686/ChangeLog.14
===================================================================
--- glibc-2.17-c758a686.orig/ChangeLog.14
+++ glibc-2.17-c758a686/ChangeLog.14
@@ -2058,13 +2058,13 @@
 	* sysdeps/powerpc/powerpc64/__longjmp-common.S: New file.
 	* sysdeps/powerpc/powerpc64/__longjmp.S [NOT_IN_libc](__longjmp):
 	Non-versioned __longjmp for rtld-__longjmp.
-	[!NOT_IN_libc](__vmx__longjmp): Add VMX reg support and define as
+	[!IS_IN (libc)](__vmx__longjmp): Add VMX reg support and define as
 	default version of __longjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_3, GLIBC_2_3_4)]
 	(__novmx__longjmp): Original version of __longjmp.
 	* sysdeps/powerpc/powerpc64/bsd-_setjmp.S [NOT_IN_libc](_setjmp):
 	Non-versioned _setjmp for rtld-_setjmp.
-	[!NOT_IN_libc](__vmx_setjmp): Branch to __vmx__sigsetjmp and define
+	[!IS_IN (libc)](__vmx_setjmp): Branch to __vmx__sigsetjmp and define
 	as default version of _setjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_3, GLIBC_2_3_4)]
 	(__novmx_setjmp): Original version of _setjmp.
@@ -2075,7 +2075,7 @@
 	* sysdeps/powerpc/powerpc64/setjmp-common.S: New file.
 	* sysdeps/powerpc/powerpc64/setjmp.S [NOT_IN_libc](__setjmp):
 	Non-versioned __sigsetjmp for rtld-setjmp.
-	[!NOT_IN_libc](__vmx__sigsetjmp): Add VMX reg support and define
+	[!IS_IN (libc)](__vmx__sigsetjmp): Add VMX reg support and define
 	as default version of __sigsetjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_3, GLIBC_2_3_4)]
 	(__novmx__sigsetjmp): Original version of __sigsetjmp.
@@ -2083,13 +2083,13 @@
 	* sysdeps/powerpc/powerpc32/__longjmp-common.S: New File
 	* sysdeps/powerpc/powerpc32/__longjmp.S [NOT_IN_libc](__longjmp):
 	Non-versioned __longjmp for rtld-__longjmp.
-	[!NOT_IN_libc](__vmx__longjmp): Add VMX reg support and define as
+	[!IS_IN (libc)](__vmx__longjmp): Add VMX reg support and define as
 	default version of __longjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)]
 	(__novmx__longjmp): Original version of __longjmp.
 	* sysdeps/powerpc/powerpc32/bsd-_setjmp.S [NOT_IN_libc](_setjmp):
 	Non-versioned _setjmp for rtld-_setjmp.
-	[!NOT_IN_libc](__vmx_setjmp): Branch to __vmx__sigsetjmp and define
+	[!IS_IN (libc)](__vmx_setjmp): Branch to __vmx__sigsetjmp and define
 	as default version of _setjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)]
 	(__novmx_setjmp): Original version of _setjmp.
@@ -2100,21 +2100,21 @@
 	* sysdeps/powerpc/powerpc32/fpu/__longjmp-common.S: New file.
 	* sysdeps/powerpc/powerpc32/fpu/__longjmp.S [NOT_IN_libc](__longjmp):
 	Non-versioned __longjmp for rtld-__longjmp.
-	[!NOT_IN_libc](__vmx__longjmp): Add VMX reg support and define as
+	[!IS_IN (libc)](__vmx__longjmp): Add VMX reg support and define as
 	default version of __longjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)]
 	(__novmx__longjmp): Original version of __longjmp.
 	* sysdeps/powerpc/powerpc32/fpu/setjmp-common.S: New file.
 	* sysdeps/powerpc/powerpc32/fpu/setjmp.S [NOT_IN_libc](__setjmp):
 	Non-versioned __sigsetjmp for rtld-setjmp.
-	[!NOT_IN_libc](__vmx__sigsetjmp): Add VMX reg support and define
+	[!IS_IN (libc)](__vmx__sigsetjmp): Add VMX reg support and define
 	as default version of __sigsetjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)]
 	(__novmx__sigsetjmp): Original version of __sigsetjmp.
 	* sysdeps/powerpc/powerpc32/setjmp-common.S: New file.
 	* sysdeps/powerpc/powerpc32/setjmp.S [NOT_IN_libc](__setjmp):
 	Non-versioned __sigsetjmp for rtld-setjmp.
-	[!NOT_IN_libc](__vmx__sigsetjmp): Add VMX reg support and define
+	[!IS_IN (libc)](__vmx__sigsetjmp): Add VMX reg support and define
 	as default version of __sigsetjmp.
 	[SHARED && SHLIB_COMPAT (libc, GLIBC_2_0, GLIBC_2_3_4)]
 	(__novmx__sigsetjmp): Original version of __sigsetjmp.
Index: glibc-2.17-c758a686/csu/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/csu/Makefile
+++ glibc-2.17-c758a686/csu/Makefile
@@ -146,13 +146,13 @@ $(objpfx)version-info.h: $(common-objpfx
 	   linux*) version=`(printf '%s\n%s\n' \
 				    '#include <linux/version.h>' \
 				    UTS_RELEASE \
-			     | $(CC) $(CPPFLAGS) -O -E -P - -DNOT_IN_libc=1 | \
+			     | $(CC) $(CPPFLAGS) -O -E -P - | \
 			     sed -e 's/"\([^"]*\)".*/\1/p' -e d) 2>/dev/null`;\
 		   if [ -z "$$version" ]; then \
 		     version=`(printf '%s\n%s\n' \
 				      '#include <linux/version.h>' \
 				       LINUX_VERSION_CODE \
-			       | $(CC) $(CPPFLAGS) -O -E -P - -DNOT_IN_libc=1 \
+			       | $(CC) $(CPPFLAGS) -O -E -P - \
 			       | sed -n -e '/^[123456789].*/p' \
 			       | awk '{v=$$1; \
 				       printf("%d.%d.%d\n", \
Index: glibc-2.17-c758a686/nptl/ChangeLog
===================================================================
--- glibc-2.17-c758a686.orig/nptl/ChangeLog
+++ glibc-2.17-c758a686/nptl/ChangeLog
@@ -11683,7 +11683,7 @@
 2002-12-16  Jakub Jelinek  <jakub@redhat.com>
 
 	* libc-cancellation.c: Guard both function with
-	#if !defined NOT_IN_libc.
+	#if IS_IN (libc).
 	* Makefile (libpthread-routines): Use ptw-, not pt- prefix for the
 	automatically provided pthread wrappers.
 	* pthreadP.h (LIBC_CANCEL_ASYNC, LIBC_CANCEL_RESET): Define to
Index: glibc-2.17-c758a686/nptl/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/nptl/Makefile
+++ glibc-2.17-c758a686/nptl/Makefile
@@ -134,8 +134,6 @@ libpthread-routines = nptl-init vars eve
 libpthread-shared-only-routines = version pt-allocrtsig unwind-forcedunwind
 libpthread-static-only-routines = pthread_atfork
 
-CFLAGS-pthread_atfork.c = -DNOT_IN_libc
-
 # Since cancellation handling is in large parts handled using exceptions
 # we have to compile some files with exception handling enabled, some
 # even with asynchronous unwind tables.
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/not-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/i386/not-cancel.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/i386/not-cancel.h
@@ -19,7 +19,7 @@
 
 #include <sysdep.h>
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 extern int __open_nocancel (const char *, int, ...) attribute_hidden;
 extern int __close_nocancel (int) attribute_hidden;
 extern int __read_nocancel (int, void *, size_t) attribute_hidden;
Index: glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/nptl/sysdeps/unix/sysv/linux/powerpc/lowlevellock.h
+++ glibc-2.17-c758a686/nptl/sysdeps/unix/sysv/linux/powerpc/lowlevellock.h
@@ -52,7 +52,7 @@
 #define LLL_PRIVATE	0
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/aarch64/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/aarch64/nptl/lowlevellock.h
@@ -49,7 +49,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/alpha/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/alpha/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/alpha/nptl/lowlevellock.h
@@ -50,7 +50,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/am33/linuxthreads/sysdep-cancel.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/am33/linuxthreads/sysdep-cancel.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/am33/linuxthreads/sysdep-cancel.h
@@ -23,7 +23,7 @@
 # include <linuxthreads/internals.h>
 #endif
 
-#if !defined NOT_IN_libc || IS_IN (libpthread) || IS_IN (librt)
+#if IS_IN (libc) || IS_IN (libpthread) || IS_IN (librt)
 
 # undef PSEUDO
 # define PSEUDO(name, syscall_name, args)				\
@@ -103,7 +103,7 @@
 #  define CDISABLE	call +__libc_disable_asynccancel,[],0;
 # endif
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 # define __local_multiple_threads __libc_multiple_threads
 #elif IS_IN (libpthread)
 # define __local_multiple_threads __pthread_multiple_threads
@@ -118,7 +118,7 @@
 				   p_header.data.multiple_threads) == 0, 1)
 #  else
 extern int __local_multiple_threads
-#   if !defined NOT_IN_libc || IS_IN (libpthread)
+#   if IS_IN (libc) || IS_IN (libpthread)
   attribute_hidden;
 #   else
   ;
@@ -130,7 +130,7 @@ extern int __local_multiple_threads
 #   define SINGLE_THREAD_P \
 	mov (+__local_multiple_threads),d0; \
 	cmp 0,d0
-#  elif !defined NOT_IN_libc || IS_IN (libpthread)
+#  elif IS_IN (libc) || IS_IN (libpthread)
 #   define SINGLE_THREAD_P \
 	movm [a2],(sp); \
      1: mov pc,a2; \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/arm/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/arm/nptl/lowlevellock.h
@@ -48,7 +48,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/m68k/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/m68k/nptl/lowlevellock.h
@@ -50,7 +50,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/mips/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/mips/nptl/lowlevellock.h
@@ -48,7 +48,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/lowlevellock.h
===================================================================
--- glibc-2.17-c758a686.orig/ports/sysdeps/unix/sysv/linux/tile/nptl/lowlevellock.h
+++ glibc-2.17-c758a686/ports/sysdeps/unix/sysv/linux/tile/nptl/lowlevellock.h
@@ -50,7 +50,7 @@
 #define LLL_SHARED	FUTEX_PRIVATE_FLAG
 
 
-#if !defined NOT_IN_libc || IS_IN (rtld)
+#if IS_IN (libc) || IS_IN (rtld)
 /* In libc.so or ld.so all futexes are private.  */
 # ifdef __ASSUME_PRIVATE_FUTEX
 #  define __lll_private_flag(fl, private) \
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/memrchr-ppc32.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/power4/multiarch/memrchr-ppc32.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/memrchr-ppc32.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define MEMRCHR  __memrchr_ppc
 # include <string.h>
 extern void *__memrchr_ppc (const void *, int, size_t);
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcschr-ppc32.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/power4/multiarch/wcschr-ppc32.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcschr-ppc32.c
@@ -17,7 +17,7 @@
 
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # ifdef SHARED
 #   undef libc_hidden_def
 #   define libc_hidden_def(name)  \
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcscpy-ppc32.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/power4/multiarch/wcscpy-ppc32.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcscpy-ppc32.c
@@ -17,7 +17,7 @@
 
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define WCSCPY  __wcscpy_ppc
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcsrchr-ppc32.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/powerpc/powerpc32/power4/multiarch/wcsrchr-ppc32.c
+++ glibc-2.17-c758a686/sysdeps/powerpc/powerpc32/power4/multiarch/wcsrchr-ppc32.c
@@ -17,7 +17,7 @@
 
 #include <wchar.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # define WCSRCHR  __wcsrchr_ppc
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memccpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define MEMCCPY  __memccpy_c
 # undef weak_alias
 # define weak_alias(a, b)
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memccpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -153,4 +153,4 @@ ENTRY(__memccpy_vx)
 	lghi	%r2,0		/* Return null.  */
 	br	%r14
 END(__memccpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memccpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memccpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__memccpy, memccpy)
 
 #else
 # include <string/memccpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -154,6 +154,6 @@ END(__memchr_vx)
 # define memchr __memchr_c
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) strong_alias(__memchr_c, __GI_memchr)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
 
 #include <memchr.S>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memrchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define MEMRCHR  __memrchr_c
 
 # include <string.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memrchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -157,4 +157,4 @@ ENTRY(__memrchr_vx)
 	clgijhe	%r4,64,.Lloop64	/* If n >= 64 -> loop64.  */
 	j	.Llt64
 END(__memrchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/memrchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/memrchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__memrchr, memrchr)
 
 #else
 # include <string/memrchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/rawmemchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 
 # define RAWMEMCHR  __rawmemchr_c
@@ -31,4 +31,4 @@
 extern __typeof (rawmemchr) __rawmemchr_c attribute_hidden;
 
 # include <string/rawmemchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/rawmemchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -89,4 +89,4 @@ ENTRY(__rawmemchr_vx)
 	la	%r2,0(%r5,%r2)	/* Return pointer to character.  */
 	br	%r14
 END(__rawmemchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/rawmemchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/rawmemchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__rawmemchr, rawmemchr)
 
 #else
 # include <string/rawmemchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT &&!defined NOT_IN_libc ) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT &&IS_IN (libc) ) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpcpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STPCPY  __stpcpy_c
 # undef libc_hidden_def
 # undef weak_alias
@@ -31,4 +31,4 @@
 
 
 # include <string/stpcpy.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpcpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -101,4 +101,4 @@ ENTRY(__stpcpy_vx)
 	la	%r2,0(%r5,%r2)	/* Return pointer to zero.  */
 	br	%r14
 END(__stpcpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpcpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -26,4 +26,4 @@ libc_hidden_builtin_def (stpcpy)
 
 #else
 # include <string/stpcpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpncpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STPNCPY  __stpncpy_c
 # ifdef SHARED
 #  undef libc_hidden_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/stpncpy.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpncpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -197,4 +197,4 @@ ENTRY(__stpncpy_vx)
 	vl	%v16,0(%r5,%r3)	/* Load s.  */
 	j	.Llt64
 END(__stpncpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/stpncpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/stpncpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__stpncpy, stpncpy)
 
 #else
 # include <string/stpncpy.c>
-#endif  /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif  /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcat-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRCAT  __strcat_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strcat.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcat-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -158,4 +158,4 @@ ENTRY(__strcat_vx)
 	lgr	%r2,%r0		/* Load saved dest-ptr.  */
 	br	%r14
 END(__strcat_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcat.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcat.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strcat, strcat)
 
 #else
 # include <string/strcat.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRCHR  __strchr_c
 # undef weak_alias
 # ifdef SHARED
@@ -26,4 +26,4 @@
 # endif /* SHARED */
 
 # include <string/strchr.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -97,4 +97,4 @@ ENTRY(__strchr_vx)
 	lghi	%r2,0		/* Return null if character not found.  */
 	br	%r14
 END(__strchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (strchr, index)
 
 #else
 # include <string/strchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchrnul-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRCHRNUL  __strchrnul_c
 # define __strchrnul STRCHRNUL
 # undef weak_alias
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchrnul-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -90,4 +90,4 @@ ENTRY(__strchrnul_vx)
 .Lend:
 	br	%r14
 END(__strchrnul_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strchrnul.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strchrnul.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__strchrnul, strchrnul)
 
 #else
 # include <string/strchrnul.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcmp-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcmp-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcmp-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -111,6 +111,6 @@ END(__strcmp_vx)
 # define strcmp __strcmp_c
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) strong_alias(__strcmp_c, __GI_strcmp)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
 
 #include <strcmp.S>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -103,7 +103,7 @@ END(__strcpy_vx)
 # define strcpy __strcpy_c
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) strong_alias(__strcpy_c, __GI_strcpy)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
 
 /* Include mvst-strcpy-implementation in s390-32/s390-64 subdirectory.  */
 #include <strcpy.S>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcspn-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRCSPN  __strcspn_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strcspn.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcspn-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -278,4 +278,4 @@ ENTRY(__strcspn_vx)
 	vlgvg	%r9,%v31,1
 	br	%r14
 END(__strcspn_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strcspn.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strcspn.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strcspn, strcspn)
 
 #else
 # include <string/strcspn.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strlen-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRLEN  __strlen_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strlen.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strlen-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -81,4 +81,4 @@ ENTRY(__strlen_vx)
 	algr	%r2,%r5
 	br	%r14
 END(__strlen_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strlen.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strlen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strlen, strlen)
 
 #else
 # include <string/strlen.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncat-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRNCAT  __strncat_c
 
 # include <string/strncat.c>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncat-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -236,4 +236,4 @@ ENTRY(__strncat_vx)
 	vl	%v16,0(%r5,%r3)	/* Load s.  */
 	j	.Lcpy_lt64
 END(__strncat_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncat.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncat.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strncat, strncat)
 
 #else
 # include <string/strncat.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncmp-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRNCMP  __strncmp_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strncmp.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncmp-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -134,4 +134,4 @@ ENTRY(__strncmp_vx)
 	lghi	%r2,0
 	br	%r14
 END(__strncmp_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -27,4 +27,4 @@ s390_vx_libc_ifunc2 (__strncmp, strncmp)
 
 #else
 # include <string/strncmp.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -201,7 +201,7 @@ END(__strncpy_vx)
 # define strncpy __strncpy_c
 # undef libc_hidden_builtin_def
 # define libc_hidden_builtin_def(name) strong_alias(__strncpy_c, __GI_strncpy)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
 
 /* Include strncpy-implementation in s390-32/s390-64 subdirectory.  */
 #include <strncpy.S>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strncpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strncpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strnlen-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRNLEN  __strnlen_c
 # ifdef SHARED
 #  undef libc_hidden_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strnlen.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strnlen-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -131,4 +131,4 @@ ENTRY(__strnlen_vx)
 
 	j	.Llt64
 END(__strnlen_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strnlen.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strnlen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -26,4 +26,4 @@ libc_hidden_def (strnlen)
 
 #else
 # include <string/strnlen.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strpbrk-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRPBRK  __strpbrk_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strpbrk.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strpbrk-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -299,4 +299,4 @@ ENTRY(__strpbrk_vx)
 	lgr	%r2,%r1
 	br	%r14
 END(__strpbrk_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strpbrk.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strpbrk.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strpbrk, strpbrk)
 
 #else
 # include <string/strpbrk.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strrchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRRCHR  __strrchr_c
 # undef weak_alias
 # ifdef SHARED
@@ -26,4 +26,4 @@
 # endif /* SHARED */
 
 # include <string/strrchr.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strrchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -177,4 +177,4 @@ ENTRY(__strrchr_vx)
 	.byte	0x0F,0x0E,0x0D,0x0C,0x0B,0x0A,0x09,0x08
 	.byte	0x07,0x06,0x05,0x04,0x03,0x02,0x01,0x00
 END(__strrchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strrchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strrchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (strrchr, rindex)
 
 #else
 # include <string/strrchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strspn-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define STRSPN  __strspn_c
 # ifdef SHARED
 #  undef libc_hidden_builtin_def
@@ -25,4 +25,4 @@
 # endif /* SHARED */
 
 # include <string/strspn.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strspn-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -253,4 +253,4 @@ ENTRY(__strspn_vx)
 	j	.Lslow_next_acc_notonbb /* ... and search for zero in
 					    fully loaded vreg again.  */
 END(__strspn_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/strspn.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/strspn.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <string.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__strspn, strspn)
 
 #else
 # include <string/strspn.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpcpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCPCPY  __wcpcpy_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpcpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -111,4 +111,4 @@ ENTRY(__wcpcpy_vx)
 .Lfallback:
 	jg	__wcpcpy_c
 END(__wcpcpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpcpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpcpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcpcpy, wcpcpy)
 
 #else
 # include <wcsmbs/wcpcpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpncpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCPNCPY  __wcpncpy_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpncpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -219,4 +219,4 @@ ENTRY(__wcpncpy_vx)
 .Lfallback:
 	jg	__wcpncpy_c
 END(__wcpncpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcpncpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcpncpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcpncpy, wcpncpy)
 
 #else
 # include <wcsmbs/wcpncpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscat-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCAT  __wcscat_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscat-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -172,4 +172,4 @@ ENTRY(__wcscat_vx)
 .Lfallback:
 	jg	__wcscat_c
 END(__wcscat_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscat.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscat.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcscat, wcscat)
 
 #else
 # include <wcsmbs/wcscat.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCHR  __wcschr_c
 
 # include <wchar.h>
@@ -28,4 +28,4 @@ extern __typeof (wcschr) __wcschr_c;
 # endif /* SHARED */
 
 # include <wcsmbs/wcschr.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -100,4 +100,4 @@ ENTRY(__wcschr_vx)
 .Lfallback:
 	jg	__wcschr_c
 END(__wcschr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcschr, wcschr)
 
 #else
 # include <wcsmbs/wcschr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschrnul-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCHRNUL  __wcschrnul_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschrnul-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -94,4 +94,4 @@ ENTRY(__wcschrnul_vx)
 .Lfallback:
 	jg	__wcschrnul_c
 END(__wcschrnul_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcschrnul.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcschrnul.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcschrnul, wcschrnul)
 
 #else
 # include <wcsmbs/wcschrnul.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscmp-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCMP  __wcscmp_c
 
 # include <wchar.h>
@@ -27,4 +27,4 @@ extern __typeof (wcscmp) __wcscmp_c;
   __hidden_ver1 (__wcscmp_c, __GI_wcscmp, __wcscmp_c);
 # endif /* SHARED */
 # include <wcsmbs/wcscmp.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscmp-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -128,4 +128,4 @@ ENTRY(__wcscmp_vx)
 	lghi	%r2,0
 	br	%r14
 END(__wcscmp_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcscmp, wcscmp)
 
 #else
 # include <wcsmbs/wcscmp.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCPY  __wcscpy_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -108,4 +108,4 @@ ENTRY(__wcscpy_vx)
 .Lfallback:
 	jg	__wcscpy_c
 END(__wcscpy_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcscpy, wcscpy)
 
 #else
 # include <wcsmbs/wcscpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscspn-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSCSPN  __wcscspn_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscspn-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -290,4 +290,4 @@ ENTRY(__wcscspn_vx)
 .Lfallback:
 	jg	__wcscspn_c
 END(__wcscspn_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcscspn.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcscspn.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcscspn, wcscspn)
 
 #else
 # include <wcsmbs/wcscspn.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcslen-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSLEN  __wcslen_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcslen-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -88,4 +88,4 @@ ENTRY(__wcslen_vx)
 .Lfallback:
 	jg	__wcslen_c
 END(__wcslen_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcslen.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcslen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcslen, wcslen)
 
 #else
 # include <wcsmbs/wcslen.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncat-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSNCAT  __wcsncat_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncat-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -262,4 +262,4 @@ ENTRY(__wcsncat_vx)
 .Lfallback:
 	jg	__wcsncat_c
 END(__wcsncat_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncat.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncat.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcsncat, wcsncat)
 
 #else
 # include <wcsmbs/wcsncat.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncmp-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSNCMP  __wcsncmp_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncmp-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -174,4 +174,4 @@ ENTRY(__wcsncmp_vx)
 	locgrl	%r2,%r1
 	br	%r14
 END(__wcsncmp_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcsncmp, wcsncmp)
 
 #else
 # include <wcsmbs/wcsncmp.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncpy-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSNCPY  __wcsncpy_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncpy-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -220,4 +220,4 @@ ENTRY(__wcsncpy_vx)
 	jg	__wcsncpy_c
 END(__wcsncpy_vx)
 
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsncpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsncpy.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcsncpy, wcsncpy)
 
 #else
 # include <wcsmbs/wcsncpy.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsnlen-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSNLEN  __wcsnlen_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsnlen-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -148,4 +148,4 @@ ENTRY(__wcsnlen_vx)
 .Lfallback:
 	jg	__wcsnlen_c
 END(__wcsnlen_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsnlen.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsnlen.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -25,4 +25,4 @@ weak_alias (__wcsnlen, wcsnlen)
 
 #else
 # include <wcsmbs/wcsnlen.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcspbrk-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSPBRK  __wcspbrk_c
 
 # include <wchar.h>
@@ -28,4 +28,4 @@ extern __typeof (wcspbrk) __wcspbrk_c;
 # endif /* SHARED */
 
 # include <wcsmbs/wcspbrk.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcspbrk-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -312,4 +312,4 @@ ENTRY(__wcspbrk_vx)
 .Lfallback:
 	jg	__wcspbrk_c
 END(__wcspbrk_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcspbrk.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcspbrk.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcspbrk, wcspbrk)
 
 #else
 # include <wcsmbs/wcspbrk.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsrchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSRCHR  __wcsrchr_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsrchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -187,4 +187,4 @@ ENTRY(__wcsrchr_vx)
 .Lfallback:
 	jg	__wcsrchr_c
 END(__wcsrchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsrchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsrchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcsrchr, wcsrchr)
 
 #else
 # include <wcsmbs/wcsrchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsspn-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WCSSPN  __wcsspn_c
 
 # include <wchar.h>
@@ -28,4 +28,4 @@ extern __typeof (wcsspn) __wcsspn_c;
 # endif /* SHARED */
 
 # include <wcsmbs/wcsspn.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsspn-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -267,4 +267,4 @@ ENTRY(__wcsspn_vx)
 .Lfallback:
 	jg	__wcsspn_c
 END(__wcsspn_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wcsspn.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wcsspn.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wcsspn, wcsspn)
 
 #else
 # include <wcsmbs/wcsspn.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemchr-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WMEMCHR  __wmemchr_c
 
 # include <wchar.h>
@@ -28,4 +28,4 @@ extern __typeof (wmemchr) __wmemchr_c;
 # endif /* SHARED */
 
 # include <wcsmbs/wmemchr.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemchr-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -163,4 +163,4 @@ ENTRY(__wmemchr_vx)
 .Lfallback:
 	jg	__wmemchr_c
 END(__wmemchr_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemchr.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemchr.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wmemchr, wmemchr)
 
 #else
 # include <wcsmbs/wmemchr.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemcmp-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WMEMCMP  __wmemcmp_c
 
 # include <wchar.h>
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemcmp-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -146,4 +146,4 @@ ENTRY(__wmemcmp_vx)
 	la	%r3,0(%r5,%r3)
 	j	.Lremaining
 END(__wmemcmp_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemcmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemcmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wmemcmp, wmemcmp)
 
 #else
 # include <wcsmbs/wmemcmp.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset-c.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemset-c.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset-c.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # define WMEMSET  __wmemset_c
 
 # include <wchar.h>
@@ -28,4 +28,4 @@ extern __typeof (wmemset) __wmemset_c;
 # endif /* SHARED */
 
 # include <wcsmbs/wmemset.c>
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset-vx.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemset-vx.S
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset-vx.S
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 
 # include "sysdep.h"
 # include "asm-syntax.h"
@@ -139,4 +139,4 @@ ENTRY(__wmemset_vx)
 	srlg	%r4,%r4,2	/* Convert byte-count to character-count.  */
 	jg	__wmemset_c
 END(__wmemset_vx)
-#endif /* HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc */
+#endif /* HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc) */
Index: glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/multiarch/wmemset.c
+++ glibc-2.17-c758a686/sysdeps/s390/multiarch/wmemset.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc
+#if defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)
 # include <wchar.h>
 # include <ifunc-resolve.h>
 
@@ -24,4 +24,4 @@ s390_vx_libc_ifunc2 (__wmemset, wmemset)
 
 #else
 # include <wcsmbs/wmemset.c>
-#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && !defined NOT_IN_libc) */
+#endif /* !(defined HAVE_S390_VX_ASM_SUPPORT && IS_IN (libc)) */
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcmp-s390.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memcmp-s390.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcmp-s390.S
@@ -27,7 +27,7 @@
 
        .text
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 ENTRY(__memcmp_z196)
 	.machine "z196"
@@ -92,11 +92,11 @@ ENTRY(__memcmp_z10)
 	clc     0(1,%r3),0(%r2)
 END(__memcmp_z10)
 
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
 
 #include "../memcmp.S"
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 .globl   memcmp
 .set     memcmp,__memcmp_default
 .weak    bcmp
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memcmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memcmp)
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcpy-s390.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memcpy-s390.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcpy-s390.S
@@ -27,7 +27,7 @@
 
        .text
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 
 ENTRY(__memcpy_z196)
 	.machine "z196"
@@ -88,11 +88,11 @@ ENTRY(__memcpy_z10)
 	mvc     0(1,%r1),0(%r3)
 END(__memcpy_z10)
 
-#endif /* SHARED && !defined NOT_IN_libc */
+#endif /* SHARED && IS_IN (libc) */
 
 #include "../memcpy.S"
 
-#if !defined SHARED || defined NOT_IN_libc
+#if !defined SHARED || !IS_IN (libc)
 .globl   memcpy
 .set     memcpy,__memcpy_default
 #endif
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memcpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memcpy.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* In the static lib memcpy is needed before the reloc is resolved.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memcpy)
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memset-s390.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memset-s390.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memset-s390.S
@@ -27,7 +27,7 @@
 
        .text
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 ENTRY(__memset_z196)
 	.machine "z196"
@@ -103,11 +103,11 @@ ENTRY(__memset_mvcle)
 	br      %r14
 END(__memset_mvcle)
 
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
 
 #include "../memset.S"
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 .globl   memset
 .set     memset,__memset_default
 #endif
Index: glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memset.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-32/multiarch/memset.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-32/multiarch/memset.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memset)
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcmp-s390x.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memcmp-s390x.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcmp-s390x.S
@@ -27,7 +27,7 @@
 
        .text
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 ENTRY(__memcmp_z196)
 	.machine "z196"
@@ -89,11 +89,11 @@ ENTRY(__memcmp_z10)
 	clc     0(1,%r3),0(%r2)
 END(__memcmp_z10)
 
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
 
 #include "../memcmp.S"
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 .globl   memcmp
 .set     memcmp,__memcmp_default
 .weak    bcmp
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcmp.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memcmp.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcmp.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memcmp)
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcpy-s390x.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memcpy-s390x.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcpy-s390x.S
@@ -27,7 +27,7 @@
 
        .text
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 
 ENTRY(__memcpy_z196)
 	.machine "z196"
@@ -84,11 +84,11 @@ ENTRY(__memcpy_z10)
 	mvc     0(1,%r1),0(%r3)
 END(__memcpy_z10)
 
-#endif /* SHARED && !defined NOT_IN_libc  */
+#endif /* SHARED && IS_IN (libc)  */
 
 #include "../memcpy.S"
 
-#if !defined SHARED || defined NOT_IN_libc
+#if !defined SHARED || !IS_IN (libc)
 .globl   memcpy
 .set     memcpy,__memcpy_default
 #endif
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcpy.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memcpy.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memcpy.c
@@ -17,7 +17,7 @@
    <http://www.gnu.org/licenses/>.  */
 
 /* In the static lib memcpy is needed before the reloc is resolved.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memcpy)
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memset-s390x.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memset-s390x.S
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memset-s390x.S
@@ -27,7 +27,7 @@
 
        .text
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 ENTRY(__memset_z196)
 	.machine "z196"
@@ -99,11 +99,11 @@ ENTRY(__memset_mvcle)
 	br	%r14
 END(__memset_mvcle)
 
-#endif /* !NOT_IN_libc */
+#endif /* !IS_IN (libc) */
 
 #include "../memset.S"
 
-#ifdef NOT_IN_libc
+#if !IS_IN (libc)
 .globl   memset
 .set     memset,__memset_default
 #endif
Index: glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memset.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/s390/s390-64/multiarch/memset.c
+++ glibc-2.17-c758a686/sysdeps/s390/s390-64/multiarch/memset.c
@@ -16,7 +16,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # include <ifunc-resolve.h>
 
 s390_libc_ifunc (memset)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset-x86-64.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/memset-x86-64.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/memset-x86-64.S
@@ -1,6 +1,6 @@
 #include <sysdep.h>
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 # undef ENTRY_CHK
 # define ENTRY_CHK(name) \
 	.type __memset_chk_x86_64, @function; \
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/rawmemchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/rawmemchr.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/rawmemchr.S
@@ -23,7 +23,7 @@
 
 
 /* Define multiple versions only for the definition in lib.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 	.text
 ENTRY(rawmemchr)
 	.type	rawmemchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse2-no-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strlen-sse2-no-bsf.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse2-no-bsf.S
@@ -19,7 +19,7 @@
 
 /* only for strlen case we don't use optimized version for STATIC build just for SHARED */
 
-#if (defined SHARED || defined USE_AS_STRCAT || defined USE_AS_STRNLEN) && !defined NOT_IN_libc
+#if (defined SHARED || defined USE_AS_STRCAT || defined USE_AS_STRNLEN) && IS_IN (libc)
 
 # ifndef USE_AS_STRCAT
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse2-pminub.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strlen-sse2-pminub.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse2-pminub.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if !defined NOT_IN_libc && (defined SHARED || defined USE_AS_STRCAT)
+#if IS_IN (libc) && (defined SHARED || defined USE_AS_STRCAT)
 
 # ifndef USE_AS_STRCAT
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse4.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strlen-sse4.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen-sse4.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 
 #include <sysdep.h>
 
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strlen.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strlen.S
@@ -25,7 +25,7 @@
 /* Define multiple versions only for the definition in libc and for
    the DSO.  In static binaries we need strlen before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(strlen)
 	.type	strlen, @gnu_indirect_function
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strnlen.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strnlen.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strnlen.S
@@ -22,7 +22,7 @@
 
 
 /* Define multiple versions only for the definition in libc.  */
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 
 	.text
 ENTRY(__strnlen)
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strrchr-sse2-no-bsf.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strrchr-sse2-no-bsf.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strrchr-sse2-no-bsf.S
@@ -17,7 +17,7 @@
    License along with the GNU C Library; if not, see
    <http://www.gnu.org/licenses/>.  */
 
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 
 # include <sysdep.h>
 # include "asm-syntax.h"
Index: glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strrchr.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/x86_64/multiarch/strrchr.S
+++ glibc-2.17-c758a686/sysdeps/x86_64/multiarch/strrchr.S
@@ -24,7 +24,7 @@
 /* Define multiple versions only for the definition in libc and for
    the DSO.  In static binaries we need strrchr before the initialization
    happened.  */
-#if defined SHARED && !defined NOT_IN_libc
+#if defined SHARED && IS_IN (libc)
 	.text
 ENTRY(strrchr)
 	.type	strrchr, @gnu_indirect_function
Index: glibc-2.17-c758a686/Makerules
===================================================================
--- glibc-2.17-c758a686.orig/Makerules
+++ glibc-2.17-c758a686/Makerules
@@ -1156,9 +1156,6 @@ lib := nonlib
 include $(patsubst %,$(..)cppflags-iterator.mk,$(cpp-srcs-left))
 endif
 
-# The include magic above causes those files to use this variable for flags.
-CPPFLAGS-nonlib = -DNOT_IN_libc=1
-
 
 ifeq ($(versioning),yes)
 # Generate normalized lists of symbols, versions, and data sizes.
Index: glibc-2.17-c758a686/include/ctype.h
===================================================================
--- glibc-2.17-c758a686.orig/include/ctype.h
+++ glibc-2.17-c758a686/include/ctype.h
@@ -7,7 +7,7 @@ libc_hidden_proto (__ctype_init)
 
 extern int __isctype (int __c, int __mask);
 
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 
 /* These accessors are used by the optimized macros to find the
    thread-local cache of ctype information from the current thread's
@@ -46,13 +46,13 @@ __ctype_tolower_loc (void)
   return __libc_tsd_address (const int32_t *, CTYPE_TOLOWER);
 }
 
-# endif	/* Not NOT_IN_libc.  */
+# endif	/* IS_IN (libc)  */
 #endif
 
 #include <ctype/ctype.h>
 
 #ifndef _ISOMAC
-# if !defined __NO_CTYPE && !defined NOT_IN_libc
+# if !defined __NO_CTYPE && IS_IN (libc)
 /* The spec says that isdigit must only match the decimal digits.  We
    can check this without a memory access.  */
 #  undef isdigit
Index: glibc-2.17-c758a686/include/libc-symbols.h
===================================================================
--- glibc-2.17-c758a686.orig/include/libc-symbols.h
+++ glibc-2.17-c758a686/include/libc-symbols.h
@@ -548,7 +548,7 @@ for linking")
 # define hidden_nolink(name, lib, version)
 #endif
 
-#if !defined NOT_IN_libc
+#if IS_IN (libc)
 # define libc_hidden_proto(name, attrs...) hidden_proto (name, ##attrs)
 # define libc_hidden_def(name) hidden_def (name)
 # define libc_hidden_weak(name) hidden_weak (name)
Index: glibc-2.17-c758a686/include/netdb.h
===================================================================
--- glibc-2.17-c758a686.orig/include/netdb.h
+++ glibc-2.17-c758a686/include/netdb.h
@@ -3,11 +3,11 @@
 
 #ifndef _ISOMAC
 /* Macros for accessing h_errno from inside libc.  */
-# if !defined NOT_IN_libc || IS_IN_LIB
+# if IS_IN_LIB
 #  undef  h_errno
 #  ifdef _LIBC_REENTRANT
 #   include <tls.h>
-#   ifndef NOT_IN_libc
+#   if IS_IN (libc)
 #    define h_errno __libc_h_errno
 #   else
 #    define h_errno h_errno	/* For #ifndef h_errno tests.  */
@@ -16,7 +16,7 @@ extern __thread int h_errno attribute_tl
 #  else
 extern int h_errno;
 #  endif	/* _LIBC_REENTRANT */
-# endif /* !NOT_IN_libc || IS_IN_LIB */
+# endif /* IS_IN_LIB */
 # define __set_h_errno(x) (h_errno = (x))
 
 libc_hidden_proto (hstrerror)
Index: glibc-2.17-c758a686/include/resolv.h
===================================================================
--- glibc-2.17-c758a686.orig/include/resolv.h
+++ glibc-2.17-c758a686/include/resolv.h
@@ -16,7 +16,7 @@
 # ifdef _LIBC_REENTRANT
 #  include <tls.h>
 #  undef _res
-#  ifndef NOT_IN_libc
+#  if IS_IN (libc)
 #   define __resp __libc_resp
 #  endif
 #  define _res (*__resp)
Index: glibc-2.17-c758a686/include/stdlib.h
===================================================================
--- glibc-2.17-c758a686.orig/include/stdlib.h
+++ glibc-2.17-c758a686/include/stdlib.h
@@ -216,7 +216,7 @@ extern int __qfcvt_r (long double __valu
 		      int *__restrict __decpt, int *__restrict __sign,
 		      char *__restrict __buf, size_t __len);
 
-# ifndef NOT_IN_libc
+# if IS_IN (libc)
 #  undef MB_CUR_MAX
 #  define MB_CUR_MAX (_NL_CURRENT_WORD (LC_CTYPE, _NL_CTYPE_MB_CUR_MAX))
 
Index: glibc-2.17-c758a686/locale/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/locale/Makefile
+++ glibc-2.17-c758a686/locale/Makefile
@@ -88,13 +88,13 @@ CPPFLAGS-locale-programs = -DLOCALE_PATH
 			   -DCHARMAP_PATH='"$(i18ndir)/charmaps"' \
 			   -DREPERTOIREMAP_PATH='"$(i18ndir)/repertoiremaps"' \
 			   -DLOCSRCDIR='"$(i18ndir)/locales"' \
-			   -DHAVE_CONFIG_H -DNOT_IN_libc
+			   -DHAVE_CONFIG_H
 
 CFLAGS-charmap.c = -Wno-write-strings -Wno-char-subscripts
 CFLAGS-locfile.c = -Wno-write-strings -Wno-char-subscripts
 CFLAGS-charmap-dir.c = -Wno-write-strings
 
-# This makes sure -DNOT_IN_libc et al are passed for all these modules.
+# Set libof-* for each routine.
 cpp-srcs-left := $(localedef-modules) $(localedef-aux) $(locale-modules) \
 		 $(lib-modules)
 lib := locale-programs
Index: glibc-2.17-c758a686/nss/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/nss/Makefile
+++ glibc-2.17-c758a686/nss/Makefile
@@ -109,7 +109,6 @@ $(inst_vardbdir)/Makefile: db-Makefile $
 	$(do-install)
 
 libof-nss_test1 = extramodules
-CPPFLAGS-nss_test1 = -DNOT_IN_libc=1
 $(objpfx)/libnss_test1.so: $(objpfx)nss_test1.os $(common-objpfx)libc.so \
 			   $(common-objpfx)libc_nonshared.a
 	$(build-module)
Index: glibc-2.17-c758a686/resolv/res_hconf.c
===================================================================
--- glibc-2.17-c758a686.orig/resolv/res_hconf.c
+++ glibc-2.17-c758a686/resolv/res_hconf.c
@@ -359,7 +359,7 @@ _res_hconf_init (void)
 }
 
 
-#ifndef NOT_IN_libc
+#if IS_IN (libc)
 /* List of known interfaces.  */
 libc_freeres_ptr (
 static struct netaddr
Index: glibc-2.17-c758a686/stdlib/Makefile
===================================================================
--- glibc-2.17-c758a686.orig/stdlib/Makefile
+++ glibc-2.17-c758a686/stdlib/Makefile
@@ -139,7 +139,6 @@ LDFLAGS-tst-putenv = $(no-as-needed)
 $(objpfx)tst-putenvmod.so: $(objpfx)tst-putenvmod.os
 	$(build-module)
 libof-tst-putenvmod = extramodules
-CFLAGS-tst-putenvmod.c = -DNOT_IN_libc=1
 
 ifeq ($(build-shared),yes)
 link-libm = $(common-objpfx)math/libm.so
Index: glibc-2.17-c758a686/sysdeps/gnu/errlist.awk
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/gnu/errlist.awk
+++ glibc-2.17-c758a686/sysdeps/gnu/errlist.awk
@@ -109,7 +109,7 @@ END {
   print "  (sizeof _sys_errlist_internal / sizeof _sys_errlist_internal [0])";
   print "const int _sys_nerr_internal = NERR;"
   print "";
-  print "#if !defined NOT_IN_libc && !ERRLIST_NO_COMPAT";
+  print "#if IS_IN (libc) && !ERRLIST_NO_COMPAT";
   print "# include <errlist-compat.c>";
   print "#endif";
   print "";
Index: glibc-2.17-c758a686/sysdeps/gnu/errlist.c
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/gnu/errlist.c
+++ glibc-2.17-c758a686/sysdeps/gnu/errlist.c
@@ -1479,7 +1479,7 @@ TRANS error; @pxref{Cancel AIO Operation
   (sizeof _sys_errlist_internal / sizeof _sys_errlist_internal [0])
 const int _sys_nerr_internal = NERR;
 
-#if !defined NOT_IN_libc && !ERRLIST_NO_COMPAT
+#if IS_IN (libc) && !ERRLIST_NO_COMPAT
 # include <errlist-compat.c>
 #endif
 
Index: glibc-2.17-c758a686/sysdeps/i386/i586/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i586/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i586/memcpy.S
@@ -34,7 +34,7 @@
 #define LEN	SRC+PTR_SIZE
 
         .text
-#if defined PIC && !defined NOT_IN_libc
+#if defined PIC && IS_IN (libc)
 ENTRY (__memcpy_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/memcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/memcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/memcpy.S
@@ -30,7 +30,7 @@
 #define LEN	SRC+PTR_SIZE
 
 	.text
-#if defined PIC && !defined NOT_IN_libc
+#if defined PIC && IS_IN (libc)
 ENTRY_CHK (__memcpy_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/memmove.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/memmove.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/memmove.S
@@ -37,7 +37,7 @@
 # define SRC	DEST+PTR_SIZE
 # define LEN	SRC+PTR_SIZE
 
-# if defined PIC && !defined NOT_IN_libc
+# if defined PIC && IS_IN (libc)
 ENTRY_CHK (__memmove_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
Index: glibc-2.17-c758a686/sysdeps/i386/i686/mempcpy.S
===================================================================
--- glibc-2.17-c758a686.orig/sysdeps/i386/i686/mempcpy.S
+++ glibc-2.17-c758a686/sysdeps/i386/i686/mempcpy.S
@@ -30,7 +30,7 @@
 #define LEN	SRC+PTR_SIZE
 
 	.text
-#if defined PIC && !defined NOT_IN_libc
+#if defined PIC && IS_IN (libc)
 ENTRY_CHK (__mempcpy_chk)
 	movl	12(%esp), %eax
 	cmpl	%eax, 16(%esp)
